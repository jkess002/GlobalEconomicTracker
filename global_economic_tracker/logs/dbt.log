[0m10:50:14.420497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AB665F4320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AB6582A660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AB665F4260>]}


============================== 10:50:14.422999 | 9d2b9564-5c2e-42a0-b93b-74a378c0d2bc ==============================
[0m10:50:14.422999 [info ] [MainThread]: Running with dbt=1.9.4
[0m10:50:14.424004 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\joeyk\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\joeyk\\PycharmProjects\\local_etl_project\\dbt_project\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:50:14.435538 [info ] [MainThread]: dbt version: 1.9.4
[0m10:50:14.436539 [info ] [MainThread]: python version: 3.12.8
[0m10:50:14.436539 [info ] [MainThread]: python path: C:\Users\joeyk\PycharmProjects\local_etl_project\.venv\Scripts\python.exe
[0m10:50:14.436539 [info ] [MainThread]: os info: Windows-11-10.0.26100-SP0
[0m10:50:14.437540 [info ] [MainThread]: Using profiles dir at C:\Users\joeyk\.dbt
[0m10:50:14.437540 [info ] [MainThread]: Using profiles.yml file at C:\Users\joeyk\.dbt\profiles.yml
[0m10:50:14.437540 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\joeyk\PycharmProjects\local_etl_project\dbt_project\dbt_project.yml
[0m10:50:14.463752 [info ] [MainThread]: Configuration:
[0m10:50:14.463752 [info ] [MainThread]:   profiles.yml file [[31mERROR not found[0m]
[0m10:50:14.464753 [info ] [MainThread]:   dbt_project.yml file [[31mERROR invalid[0m]
[0m10:50:14.464753 [info ] [MainThread]: Required dependencies:
[0m10:50:14.464753 [debug] [MainThread]: Executing "git --help"
[0m10:50:14.484766 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m10:50:14.484766 [debug] [MainThread]: STDERR: "b''"
[0m10:50:14.486234 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m10:50:14.486234 [info ] [MainThread]: Connection test skipped since no profile was found
[0m10:50:14.486234 [info ] [MainThread]: [31m2 checks failed:[0m
[0m10:50:14.487237 [info ] [MainThread]: dbt looked for a profiles.yml file in C:\Users\joeyk\.dbt\profiles.yml, but did
not find one. For more information on configuring your profile, consult the
documentation:

https://docs.getdbt.com/docs/configure-your-profile


[0m10:50:14.487237 [info ] [MainThread]: Project loading failed for the following reason:
Runtime Error
  at path ['name']: None is not of type 'string'

Error encountered in C:\Users\joeyk\PycharmProjects\local_etl_project\dbt_project\dbt_project.yml


[0m10:50:14.487237 [debug] [MainThread]: Command `dbt debug` failed at 10:50:14.487237 after 0.14 seconds
[0m10:50:14.488234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AB6577E270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AB6577F0E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AB65FB6C30>]}
[0m10:50:14.488234 [debug] [MainThread]: Flushing usage events
[0m10:50:14.807874 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:15:09.560056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002431FE49100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002431F476960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002431D6094C0>]}


============================== 11:15:09.563564 | c47b5570-8cf6-4bd5-b4e8-61679afd35b7 ==============================
[0m11:15:09.563564 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:15:09.563564 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\joeyk\\PycharmProjects\\GlobalEconomicTracker\\global_economic_tracker\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\joeyk\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select staging.daily_returns', 'send_anonymous_usage_stats': 'True'}
[0m11:15:09.565566 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'global_economic_tracker'
[0m11:15:09.565566 [debug] [MainThread]: Command `dbt run` failed at 11:15:09.565566 after 0.08 seconds
[0m11:15:09.565566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002432040BAD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002431A349E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024320202750>]}
[0m11:15:09.566563 [debug] [MainThread]: Flushing usage events
[0m11:15:10.122935 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:19:41.147041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFFD0E2930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFFD431640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFFA4BCEC0>]}


============================== 11:19:41.150046 | 96b33bd1-f2a7-433e-8545-0280615d2262 ==============================
[0m11:19:41.150046 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:19:41.150046 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\joeyk\\.dbt', 'log_path': 'C:\\Users\\joeyk\\PycharmProjects\\GlobalEconomicTracker\\global_economic_tracker\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select staging.daily_returns', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:19:41.152213 [info ] [MainThread]: Error importing adapter: No module named 'dbt.adapters.sqlite'
[0m11:19:41.153216 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "global_economic_tracker", target "dev" invalid: Runtime Error
    Could not find adapter type sqlite!
[0m11:19:41.153216 [debug] [MainThread]: Command `dbt run` failed at 11:19:41.153216 after 0.08 seconds
[0m11:19:41.153216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFFD26F4A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFFD557530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFFD5CA000>]}
[0m11:19:41.154217 [debug] [MainThread]: Flushing usage events
[0m11:19:41.700673 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:21:23.487157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDBCA63C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDBEF3BC80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDBEF39970>]}


============================== 11:21:23.489488 | 611db355-fa49-4cbe-b6c1-e3aae3e85de3 ==============================
[0m11:21:23.489488 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:21:23.490487 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\joeyk\\PycharmProjects\\GlobalEconomicTracker\\global_economic_tracker\\logs', 'profiles_dir': 'C:\\Users\\joeyk\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:21:23.508970 [info ] [MainThread]: dbt version: 1.9.4
[0m11:21:23.508970 [info ] [MainThread]: python version: 3.12.8
[0m11:21:23.509974 [info ] [MainThread]: python path: C:\Users\joeyk\AppData\Local\Programs\Python\Python312\python.exe
[0m11:21:23.509974 [info ] [MainThread]: os info: Windows-11-10.0.26100-SP0
[0m11:21:23.511973 [info ] [MainThread]: Error importing adapter: No module named 'dbt.adapters.sqlite'
[0m11:21:23.511973 [info ] [MainThread]: Using profiles dir at C:\Users\joeyk\.dbt
[0m11:21:23.512974 [info ] [MainThread]: Using profiles.yml file at C:\Users\joeyk\.dbt\profiles.yml
[0m11:21:23.512974 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\joeyk\PycharmProjects\GlobalEconomicTracker\global_economic_tracker\dbt_project.yml
[0m11:21:23.554024 [info ] [MainThread]: Configuration:
[0m11:21:23.554024 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m11:21:23.554024 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m11:21:23.554024 [info ] [MainThread]: Required dependencies:
[0m11:21:23.555025 [debug] [MainThread]: Executing "git --help"
[0m11:21:23.576903 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m11:21:23.576903 [debug] [MainThread]: STDERR: "b''"
[0m11:21:23.576903 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m11:21:23.576903 [info ] [MainThread]: Connection test skipped since no profile was found
[0m11:21:23.576903 [info ] [MainThread]: [31m1 check failed:[0m
[0m11:21:23.576903 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Credentials in profile "global_economic_tracker", target "dev" invalid: Runtime Error
    Could not find adapter type sqlite!


[0m11:21:23.578406 [debug] [MainThread]: Command `dbt debug` failed at 11:21:23.578406 after 0.17 seconds
[0m11:21:23.578406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDBEF39970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDBF7C4B00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDBF7C6450>]}
[0m11:21:23.578406 [debug] [MainThread]: Flushing usage events
[0m11:21:24.173594 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:22:29.284460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DDC971E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DDFF802C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DDF8955E0>]}


============================== 11:22:29.287457 | a0908dbb-cf43-42be-8907-c031a062d890 ==============================
[0m11:22:29.287457 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:22:29.287457 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\joeyk\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\joeyk\\PycharmProjects\\GlobalEconomicTracker\\global_economic_tracker\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:22:29.299962 [info ] [MainThread]: dbt version: 1.9.4
[0m11:22:29.299962 [info ] [MainThread]: python version: 3.12.8
[0m11:22:29.300465 [info ] [MainThread]: python path: C:\Users\joeyk\AppData\Local\Programs\Python\Python312\python.exe
[0m11:22:29.300465 [info ] [MainThread]: os info: Windows-11-10.0.26100-SP0
[0m11:22:29.311181 [info ] [MainThread]: Using profiles dir at C:\Users\joeyk\.dbt
[0m11:22:29.311181 [info ] [MainThread]: Using profiles.yml file at C:\Users\joeyk\.dbt\profiles.yml
[0m11:22:29.311181 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\joeyk\PycharmProjects\GlobalEconomicTracker\global_economic_tracker\dbt_project.yml
[0m11:22:29.352140 [info ] [MainThread]: Configuration:
[0m11:22:29.353138 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m11:22:29.353138 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m11:22:29.353138 [info ] [MainThread]: Required dependencies:
[0m11:22:29.353138 [debug] [MainThread]: Executing "git --help"
[0m11:22:29.374830 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m11:22:29.374830 [debug] [MainThread]: STDERR: "b''"
[0m11:22:29.374830 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m11:22:29.375831 [info ] [MainThread]: Connection test skipped since no profile was found
[0m11:22:29.375831 [info ] [MainThread]: [31m1 check failed:[0m
[0m11:22:29.375831 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Credentials in profile "global_economic_tracker", target "dev" invalid: 'schema' is a required property


[0m11:22:29.376830 [debug] [MainThread]: Command `dbt debug` failed at 11:22:29.376830 after 0.16 seconds
[0m11:22:29.376830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DDF2F7080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DDF8CE600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DDF814DA0>]}
[0m11:22:29.376830 [debug] [MainThread]: Flushing usage events
[0m11:22:29.753252 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:26:15.412618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001673CFD1E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016740570D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000167405733B0>]}


============================== 11:26:15.415126 | 0d877f93-7d76-4664-94b3-29753e9b747c ==============================
[0m11:26:15.415126 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:26:15.415126 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\joeyk\\PycharmProjects\\GlobalEconomicTracker\\global_economic_tracker\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\joeyk\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt debug', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:26:15.429476 [info ] [MainThread]: dbt version: 1.9.4
[0m11:26:15.430479 [info ] [MainThread]: python version: 3.12.8
[0m11:26:15.430479 [info ] [MainThread]: python path: C:\Users\joeyk\AppData\Local\Programs\Python\Python312\python.exe
[0m11:26:15.430479 [info ] [MainThread]: os info: Windows-11-10.0.26100-SP0
[0m11:26:15.442752 [info ] [MainThread]: Using profiles dir at C:\Users\joeyk\.dbt
[0m11:26:15.442752 [info ] [MainThread]: Using profiles.yml file at C:\Users\joeyk\.dbt\profiles.yml
[0m11:26:15.442752 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\joeyk\PycharmProjects\GlobalEconomicTracker\global_economic_tracker\dbt_project.yml
[0m11:26:15.486955 [info ] [MainThread]: Configuration:
[0m11:26:15.486955 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m11:26:15.486955 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m11:26:15.487955 [info ] [MainThread]: Required dependencies:
[0m11:26:15.487955 [debug] [MainThread]: Executing "git --help"
[0m11:26:15.508990 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m11:26:15.508990 [debug] [MainThread]: STDERR: "b''"
[0m11:26:15.509990 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m11:26:15.509990 [info ] [MainThread]: Connection test skipped since no profile was found
[0m11:26:15.509990 [info ] [MainThread]: [31m1 check failed:[0m
[0m11:26:15.510990 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Credentials in profile "global_economic_tracker", target "dev" invalid: 'schema' is a required property


[0m11:26:15.510990 [debug] [MainThread]: Command `dbt debug` failed at 11:26:15.510990 after 0.17 seconds
[0m11:26:15.511990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001673DA152B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000167403209E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016740320620>]}
[0m11:26:15.511990 [debug] [MainThread]: Flushing usage events
[0m11:26:15.894301 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:27:02.377797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000135C9B99E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000135CAB61730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000135CD56F500>]}


============================== 11:27:02.380286 | 1bf6ce9d-93e1-4012-bd34-b51b54903c5f ==============================
[0m11:27:02.380286 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:27:02.381288 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\joeyk\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\joeyk\\PycharmProjects\\GlobalEconomicTracker\\global_economic_tracker\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:27:02.393308 [info ] [MainThread]: dbt version: 1.9.4
[0m11:27:02.393308 [info ] [MainThread]: python version: 3.12.8
[0m11:27:02.393308 [info ] [MainThread]: python path: C:\Users\joeyk\AppData\Local\Programs\Python\Python312\python.exe
[0m11:27:02.393308 [info ] [MainThread]: os info: Windows-11-10.0.26100-SP0
[0m11:27:02.405764 [info ] [MainThread]: Using profiles dir at C:\Users\joeyk\.dbt
[0m11:27:02.405764 [info ] [MainThread]: Using profiles.yml file at C:\Users\joeyk\.dbt\profiles.yml
[0m11:27:02.406764 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\joeyk\PycharmProjects\GlobalEconomicTracker\global_economic_tracker\dbt_project.yml
[0m11:27:02.446977 [info ] [MainThread]: Configuration:
[0m11:27:02.446977 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m11:27:02.448427 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m11:27:02.448427 [info ] [MainThread]: Required dependencies:
[0m11:27:02.448427 [debug] [MainThread]: Executing "git --help"
[0m11:27:02.472007 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m11:27:02.472007 [debug] [MainThread]: STDERR: "b''"
[0m11:27:02.473004 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m11:27:02.473004 [info ] [MainThread]: Connection test skipped since no profile was found
[0m11:27:02.473004 [info ] [MainThread]: [31m1 check failed:[0m
[0m11:27:02.473004 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Credentials in profile "global_economic_tracker", target "dev" invalid: 'schemas_and_paths' is a required property


[0m11:27:02.474004 [debug] [MainThread]: Command `dbt debug` failed at 11:27:02.474004 after 0.17 seconds
[0m11:27:02.474004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000135CD14EF60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000135CCC0B620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000135CCC09F40>]}
[0m11:27:02.474004 [debug] [MainThread]: Flushing usage events
[0m11:27:02.981863 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:27:43.135678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4AE943B30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4B179DAC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4AF5D92E0>]}


============================== 11:27:43.137681 | 8b59c2e2-6706-4ac8-a25c-336a71d7ff05 ==============================
[0m11:27:43.137681 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:27:43.138681 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\joeyk\\PycharmProjects\\GlobalEconomicTracker\\global_economic_tracker\\logs', 'profiles_dir': 'C:\\Users\\joeyk\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:27:43.149690 [info ] [MainThread]: dbt version: 1.9.4
[0m11:27:43.149690 [info ] [MainThread]: python version: 3.12.8
[0m11:27:43.149690 [info ] [MainThread]: python path: C:\Users\joeyk\AppData\Local\Programs\Python\Python312\python.exe
[0m11:27:43.149690 [info ] [MainThread]: os info: Windows-11-10.0.26100-SP0
[0m11:27:43.162207 [info ] [MainThread]: Using profiles dir at C:\Users\joeyk\.dbt
[0m11:27:43.162207 [info ] [MainThread]: Using profiles.yml file at C:\Users\joeyk\.dbt\profiles.yml
[0m11:27:43.163207 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\joeyk\PycharmProjects\GlobalEconomicTracker\global_economic_tracker\dbt_project.yml
[0m11:27:43.203344 [info ] [MainThread]: Configuration:
[0m11:27:43.204344 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m11:27:43.204344 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m11:27:43.204344 [info ] [MainThread]: Required dependencies:
[0m11:27:43.204344 [debug] [MainThread]: Executing "git --help"
[0m11:27:43.225369 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m11:27:43.225369 [debug] [MainThread]: STDERR: "b''"
[0m11:27:43.226512 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m11:27:43.226512 [info ] [MainThread]: Connection test skipped since no profile was found
[0m11:27:43.226512 [info ] [MainThread]: [31m1 check failed:[0m
[0m11:27:43.226512 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Credentials in profile "global_economic_tracker", target "dev" invalid: 'schema' is a required property


[0m11:27:43.227514 [debug] [MainThread]: Command `dbt debug` failed at 11:27:43.227514 after 0.17 seconds
[0m11:27:43.227514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4AE943B30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4B1C02E40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4B1C03F20>]}
[0m11:27:43.227514 [debug] [MainThread]: Flushing usage events
[0m11:27:43.805757 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:28:41.828939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213789E9E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002137C7404A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002137C743FE0>]}


============================== 11:28:41.831941 | 549ffd20-19d3-46e1-bc88-288a21611e97 ==============================
[0m11:28:41.831941 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:28:41.831941 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\joeyk\\PycharmProjects\\GlobalEconomicTracker\\global_economic_tracker\\logs', 'profiles_dir': 'C:\\Users\\joeyk\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt debug', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:28:41.843224 [info ] [MainThread]: dbt version: 1.9.4
[0m11:28:41.843224 [info ] [MainThread]: python version: 3.12.8
[0m11:28:41.843224 [info ] [MainThread]: python path: C:\Users\joeyk\AppData\Local\Programs\Python\Python312\python.exe
[0m11:28:41.844226 [info ] [MainThread]: os info: Windows-11-10.0.26100-SP0
[0m11:28:41.856403 [info ] [MainThread]: Using profiles dir at C:\Users\joeyk\.dbt
[0m11:28:41.856403 [info ] [MainThread]: Using profiles.yml file at C:\Users\joeyk\.dbt\profiles.yml
[0m11:28:41.856403 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\joeyk\PycharmProjects\GlobalEconomicTracker\global_economic_tracker\dbt_project.yml
[0m11:28:41.897964 [info ] [MainThread]: Configuration:
[0m11:28:41.897964 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m11:28:41.897964 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m11:28:41.898969 [info ] [MainThread]: Required dependencies:
[0m11:28:41.898969 [debug] [MainThread]: Executing "git --help"
[0m11:28:41.919458 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m11:28:41.919458 [debug] [MainThread]: STDERR: "b''"
[0m11:28:41.920457 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m11:28:41.920457 [info ] [MainThread]: Connection test skipped since no profile was found
[0m11:28:41.920457 [info ] [MainThread]: [31m1 check failed:[0m
[0m11:28:41.920457 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Credentials in profile "global_economic_tracker", target "dev" invalid: 'schema_directory' is a required property


[0m11:28:41.921457 [debug] [MainThread]: Command `dbt debug` failed at 11:28:41.921457 after 0.17 seconds
[0m11:28:41.921457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002137C2F7740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002137CAD3D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002137C5CCC50>]}
[0m11:28:41.921457 [debug] [MainThread]: Flushing usage events
[0m11:28:42.421011 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:29:45.387886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A53FA0980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A53FA0890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A545A3950>]}


============================== 11:29:45.390391 | f340e6c5-1690-41e5-8adb-927011d45179 ==============================
[0m11:29:45.390391 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:29:45.390391 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\joeyk\\PycharmProjects\\GlobalEconomicTracker\\global_economic_tracker\\logs', 'profiles_dir': 'C:\\Users\\joeyk\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:29:45.403925 [info ] [MainThread]: dbt version: 1.9.4
[0m11:29:45.403925 [info ] [MainThread]: python version: 3.12.8
[0m11:29:45.404924 [info ] [MainThread]: python path: C:\Users\joeyk\AppData\Local\Programs\Python\Python312\python.exe
[0m11:29:45.404924 [info ] [MainThread]: os info: Windows-11-10.0.26100-SP0
[0m11:29:45.419946 [info ] [MainThread]: Using profiles dir at C:\Users\joeyk\.dbt
[0m11:29:45.419946 [info ] [MainThread]: Using profiles.yml file at C:\Users\joeyk\.dbt\profiles.yml
[0m11:29:45.419946 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\joeyk\PycharmProjects\GlobalEconomicTracker\global_economic_tracker\dbt_project.yml
[0m11:29:45.420950 [info ] [MainThread]: adapter type: sqlite
[0m11:29:45.420950 [info ] [MainThread]: adapter version: 1.9.1
[0m11:29:45.462714 [info ] [MainThread]: Configuration:
[0m11:29:45.462714 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m11:29:45.462714 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m11:29:45.462714 [info ] [MainThread]: Required dependencies:
[0m11:29:45.463714 [debug] [MainThread]: Executing "git --help"
[0m11:29:45.483750 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m11:29:45.483750 [debug] [MainThread]: STDERR: "b''"
[0m11:29:45.484750 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m11:29:45.484750 [info ] [MainThread]: Connection:
[0m11:29:45.484750 [info ] [MainThread]:   database: C:/Users/joeyk/PycharmProjects/GlobalEconomicTracker/db/global_economic_tracker.sqlite
[0m11:29:45.484750 [info ] [MainThread]:   schema: main
[0m11:29:45.484750 [info ] [MainThread]:   schemas_and_paths: {'main': ''}
[0m11:29:45.485752 [info ] [MainThread]:   schema_directory: C:/Users/joeyk/PycharmProjects/GlobalEconomicTracker/db
[0m11:29:45.485752 [info ] [MainThread]: Registered adapter: sqlite=1.9.1
[0m11:29:45.637928 [debug] [MainThread]: Acquiring new sqlite connection 'debug'
[0m11:29:46.744745 [debug] [MainThread]: Using sqlite connection "debug"
[0m11:29:46.744745 [debug] [MainThread]: On debug: select 1 as id
[0m11:29:46.745745 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:29:46.745745 [warn ] [MainThread]: [AdapterEventDebug]: Unable to parse logging event dictionary. Failed to parse args field: Value unable to open database file has unexpected type <class 'sqlite3.OperationalError'> at AdapterEventDebug.args[0].. Dictionary: {'name': 'SQLite', 'base_msg': "Got an error when attempting to open a sqlite3 connection: '%s'", 'args': [OperationalError('unable to open database file')], 'node_info': {}}
[0m11:29:46.746745 [debug] [MainThread]:  adapter: 
[0m11:29:46.746745 [debug] [MainThread]: SQLite adapter: Error running SQL: select 1 as id
[0m11:29:46.746745 [debug] [MainThread]: SQLite adapter: Rolling back transaction.
[0m11:29:46.746745 [debug] [MainThread]: On debug: No close available on handle
[0m11:29:46.746745 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m11:29:46.746745 [info ] [MainThread]: [31m1 check failed:[0m
[0m11:29:46.747745 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Runtime Error
  Database Error
    unable to open database file

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m11:29:46.747745 [debug] [MainThread]: Command `dbt debug` failed at 11:29:46.747745 after 1.43 seconds
[0m11:29:46.747745 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m11:29:46.747745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A547F6300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A54A33E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A54AEF500>]}
[0m11:29:46.747745 [debug] [MainThread]: Flushing usage events
[0m11:29:47.279990 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:32:23.912473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002019B557E00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002019B37E4E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002019B37E600>]}


============================== 11:32:23.915477 | 83d282fe-5ac4-420b-84b3-f8421cb73df5 ==============================
[0m11:32:23.915477 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:32:23.915477 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\joeyk\\PycharmProjects\\GlobalEconomicTracker\\global_economic_tracker\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\joeyk\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:32:23.926486 [info ] [MainThread]: dbt version: 1.9.4
[0m11:32:23.926486 [info ] [MainThread]: python version: 3.12.8
[0m11:32:23.926486 [info ] [MainThread]: python path: C:\Users\joeyk\AppData\Local\Programs\Python\Python312\python.exe
[0m11:32:23.926486 [info ] [MainThread]: os info: Windows-11-10.0.26100-SP0
[0m11:32:23.941000 [info ] [MainThread]: Using profiles dir at C:\Users\joeyk\.dbt
[0m11:32:23.941000 [info ] [MainThread]: Using profiles.yml file at C:\Users\joeyk\.dbt\profiles.yml
[0m11:32:23.941000 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\joeyk\PycharmProjects\GlobalEconomicTracker\global_economic_tracker\dbt_project.yml
[0m11:32:23.941000 [info ] [MainThread]: adapter type: sqlite
[0m11:32:23.941000 [info ] [MainThread]: adapter version: 1.9.1
[0m11:32:23.982328 [info ] [MainThread]: Configuration:
[0m11:32:23.983333 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m11:32:23.983333 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m11:32:23.983333 [info ] [MainThread]: Required dependencies:
[0m11:32:23.984331 [debug] [MainThread]: Executing "git --help"
[0m11:32:24.004357 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m11:32:24.004357 [debug] [MainThread]: STDERR: "b''"
[0m11:32:24.005357 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m11:32:24.005357 [info ] [MainThread]: Connection:
[0m11:32:24.005357 [info ] [MainThread]:   database: ../db/global_economic_tracker.sqlite
[0m11:32:24.005357 [info ] [MainThread]:   schema: main
[0m11:32:24.005357 [info ] [MainThread]:   schemas_and_paths: {'main': ''}
[0m11:32:24.005357 [info ] [MainThread]:   schema_directory: ../db
[0m11:32:24.006357 [info ] [MainThread]: Registered adapter: sqlite=1.9.1
[0m11:32:24.122586 [debug] [MainThread]: Acquiring new sqlite connection 'debug'
[0m11:32:24.165629 [debug] [MainThread]: Using sqlite connection "debug"
[0m11:32:24.166629 [debug] [MainThread]: On debug: select 1 as id
[0m11:32:24.166629 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:32:24.166629 [warn ] [MainThread]: [AdapterEventDebug]: Unable to parse logging event dictionary. Failed to parse args field: Value unable to open database file has unexpected type <class 'sqlite3.OperationalError'> at AdapterEventDebug.args[0].. Dictionary: {'name': 'SQLite', 'base_msg': "Got an error when attempting to open a sqlite3 connection: '%s'", 'args': [OperationalError('unable to open database file')], 'node_info': {}}
[0m11:32:24.166629 [debug] [MainThread]:  adapter: 
[0m11:32:24.166629 [debug] [MainThread]: SQLite adapter: Error running SQL: select 1 as id
[0m11:32:24.166629 [debug] [MainThread]: SQLite adapter: Rolling back transaction.
[0m11:32:24.167629 [debug] [MainThread]: On debug: No close available on handle
[0m11:32:24.167629 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m11:32:24.167629 [info ] [MainThread]: [31m1 check failed:[0m
[0m11:32:24.167629 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Runtime Error
  Database Error
    unable to open database file

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m11:32:24.168629 [debug] [MainThread]: Command `dbt debug` failed at 11:32:24.167629 after 0.33 seconds
[0m11:32:24.168629 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m11:32:24.168629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002019867D2B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002019BEE8440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002019BC55850>]}
[0m11:32:24.168629 [debug] [MainThread]: Flushing usage events
[0m11:32:24.705177 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:33:52.087044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002113393B5F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211341570E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021134157380>]}


============================== 11:33:52.090045 | d5ee0d26-d14c-4c06-a68b-c60d4c0a5e27 ==============================
[0m11:33:52.090045 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:33:52.090045 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\joeyk\\PycharmProjects\\GlobalEconomicTracker\\global_economic_tracker\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\joeyk\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:33:52.102058 [info ] [MainThread]: dbt version: 1.9.4
[0m11:33:52.102058 [info ] [MainThread]: python version: 3.12.8
[0m11:33:52.102058 [info ] [MainThread]: python path: C:\Users\joeyk\AppData\Local\Programs\Python\Python312\python.exe
[0m11:33:52.103059 [info ] [MainThread]: os info: Windows-11-10.0.26100-SP0
[0m11:33:52.147907 [info ] [MainThread]: Using profiles dir at C:\Users\joeyk\.dbt
[0m11:33:52.148913 [info ] [MainThread]: Using profiles.yml file at C:\Users\joeyk\.dbt\profiles.yml
[0m11:33:52.148913 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\joeyk\PycharmProjects\GlobalEconomicTracker\global_economic_tracker\dbt_project.yml
[0m11:33:52.149911 [info ] [MainThread]: adapter type: sqlite
[0m11:33:52.149911 [info ] [MainThread]: adapter version: 1.9.1
[0m11:33:52.191598 [info ] [MainThread]: Configuration:
[0m11:33:52.191598 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m11:33:52.191598 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m11:33:52.191598 [info ] [MainThread]: Required dependencies:
[0m11:33:52.192599 [debug] [MainThread]: Executing "git --help"
[0m11:33:52.213650 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m11:33:52.214649 [debug] [MainThread]: STDERR: "b''"
[0m11:33:52.214649 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m11:33:52.214649 [info ] [MainThread]: Connection:
[0m11:33:52.214649 [info ] [MainThread]:   database: C:/Users/joeyk/PycharmProjects/GlobalEconomicTracker/db/global_economic_tracker.sqlite
[0m11:33:52.216155 [info ] [MainThread]:   schema: main
[0m11:33:52.216155 [info ] [MainThread]:   schemas_and_paths: {'main': ''}
[0m11:33:52.216155 [info ] [MainThread]:   schema_directory: C:/Users/joeyk/PycharmProjects/GlobalEconomicTracker/db
[0m11:33:52.216155 [info ] [MainThread]: Registered adapter: sqlite=1.9.1
[0m11:33:52.418550 [debug] [MainThread]: Acquiring new sqlite connection 'debug'
[0m11:33:53.417438 [debug] [MainThread]: Using sqlite connection "debug"
[0m11:33:53.417438 [debug] [MainThread]: On debug: select 1 as id
[0m11:33:53.417438 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:33:53.418438 [warn ] [MainThread]: [AdapterEventDebug]: Unable to parse logging event dictionary. Failed to parse args field: Value unable to open database file has unexpected type <class 'sqlite3.OperationalError'> at AdapterEventDebug.args[0].. Dictionary: {'name': 'SQLite', 'base_msg': "Got an error when attempting to open a sqlite3 connection: '%s'", 'args': [OperationalError('unable to open database file')], 'node_info': {}}
[0m11:33:53.418438 [debug] [MainThread]:  adapter: 
[0m11:33:53.418438 [debug] [MainThread]: SQLite adapter: Error running SQL: select 1 as id
[0m11:33:53.418438 [debug] [MainThread]: SQLite adapter: Rolling back transaction.
[0m11:33:53.418438 [debug] [MainThread]: On debug: No close available on handle
[0m11:33:53.418438 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m11:33:53.418438 [info ] [MainThread]: [31m1 check failed:[0m
[0m11:33:53.418438 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Runtime Error
  Database Error
    unable to open database file

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m11:33:53.419940 [debug] [MainThread]: Command `dbt debug` failed at 11:33:53.419940 after 1.42 seconds
[0m11:33:53.419940 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m11:33:53.420944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211342E6F30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211348502C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002113494C470>]}
[0m11:33:53.420944 [debug] [MainThread]: Flushing usage events
[0m11:33:53.987163 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:35:45.197687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000117F7A6E570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000117F4789E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000117F79DFCE0>]}


============================== 11:35:45.200193 | d5845b48-d122-4936-9fcb-9aa4ca987375 ==============================
[0m11:35:45.200193 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:35:45.200193 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\joeyk\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\joeyk\\PycharmProjects\\GlobalEconomicTracker\\global_economic_tracker\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m11:35:45.211201 [info ] [MainThread]: dbt version: 1.9.4
[0m11:35:45.212205 [info ] [MainThread]: python version: 3.12.8
[0m11:35:45.212205 [info ] [MainThread]: python path: C:\Users\joeyk\AppData\Local\Programs\Python\Python312\python.exe
[0m11:35:45.212205 [info ] [MainThread]: os info: Windows-11-10.0.26100-SP0
[0m11:35:45.226214 [info ] [MainThread]: Using profiles dir at C:\Users\joeyk\.dbt
[0m11:35:45.226214 [info ] [MainThread]: Using profiles.yml file at C:\Users\joeyk\.dbt\profiles.yml
[0m11:35:45.226214 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\joeyk\PycharmProjects\GlobalEconomicTracker\global_economic_tracker\dbt_project.yml
[0m11:35:45.226214 [info ] [MainThread]: adapter type: sqlite
[0m11:35:45.227718 [info ] [MainThread]: adapter version: 1.9.1
[0m11:35:45.269764 [info ] [MainThread]: Configuration:
[0m11:35:45.269764 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m11:35:45.269764 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m11:35:45.270764 [info ] [MainThread]: Required dependencies:
[0m11:35:45.270764 [debug] [MainThread]: Executing "git --help"
[0m11:35:45.290278 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m11:35:45.290278 [debug] [MainThread]: STDERR: "b''"
[0m11:35:45.291781 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m11:35:45.291781 [info ] [MainThread]: Connection:
[0m11:35:45.291781 [info ] [MainThread]:   database: C:/Users/joeyk/PycharmProjects/GlobalEconomicTracker/db/global_economic_tracker.sqlite
[0m11:35:45.291781 [info ] [MainThread]:   schema: main
[0m11:35:45.292785 [info ] [MainThread]:   schemas_and_paths: {'main': ''}
[0m11:35:45.292785 [info ] [MainThread]:   schema_directory: C:/Users/joeyk/PycharmProjects/GlobalEconomicTracker/db
[0m11:35:45.292785 [info ] [MainThread]: Registered adapter: sqlite=1.9.1
[0m11:35:45.412295 [debug] [MainThread]: Acquiring new sqlite connection 'debug'
[0m11:35:45.458345 [debug] [MainThread]: Using sqlite connection "debug"
[0m11:35:45.458345 [debug] [MainThread]: On debug: select 1 as id
[0m11:35:45.458345 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:35:45.458345 [warn ] [MainThread]: [AdapterEventDebug]: Unable to parse logging event dictionary. Failed to parse args field: Value unable to open database file has unexpected type <class 'sqlite3.OperationalError'> at AdapterEventDebug.args[0].. Dictionary: {'name': 'SQLite', 'base_msg': "Got an error when attempting to open a sqlite3 connection: '%s'", 'args': [OperationalError('unable to open database file')], 'node_info': {}}
[0m11:35:45.459346 [debug] [MainThread]:  adapter: 
[0m11:35:45.459346 [debug] [MainThread]: SQLite adapter: Error running SQL: select 1 as id
[0m11:35:45.459346 [debug] [MainThread]: SQLite adapter: Rolling back transaction.
[0m11:35:45.459346 [debug] [MainThread]: On debug: No close available on handle
[0m11:35:45.459346 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m11:35:45.459346 [info ] [MainThread]: [31m1 check failed:[0m
[0m11:35:45.460346 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Runtime Error
  Database Error
    unable to open database file

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m11:35:45.460346 [debug] [MainThread]: Command `dbt debug` failed at 11:35:45.460346 after 0.33 seconds
[0m11:35:45.460346 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m11:35:45.460346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000117F4D9D220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000117F83AEAE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000117F9ABA3C0>]}
[0m11:35:45.461346 [debug] [MainThread]: Flushing usage events
[0m11:35:46.027019 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:37:11.688208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFE8C0F380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFE8B19460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFE6864DA0>]}


============================== 11:37:11.690719 | 0116487a-ea9c-453a-be3e-fedc62a17c22 ==============================
[0m11:37:11.690719 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:37:11.690719 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\joeyk\\PycharmProjects\\GlobalEconomicTracker\\global_economic_tracker\\logs', 'profiles_dir': 'C:\\Users\\joeyk\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:37:11.702722 [info ] [MainThread]: dbt version: 1.9.4
[0m11:37:11.702722 [info ] [MainThread]: python version: 3.12.8
[0m11:37:11.702722 [info ] [MainThread]: python path: C:\Users\joeyk\AppData\Local\Programs\Python\Python312\python.exe
[0m11:37:11.702722 [info ] [MainThread]: os info: Windows-11-10.0.26100-SP0
[0m11:37:11.716737 [info ] [MainThread]: Using profiles dir at C:\Users\joeyk\.dbt
[0m11:37:11.716737 [info ] [MainThread]: Using profiles.yml file at C:\Users\joeyk\.dbt\profiles.yml
[0m11:37:11.716737 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\joeyk\PycharmProjects\GlobalEconomicTracker\global_economic_tracker\dbt_project.yml
[0m11:37:11.717738 [info ] [MainThread]: adapter type: sqlite
[0m11:37:11.718245 [info ] [MainThread]: adapter version: 1.9.1
[0m11:37:11.761893 [info ] [MainThread]: Configuration:
[0m11:37:11.763399 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m11:37:11.763399 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m11:37:11.763399 [info ] [MainThread]: Required dependencies:
[0m11:37:11.764406 [debug] [MainThread]: Executing "git --help"
[0m11:37:11.785009 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m11:37:11.785009 [debug] [MainThread]: STDERR: "b''"
[0m11:37:11.785009 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m11:37:11.785009 [info ] [MainThread]: Connection:
[0m11:37:11.785009 [info ] [MainThread]:   database: C:/Users/joeyk/PycharmProjects/GlobalEconomicTracker/db/global_economic_tracker.sqlite
[0m11:37:11.786513 [info ] [MainThread]:   schema: main
[0m11:37:11.786513 [info ] [MainThread]:   schemas_and_paths: {'main': ''}
[0m11:37:11.787516 [info ] [MainThread]:   schema_directory: C:/Users/joeyk/PycharmProjects/GlobalEconomicTracker/db
[0m11:37:11.787516 [info ] [MainThread]: Registered adapter: sqlite=1.9.1
[0m11:37:11.901308 [debug] [MainThread]: Acquiring new sqlite connection 'debug'
[0m11:37:11.944063 [debug] [MainThread]: Using sqlite connection "debug"
[0m11:37:11.944063 [debug] [MainThread]: On debug: select 1 as id
[0m11:37:11.944063 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:37:11.944618 [warn ] [MainThread]: [AdapterEventDebug]: Unable to parse logging event dictionary. Failed to parse args field: Value unable to open database file has unexpected type <class 'sqlite3.OperationalError'> at AdapterEventDebug.args[0].. Dictionary: {'name': 'SQLite', 'base_msg': "Got an error when attempting to open a sqlite3 connection: '%s'", 'args': [OperationalError('unable to open database file')], 'node_info': {}}
[0m11:37:11.944618 [debug] [MainThread]:  adapter: 
[0m11:37:11.944618 [debug] [MainThread]: SQLite adapter: Error running SQL: select 1 as id
[0m11:37:11.944618 [debug] [MainThread]: SQLite adapter: Rolling back transaction.
[0m11:37:11.944618 [debug] [MainThread]: On debug: No close available on handle
[0m11:37:11.944618 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m11:37:11.945623 [info ] [MainThread]: [31m1 check failed:[0m
[0m11:37:11.945623 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Runtime Error
  Database Error
    unable to open database file

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m11:37:11.945623 [debug] [MainThread]: Command `dbt debug` failed at 11:37:11.945623 after 0.33 seconds
[0m11:37:11.946623 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m11:37:11.946623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFE8C0F380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFE94EEC90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFE94A0500>]}
[0m11:37:11.946623 [debug] [MainThread]: Flushing usage events
[0m11:37:12.329615 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:38:10.146923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CECDA3D8B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CECDA3FE30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CECDA3E7E0>]}


============================== 11:38:10.148922 | d8c18a6c-98e9-45ea-9dbe-37b5f83b1813 ==============================
[0m11:38:10.148922 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:38:10.149923 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\joeyk\\.dbt', 'log_path': 'C:\\Users\\joeyk\\PycharmProjects\\GlobalEconomicTracker\\global_economic_tracker\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:38:10.162248 [info ] [MainThread]: dbt version: 1.9.4
[0m11:38:10.162248 [info ] [MainThread]: python version: 3.12.8
[0m11:38:10.162248 [info ] [MainThread]: python path: C:\Users\joeyk\AppData\Local\Programs\Python\Python312\python.exe
[0m11:38:10.163251 [info ] [MainThread]: os info: Windows-11-10.0.26100-SP0
[0m11:38:10.175273 [info ] [MainThread]: Using profiles dir at C:\Users\joeyk\.dbt
[0m11:38:10.176272 [info ] [MainThread]: Using profiles.yml file at C:\Users\joeyk\.dbt\profiles.yml
[0m11:38:10.176272 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\joeyk\PycharmProjects\GlobalEconomicTracker\global_economic_tracker\dbt_project.yml
[0m11:38:10.218850 [info ] [MainThread]: Configuration:
[0m11:38:10.219354 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m11:38:10.219354 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m11:38:10.219354 [info ] [MainThread]: Required dependencies:
[0m11:38:10.219354 [debug] [MainThread]: Executing "git --help"
[0m11:38:10.240464 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m11:38:10.240464 [debug] [MainThread]: STDERR: "b''"
[0m11:38:10.242007 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m11:38:10.242007 [info ] [MainThread]: Connection test skipped since no profile was found
[0m11:38:10.243012 [info ] [MainThread]: [31m1 check failed:[0m
[0m11:38:10.243012 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Credentials in profile "global_economic_tracker", target "dev" invalid: 'schemas_and_paths' is a required property


[0m11:38:10.243012 [debug] [MainThread]: Command `dbt debug` failed at 11:38:10.243012 after 0.17 seconds
[0m11:38:10.244012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CECD8B3E60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CECA15EB40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CECDD3E990>]}
[0m11:38:10.244012 [debug] [MainThread]: Flushing usage events
[0m11:38:10.583840 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:38:21.728508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023BB8D55E20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023BB8D551F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023BB866C560>]}


============================== 11:38:21.731520 | c9d4a158-808d-45c1-a87d-9982df876273 ==============================
[0m11:38:21.731520 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:38:21.731520 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\joeyk\\PycharmProjects\\GlobalEconomicTracker\\global_economic_tracker\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\joeyk\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m11:38:21.744535 [info ] [MainThread]: dbt version: 1.9.4
[0m11:38:21.744535 [info ] [MainThread]: python version: 3.12.8
[0m11:38:21.744535 [info ] [MainThread]: python path: C:\Users\joeyk\AppData\Local\Programs\Python\Python312\python.exe
[0m11:38:21.744535 [info ] [MainThread]: os info: Windows-11-10.0.26100-SP0
[0m11:38:21.757594 [info ] [MainThread]: Using profiles dir at C:\Users\joeyk\.dbt
[0m11:38:21.757594 [info ] [MainThread]: Using profiles.yml file at C:\Users\joeyk\.dbt\profiles.yml
[0m11:38:21.757594 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\joeyk\PycharmProjects\GlobalEconomicTracker\global_economic_tracker\dbt_project.yml
[0m11:38:21.798101 [info ] [MainThread]: Configuration:
[0m11:38:21.799100 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m11:38:21.799100 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m11:38:21.799604 [info ] [MainThread]: Required dependencies:
[0m11:38:21.799604 [debug] [MainThread]: Executing "git --help"
[0m11:38:21.820768 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m11:38:21.820768 [debug] [MainThread]: STDERR: "b''"
[0m11:38:21.822278 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m11:38:21.822278 [info ] [MainThread]: Connection test skipped since no profile was found
[0m11:38:21.822278 [info ] [MainThread]: [31m1 check failed:[0m
[0m11:38:21.822278 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  Credentials in profile "global_economic_tracker", target "dev" invalid: 'schema_directory' is a required property


[0m11:38:21.823282 [debug] [MainThread]: Command `dbt debug` failed at 11:38:21.823282 after 0.17 seconds
[0m11:38:21.823282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023BB6D1A090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023BB8696C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023BB86973E0>]}
[0m11:38:21.823282 [debug] [MainThread]: Flushing usage events
[0m11:38:22.391820 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:39:26.899772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A797109E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A79AD75280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A79A465610>]}


============================== 11:39:26.901748 | 1671129a-2a44-49b9-bc51-bb245bcd4389 ==============================
[0m11:39:26.901748 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:39:26.902753 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\joeyk\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\joeyk\\PycharmProjects\\GlobalEconomicTracker\\global_economic_tracker\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m11:39:26.913909 [info ] [MainThread]: dbt version: 1.9.4
[0m11:39:26.913909 [info ] [MainThread]: python version: 3.12.8
[0m11:39:26.913909 [info ] [MainThread]: python path: C:\Users\joeyk\AppData\Local\Programs\Python\Python312\python.exe
[0m11:39:26.913909 [info ] [MainThread]: os info: Windows-11-10.0.26100-SP0
[0m11:39:26.928413 [info ] [MainThread]: Using profiles dir at C:\Users\joeyk\.dbt
[0m11:39:26.929413 [info ] [MainThread]: Using profiles.yml file at C:\Users\joeyk\.dbt\profiles.yml
[0m11:39:26.929413 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\joeyk\PycharmProjects\GlobalEconomicTracker\global_economic_tracker\dbt_project.yml
[0m11:39:26.930414 [info ] [MainThread]: adapter type: sqlite
[0m11:39:26.930414 [info ] [MainThread]: adapter version: 1.9.1
[0m11:39:26.973283 [info ] [MainThread]: Configuration:
[0m11:39:26.973283 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m11:39:26.974281 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m11:39:26.974281 [info ] [MainThread]: Required dependencies:
[0m11:39:26.974281 [debug] [MainThread]: Executing "git --help"
[0m11:39:26.995298 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m11:39:26.996298 [debug] [MainThread]: STDERR: "b''"
[0m11:39:26.997298 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m11:39:26.997298 [info ] [MainThread]: Connection:
[0m11:39:26.997298 [info ] [MainThread]:   database: global_economic_tracker.sqlite
[0m11:39:26.997298 [info ] [MainThread]:   schema: main
[0m11:39:26.997298 [info ] [MainThread]:   schemas_and_paths: {'main': ''}
[0m11:39:26.998299 [info ] [MainThread]:   schema_directory: C:/Users/joeyk/PycharmProjects/GlobalEconomicTracker/db
[0m11:39:26.998299 [info ] [MainThread]: Registered adapter: sqlite=1.9.1
[0m11:39:27.118254 [debug] [MainThread]: Acquiring new sqlite connection 'debug'
[0m11:39:27.165409 [debug] [MainThread]: Using sqlite connection "debug"
[0m11:39:27.165409 [debug] [MainThread]: On debug: select 1 as id
[0m11:39:27.165409 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:39:27.165409 [warn ] [MainThread]: [AdapterEventDebug]: Unable to parse logging event dictionary. Failed to parse args field: Value unable to open database file has unexpected type <class 'sqlite3.OperationalError'> at AdapterEventDebug.args[0].. Dictionary: {'name': 'SQLite', 'base_msg': "Got an error when attempting to open a sqlite3 connection: '%s'", 'args': [OperationalError('unable to open database file')], 'node_info': {}}
[0m11:39:27.165409 [debug] [MainThread]:  adapter: 
[0m11:39:27.166411 [debug] [MainThread]: SQLite adapter: Error running SQL: select 1 as id
[0m11:39:27.166411 [debug] [MainThread]: SQLite adapter: Rolling back transaction.
[0m11:39:27.166411 [debug] [MainThread]: On debug: No close available on handle
[0m11:39:27.166411 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m11:39:27.166411 [info ] [MainThread]: [31m1 check failed:[0m
[0m11:39:27.166411 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Runtime Error
  Database Error
    unable to open database file

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m11:39:27.167410 [debug] [MainThread]: Command `dbt debug` failed at 11:39:27.167410 after 0.34 seconds
[0m11:39:27.167410 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m11:39:27.167410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A79AFCFFB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A79B000740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A79B529C70>]}
[0m11:39:27.168408 [debug] [MainThread]: Flushing usage events
[0m11:39:27.776053 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:20:43.950695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f731b0c5b70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f731a3eebc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f731a3edf00>]}


============================== 20:20:43.953452 | cbc5e60c-08dc-43cd-9140-ed037a823c75 ==============================
[0m20:20:43.953452 [info ] [MainThread]: Running with dbt=1.9.4
[0m20:20:43.954550 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/joey/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/mnt/c/Users/joeyk/PycharmProjects/GlobalEconomicTracker/global_economic_tracker/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m20:20:43.959771 [info ] [MainThread]: dbt version: 1.9.4
[0m20:20:43.960680 [info ] [MainThread]: python version: 3.10.12
[0m20:20:43.961610 [info ] [MainThread]: python path: /usr/bin/python3
[0m20:20:43.962543 [info ] [MainThread]: os info: Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.35
[0m20:20:43.995653 [info ] [MainThread]: Using profiles dir at /home/joey/.dbt
[0m20:20:43.996471 [info ] [MainThread]: Using profiles.yml file at /home/joey/.dbt/profiles.yml
[0m20:20:43.997301 [info ] [MainThread]: Using dbt_project.yml file at /mnt/c/Users/joeyk/PycharmProjects/GlobalEconomicTracker/global_economic_tracker/dbt_project.yml
[0m20:20:43.998191 [info ] [MainThread]: adapter type: postgres
[0m20:20:43.999383 [info ] [MainThread]: adapter version: 1.9.0
[0m20:20:44.051340 [info ] [MainThread]: Configuration:
[0m20:20:44.052217 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m20:20:44.053144 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m20:20:44.053835 [info ] [MainThread]: Required dependencies:
[0m20:20:44.054561 [debug] [MainThread]: Executing "git --help"
[0m20:20:44.056653 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m20:20:44.057351 [debug] [MainThread]: STDERR: "b''"
[0m20:20:44.057963 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m20:20:44.058643 [info ] [MainThread]: Connection:
[0m20:20:44.059361 [info ] [MainThread]:   host: postgres
[0m20:20:44.060071 [info ] [MainThread]:   port: 5432
[0m20:20:44.060799 [info ] [MainThread]:   user: airflow
[0m20:20:44.061518 [info ] [MainThread]:   database: airflow
[0m20:20:44.062193 [info ] [MainThread]:   schema: public
[0m20:20:44.062880 [info ] [MainThread]:   connect_timeout: 10
[0m20:20:44.063556 [info ] [MainThread]:   role: None
[0m20:20:44.064229 [info ] [MainThread]:   search_path: None
[0m20:20:44.065078 [info ] [MainThread]:   keepalives_idle: 0
[0m20:20:44.065948 [info ] [MainThread]:   sslmode: None
[0m20:20:44.066650 [info ] [MainThread]:   sslcert: None
[0m20:20:44.067359 [info ] [MainThread]:   sslkey: None
[0m20:20:44.068043 [info ] [MainThread]:   sslrootcert: None
[0m20:20:44.068762 [info ] [MainThread]:   application_name: dbt
[0m20:20:44.069452 [info ] [MainThread]:   retries: 1
[0m20:20:44.070330 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:20:44.094363 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m20:20:44.100045 [debug] [MainThread]: Using postgres connection "debug"
[0m20:20:44.100728 [debug] [MainThread]: On debug: select 1 as id
[0m20:20:44.101419 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:20:54.113330 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
could not translate host name "postgres" to address: Temporary failure in name resolution

[0m20:21:04.147903 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m20:21:04.148769 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m20:21:04.149520 [debug] [MainThread]: On debug: No close available on handle
[0m20:21:04.150386 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m20:21:04.151268 [info ] [MainThread]: [31m1 check failed:[0m
[0m20:21:04.152077 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  could not translate host name "postgres" to address: Temporary failure in name resolution
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m20:21:04.153236 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 20.24892, "process_in_blocks": "0", "process_kernel_time": 0.051006, "process_mem_max_rss": "101920", "process_out_blocks": "0", "process_user_time": 0.673288}
[0m20:21:04.154168 [debug] [MainThread]: Command `dbt debug` failed at 20:21:04.154092 after 20.25 seconds
[0m20:21:04.154850 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m20:21:04.155653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f731b0c5b70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f731a1cd9f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73195d0130>]}
[0m20:21:04.156400 [debug] [MainThread]: Flushing usage events
[0m20:21:04.685521 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:23:29.941045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadfc85db70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadfb962bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadfb961f00>]}


============================== 20:23:29.942819 | 044b90e0-e195-4f48-98e9-f9f2fe4fdbaa ==============================
[0m20:23:29.942819 [info ] [MainThread]: Running with dbt=1.9.4
[0m20:23:29.943738 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/mnt/c/Users/joeyk/PycharmProjects/GlobalEconomicTracker/global_economic_tracker/logs', 'debug': 'False', 'profiles_dir': '/home/joey/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:23:29.948770 [info ] [MainThread]: dbt version: 1.9.4
[0m20:23:29.949488 [info ] [MainThread]: python version: 3.10.12
[0m20:23:29.950184 [info ] [MainThread]: python path: /usr/bin/python3
[0m20:23:29.950867 [info ] [MainThread]: os info: Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.35
[0m20:23:29.978097 [info ] [MainThread]: Using profiles dir at /home/joey/.dbt
[0m20:23:29.978916 [info ] [MainThread]: Using profiles.yml file at /home/joey/.dbt/profiles.yml
[0m20:23:29.979717 [info ] [MainThread]: Using dbt_project.yml file at /mnt/c/Users/joeyk/PycharmProjects/GlobalEconomicTracker/global_economic_tracker/dbt_project.yml
[0m20:23:29.980534 [info ] [MainThread]: adapter type: postgres
[0m20:23:29.981233 [info ] [MainThread]: adapter version: 1.9.0
[0m20:23:30.033422 [info ] [MainThread]: Configuration:
[0m20:23:30.034421 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m20:23:30.035146 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m20:23:30.035834 [info ] [MainThread]: Required dependencies:
[0m20:23:30.036546 [debug] [MainThread]: Executing "git --help"
[0m20:23:30.038383 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m20:23:30.039062 [debug] [MainThread]: STDERR: "b''"
[0m20:23:30.039702 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m20:23:30.040491 [info ] [MainThread]: Connection:
[0m20:23:30.041194 [info ] [MainThread]:   host: 127.0.0.1
[0m20:23:30.041896 [info ] [MainThread]:   port: 5432
[0m20:23:30.042580 [info ] [MainThread]:   user: airflow
[0m20:23:30.043257 [info ] [MainThread]:   database: airflow
[0m20:23:30.043976 [info ] [MainThread]:   schema: public
[0m20:23:30.044684 [info ] [MainThread]:   connect_timeout: 10
[0m20:23:30.045386 [info ] [MainThread]:   role: None
[0m20:23:30.046073 [info ] [MainThread]:   search_path: None
[0m20:23:30.046771 [info ] [MainThread]:   keepalives_idle: 0
[0m20:23:30.047468 [info ] [MainThread]:   sslmode: None
[0m20:23:30.048235 [info ] [MainThread]:   sslcert: None
[0m20:23:30.049100 [info ] [MainThread]:   sslkey: None
[0m20:23:30.049819 [info ] [MainThread]:   sslrootcert: None
[0m20:23:30.050515 [info ] [MainThread]:   application_name: dbt
[0m20:23:30.051212 [info ] [MainThread]:   retries: 1
[0m20:23:30.052069 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:23:30.076456 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m20:23:30.084400 [debug] [MainThread]: Using postgres connection "debug"
[0m20:23:30.085061 [debug] [MainThread]: On debug: select 1 as id
[0m20:23:30.085717 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:23:30.087046 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "127.0.0.1", port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m20:23:30.087875 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m20:23:30.088523 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m20:23:30.089197 [debug] [MainThread]: On debug: No close available on handle
[0m20:23:30.089851 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m20:23:30.090636 [info ] [MainThread]: [31m1 check failed:[0m
[0m20:23:30.091340 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  connection to server at "127.0.0.1", port 5432 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m20:23:30.092364 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.18841058, "process_in_blocks": "0", "process_kernel_time": 0.058146, "process_mem_max_rss": "101820", "process_out_blocks": "0", "process_user_time": 0.697752}
[0m20:23:30.093100 [debug] [MainThread]: Command `dbt debug` failed at 20:23:30.093032 after 0.19 seconds
[0m20:23:30.093733 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m20:23:30.094412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadfc85db70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadfb278400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fadfb35c130>]}
[0m20:23:30.095125 [debug] [MainThread]: Flushing usage events
[0m20:23:30.523845 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:26:47.656248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb392b71b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb392a3eda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb392a3c760>]}


============================== 20:26:47.658561 | 24df4363-7437-4296-b08e-cd423f964d2a ==============================
[0m20:26:47.658561 [info ] [MainThread]: Running with dbt=1.9.4
[0m20:26:47.659508 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/joey/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/mnt/c/Users/joeyk/PycharmProjects/GlobalEconomicTracker/global_economic_tracker/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m20:26:47.670507 [info ] [MainThread]: dbt version: 1.9.4
[0m20:26:47.671335 [info ] [MainThread]: python version: 3.10.12
[0m20:26:47.672246 [info ] [MainThread]: python path: /usr/bin/python3
[0m20:26:47.672949 [info ] [MainThread]: os info: Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.35
[0m20:26:47.723276 [info ] [MainThread]: Using profiles dir at /home/joey/.dbt
[0m20:26:47.724068 [info ] [MainThread]: Using profiles.yml file at /home/joey/.dbt/profiles.yml
[0m20:26:47.724867 [info ] [MainThread]: Using dbt_project.yml file at /mnt/c/Users/joeyk/PycharmProjects/GlobalEconomicTracker/global_economic_tracker/dbt_project.yml
[0m20:26:47.726041 [info ] [MainThread]: adapter type: postgres
[0m20:26:47.726714 [info ] [MainThread]: adapter version: 1.9.0
[0m20:26:47.780880 [info ] [MainThread]: Configuration:
[0m20:26:47.781628 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m20:26:47.782357 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m20:26:47.783134 [info ] [MainThread]: Required dependencies:
[0m20:26:47.783878 [debug] [MainThread]: Executing "git --help"
[0m20:26:47.790418 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m20:26:47.791154 [debug] [MainThread]: STDERR: "b''"
[0m20:26:47.791878 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m20:26:47.792628 [info ] [MainThread]: Connection:
[0m20:26:47.793399 [info ] [MainThread]:   host: 172.18.0.2
[0m20:26:47.794113 [info ] [MainThread]:   port: 5432
[0m20:26:47.794826 [info ] [MainThread]:   user: airflow
[0m20:26:47.795495 [info ] [MainThread]:   database: airflow
[0m20:26:47.796332 [info ] [MainThread]:   schema: public
[0m20:26:47.797100 [info ] [MainThread]:   connect_timeout: 10
[0m20:26:47.797808 [info ] [MainThread]:   role: None
[0m20:26:47.798511 [info ] [MainThread]:   search_path: None
[0m20:26:47.799220 [info ] [MainThread]:   keepalives_idle: 0
[0m20:26:47.799925 [info ] [MainThread]:   sslmode: None
[0m20:26:47.800709 [info ] [MainThread]:   sslcert: None
[0m20:26:47.801413 [info ] [MainThread]:   sslkey: None
[0m20:26:47.802132 [info ] [MainThread]:   sslrootcert: None
[0m20:26:47.802841 [info ] [MainThread]:   application_name: dbt
[0m20:26:47.803494 [info ] [MainThread]:   retries: 1
[0m20:26:47.804285 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:26:47.877963 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m20:26:47.890333 [debug] [MainThread]: Using postgres connection "debug"
[0m20:26:47.891364 [debug] [MainThread]: On debug: select 1 as id
[0m20:26:47.892309 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:26:47.902510 [debug] [MainThread]: SQL status: SELECT 1 in 0.010 seconds
[0m20:26:47.903890 [debug] [MainThread]: On debug: Close
[0m20:26:47.904861 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m20:26:47.905888 [info ] [MainThread]: [32mAll checks passed![0m
[0m20:26:47.907855 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.2889654, "process_in_blocks": "61904", "process_kernel_time": 0.102213, "process_mem_max_rss": "103284", "process_out_blocks": "0", "process_user_time": 0.756377}
[0m20:26:47.909244 [debug] [MainThread]: Command `dbt debug` succeeded at 20:26:47.909165 after 0.29 seconds
[0m20:26:47.910131 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m20:26:47.911065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb392b71b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb392a578e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb391c76920>]}
[0m20:26:47.912578 [debug] [MainThread]: Flushing usage events
[0m20:26:48.497692 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:28:06.065607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7279605ae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72794e5450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72794e5a50>]}


============================== 20:28:06.067909 | ab517f84-8676-4a4b-8b20-395041694b38 ==============================
[0m20:28:06.067909 [info ] [MainThread]: Running with dbt=1.9.4
[0m20:28:06.068826 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/joey/.dbt', 'log_path': '/mnt/c/Users/joeyk/PycharmProjects/GlobalEconomicTracker/global_economic_tracker/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m20:28:06.205407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ab517f84-8676-4a4b-8b20-395041694b38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f727868ca60>]}
[0m20:28:06.242742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ab517f84-8676-4a4b-8b20-395041694b38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72794e48b0>]}
[0m20:28:06.243830 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:28:06.277495 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m20:28:06.280028 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m20:28:06.280772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ab517f84-8676-4a4b-8b20-395041694b38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7277d076d0>]}
[0m20:28:06.842758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ab517f84-8676-4a4b-8b20-395041694b38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72771516c0>]}
[0m20:28:06.883960 [debug] [MainThread]: Wrote artifact WritableManifest to /mnt/c/Users/joeyk/PycharmProjects/GlobalEconomicTracker/global_economic_tracker/target/manifest.json
[0m20:28:06.888157 [debug] [MainThread]: Wrote artifact SemanticManifest to /mnt/c/Users/joeyk/PycharmProjects/GlobalEconomicTracker/global_economic_tracker/target/semantic_manifest.json
[0m20:28:06.909304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ab517f84-8676-4a4b-8b20-395041694b38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7276d6d8a0>]}
[0m20:28:06.910190 [info ] [MainThread]: Found 2 models, 433 macros
[0m20:28:06.911019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ab517f84-8676-4a4b-8b20-395041694b38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f727a2e4400>]}
[0m20:28:06.912365 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m20:28:06.913194 [debug] [MainThread]: Command end result
[0m20:28:06.931795 [debug] [MainThread]: Wrote artifact WritableManifest to /mnt/c/Users/joeyk/PycharmProjects/GlobalEconomicTracker/global_economic_tracker/target/manifest.json
[0m20:28:06.935186 [debug] [MainThread]: Wrote artifact SemanticManifest to /mnt/c/Users/joeyk/PycharmProjects/GlobalEconomicTracker/global_economic_tracker/target/semantic_manifest.json
[0m20:28:06.939550 [debug] [MainThread]: Wrote artifact RunExecutionResult to /mnt/c/Users/joeyk/PycharmProjects/GlobalEconomicTracker/global_economic_tracker/target/run_results.json
[0m20:28:06.940482 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.92816824, "process_in_blocks": "11104", "process_kernel_time": 0.029532, "process_mem_max_rss": "110052", "process_out_blocks": "0", "process_user_time": 1.358473}
[0m20:28:06.941313 [debug] [MainThread]: Command `dbt test` succeeded at 20:28:06.941237 after 0.93 seconds
[0m20:28:06.941942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7279605ae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72775a84f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7279691420>]}
[0m20:28:06.942580 [debug] [MainThread]: Flushing usage events
[0m20:28:07.616759 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:37:50.708704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90930d1ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90928bb280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9092fabf40>]}


============================== 20:37:50.711048 | 9e64d4a2-1ca8-4113-9f67-9b103d0b3eb8 ==============================
[0m20:37:50.711048 [info ] [MainThread]: Running with dbt=1.9.4
[0m20:37:50.711866 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/joey/.dbt', 'log_path': '/mnt/c/Users/joeyk/PycharmProjects/GlobalEconomicTracker/global_economic_tracker/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt test', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:37:50.796003 [error] [MainThread]: Encountered an error:
Runtime Error
  at path ['models']: [{'name': 'staging_daily_returns', 'description': 'Staging table for daily returns', 'columns': [{'name': 'ticker', 'tests': ['not_null', 'unique']}, {'name': 'timestamp', 'tests': ['not_null']}, {'name': 'daily_return', 'tests': ['not_null']}]}] is not of type 'object'

Error encountered in /mnt/c/Users/joeyk/PycharmProjects/GlobalEconomicTracker/global_economic_tracker/dbt_project.yml
[0m20:37:50.797366 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 0.12664257, "process_in_blocks": "56696", "process_kernel_time": 0.101523, "process_mem_max_rss": "95288", "process_out_blocks": "0", "process_user_time": 0.73097}
[0m20:37:50.798176 [debug] [MainThread]: Command `dbt test` failed at 20:37:50.798099 after 0.13 seconds
[0m20:37:50.798898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90930d1ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90922681c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90922973a0>]}
[0m20:37:50.799601 [debug] [MainThread]: Flushing usage events
[0m20:37:51.274102 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:38:45.514017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6546adb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd653e95bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd653e950f0>]}


============================== 20:38:45.517543 | fa319abe-8714-4ef4-b98c-1390c0ac2fb6 ==============================
[0m20:38:45.517543 [info ] [MainThread]: Running with dbt=1.9.4
[0m20:38:45.519335 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/joey/.dbt', 'log_path': '/mnt/c/Users/joeyk/PycharmProjects/GlobalEconomicTracker/global_economic_tracker/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:38:45.653317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fa319abe-8714-4ef4-b98c-1390c0ac2fb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd655e4e470>]}
[0m20:38:45.683711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fa319abe-8714-4ef4-b98c-1390c0ac2fb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd653ec0700>]}
[0m20:38:45.684937 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:38:45.717894 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m20:38:45.761319 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m20:38:45.762212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'fa319abe-8714-4ef4-b98c-1390c0ac2fb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd653e952d0>]}
[0m20:38:46.316763 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'staging_daily_returns' in the 'models' section of file 'models/staging/staging_daily_returns.yml'
[0m20:38:46.371825 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.global_economic_tracker.not_null_staging_daily_returns_ticker.cbbf80c064' (models/staging/staging_daily_returns.yml) depends on a node named 'staging_daily_returns' in package '' which was not found
[0m20:38:46.372649 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.global_economic_tracker.unique_staging_daily_returns_ticker.5772882af8' (models/staging/staging_daily_returns.yml) depends on a node named 'staging_daily_returns' in package '' which was not found
[0m20:38:46.373487 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.global_economic_tracker.not_null_staging_daily_returns_timestamp.5ec0aef1e2' (models/staging/staging_daily_returns.yml) depends on a node named 'staging_daily_returns' in package '' which was not found
[0m20:38:46.374255 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.global_economic_tracker.not_null_staging_daily_returns_daily_return.c980dcc68f' (models/staging/staging_daily_returns.yml) depends on a node named 'staging_daily_returns' in package '' which was not found
[0m20:38:46.422275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fa319abe-8714-4ef4-b98c-1390c0ac2fb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd650140130>]}
[0m20:38:46.476370 [debug] [MainThread]: Wrote artifact WritableManifest to /mnt/c/Users/joeyk/PycharmProjects/GlobalEconomicTracker/global_economic_tracker/target/manifest.json
[0m20:38:46.483700 [debug] [MainThread]: Wrote artifact SemanticManifest to /mnt/c/Users/joeyk/PycharmProjects/GlobalEconomicTracker/global_economic_tracker/target/semantic_manifest.json
[0m20:38:46.513160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fa319abe-8714-4ef4-b98c-1390c0ac2fb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd650107760>]}
[0m20:38:46.514095 [info ] [MainThread]: Found 2 models, 433 macros
[0m20:38:46.514927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fa319abe-8714-4ef4-b98c-1390c0ac2fb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd65172de10>]}
[0m20:38:46.516751 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m20:38:46.518043 [debug] [MainThread]: Command end result
[0m20:38:46.543415 [debug] [MainThread]: Wrote artifact WritableManifest to /mnt/c/Users/joeyk/PycharmProjects/GlobalEconomicTracker/global_economic_tracker/target/manifest.json
[0m20:38:46.551060 [debug] [MainThread]: Wrote artifact SemanticManifest to /mnt/c/Users/joeyk/PycharmProjects/GlobalEconomicTracker/global_economic_tracker/target/semantic_manifest.json
[0m20:38:46.559087 [debug] [MainThread]: Wrote artifact RunExecutionResult to /mnt/c/Users/joeyk/PycharmProjects/GlobalEconomicTracker/global_economic_tracker/target/run_results.json
[0m20:38:46.560302 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.0970466, "process_in_blocks": "5472", "process_kernel_time": 0.087516, "process_mem_max_rss": "116284", "process_out_blocks": "0", "process_user_time": 1.371096}
[0m20:38:46.562012 [debug] [MainThread]: Command `dbt test` succeeded at 20:38:46.561912 after 1.10 seconds
[0m20:38:46.564416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6546adb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd65473d4b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd655e4e470>]}
[0m20:38:46.565433 [debug] [MainThread]: Flushing usage events
[0m20:38:47.203694 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:49:19.869843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3af0b91a80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3af037baf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3af0378d90>]}


============================== 20:49:19.871751 | 81a5d96c-4af7-4bae-86d9-e6b9a25e8d2c ==============================
[0m20:49:19.871751 [info ] [MainThread]: Running with dbt=1.9.4
[0m20:49:19.872581 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/joey/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/mnt/c/Users/joeyk/PycharmProjects/GlobalEconomicTracker/global_economic_tracker/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m20:49:19.957275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '81a5d96c-4af7-4bae-86d9-e6b9a25e8d2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3af0a70700>]}
[0m20:49:19.986164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '81a5d96c-4af7-4bae-86d9-e6b9a25e8d2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3af03d7280>]}
[0m20:49:19.987131 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:49:20.017049 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m20:49:20.144134 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:49:20.145071 [debug] [MainThread]: Partial parsing: updated file: global_economic_tracker://models/staging/staging_daily_returns.yml
[0m20:49:20.182412 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'staging_daily_returns' in the 'models' section of file 'models/staging/staging_daily_returns.yml'
[0m20:49:20.231889 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.global_economic_tracker.not_null_staging_daily_returns_ticker.cbbf80c064' (models/staging/staging_daily_returns.yml) depends on a node named 'staging_daily_returns' in package '' which was not found
[0m20:49:20.232671 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.global_economic_tracker.unique_staging_daily_returns_ticker.5772882af8' (models/staging/staging_daily_returns.yml) depends on a node named 'staging_daily_returns' in package '' which was not found
[0m20:49:20.233552 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.global_economic_tracker.not_null_staging_daily_returns_timestamp.5ec0aef1e2' (models/staging/staging_daily_returns.yml) depends on a node named 'staging_daily_returns' in package '' which was not found
[0m20:49:20.234436 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.global_economic_tracker.not_null_staging_daily_returns_daily_returns.5d7f3cf7cc' (models/staging/staging_daily_returns.yml) depends on a node named 'staging_daily_returns' in package '' which was not found
[0m20:49:20.274678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '81a5d96c-4af7-4bae-86d9-e6b9a25e8d2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3aed962170>]}
[0m20:49:20.320381 [debug] [MainThread]: Wrote artifact WritableManifest to /mnt/c/Users/joeyk/PycharmProjects/GlobalEconomicTracker/global_economic_tracker/target/manifest.json
[0m20:49:20.324323 [debug] [MainThread]: Wrote artifact SemanticManifest to /mnt/c/Users/joeyk/PycharmProjects/GlobalEconomicTracker/global_economic_tracker/target/semantic_manifest.json
[0m20:49:20.340218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '81a5d96c-4af7-4bae-86d9-e6b9a25e8d2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3aee150a00>]}
[0m20:49:20.340977 [info ] [MainThread]: Found 2 models, 433 macros
[0m20:49:20.341711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '81a5d96c-4af7-4bae-86d9-e6b9a25e8d2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3aedd4d390>]}
[0m20:49:20.343251 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m20:49:20.344125 [debug] [MainThread]: Command end result
[0m20:49:20.387872 [debug] [MainThread]: Wrote artifact WritableManifest to /mnt/c/Users/joeyk/PycharmProjects/GlobalEconomicTracker/global_economic_tracker/target/manifest.json
[0m20:49:20.391569 [debug] [MainThread]: Wrote artifact SemanticManifest to /mnt/c/Users/joeyk/PycharmProjects/GlobalEconomicTracker/global_economic_tracker/target/semantic_manifest.json
[0m20:49:20.396435 [debug] [MainThread]: Wrote artifact RunExecutionResult to /mnt/c/Users/joeyk/PycharmProjects/GlobalEconomicTracker/global_economic_tracker/target/run_results.json
[0m20:49:20.397414 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.5645867, "process_in_blocks": "0", "process_kernel_time": 0.079186, "process_mem_max_rss": "108848", "process_out_blocks": "0", "process_user_time": 0.979931}
[0m20:49:20.398229 [debug] [MainThread]: Command `dbt test` succeeded at 20:49:20.398156 after 0.57 seconds
[0m20:49:20.398936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3af0b91a80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3af0a52500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3aee1a5210>]}
[0m20:49:20.399637 [debug] [MainThread]: Flushing usage events
[0m20:49:20.944705 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:50:45.085989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10054d9b40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1004602080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1004603f10>]}


============================== 20:50:45.087798 | 9006f2b7-fc19-4d63-96af-9ae5d2648320 ==============================
[0m20:50:45.087798 [info ] [MainThread]: Running with dbt=1.9.4
[0m20:50:45.088721 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/joey/.dbt', 'log_path': '/mnt/c/Users/joeyk/PycharmProjects/GlobalEconomicTracker/global_economic_tracker/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:50:45.142881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9006f2b7-fc19-4d63-96af-9ae5d2648320', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1004696ce0>]}
[0m20:50:45.162910 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.11225863, "process_in_blocks": "264", "process_kernel_time": 0.020524, "process_mem_max_rss": "92868", "process_out_blocks": "0", "process_user_time": 0.625987}
[0m20:50:45.163690 [debug] [MainThread]: Command `dbt clean` succeeded at 20:50:45.163615 after 0.11 seconds
[0m20:50:45.164405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f10054d9b40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1004697010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1004697d60>]}
[0m20:50:45.165145 [debug] [MainThread]: Flushing usage events
[0m20:50:45.550271 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:50:48.332606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabb4645ae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabb4525a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabb45257b0>]}


============================== 20:50:48.334343 | 93a34071-4558-4efd-9bb7-5ddb2db4a767 ==============================
[0m20:50:48.334343 [info ] [MainThread]: Running with dbt=1.9.4
[0m20:50:48.335243 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/joey/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/mnt/c/Users/joeyk/PycharmProjects/GlobalEconomicTracker/global_economic_tracker/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:50:48.387634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '93a34071-4558-4efd-9bb7-5ddb2db4a767', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabb3e2fee0>]}
[0m20:50:48.400009 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m20:50:48.402134 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m20:50:48.403138 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.10444931, "process_in_blocks": "408", "process_kernel_time": 0.020813, "process_mem_max_rss": "92972", "process_out_blocks": "0", "process_user_time": 0.603596}
[0m20:50:48.403922 [debug] [MainThread]: Command `dbt deps` succeeded at 20:50:48.403848 after 0.11 seconds
[0m20:50:48.404584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabb4645ae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabb3e2fee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fabb3722a10>]}
[0m20:50:48.405252 [debug] [MainThread]: Flushing usage events
[0m20:50:48.808447 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:50:54.059082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a66ef1ae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a66dd17b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a66dd3190>]}


============================== 20:50:54.060864 | ae6293be-465d-4e5e-b344-bfb9532955d1 ==============================
[0m20:50:54.060864 [info ] [MainThread]: Running with dbt=1.9.4
[0m20:50:54.061723 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/joey/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/mnt/c/Users/joeyk/PycharmProjects/GlobalEconomicTracker/global_economic_tracker/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt compile', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:50:54.138288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ae6293be-465d-4e5e-b344-bfb9532955d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a68692440>]}
[0m20:50:54.172751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ae6293be-465d-4e5e-b344-bfb9532955d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a66620f10>]}
[0m20:50:54.173955 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:50:54.216491 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m20:50:54.220141 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m20:50:54.221448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ae6293be-465d-4e5e-b344-bfb9532955d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a657e4a00>]}
[0m20:50:54.888445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ae6293be-465d-4e5e-b344-bfb9532955d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a63fc9270>]}
[0m20:50:54.938248 [debug] [MainThread]: Wrote artifact WritableManifest to /mnt/c/Users/joeyk/PycharmProjects/GlobalEconomicTracker/global_economic_tracker/target/manifest.json
[0m20:50:54.942809 [debug] [MainThread]: Wrote artifact SemanticManifest to /mnt/c/Users/joeyk/PycharmProjects/GlobalEconomicTracker/global_economic_tracker/target/semantic_manifest.json
[0m20:50:54.952344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ae6293be-465d-4e5e-b344-bfb9532955d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a63fb0280>]}
[0m20:50:54.953088 [info ] [MainThread]: Found 2 models, 4 data tests, 433 macros
[0m20:50:54.953818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ae6293be-465d-4e5e-b344-bfb9532955d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a67b6bd90>]}
[0m20:50:54.955368 [info ] [MainThread]: 
[0m20:50:54.956134 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:50:54.956823 [info ] [MainThread]: 
[0m20:50:54.957622 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:50:54.960218 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_public'
[0m20:50:54.975893 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m20:50:54.976649 [debug] [ThreadPool]: On list_airflow_public: BEGIN
[0m20:50:54.977348 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:50:54.985617 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m20:50:54.986525 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m20:50:54.987271 [debug] [ThreadPool]: On list_airflow_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:50:54.991755 [debug] [ThreadPool]: SQL status: SELECT 42 in 0.004 seconds
[0m20:50:54.993126 [debug] [ThreadPool]: On list_airflow_public: ROLLBACK
[0m20:50:54.993894 [debug] [ThreadPool]: On list_airflow_public: Close
[0m20:50:54.998498 [debug] [MainThread]: Using postgres connection "master"
[0m20:50:54.999197 [debug] [MainThread]: On master: BEGIN
[0m20:50:54.999905 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:50:55.001909 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m20:50:55.002599 [debug] [MainThread]: Using postgres connection "master"
[0m20:50:55.003283 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:50:55.005953 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m20:50:55.007016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ae6293be-465d-4e5e-b344-bfb9532955d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a662e6e30>]}
[0m20:50:55.007734 [debug] [MainThread]: On master: ROLLBACK
[0m20:50:55.008616 [debug] [MainThread]: On master: Close
[0m20:50:55.014623 [debug] [Thread-1 (]: Began running node model.global_economic_tracker.daily_returns
[0m20:50:55.015481 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_public, now model.global_economic_tracker.daily_returns)
[0m20:50:55.016187 [debug] [Thread-1 (]: Began compiling node model.global_economic_tracker.daily_returns
[0m20:50:55.020342 [debug] [Thread-1 (]: Writing injected SQL for node "model.global_economic_tracker.daily_returns"
[0m20:50:55.033910 [debug] [Thread-1 (]: Began executing node model.global_economic_tracker.daily_returns
[0m20:50:55.034764 [debug] [Thread-1 (]: Finished running node model.global_economic_tracker.daily_returns
[0m20:50:55.036006 [debug] [Thread-3 (]: Began running node model.global_economic_tracker.rolling_metrics
[0m20:50:55.036257 [debug] [Thread-4 (]: Began running node test.global_economic_tracker.not_null_daily_returns_daily_return.93322b076b
[0m20:50:55.036508 [debug] [Thread-2 (]: Began running node test.global_economic_tracker.not_null_daily_returns_ticker.2a93ed2341
[0m20:50:55.036765 [debug] [Thread-1 (]: Began running node test.global_economic_tracker.not_null_daily_returns_timestamp.657a6e8fda
[0m20:50:55.037553 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.global_economic_tracker.rolling_metrics'
[0m20:50:55.038357 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.global_economic_tracker.not_null_daily_returns_daily_return.93322b076b'
[0m20:50:55.039141 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.global_economic_tracker.not_null_daily_returns_ticker.2a93ed2341'
[0m20:50:55.039921 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.global_economic_tracker.daily_returns, now test.global_economic_tracker.not_null_daily_returns_timestamp.657a6e8fda)
[0m20:50:55.040665 [debug] [Thread-3 (]: Began compiling node model.global_economic_tracker.rolling_metrics
[0m20:50:55.041375 [debug] [Thread-4 (]: Began compiling node test.global_economic_tracker.not_null_daily_returns_daily_return.93322b076b
[0m20:50:55.042081 [debug] [Thread-2 (]: Began compiling node test.global_economic_tracker.not_null_daily_returns_ticker.2a93ed2341
[0m20:50:55.042792 [debug] [Thread-1 (]: Began compiling node test.global_economic_tracker.not_null_daily_returns_timestamp.657a6e8fda
[0m20:50:55.044733 [debug] [Thread-3 (]: Writing injected SQL for node "model.global_economic_tracker.rolling_metrics"
[0m20:50:55.051154 [debug] [Thread-4 (]: Writing injected SQL for node "test.global_economic_tracker.not_null_daily_returns_daily_return.93322b076b"
[0m20:50:55.053556 [debug] [Thread-2 (]: Writing injected SQL for node "test.global_economic_tracker.not_null_daily_returns_ticker.2a93ed2341"
[0m20:50:55.056088 [debug] [Thread-1 (]: Writing injected SQL for node "test.global_economic_tracker.not_null_daily_returns_timestamp.657a6e8fda"
[0m20:50:55.061538 [debug] [Thread-3 (]: Began executing node model.global_economic_tracker.rolling_metrics
[0m20:50:55.062425 [debug] [Thread-3 (]: Finished running node model.global_economic_tracker.rolling_metrics
[0m20:50:55.063159 [debug] [Thread-3 (]: Began running node test.global_economic_tracker.unique_daily_returns_ticker.37e3dc3873
[0m20:50:55.063997 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.global_economic_tracker.rolling_metrics, now test.global_economic_tracker.unique_daily_returns_ticker.37e3dc3873)
[0m20:50:55.064247 [debug] [Thread-1 (]: Began executing node test.global_economic_tracker.not_null_daily_returns_timestamp.657a6e8fda
[0m20:50:55.064928 [debug] [Thread-3 (]: Began compiling node test.global_economic_tracker.unique_daily_returns_ticker.37e3dc3873
[0m20:50:55.065246 [debug] [Thread-4 (]: Began executing node test.global_economic_tracker.not_null_daily_returns_daily_return.93322b076b
[0m20:50:55.066181 [debug] [Thread-1 (]: Finished running node test.global_economic_tracker.not_null_daily_returns_timestamp.657a6e8fda
[0m20:50:55.066700 [debug] [Thread-2 (]: Began executing node test.global_economic_tracker.not_null_daily_returns_ticker.2a93ed2341
[0m20:50:55.070116 [debug] [Thread-3 (]: Writing injected SQL for node "test.global_economic_tracker.unique_daily_returns_ticker.37e3dc3873"
[0m20:50:55.071025 [debug] [Thread-4 (]: Finished running node test.global_economic_tracker.not_null_daily_returns_daily_return.93322b076b
[0m20:50:55.072463 [debug] [Thread-2 (]: Finished running node test.global_economic_tracker.not_null_daily_returns_ticker.2a93ed2341
[0m20:50:55.079745 [debug] [Thread-3 (]: Began executing node test.global_economic_tracker.unique_daily_returns_ticker.37e3dc3873
[0m20:50:55.080611 [debug] [Thread-3 (]: Finished running node test.global_economic_tracker.unique_daily_returns_ticker.37e3dc3873
[0m20:50:55.082027 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:50:55.082689 [debug] [MainThread]: Connection 'test.global_economic_tracker.not_null_daily_returns_timestamp.657a6e8fda' was properly closed.
[0m20:50:55.083328 [debug] [MainThread]: Connection 'test.global_economic_tracker.unique_daily_returns_ticker.37e3dc3873' was properly closed.
[0m20:50:55.083931 [debug] [MainThread]: Connection 'test.global_economic_tracker.not_null_daily_returns_daily_return.93322b076b' was properly closed.
[0m20:50:55.084571 [debug] [MainThread]: Connection 'test.global_economic_tracker.not_null_daily_returns_ticker.2a93ed2341' was properly closed.
[0m20:50:55.085588 [debug] [MainThread]: Command end result
[0m20:50:55.105360 [debug] [MainThread]: Wrote artifact WritableManifest to /mnt/c/Users/joeyk/PycharmProjects/GlobalEconomicTracker/global_economic_tracker/target/manifest.json
[0m20:50:55.108942 [debug] [MainThread]: Wrote artifact SemanticManifest to /mnt/c/Users/joeyk/PycharmProjects/GlobalEconomicTracker/global_economic_tracker/target/semantic_manifest.json
[0m20:50:55.115546 [debug] [MainThread]: Wrote artifact RunExecutionResult to /mnt/c/Users/joeyk/PycharmProjects/GlobalEconomicTracker/global_economic_tracker/target/run_results.json
[0m20:50:55.116548 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 1.0919905, "process_in_blocks": "4608", "process_kernel_time": 0.048354, "process_mem_max_rss": "120392", "process_out_blocks": "0", "process_user_time": 1.382931}
[0m20:50:55.117383 [debug] [MainThread]: Command `dbt compile` succeeded at 20:50:55.117309 after 1.09 seconds
[0m20:50:55.118053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a66ef1ae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a68692440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a63facf10>]}
[0m20:50:55.118744 [debug] [MainThread]: Flushing usage events
[0m20:50:55.474802 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:51:01.899775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c9c20db10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c9b9f5bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c9b9f50f0>]}


============================== 20:51:01.901950 | 9206c74a-3bc6-4796-827a-30d9f5d74797 ==============================
[0m20:51:01.901950 [info ] [MainThread]: Running with dbt=1.9.4
[0m20:51:01.902827 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/mnt/c/Users/joeyk/PycharmProjects/GlobalEconomicTracker/global_economic_tracker/logs', 'debug': 'False', 'profiles_dir': '/home/joey/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt test', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:51:01.982241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9206c74a-3bc6-4796-827a-30d9f5d74797', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c9d9ae470>]}
[0m20:51:02.020297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9206c74a-3bc6-4796-827a-30d9f5d74797', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c9ba20700>]}
[0m20:51:02.021979 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:51:02.064864 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m20:51:02.221083 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:51:02.221883 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:51:02.244441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9206c74a-3bc6-4796-827a-30d9f5d74797', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c99bc4130>]}
[0m20:51:02.292281 [debug] [MainThread]: Wrote artifact WritableManifest to /mnt/c/Users/joeyk/PycharmProjects/GlobalEconomicTracker/global_economic_tracker/target/manifest.json
[0m20:51:02.296509 [debug] [MainThread]: Wrote artifact SemanticManifest to /mnt/c/Users/joeyk/PycharmProjects/GlobalEconomicTracker/global_economic_tracker/target/semantic_manifest.json
[0m20:51:02.311063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9206c74a-3bc6-4796-827a-30d9f5d74797', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c99b54250>]}
[0m20:51:02.311839 [info ] [MainThread]: Found 2 models, 4 data tests, 433 macros
[0m20:51:02.312586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9206c74a-3bc6-4796-827a-30d9f5d74797', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c9c0ef400>]}
[0m20:51:02.314053 [info ] [MainThread]: 
[0m20:51:02.314775 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:51:02.315465 [info ] [MainThread]: 
[0m20:51:02.316312 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:51:02.319090 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_public'
[0m20:51:02.331902 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m20:51:02.332598 [debug] [ThreadPool]: On list_airflow_public: BEGIN
[0m20:51:02.333268 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:51:02.335959 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m20:51:02.336656 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m20:51:02.337325 [debug] [ThreadPool]: On list_airflow_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:51:02.339136 [debug] [ThreadPool]: SQL status: SELECT 42 in 0.001 seconds
[0m20:51:02.340576 [debug] [ThreadPool]: On list_airflow_public: ROLLBACK
[0m20:51:02.341364 [debug] [ThreadPool]: On list_airflow_public: Close
[0m20:51:02.346179 [debug] [MainThread]: Using postgres connection "master"
[0m20:51:02.347224 [debug] [MainThread]: On master: BEGIN
[0m20:51:02.347895 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:51:02.349961 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m20:51:02.350654 [debug] [MainThread]: Using postgres connection "master"
[0m20:51:02.351392 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:51:02.353257 [debug] [MainThread]: SQL status: SELECT 0 in 0.001 seconds
[0m20:51:02.354290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9206c74a-3bc6-4796-827a-30d9f5d74797', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c9b5fee30>]}
[0m20:51:02.355032 [debug] [MainThread]: On master: ROLLBACK
[0m20:51:02.355779 [debug] [MainThread]: Using postgres connection "master"
[0m20:51:02.356444 [debug] [MainThread]: On master: BEGIN
[0m20:51:02.357304 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m20:51:02.358018 [debug] [MainThread]: On master: COMMIT
[0m20:51:02.358699 [debug] [MainThread]: Using postgres connection "master"
[0m20:51:02.359372 [debug] [MainThread]: On master: COMMIT
[0m20:51:02.360157 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:51:02.360834 [debug] [MainThread]: On master: Close
[0m20:51:02.364145 [debug] [Thread-1 (]: Began running node test.global_economic_tracker.not_null_daily_returns_daily_return.93322b076b
[0m20:51:02.364407 [debug] [Thread-2 (]: Began running node test.global_economic_tracker.not_null_daily_returns_ticker.2a93ed2341
[0m20:51:02.364673 [debug] [Thread-3 (]: Began running node test.global_economic_tracker.not_null_daily_returns_timestamp.657a6e8fda
[0m20:51:02.364942 [debug] [Thread-4 (]: Began running node test.global_economic_tracker.unique_daily_returns_ticker.37e3dc3873
[0m20:51:02.365345 [info ] [Thread-1 (]: 1 of 4 START test not_null_daily_returns_daily_return .......................... [RUN]
[0m20:51:02.366124 [info ] [Thread-2 (]: 2 of 4 START test not_null_daily_returns_ticker ................................ [RUN]
[0m20:51:02.366865 [info ] [Thread-3 (]: 3 of 4 START test not_null_daily_returns_timestamp ............................. [RUN]
[0m20:51:02.367592 [info ] [Thread-4 (]: 4 of 4 START test unique_daily_returns_ticker .................................. [RUN]
[0m20:51:02.368364 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_public, now test.global_economic_tracker.not_null_daily_returns_daily_return.93322b076b)
[0m20:51:02.369206 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.global_economic_tracker.not_null_daily_returns_ticker.2a93ed2341'
[0m20:51:02.369999 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.global_economic_tracker.not_null_daily_returns_timestamp.657a6e8fda'
[0m20:51:02.370793 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.global_economic_tracker.unique_daily_returns_ticker.37e3dc3873'
[0m20:51:02.371526 [debug] [Thread-1 (]: Began compiling node test.global_economic_tracker.not_null_daily_returns_daily_return.93322b076b
[0m20:51:02.372246 [debug] [Thread-2 (]: Began compiling node test.global_economic_tracker.not_null_daily_returns_ticker.2a93ed2341
[0m20:51:02.373000 [debug] [Thread-3 (]: Began compiling node test.global_economic_tracker.not_null_daily_returns_timestamp.657a6e8fda
[0m20:51:02.373746 [debug] [Thread-4 (]: Began compiling node test.global_economic_tracker.unique_daily_returns_ticker.37e3dc3873
[0m20:51:02.382317 [debug] [Thread-1 (]: Writing injected SQL for node "test.global_economic_tracker.not_null_daily_returns_daily_return.93322b076b"
[0m20:51:02.384630 [debug] [Thread-2 (]: Writing injected SQL for node "test.global_economic_tracker.not_null_daily_returns_ticker.2a93ed2341"
[0m20:51:02.387446 [debug] [Thread-3 (]: Writing injected SQL for node "test.global_economic_tracker.not_null_daily_returns_timestamp.657a6e8fda"
[0m20:51:02.415396 [debug] [Thread-4 (]: Writing injected SQL for node "test.global_economic_tracker.unique_daily_returns_ticker.37e3dc3873"
[0m20:51:02.420560 [debug] [Thread-1 (]: Began executing node test.global_economic_tracker.not_null_daily_returns_daily_return.93322b076b
[0m20:51:02.420836 [debug] [Thread-2 (]: Began executing node test.global_economic_tracker.not_null_daily_returns_ticker.2a93ed2341
[0m20:51:02.426787 [debug] [Thread-3 (]: Began executing node test.global_economic_tracker.not_null_daily_returns_timestamp.657a6e8fda
[0m20:51:02.428686 [debug] [Thread-1 (]: Writing runtime sql for node "test.global_economic_tracker.not_null_daily_returns_daily_return.93322b076b"
[0m20:51:02.428966 [debug] [Thread-4 (]: Began executing node test.global_economic_tracker.unique_daily_returns_ticker.37e3dc3873
[0m20:51:02.430537 [debug] [Thread-2 (]: Writing runtime sql for node "test.global_economic_tracker.not_null_daily_returns_ticker.2a93ed2341"
[0m20:51:02.432110 [debug] [Thread-3 (]: Writing runtime sql for node "test.global_economic_tracker.not_null_daily_returns_timestamp.657a6e8fda"
[0m20:51:02.434569 [debug] [Thread-4 (]: Writing runtime sql for node "test.global_economic_tracker.unique_daily_returns_ticker.37e3dc3873"
[0m20:51:02.445665 [debug] [Thread-1 (]: Using postgres connection "test.global_economic_tracker.not_null_daily_returns_daily_return.93322b076b"
[0m20:51:02.446359 [debug] [Thread-1 (]: On test.global_economic_tracker.not_null_daily_returns_daily_return.93322b076b: BEGIN
[0m20:51:02.447195 [debug] [Thread-4 (]: Using postgres connection "test.global_economic_tracker.unique_daily_returns_ticker.37e3dc3873"
[0m20:51:02.447483 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:51:02.448375 [debug] [Thread-4 (]: On test.global_economic_tracker.unique_daily_returns_ticker.37e3dc3873: BEGIN
[0m20:51:02.448775 [debug] [Thread-3 (]: Using postgres connection "test.global_economic_tracker.not_null_daily_returns_timestamp.657a6e8fda"
[0m20:51:02.450104 [debug] [Thread-2 (]: Using postgres connection "test.global_economic_tracker.not_null_daily_returns_ticker.2a93ed2341"
[0m20:51:02.450423 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:51:02.451353 [debug] [Thread-3 (]: On test.global_economic_tracker.not_null_daily_returns_timestamp.657a6e8fda: BEGIN
[0m20:51:02.451888 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m20:51:02.452318 [debug] [Thread-2 (]: On test.global_economic_tracker.not_null_daily_returns_ticker.2a93ed2341: BEGIN
[0m20:51:02.453726 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:51:02.454485 [debug] [Thread-1 (]: Using postgres connection "test.global_economic_tracker.not_null_daily_returns_daily_return.93322b076b"
[0m20:51:02.454999 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m20:51:02.455459 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:51:02.456855 [debug] [Thread-1 (]: On test.global_economic_tracker.not_null_daily_returns_daily_return.93322b076b: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.not_null_daily_returns_daily_return.93322b076b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select daily_return
from "airflow"."public"."daily_returns"
where daily_return is null



      
    ) dbt_internal_test
[0m20:51:02.457637 [debug] [Thread-4 (]: Using postgres connection "test.global_economic_tracker.unique_daily_returns_ticker.37e3dc3873"
[0m20:51:02.457970 [debug] [Thread-3 (]: SQL status: BEGIN in 0.004 seconds
[0m20:51:02.459724 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.daily_returns" does not exist
LINE 14: from "airflow"."public"."daily_returns"
              ^

[0m20:51:02.460395 [debug] [Thread-4 (]: On test.global_economic_tracker.unique_daily_returns_ticker.37e3dc3873: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.unique_daily_returns_ticker.37e3dc3873"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    ticker as unique_field,
    count(*) as n_records

from "airflow"."public"."daily_returns"
where ticker is not null
group by ticker
having count(*) > 1



      
    ) dbt_internal_test
[0m20:51:02.461039 [debug] [Thread-2 (]: SQL status: BEGIN in 0.006 seconds
[0m20:51:02.461432 [debug] [Thread-3 (]: Using postgres connection "test.global_economic_tracker.not_null_daily_returns_timestamp.657a6e8fda"
[0m20:51:02.462191 [debug] [Thread-1 (]: On test.global_economic_tracker.not_null_daily_returns_daily_return.93322b076b: ROLLBACK
[0m20:51:02.463194 [debug] [Thread-4 (]: Postgres adapter: Postgres error: relation "public.daily_returns" does not exist
LINE 15: from "airflow"."public"."daily_returns"
              ^

[0m20:51:02.463906 [debug] [Thread-2 (]: Using postgres connection "test.global_economic_tracker.not_null_daily_returns_ticker.2a93ed2341"
[0m20:51:02.464734 [debug] [Thread-3 (]: On test.global_economic_tracker.not_null_daily_returns_timestamp.657a6e8fda: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.not_null_daily_returns_timestamp.657a6e8fda"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select timestamp
from "airflow"."public"."daily_returns"
where timestamp is null



      
    ) dbt_internal_test
[0m20:51:02.465630 [debug] [Thread-1 (]: On test.global_economic_tracker.not_null_daily_returns_daily_return.93322b076b: Close
[0m20:51:02.466187 [debug] [Thread-4 (]: On test.global_economic_tracker.unique_daily_returns_ticker.37e3dc3873: ROLLBACK
[0m20:51:02.466875 [debug] [Thread-2 (]: On test.global_economic_tracker.not_null_daily_returns_ticker.2a93ed2341: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.not_null_daily_returns_ticker.2a93ed2341"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select ticker
from "airflow"."public"."daily_returns"
where ticker is null



      
    ) dbt_internal_test
[0m20:51:02.467851 [debug] [Thread-3 (]: Postgres adapter: Postgres error: relation "public.daily_returns" does not exist
LINE 14: from "airflow"."public"."daily_returns"
              ^

[0m20:51:02.469371 [debug] [Thread-4 (]: On test.global_economic_tracker.unique_daily_returns_ticker.37e3dc3873: Close
[0m20:51:02.470366 [debug] [Thread-2 (]: Postgres adapter: Postgres error: relation "public.daily_returns" does not exist
LINE 14: from "airflow"."public"."daily_returns"
              ^

[0m20:51:02.471110 [debug] [Thread-3 (]: On test.global_economic_tracker.not_null_daily_returns_timestamp.657a6e8fda: ROLLBACK
[0m20:51:02.473526 [debug] [Thread-2 (]: On test.global_economic_tracker.not_null_daily_returns_ticker.2a93ed2341: ROLLBACK
[0m20:51:02.474829 [debug] [Thread-3 (]: On test.global_economic_tracker.not_null_daily_returns_timestamp.657a6e8fda: Close
[0m20:51:02.476135 [debug] [Thread-1 (]: Database Error in test not_null_daily_returns_daily_return (models/staging/staging_daily_returns.yml)
  relation "public.daily_returns" does not exist
  LINE 14: from "airflow"."public"."daily_returns"
                ^
  compiled code at target/run/global_economic_tracker/models/staging/staging_daily_returns.yml/not_null_daily_returns_daily_return.sql
[0m20:51:02.476520 [debug] [Thread-2 (]: On test.global_economic_tracker.not_null_daily_returns_ticker.2a93ed2341: Close
[0m20:51:02.476837 [debug] [Thread-4 (]: Database Error in test unique_daily_returns_ticker (models/staging/staging_daily_returns.yml)
  relation "public.daily_returns" does not exist
  LINE 15: from "airflow"."public"."daily_returns"
                ^
  compiled code at target/run/global_economic_tracker/models/staging/staging_daily_returns.yml/unique_daily_returns_ticker.sql
[0m20:51:02.477678 [debug] [Thread-3 (]: Database Error in test not_null_daily_returns_timestamp (models/staging/staging_daily_returns.yml)
  relation "public.daily_returns" does not exist
  LINE 14: from "airflow"."public"."daily_returns"
                ^
  compiled code at target/run/global_economic_tracker/models/staging/staging_daily_returns.yml/not_null_daily_returns_timestamp.sql
[0m20:51:02.478303 [error] [Thread-1 (]: 1 of 4 ERROR not_null_daily_returns_daily_return ............................... [[31mERROR[0m in 0.11s]
[0m20:51:02.479348 [debug] [Thread-2 (]: Database Error in test not_null_daily_returns_ticker (models/staging/staging_daily_returns.yml)
  relation "public.daily_returns" does not exist
  LINE 14: from "airflow"."public"."daily_returns"
                ^
  compiled code at target/run/global_economic_tracker/models/staging/staging_daily_returns.yml/not_null_daily_returns_ticker.sql
[0m20:51:02.480046 [error] [Thread-4 (]: 4 of 4 ERROR unique_daily_returns_ticker ....................................... [[31mERROR[0m in 0.11s]
[0m20:51:02.480852 [error] [Thread-3 (]: 3 of 4 ERROR not_null_daily_returns_timestamp .................................. [[31mERROR[0m in 0.11s]
[0m20:51:02.481705 [debug] [Thread-1 (]: Finished running node test.global_economic_tracker.not_null_daily_returns_daily_return.93322b076b
[0m20:51:02.482478 [error] [Thread-2 (]: 2 of 4 ERROR not_null_daily_returns_ticker ..................................... [[31mERROR[0m in 0.11s]
[0m20:51:02.483297 [debug] [Thread-4 (]: Finished running node test.global_economic_tracker.unique_daily_returns_ticker.37e3dc3873
[0m20:51:02.484079 [debug] [Thread-3 (]: Finished running node test.global_economic_tracker.not_null_daily_returns_timestamp.657a6e8fda
[0m20:51:02.484976 [debug] [Thread-7 (]: Marking all children of 'test.global_economic_tracker.not_null_daily_returns_daily_return.93322b076b' to be skipped because of status 'error'.  Reason: Database Error in test not_null_daily_returns_daily_return (models/staging/staging_daily_returns.yml)
  relation "public.daily_returns" does not exist
  LINE 14: from "airflow"."public"."daily_returns"
                ^
  compiled code at target/run/global_economic_tracker/models/staging/staging_daily_returns.yml/not_null_daily_returns_daily_return.sql.
[0m20:51:02.485753 [debug] [Thread-2 (]: Finished running node test.global_economic_tracker.not_null_daily_returns_ticker.2a93ed2341
[0m20:51:02.487968 [debug] [Thread-7 (]: Marking all children of 'test.global_economic_tracker.unique_daily_returns_ticker.37e3dc3873' to be skipped because of status 'error'.  Reason: Database Error in test unique_daily_returns_ticker (models/staging/staging_daily_returns.yml)
  relation "public.daily_returns" does not exist
  LINE 15: from "airflow"."public"."daily_returns"
                ^
  compiled code at target/run/global_economic_tracker/models/staging/staging_daily_returns.yml/unique_daily_returns_ticker.sql.
[0m20:51:02.489281 [debug] [Thread-7 (]: Marking all children of 'test.global_economic_tracker.not_null_daily_returns_timestamp.657a6e8fda' to be skipped because of status 'error'.  Reason: Database Error in test not_null_daily_returns_timestamp (models/staging/staging_daily_returns.yml)
  relation "public.daily_returns" does not exist
  LINE 14: from "airflow"."public"."daily_returns"
                ^
  compiled code at target/run/global_economic_tracker/models/staging/staging_daily_returns.yml/not_null_daily_returns_timestamp.sql.
[0m20:51:02.490070 [debug] [Thread-7 (]: Marking all children of 'test.global_economic_tracker.not_null_daily_returns_ticker.2a93ed2341' to be skipped because of status 'error'.  Reason: Database Error in test not_null_daily_returns_ticker (models/staging/staging_daily_returns.yml)
  relation "public.daily_returns" does not exist
  LINE 14: from "airflow"."public"."daily_returns"
                ^
  compiled code at target/run/global_economic_tracker/models/staging/staging_daily_returns.yml/not_null_daily_returns_ticker.sql.
[0m20:51:02.491891 [debug] [MainThread]: Using postgres connection "master"
[0m20:51:02.492593 [debug] [MainThread]: On master: BEGIN
[0m20:51:02.493276 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:51:02.495363 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m20:51:02.496043 [debug] [MainThread]: On master: COMMIT
[0m20:51:02.496721 [debug] [MainThread]: Using postgres connection "master"
[0m20:51:02.497408 [debug] [MainThread]: On master: COMMIT
[0m20:51:02.498184 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:51:02.498835 [debug] [MainThread]: On master: Close
[0m20:51:02.499594 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:51:02.500282 [debug] [MainThread]: Connection 'test.global_economic_tracker.not_null_daily_returns_daily_return.93322b076b' was properly closed.
[0m20:51:02.500946 [debug] [MainThread]: Connection 'test.global_economic_tracker.not_null_daily_returns_ticker.2a93ed2341' was properly closed.
[0m20:51:02.501619 [debug] [MainThread]: Connection 'test.global_economic_tracker.not_null_daily_returns_timestamp.657a6e8fda' was properly closed.
[0m20:51:02.502301 [debug] [MainThread]: Connection 'test.global_economic_tracker.unique_daily_returns_ticker.37e3dc3873' was properly closed.
[0m20:51:02.503202 [info ] [MainThread]: 
[0m20:51:02.504001 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 0.19 seconds (0.19s).
[0m20:51:02.505149 [debug] [MainThread]: Command end result
[0m20:51:02.525876 [debug] [MainThread]: Wrote artifact WritableManifest to /mnt/c/Users/joeyk/PycharmProjects/GlobalEconomicTracker/global_economic_tracker/target/manifest.json
[0m20:51:02.529649 [debug] [MainThread]: Wrote artifact SemanticManifest to /mnt/c/Users/joeyk/PycharmProjects/GlobalEconomicTracker/global_economic_tracker/target/semantic_manifest.json
[0m20:51:02.536217 [debug] [MainThread]: Wrote artifact RunExecutionResult to /mnt/c/Users/joeyk/PycharmProjects/GlobalEconomicTracker/global_economic_tracker/target/run_results.json
[0m20:51:02.536911 [info ] [MainThread]: 
[0m20:51:02.537746 [info ] [MainThread]: [31mCompleted with 4 errors, 0 partial successes, and 0 warnings:[0m
[0m20:51:02.538590 [info ] [MainThread]: 
[0m20:51:02.539398 [error] [MainThread]:   Database Error in test not_null_daily_returns_daily_return (models/staging/staging_daily_returns.yml)
  relation "public.daily_returns" does not exist
  LINE 14: from "airflow"."public"."daily_returns"
                ^
  compiled code at target/run/global_economic_tracker/models/staging/staging_daily_returns.yml/not_null_daily_returns_daily_return.sql
[0m20:51:02.540151 [info ] [MainThread]: 
[0m20:51:02.540901 [error] [MainThread]:   Database Error in test unique_daily_returns_ticker (models/staging/staging_daily_returns.yml)
  relation "public.daily_returns" does not exist
  LINE 15: from "airflow"."public"."daily_returns"
                ^
  compiled code at target/run/global_economic_tracker/models/staging/staging_daily_returns.yml/unique_daily_returns_ticker.sql
[0m20:51:02.541603 [info ] [MainThread]: 
[0m20:51:02.542322 [error] [MainThread]:   Database Error in test not_null_daily_returns_timestamp (models/staging/staging_daily_returns.yml)
  relation "public.daily_returns" does not exist
  LINE 14: from "airflow"."public"."daily_returns"
                ^
  compiled code at target/run/global_economic_tracker/models/staging/staging_daily_returns.yml/not_null_daily_returns_timestamp.sql
[0m20:51:02.543102 [info ] [MainThread]: 
[0m20:51:02.543868 [error] [MainThread]:   Database Error in test not_null_daily_returns_ticker (models/staging/staging_daily_returns.yml)
  relation "public.daily_returns" does not exist
  LINE 14: from "airflow"."public"."daily_returns"
                ^
  compiled code at target/run/global_economic_tracker/models/staging/staging_daily_returns.yml/not_null_daily_returns_ticker.sql
[0m20:51:02.544561 [info ] [MainThread]: 
[0m20:51:02.545304 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=4 SKIP=0 TOTAL=4
[0m20:51:02.546325 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 0.6827615, "process_in_blocks": "656", "process_kernel_time": 0.068932, "process_mem_max_rss": "115396", "process_out_blocks": "0", "process_user_time": 0.955212}
[0m20:51:02.547136 [debug] [MainThread]: Command `dbt test` failed at 20:51:02.547062 after 0.68 seconds
[0m20:51:02.547863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c9c20db10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c99b559f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5c9c0dbeb0>]}
[0m20:51:02.548605 [debug] [MainThread]: Flushing usage events
[0m20:51:02.893427 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:52:16.455103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7df173dab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7df0f27280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7df161bf40>]}


============================== 20:52:16.457322 | d43313d3-3021-48d6-a6f8-02341f34579f ==============================
[0m20:52:16.457322 [info ] [MainThread]: Running with dbt=1.9.4
[0m20:52:16.458032 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/joey/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/mnt/c/Users/joeyk/PycharmProjects/GlobalEconomicTracker/global_economic_tracker/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt build', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:52:16.577382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd43313d3-3021-48d6-a6f8-02341f34579f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7df02f3160>]}
[0m20:52:16.611023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd43313d3-3021-48d6-a6f8-02341f34579f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7df0f81300>]}
[0m20:52:16.612132 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:52:16.648896 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m20:52:16.806770 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:52:16.807698 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:52:16.831694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd43313d3-3021-48d6-a6f8-02341f34579f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7def3c4130>]}
[0m20:52:16.890553 [debug] [MainThread]: Wrote artifact WritableManifest to /mnt/c/Users/joeyk/PycharmProjects/GlobalEconomicTracker/global_economic_tracker/target/manifest.json
[0m20:52:16.896414 [debug] [MainThread]: Wrote artifact SemanticManifest to /mnt/c/Users/joeyk/PycharmProjects/GlobalEconomicTracker/global_economic_tracker/target/semantic_manifest.json
[0m20:52:16.925394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd43313d3-3021-48d6-a6f8-02341f34579f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7def34abf0>]}
[0m20:52:16.926343 [info ] [MainThread]: Found 2 models, 4 data tests, 433 macros
[0m20:52:16.928348 [info ] [MainThread]: 
[0m20:52:16.929469 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:52:16.930255 [info ] [MainThread]: 
[0m20:52:16.931288 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:52:16.935719 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m20:52:16.954436 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m20:52:16.955342 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m20:52:16.956124 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:52:16.964696 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.009 seconds
[0m20:52:16.965747 [debug] [ThreadPool]: On list_airflow: Close
[0m20:52:16.967092 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_public)
[0m20:52:16.970721 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m20:52:16.971575 [debug] [ThreadPool]: On list_airflow_public: BEGIN
[0m20:52:16.972800 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:52:16.975606 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m20:52:16.976317 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m20:52:16.977305 [debug] [ThreadPool]: On list_airflow_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:52:16.979663 [debug] [ThreadPool]: SQL status: SELECT 42 in 0.001 seconds
[0m20:52:16.981337 [debug] [ThreadPool]: On list_airflow_public: ROLLBACK
[0m20:52:16.982095 [debug] [ThreadPool]: On list_airflow_public: Close
[0m20:52:16.988202 [debug] [MainThread]: Using postgres connection "master"
[0m20:52:16.988833 [debug] [MainThread]: On master: BEGIN
[0m20:52:16.989473 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:52:16.991499 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m20:52:16.992188 [debug] [MainThread]: Using postgres connection "master"
[0m20:52:16.992789 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:52:16.994570 [debug] [MainThread]: SQL status: SELECT 0 in 0.001 seconds
[0m20:52:16.995580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd43313d3-3021-48d6-a6f8-02341f34579f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7def3daa10>]}
[0m20:52:16.996308 [debug] [MainThread]: On master: ROLLBACK
[0m20:52:16.996985 [debug] [MainThread]: Using postgres connection "master"
[0m20:52:16.997552 [debug] [MainThread]: On master: BEGIN
[0m20:52:16.998324 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m20:52:16.998889 [debug] [MainThread]: On master: COMMIT
[0m20:52:16.999450 [debug] [MainThread]: Using postgres connection "master"
[0m20:52:17.000032 [debug] [MainThread]: On master: COMMIT
[0m20:52:17.000706 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:52:17.001251 [debug] [MainThread]: On master: Close
[0m20:52:17.005093 [debug] [Thread-1 (]: Began running node model.global_economic_tracker.daily_returns
[0m20:52:17.005922 [info ] [Thread-1 (]: 1 of 6 START sql table model public.daily_returns .............................. [RUN]
[0m20:52:17.006703 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_public, now model.global_economic_tracker.daily_returns)
[0m20:52:17.007397 [debug] [Thread-1 (]: Began compiling node model.global_economic_tracker.daily_returns
[0m20:52:17.011575 [debug] [Thread-1 (]: Writing injected SQL for node "model.global_economic_tracker.daily_returns"
[0m20:52:17.017988 [debug] [Thread-1 (]: Began executing node model.global_economic_tracker.daily_returns
[0m20:52:17.061432 [debug] [Thread-1 (]: Writing runtime sql for node "model.global_economic_tracker.daily_returns"
[0m20:52:17.067880 [debug] [Thread-1 (]: Using postgres connection "model.global_economic_tracker.daily_returns"
[0m20:52:17.068589 [debug] [Thread-1 (]: On model.global_economic_tracker.daily_returns: BEGIN
[0m20:52:17.069273 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:52:17.071803 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m20:52:17.072514 [debug] [Thread-1 (]: Using postgres connection "model.global_economic_tracker.daily_returns"
[0m20:52:17.073210 [debug] [Thread-1 (]: On model.global_economic_tracker.daily_returns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.daily_returns"} */

  
    

  create  table "airflow"."public"."daily_returns__dbt_tmp"
  
  
    as
  
  (
    

with base as (
    select
        timestamp,
        ticker,
        type,
        price,
        row_number() over (partition by ticker order by timestamp) as rn
    from raw_prices
),

returns as (
    select
        b1.timestamp,
        b1.ticker,
        b1.type,
        b1.price,
        (b1.price - b0.price) / nullif(b0.price,  0) as daily_return
    from base b1
    left join base b0
        on b1.ticker = b0.ticker
        and b1.rn = b0.rn + 1
)

select * from returns
  );
  
[0m20:52:17.074181 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "raw_prices" does not exist
LINE 21:     from raw_prices
                  ^

[0m20:52:17.075045 [debug] [Thread-1 (]: On model.global_economic_tracker.daily_returns: ROLLBACK
[0m20:52:17.075882 [debug] [Thread-1 (]: On model.global_economic_tracker.daily_returns: Close
[0m20:52:17.080240 [debug] [Thread-1 (]: Database Error in model daily_returns (models/staging/daily_returns.sql)
  relation "raw_prices" does not exist
  LINE 21:     from raw_prices
                    ^
  compiled code at target/run/global_economic_tracker/models/staging/daily_returns.sql
[0m20:52:17.082153 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd43313d3-3021-48d6-a6f8-02341f34579f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7def34b880>]}
[0m20:52:17.083051 [error] [Thread-1 (]: 1 of 6 ERROR creating sql table model public.daily_returns ..................... [[31mERROR[0m in 0.07s]
[0m20:52:17.083963 [debug] [Thread-1 (]: Finished running node model.global_economic_tracker.daily_returns
[0m20:52:17.084758 [debug] [Thread-7 (]: Marking all children of 'model.global_economic_tracker.daily_returns' to be skipped because of status 'error'.  Reason: Database Error in model daily_returns (models/staging/daily_returns.sql)
  relation "raw_prices" does not exist
  LINE 21:     from raw_prices
                    ^
  compiled code at target/run/global_economic_tracker/models/staging/daily_returns.sql.
[0m20:52:17.086086 [debug] [Thread-3 (]: Began running node test.global_economic_tracker.not_null_daily_returns_daily_return.93322b076b
[0m20:52:17.086344 [debug] [Thread-4 (]: Began running node test.global_economic_tracker.not_null_daily_returns_ticker.2a93ed2341
[0m20:52:17.086599 [debug] [Thread-2 (]: Began running node test.global_economic_tracker.not_null_daily_returns_timestamp.657a6e8fda
[0m20:52:17.086862 [debug] [Thread-1 (]: Began running node test.global_economic_tracker.unique_daily_returns_ticker.37e3dc3873
[0m20:52:17.087288 [info ] [Thread-3 (]: 2 of 6 SKIP test not_null_daily_returns_daily_return ........................... [[33mSKIP[0m]
[0m20:52:17.088066 [info ] [Thread-4 (]: 3 of 6 SKIP test not_null_daily_returns_ticker ................................. [[33mSKIP[0m]
[0m20:52:17.088818 [info ] [Thread-2 (]: 4 of 6 SKIP test not_null_daily_returns_timestamp .............................. [[33mSKIP[0m]
[0m20:52:17.089493 [info ] [Thread-1 (]: 5 of 6 SKIP test unique_daily_returns_ticker ................................... [[33mSKIP[0m]
[0m20:52:17.090149 [debug] [Thread-3 (]: Finished running node test.global_economic_tracker.not_null_daily_returns_daily_return.93322b076b
[0m20:52:17.090878 [debug] [Thread-4 (]: Finished running node test.global_economic_tracker.not_null_daily_returns_ticker.2a93ed2341
[0m20:52:17.091622 [debug] [Thread-2 (]: Finished running node test.global_economic_tracker.not_null_daily_returns_timestamp.657a6e8fda
[0m20:52:17.092563 [debug] [Thread-1 (]: Finished running node test.global_economic_tracker.unique_daily_returns_ticker.37e3dc3873
[0m20:52:17.093355 [debug] [Thread-7 (]: Marking all children of 'test.global_economic_tracker.not_null_daily_returns_daily_return.93322b076b' to be skipped because of status 'skipped'. 
[0m20:52:17.095623 [debug] [Thread-7 (]: Marking all children of 'test.global_economic_tracker.not_null_daily_returns_ticker.2a93ed2341' to be skipped because of status 'skipped'. 
[0m20:52:17.096340 [debug] [Thread-7 (]: Marking all children of 'test.global_economic_tracker.not_null_daily_returns_timestamp.657a6e8fda' to be skipped because of status 'skipped'. 
[0m20:52:17.097125 [debug] [Thread-7 (]: Marking all children of 'test.global_economic_tracker.unique_daily_returns_ticker.37e3dc3873' to be skipped because of status 'skipped'. 
[0m20:52:17.098201 [debug] [Thread-3 (]: Began running node model.global_economic_tracker.rolling_metrics
[0m20:52:17.098920 [info ] [Thread-3 (]: 6 of 6 SKIP relation public.rolling_metrics .................................... [[33mSKIP[0m]
[0m20:52:17.099615 [debug] [Thread-3 (]: Finished running node model.global_economic_tracker.rolling_metrics
[0m20:52:17.100357 [debug] [Thread-7 (]: Marking all children of 'model.global_economic_tracker.rolling_metrics' to be skipped because of status 'skipped'. 
[0m20:52:17.101845 [debug] [MainThread]: Using postgres connection "master"
[0m20:52:17.102434 [debug] [MainThread]: On master: BEGIN
[0m20:52:17.102950 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:52:17.105390 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m20:52:17.105989 [debug] [MainThread]: On master: COMMIT
[0m20:52:17.106578 [debug] [MainThread]: Using postgres connection "master"
[0m20:52:17.107170 [debug] [MainThread]: On master: COMMIT
[0m20:52:17.107844 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:52:17.108443 [debug] [MainThread]: On master: Close
[0m20:52:17.109197 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:52:17.109724 [debug] [MainThread]: Connection 'model.global_economic_tracker.daily_returns' was properly closed.
[0m20:52:17.110404 [info ] [MainThread]: 
[0m20:52:17.111032 [info ] [MainThread]: Finished running 2 table models, 4 data tests in 0 hours 0 minutes and 0.18 seconds (0.18s).
[0m20:52:17.111886 [debug] [MainThread]: Command end result
[0m20:52:17.129331 [debug] [MainThread]: Wrote artifact WritableManifest to /mnt/c/Users/joeyk/PycharmProjects/GlobalEconomicTracker/global_economic_tracker/target/manifest.json
[0m20:52:17.132630 [debug] [MainThread]: Wrote artifact SemanticManifest to /mnt/c/Users/joeyk/PycharmProjects/GlobalEconomicTracker/global_economic_tracker/target/semantic_manifest.json
[0m20:52:17.138025 [debug] [MainThread]: Wrote artifact RunExecutionResult to /mnt/c/Users/joeyk/PycharmProjects/GlobalEconomicTracker/global_economic_tracker/target/run_results.json
[0m20:52:17.138591 [info ] [MainThread]: 
[0m20:52:17.139257 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:52:17.139973 [info ] [MainThread]: 
[0m20:52:17.140720 [error] [MainThread]:   Database Error in model daily_returns (models/staging/daily_returns.sql)
  relation "raw_prices" does not exist
  LINE 21:     from raw_prices
                    ^
  compiled code at target/run/global_economic_tracker/models/staging/daily_returns.sql
[0m20:52:17.141347 [info ] [MainThread]: 
[0m20:52:17.142043 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=5 TOTAL=6
[0m20:52:17.143425 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.7242083, "process_in_blocks": "67112", "process_kernel_time": 0.096291, "process_mem_max_rss": "114492", "process_out_blocks": "0", "process_user_time": 1.069911}
[0m20:52:17.144118 [debug] [MainThread]: Command `dbt build` failed at 20:52:17.144037 after 0.72 seconds
[0m20:52:17.144722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7df173dab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ded92f340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ded92f460>]}
[0m20:52:17.145339 [debug] [MainThread]: Flushing usage events
[0m20:52:17.530675 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:22:10.082362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6221b01ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6220c05cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6220c06650>]}


============================== 19:22:10.084893 | f1853ef8-cbfe-4290-bffa-ff07d55247de ==============================
[0m19:22:10.084893 [info ] [MainThread]: Running with dbt=1.9.4
[0m19:22:10.085834 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/mnt/c/Users/joeyk/PycharmProjects/GlobalEconomicTracker/global_economic_tracker/logs', 'fail_fast': 'False', 'profiles_dir': '/home/joey/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:22:10.163896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f1853ef8-cbfe-4290-bffa-ff07d55247de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f622317ae60>]}
[0m19:22:10.182330 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m19:22:10.189368 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m19:22:10.190536 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.15958655, "process_in_blocks": "1632", "process_kernel_time": 0.078066, "process_mem_max_rss": "92848", "process_out_blocks": "0", "process_user_time": 0.605013}
[0m19:22:10.191304 [debug] [MainThread]: Command `dbt deps` succeeded at 19:22:10.191231 after 0.16 seconds
[0m19:22:10.191950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6221b01ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f622317ae60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6220b89270>]}
[0m19:22:10.192640 [debug] [MainThread]: Flushing usage events
[0m19:22:10.735392 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:23:35.156375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1e7649a80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1e6e33310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1e6a3bd60>]}


============================== 19:23:35.158510 | dc075123-e6ce-42e3-b7a5-583bc93473ea ==============================
[0m19:23:35.158510 [info ] [MainThread]: Running with dbt=1.9.4
[0m19:23:35.159321 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/joey/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/mnt/c/Users/joeyk/PycharmProjects/GlobalEconomicTracker/global_economic_tracker/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:23:35.220654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dc075123-e6ce-42e3-b7a5-583bc93473ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1e6a38370>]}
[0m19:23:35.227858 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-jtpfbkrq'
[0m19:23:35.228629 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m19:23:35.434738 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m19:23:35.435709 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m19:23:35.568948 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m19:23:35.577084 [info ] [MainThread]: Updating lock file in file path: /mnt/c/Users/joeyk/PycharmProjects/GlobalEconomicTracker/global_economic_tracker/package-lock.yml
[0m19:23:35.585307 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-90hjjqhx'
[0m19:23:35.587310 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m19:23:38.395089 [info ] [MainThread]: Installed from version 1.1.1
[0m19:23:38.395939 [info ] [MainThread]: Updated version available: 1.3.0
[0m19:23:38.396679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'dc075123-e6ce-42e3-b7a5-583bc93473ea', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1e7508070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1e75151e0>]}
[0m19:23:38.397484 [info ] [MainThread]: 
[0m19:23:38.398195 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m19:23:38.399406 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 3.2810564, "process_in_blocks": "208", "process_kernel_time": 0.288189, "process_mem_max_rss": "95860", "process_out_blocks": "200", "process_user_time": 0.665817}
[0m19:23:38.400249 [debug] [MainThread]: Command `dbt deps` succeeded at 19:23:38.400168 after 3.28 seconds
[0m19:23:38.400911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1e7649a80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1e67fc6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1e7508070>]}
[0m19:23:38.401588 [debug] [MainThread]: Flushing usage events
[0m19:23:38.903699 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:23:50.166743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e8897dae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e88859a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e888597b0>]}


============================== 19:23:50.168646 | 4c486c2f-35a6-471c-8c03-d0af835e1a0b ==============================
[0m19:23:50.168646 [info ] [MainThread]: Running with dbt=1.9.4
[0m19:23:50.169596 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/mnt/c/Users/joeyk/PycharmProjects/GlobalEconomicTracker/global_economic_tracker/logs', 'fail_fast': 'False', 'profiles_dir': '/home/joey/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt deps', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:23:50.240636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4c486c2f-35a6-471c-8c03-d0af835e1a0b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e88854760>]}
[0m19:23:50.251373 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-jtd0gidn'
[0m19:23:50.252124 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m19:23:50.355912 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m19:23:50.356671 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m19:23:50.497795 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m19:23:50.504813 [info ] [MainThread]: Updating lock file in file path: /mnt/c/Users/joeyk/PycharmProjects/GlobalEconomicTracker/global_economic_tracker/package-lock.yml
[0m19:23:50.743839 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-m4co3c18'
[0m19:23:50.745841 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m19:23:53.317152 [info ] [MainThread]: Installed from version 1.3.0
[0m19:23:53.317989 [info ] [MainThread]: Up to date!
[0m19:23:53.318672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '4c486c2f-35a6-471c-8c03-d0af835e1a0b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e88846fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e88c29360>]}
[0m19:23:53.319959 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 3.1909437, "process_in_blocks": "0", "process_kernel_time": 0.145637, "process_mem_max_rss": "95728", "process_out_blocks": "176", "process_user_time": 0.759395}
[0m19:23:53.320699 [debug] [MainThread]: Command `dbt deps` succeeded at 19:23:53.320625 after 3.19 seconds
[0m19:23:53.321442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e8897dae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e88854760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e88c29360>]}
[0m19:23:53.322011 [debug] [MainThread]: Flushing usage events
[0m19:23:53.914997 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:28:23.529665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5151b5b40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa514362380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5143623e0>]}


============================== 19:28:23.531573 | 2b96cfdd-b7bd-427b-b140-7b2373ae7244 ==============================
[0m19:28:23.531573 [info ] [MainThread]: Running with dbt=1.9.4
[0m19:28:23.532429 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/joey/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/mnt/c/Users/joeyk/PycharmProjects/GlobalEconomicTracker/global_economic_tracker/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt build', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:28:23.646653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2b96cfdd-b7bd-427b-b140-7b2373ae7244', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5169224a0>]}
[0m19:28:23.677013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2b96cfdd-b7bd-427b-b140-7b2373ae7244', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5149fab90>]}
[0m19:28:23.678304 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m19:28:23.725078 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m19:28:23.788540 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m19:28:23.789707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2b96cfdd-b7bd-427b-b140-7b2373ae7244', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa51499d300>]}
[0m19:28:25.271601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2b96cfdd-b7bd-427b-b140-7b2373ae7244', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4dbc79cf0>]}
[0m19:28:25.348978 [debug] [MainThread]: Wrote artifact WritableManifest to /mnt/c/Users/joeyk/PycharmProjects/GlobalEconomicTracker/global_economic_tracker/target/manifest.json
[0m19:28:25.353269 [debug] [MainThread]: Wrote artifact SemanticManifest to /mnt/c/Users/joeyk/PycharmProjects/GlobalEconomicTracker/global_economic_tracker/target/semantic_manifest.json
[0m19:28:25.372354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2b96cfdd-b7bd-427b-b140-7b2373ae7244', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa51016e110>]}
[0m19:28:25.373204 [info ] [MainThread]: Found 4 models, 20 data tests, 549 macros
[0m19:28:25.375265 [info ] [MainThread]: 
[0m19:28:25.375972 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:28:25.376642 [info ] [MainThread]: 
[0m19:28:25.377426 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:28:25.380362 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m19:28:25.396765 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m19:28:25.397465 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m19:28:25.398109 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:28:25.406080 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.008 seconds
[0m19:28:25.407226 [debug] [ThreadPool]: On list_airflow: Close
[0m19:28:25.408501 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_public)
[0m19:28:25.411930 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m19:28:25.412576 [debug] [ThreadPool]: On list_airflow_public: BEGIN
[0m19:28:25.413214 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:28:25.415488 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m19:28:25.416272 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m19:28:25.416890 [debug] [ThreadPool]: On list_airflow_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:28:25.422421 [debug] [ThreadPool]: SQL status: SELECT 45 in 0.005 seconds
[0m19:28:25.423743 [debug] [ThreadPool]: On list_airflow_public: ROLLBACK
[0m19:28:25.424482 [debug] [ThreadPool]: On list_airflow_public: Close
[0m19:28:25.429456 [debug] [MainThread]: Using postgres connection "master"
[0m19:28:25.430112 [debug] [MainThread]: On master: BEGIN
[0m19:28:25.430814 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:28:25.433241 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m19:28:25.433898 [debug] [MainThread]: Using postgres connection "master"
[0m19:28:25.434576 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:28:25.438637 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m19:28:25.439686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b96cfdd-b7bd-427b-b140-7b2373ae7244', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5123f8310>]}
[0m19:28:25.440405 [debug] [MainThread]: On master: ROLLBACK
[0m19:28:25.441231 [debug] [MainThread]: Using postgres connection "master"
[0m19:28:25.441867 [debug] [MainThread]: On master: BEGIN
[0m19:28:25.442724 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m19:28:25.443368 [debug] [MainThread]: On master: COMMIT
[0m19:28:25.444019 [debug] [MainThread]: Using postgres connection "master"
[0m19:28:25.444649 [debug] [MainThread]: On master: COMMIT
[0m19:28:25.445381 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:28:25.446011 [debug] [MainThread]: On master: Close
[0m19:28:25.451201 [debug] [Thread-1 (]: Began running node model.global_economic_tracker.stg_commodity_metrics
[0m19:28:25.451451 [debug] [Thread-2 (]: Began running node model.global_economic_tracker.stg_commodity_returns
[0m19:28:25.451705 [debug] [Thread-3 (]: Began running node model.global_economic_tracker.stg_index_metrics
[0m19:28:25.451970 [debug] [Thread-4 (]: Began running node model.global_economic_tracker.stg_index_returns
[0m19:28:25.452415 [info ] [Thread-1 (]: 1 of 24 START sql table model public.stg_commodity_metrics ..................... [RUN]
[0m19:28:25.453174 [info ] [Thread-2 (]: 2 of 24 START sql table model public.stg_commodity_returns ..................... [RUN]
[0m19:28:25.454180 [info ] [Thread-3 (]: 3 of 24 START sql table model public.stg_index_metrics ......................... [RUN]
[0m19:28:25.454916 [info ] [Thread-4 (]: 4 of 24 START sql table model public.stg_index_returns ......................... [RUN]
[0m19:28:25.455633 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_public, now model.global_economic_tracker.stg_commodity_metrics)
[0m19:28:25.456462 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.global_economic_tracker.stg_commodity_returns'
[0m19:28:25.457241 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.global_economic_tracker.stg_index_metrics'
[0m19:28:25.458011 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.global_economic_tracker.stg_index_returns'
[0m19:28:25.458721 [debug] [Thread-1 (]: Began compiling node model.global_economic_tracker.stg_commodity_metrics
[0m19:28:25.459427 [debug] [Thread-2 (]: Began compiling node model.global_economic_tracker.stg_commodity_returns
[0m19:28:25.460125 [debug] [Thread-3 (]: Began compiling node model.global_economic_tracker.stg_index_metrics
[0m19:28:25.460972 [debug] [Thread-4 (]: Began compiling node model.global_economic_tracker.stg_index_returns
[0m19:28:25.465401 [debug] [Thread-1 (]: Writing injected SQL for node "model.global_economic_tracker.stg_commodity_metrics"
[0m19:28:25.467466 [debug] [Thread-2 (]: Writing injected SQL for node "model.global_economic_tracker.stg_commodity_returns"
[0m19:28:25.470197 [debug] [Thread-3 (]: Writing injected SQL for node "model.global_economic_tracker.stg_index_metrics"
[0m19:28:25.472135 [debug] [Thread-4 (]: Writing injected SQL for node "model.global_economic_tracker.stg_index_returns"
[0m19:28:25.476721 [debug] [Thread-1 (]: Began executing node model.global_economic_tracker.stg_commodity_metrics
[0m19:28:25.477001 [debug] [Thread-2 (]: Began executing node model.global_economic_tracker.stg_commodity_returns
[0m19:28:25.483872 [debug] [Thread-3 (]: Began executing node model.global_economic_tracker.stg_index_metrics
[0m19:28:25.484121 [debug] [Thread-4 (]: Began executing node model.global_economic_tracker.stg_index_returns
[0m19:28:25.497404 [debug] [Thread-1 (]: Writing runtime sql for node "model.global_economic_tracker.stg_commodity_metrics"
[0m19:28:25.499636 [debug] [Thread-2 (]: Writing runtime sql for node "model.global_economic_tracker.stg_commodity_returns"
[0m19:28:25.502751 [debug] [Thread-3 (]: Writing runtime sql for node "model.global_economic_tracker.stg_index_metrics"
[0m19:28:25.505314 [debug] [Thread-4 (]: Writing runtime sql for node "model.global_economic_tracker.stg_index_returns"
[0m19:28:25.510403 [debug] [Thread-2 (]: Using postgres connection "model.global_economic_tracker.stg_commodity_returns"
[0m19:28:25.511256 [debug] [Thread-3 (]: Using postgres connection "model.global_economic_tracker.stg_index_metrics"
[0m19:28:25.511562 [debug] [Thread-2 (]: On model.global_economic_tracker.stg_commodity_returns: BEGIN
[0m19:28:25.511963 [debug] [Thread-4 (]: Using postgres connection "model.global_economic_tracker.stg_index_returns"
[0m19:28:25.512535 [debug] [Thread-3 (]: On model.global_economic_tracker.stg_index_metrics: BEGIN
[0m19:28:25.512999 [debug] [Thread-1 (]: Using postgres connection "model.global_economic_tracker.stg_commodity_metrics"
[0m19:28:25.513372 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:28:25.514091 [debug] [Thread-4 (]: On model.global_economic_tracker.stg_index_returns: BEGIN
[0m19:28:25.514880 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:28:25.515618 [debug] [Thread-1 (]: On model.global_economic_tracker.stg_commodity_metrics: BEGIN
[0m19:28:25.516913 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:28:25.517903 [debug] [Thread-2 (]: SQL status: BEGIN in 0.004 seconds
[0m19:28:25.518578 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:28:25.519098 [debug] [Thread-3 (]: SQL status: BEGIN in 0.004 seconds
[0m19:28:25.520075 [debug] [Thread-2 (]: Using postgres connection "model.global_economic_tracker.stg_commodity_returns"
[0m19:28:25.521071 [debug] [Thread-4 (]: SQL status: BEGIN in 0.004 seconds
[0m19:28:25.521626 [debug] [Thread-3 (]: Using postgres connection "model.global_economic_tracker.stg_index_metrics"
[0m19:28:25.522347 [debug] [Thread-2 (]: On model.global_economic_tracker.stg_commodity_returns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_commodity_returns"} */

  
    

  create  table "airflow"."public"."stg_commodity_returns__dbt_tmp"
  
  
    as
  
  (
    

select
    'commodity' as type,
    ticker,
    timestamp,
    price,
    lag(price) over (partition by ticker order by timestamp) as prev_price,
    (price - lag(price) over (partition by ticker order by timestamp)) / lag(price) over (partition by ticker order by timestamp) as daily_return
from public.commodity_prices
  );
  
[0m19:28:25.523113 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m19:28:25.523350 [debug] [Thread-4 (]: Using postgres connection "model.global_economic_tracker.stg_index_returns"
[0m19:28:25.524077 [debug] [Thread-3 (]: On model.global_economic_tracker.stg_index_metrics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_index_metrics"} */

  
    

  create  table "airflow"."public"."stg_index_metrics__dbt_tmp"
  
  
    as
  
  (
    

with base as (
    select
        *,
        row_number() over (partition by ticker order by timestamp) as rn
    from public.index_history
),

rolling as (
    select
        ticker,
        timestamp,
        avg(daily_return) over (
            partition by ticker
            order by rn
            rows between 19 preceding and current row
        ) as rolling_avg_mo,

        avg(daily_return) OVER (
            partition by ticker
            order by timestamp
            rows between 6 preceding and current row
        ) as weekly_avg_return,

        stddev(daily_return) over (
            partition by ticker
            order by rn
            rows between 19 preceding and current row
        ) as rolling_volatility_mo,

        case
            when daily_return > 0 then 'up'
            when daily_return < 0 then 'down'
            else 'flat'
        end as trend

    from base
)

select
    *,
    rolling_avg_mo / nullif(rolling_volatility_mo, 0) as sharpe_mo,
    (daily_return - rolling_avg_mo) / nullif(rolling_volatility_mo, 0) as z_score_mo
from rolling
where rolling_avg_mo is not null
  );
  
[0m19:28:25.525450 [debug] [Thread-1 (]: Using postgres connection "model.global_economic_tracker.stg_commodity_metrics"
[0m19:28:25.526478 [debug] [Thread-4 (]: On model.global_economic_tracker.stg_index_returns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_index_returns"} */

  
    

  create  table "airflow"."public"."stg_index_returns__dbt_tmp"
  
  
    as
  
  (
    

select
    'index' as type,
    country,
    ticker,
    timestamp,
    price,
    lag(price) over (partition by ticker order by timestamp) as prev_price,
    (price - lag(price) over (partition by ticker order by timestamp)) / lag(price) over (partition by ticker order by timestamp) as daily_return
from public.index_history
  );
  
[0m19:28:25.528843 [debug] [Thread-1 (]: On model.global_economic_tracker.stg_commodity_metrics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_commodity_metrics"} */

  
    

  create  table "airflow"."public"."stg_commodity_metrics__dbt_tmp"
  
  
    as
  
  (
    

with base as (
    select
        *,
        row_number() over (partition by ticker order by timestamp) as rn
    from public.commodity_prices
),

rolling as (
    select
        ticker,
        timestamp,
        avg(daily_return) over (
            partition by ticker
            order by rn
            rows between 19 preceding and current row
        ) as rolling_avg_mo,

        avg(daily_return) OVER (
            partition by ticker
            order by timestamp
            rows between 6 preceding and current row
        ) as weekly_avg_return,

        stddev(daily_return) over (
            partition by ticker
            order by rn
            rows between 19 preceding and current row
        ) as rolling_volatility_mo,

        case
            when daily_return > 0 then 'up'
            when daily_return < 0 then 'down'
            else 'flat'
        end as trend

    from base
)

select
    *,
    rolling_avg_mo / nullif(rolling_volatility_mo, 0) as sharpe_mo,
    (daily_return - rolling_avg_mo) / nullif(rolling_volatility_mo, 0) as z_score_mo
from rolling
where rolling_avg_mo is not null
  );
  
[0m19:28:25.529134 [debug] [Thread-3 (]: Postgres adapter: Postgres error: column "daily_return" does not exist
LINE 25:         avg(daily_return) over (
                     ^

[0m19:28:25.530918 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "daily_return" does not exist
LINE 25:         avg(daily_return) over (
                     ^

[0m19:28:25.531205 [debug] [Thread-3 (]: On model.global_economic_tracker.stg_index_metrics: ROLLBACK
[0m19:28:25.531950 [debug] [Thread-1 (]: On model.global_economic_tracker.stg_commodity_metrics: ROLLBACK
[0m19:28:25.532856 [debug] [Thread-3 (]: On model.global_economic_tracker.stg_index_metrics: Close
[0m19:28:25.533550 [debug] [Thread-1 (]: On model.global_economic_tracker.stg_commodity_metrics: Close
[0m19:28:25.539709 [debug] [Thread-3 (]: Database Error in model stg_index_metrics (models/analytics/stg_index_metrics.sql)
  column "daily_return" does not exist
  LINE 25:         avg(daily_return) over (
                       ^
  compiled code at target/run/global_economic_tracker/models/analytics/stg_index_metrics.sql
[0m19:28:25.540092 [debug] [Thread-1 (]: Database Error in model stg_commodity_metrics (models/analytics/stg_commodity_metrics.sql)
  column "daily_return" does not exist
  LINE 25:         avg(daily_return) over (
                       ^
  compiled code at target/run/global_economic_tracker/models/analytics/stg_commodity_metrics.sql
[0m19:28:25.541604 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.012 seconds
[0m19:28:25.548210 [debug] [Thread-2 (]: SQL status: SELECT 517 in 0.023 seconds
[0m19:28:25.548355 [debug] [Thread-4 (]: Using postgres connection "model.global_economic_tracker.stg_index_returns"
[0m19:28:25.548631 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b96cfdd-b7bd-427b-b140-7b2373ae7244', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa51376d690>]}
[0m19:28:25.548872 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b96cfdd-b7bd-427b-b140-7b2373ae7244', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa51238b430>]}
[0m19:28:25.550788 [debug] [Thread-2 (]: Using postgres connection "model.global_economic_tracker.stg_commodity_returns"
[0m19:28:25.551533 [debug] [Thread-4 (]: On model.global_economic_tracker.stg_index_returns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_index_returns"} */
alter table "airflow"."public"."stg_index_returns__dbt_tmp" rename to "stg_index_returns"
[0m19:28:25.552438 [error] [Thread-3 (]: 3 of 24 ERROR creating sql table model public.stg_index_metrics ................ [[31mERROR[0m in 0.08s]
[0m19:28:25.553423 [error] [Thread-1 (]: 1 of 24 ERROR creating sql table model public.stg_commodity_metrics ............ [[31mERROR[0m in 0.09s]
[0m19:28:25.554123 [debug] [Thread-2 (]: On model.global_economic_tracker.stg_commodity_returns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_commodity_returns"} */
alter table "airflow"."public"."stg_commodity_returns__dbt_tmp" rename to "stg_commodity_returns"
[0m19:28:25.555296 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:28:25.555628 [debug] [Thread-3 (]: Finished running node model.global_economic_tracker.stg_index_metrics
[0m19:28:25.556407 [debug] [Thread-1 (]: Finished running node model.global_economic_tracker.stg_commodity_metrics
[0m19:28:25.557290 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:28:25.558471 [debug] [Thread-4 (]: Using postgres connection "model.global_economic_tracker.stg_index_returns"
[0m19:28:25.559354 [debug] [Thread-7 (]: Marking all children of 'model.global_economic_tracker.stg_index_metrics' to be skipped because of status 'error'.  Reason: Database Error in model stg_index_metrics (models/analytics/stg_index_metrics.sql)
  column "daily_return" does not exist
  LINE 25:         avg(daily_return) over (
                       ^
  compiled code at target/run/global_economic_tracker/models/analytics/stg_index_metrics.sql.
[0m19:28:25.561101 [debug] [Thread-2 (]: Using postgres connection "model.global_economic_tracker.stg_commodity_returns"
[0m19:28:25.561825 [debug] [Thread-4 (]: On model.global_economic_tracker.stg_index_returns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_index_returns"} */

        CREATE INDEX IF NOT EXISTS idx_index_returns_ticker_ts ON "airflow"."public"."stg_index_returns"(ticker, timestamp)
      
[0m19:28:25.562811 [debug] [Thread-7 (]: Marking all children of 'model.global_economic_tracker.stg_commodity_metrics' to be skipped because of status 'error'.  Reason: Database Error in model stg_commodity_metrics (models/analytics/stg_commodity_metrics.sql)
  column "daily_return" does not exist
  LINE 25:         avg(daily_return) over (
                       ^
  compiled code at target/run/global_economic_tracker/models/analytics/stg_commodity_metrics.sql.
[0m19:28:25.563254 [debug] [Thread-3 (]: Began running node test.global_economic_tracker.accepted_values_stg_index_metrics_trend__up__down__flat.1fea418295
[0m19:28:25.563491 [debug] [Thread-1 (]: Began running node test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_daily_return__0_5___0_5.6e9f33b0a2
[0m19:28:25.563879 [debug] [Thread-2 (]: On model.global_economic_tracker.stg_commodity_returns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_commodity_returns"} */

        CREATE INDEX IF NOT EXISTS idx_returns_ticker_ts ON "airflow"."public"."stg_commodity_returns"(ticker, timestamp)
      
[0m19:28:25.565883 [info ] [Thread-3 (]: 5 of 24 SKIP test accepted_values_stg_index_metrics_trend__up__down__flat ...... [[33mSKIP[0m]
[0m19:28:25.566630 [info ] [Thread-1 (]: 6 of 24 SKIP test dbt_utils_accepted_range_stg_index_metrics_daily_return__0_5___0_5  [[33mSKIP[0m]
[0m19:28:25.567670 [debug] [Thread-4 (]: SQL status: CREATE INDEX in 0.003 seconds
[0m19:28:25.568070 [debug] [Thread-3 (]: Finished running node test.global_economic_tracker.accepted_values_stg_index_metrics_trend__up__down__flat.1fea418295
[0m19:28:25.568804 [debug] [Thread-1 (]: Finished running node test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_daily_return__0_5___0_5.6e9f33b0a2
[0m19:28:25.574897 [debug] [Thread-2 (]: SQL status: CREATE INDEX in 0.008 seconds
[0m19:28:25.577146 [debug] [Thread-4 (]: On model.global_economic_tracker.stg_index_returns: COMMIT
[0m19:28:25.577737 [debug] [Thread-3 (]: Began running node test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_rolling_avg__0_3___0_3.c2bd8acf6b
[0m19:28:25.577972 [debug] [Thread-7 (]: Marking all children of 'test.global_economic_tracker.accepted_values_stg_index_metrics_trend__up__down__flat.1fea418295' to be skipped because of status 'skipped'. 
[0m19:28:25.578506 [debug] [Thread-1 (]: Began running node test.global_economic_tracker.not_null_stg_index_metrics_daily_return.26f4856193
[0m19:28:25.579632 [debug] [Thread-2 (]: On model.global_economic_tracker.stg_commodity_returns: COMMIT
[0m19:28:25.580339 [debug] [Thread-4 (]: Using postgres connection "model.global_economic_tracker.stg_index_returns"
[0m19:28:25.581121 [info ] [Thread-3 (]: 7 of 24 SKIP test dbt_utils_accepted_range_stg_index_metrics_rolling_avg__0_3___0_3  [[33mSKIP[0m]
[0m19:28:25.581845 [debug] [Thread-7 (]: Marking all children of 'test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_daily_return__0_5___0_5.6e9f33b0a2' to be skipped because of status 'skipped'. 
[0m19:28:25.582692 [info ] [Thread-1 (]: 8 of 24 SKIP test not_null_stg_index_metrics_daily_return ...................... [[33mSKIP[0m]
[0m19:28:25.583376 [debug] [Thread-2 (]: Using postgres connection "model.global_economic_tracker.stg_commodity_returns"
[0m19:28:25.584073 [debug] [Thread-4 (]: On model.global_economic_tracker.stg_index_returns: COMMIT
[0m19:28:25.584829 [debug] [Thread-3 (]: Finished running node test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_rolling_avg__0_3___0_3.c2bd8acf6b
[0m19:28:25.586052 [debug] [Thread-1 (]: Finished running node test.global_economic_tracker.not_null_stg_index_metrics_daily_return.26f4856193
[0m19:28:25.586747 [debug] [Thread-2 (]: On model.global_economic_tracker.stg_commodity_returns: COMMIT
[0m19:28:25.588044 [debug] [Thread-3 (]: Began running node test.global_economic_tracker.not_null_stg_index_metrics_ticker.4b922607c9
[0m19:28:25.588278 [debug] [Thread-7 (]: Marking all children of 'test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_rolling_avg__0_3___0_3.c2bd8acf6b' to be skipped because of status 'skipped'. 
[0m19:28:25.588877 [debug] [Thread-1 (]: Began running node test.global_economic_tracker.not_null_stg_index_metrics_timestamp.b1d1abca86
[0m19:28:25.589788 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m19:28:25.590356 [info ] [Thread-3 (]: 9 of 24 SKIP test not_null_stg_index_metrics_ticker ............................ [[33mSKIP[0m]
[0m19:28:25.590705 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m19:28:25.591266 [debug] [Thread-7 (]: Marking all children of 'test.global_economic_tracker.not_null_stg_index_metrics_daily_return.26f4856193' to be skipped because of status 'skipped'. 
[0m19:28:25.591980 [info ] [Thread-1 (]: 10 of 24 SKIP test not_null_stg_index_metrics_timestamp ........................ [[33mSKIP[0m]
[0m19:28:25.595563 [debug] [Thread-4 (]: Applying DROP to: "airflow"."public"."stg_index_returns__dbt_backup"
[0m19:28:25.596319 [debug] [Thread-3 (]: Finished running node test.global_economic_tracker.not_null_stg_index_metrics_ticker.4b922607c9
[0m19:28:25.598410 [debug] [Thread-2 (]: Applying DROP to: "airflow"."public"."stg_commodity_returns__dbt_backup"
[0m19:28:25.599761 [debug] [Thread-1 (]: Finished running node test.global_economic_tracker.not_null_stg_index_metrics_timestamp.b1d1abca86
[0m19:28:25.602452 [debug] [Thread-4 (]: Using postgres connection "model.global_economic_tracker.stg_index_returns"
[0m19:28:25.603418 [debug] [Thread-3 (]: Began running node test.global_economic_tracker.accepted_values_stg_commodity_metrics_trend__up__down__flat.70479897b5
[0m19:28:25.603677 [debug] [Thread-7 (]: Marking all children of 'test.global_economic_tracker.not_null_stg_index_metrics_ticker.4b922607c9' to be skipped because of status 'skipped'. 
[0m19:28:25.604444 [debug] [Thread-2 (]: Using postgres connection "model.global_economic_tracker.stg_commodity_returns"
[0m19:28:25.605172 [debug] [Thread-1 (]: Began running node test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_daily_return__0_5___0_5.2c4246e1e4
[0m19:28:25.605875 [debug] [Thread-4 (]: On model.global_economic_tracker.stg_index_returns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_index_returns"} */
drop table if exists "airflow"."public"."stg_index_returns__dbt_backup" cascade
[0m19:28:25.606611 [info ] [Thread-3 (]: 11 of 24 SKIP test accepted_values_stg_commodity_metrics_trend__up__down__flat . [[33mSKIP[0m]
[0m19:28:25.607324 [debug] [Thread-7 (]: Marking all children of 'test.global_economic_tracker.not_null_stg_index_metrics_timestamp.b1d1abca86' to be skipped because of status 'skipped'. 
[0m19:28:25.608151 [debug] [Thread-2 (]: On model.global_economic_tracker.stg_commodity_returns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_commodity_returns"} */
drop table if exists "airflow"."public"."stg_commodity_returns__dbt_backup" cascade
[0m19:28:25.608895 [info ] [Thread-1 (]: 12 of 24 SKIP test dbt_utils_accepted_range_stg_commodity_metrics_daily_return__0_5___0_5  [[33mSKIP[0m]
[0m19:28:25.610049 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.000 seconds
[0m19:28:25.610313 [debug] [Thread-3 (]: Finished running node test.global_economic_tracker.accepted_values_stg_commodity_metrics_trend__up__down__flat.70479897b5
[0m19:28:25.611860 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.000 seconds
[0m19:28:25.612409 [debug] [Thread-1 (]: Finished running node test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_daily_return__0_5___0_5.2c4246e1e4
[0m19:28:25.614126 [debug] [Thread-4 (]: On model.global_economic_tracker.stg_index_returns: Close
[0m19:28:25.615074 [debug] [Thread-3 (]: Began running node test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_rolling_avg__0_3___0_3.a261930571
[0m19:28:25.615331 [debug] [Thread-7 (]: Marking all children of 'test.global_economic_tracker.accepted_values_stg_commodity_metrics_trend__up__down__flat.70479897b5' to be skipped because of status 'skipped'. 
[0m19:28:25.616285 [debug] [Thread-2 (]: On model.global_economic_tracker.stg_commodity_returns: Close
[0m19:28:25.616996 [debug] [Thread-1 (]: Began running node test.global_economic_tracker.not_null_stg_commodity_metrics_daily_return.74b14cc336
[0m19:28:25.617843 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b96cfdd-b7bd-427b-b140-7b2373ae7244', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa516ba8af0>]}
[0m19:28:25.618410 [info ] [Thread-3 (]: 13 of 24 SKIP test dbt_utils_accepted_range_stg_commodity_metrics_rolling_avg__0_3___0_3  [[33mSKIP[0m]
[0m19:28:25.619449 [debug] [Thread-7 (]: Marking all children of 'test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_daily_return__0_5___0_5.2c4246e1e4' to be skipped because of status 'skipped'. 
[0m19:28:25.620491 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b96cfdd-b7bd-427b-b140-7b2373ae7244', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4d87976d0>]}
[0m19:28:25.621056 [info ] [Thread-1 (]: 14 of 24 SKIP test not_null_stg_commodity_metrics_daily_return ................. [[33mSKIP[0m]
[0m19:28:25.621975 [info ] [Thread-4 (]: 4 of 24 OK created sql table model public.stg_index_returns .................... [[32mSELECT 0[0m in 0.16s]
[0m19:28:25.622743 [debug] [Thread-3 (]: Finished running node test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_rolling_avg__0_3___0_3.a261930571
[0m19:28:25.624150 [info ] [Thread-2 (]: 2 of 24 OK created sql table model public.stg_commodity_returns ................ [[32mSELECT 517[0m in 0.16s]
[0m19:28:25.624868 [debug] [Thread-1 (]: Finished running node test.global_economic_tracker.not_null_stg_commodity_metrics_daily_return.74b14cc336
[0m19:28:25.625606 [debug] [Thread-4 (]: Finished running node model.global_economic_tracker.stg_index_returns
[0m19:28:25.626340 [debug] [Thread-3 (]: Began running node test.global_economic_tracker.not_null_stg_commodity_metrics_ticker.6d1d8d12d7
[0m19:28:25.626574 [debug] [Thread-7 (]: Marking all children of 'test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_rolling_avg__0_3___0_3.a261930571' to be skipped because of status 'skipped'. 
[0m19:28:25.627195 [debug] [Thread-2 (]: Finished running node model.global_economic_tracker.stg_commodity_returns
[0m19:28:25.627981 [debug] [Thread-1 (]: Began running node test.global_economic_tracker.not_null_stg_commodity_metrics_timestamp.5651d4b196
[0m19:28:25.629216 [info ] [Thread-3 (]: 15 of 24 SKIP test not_null_stg_commodity_metrics_ticker ....................... [[33mSKIP[0m]
[0m19:28:25.629936 [debug] [Thread-7 (]: Marking all children of 'test.global_economic_tracker.not_null_stg_commodity_metrics_daily_return.74b14cc336' to be skipped because of status 'skipped'. 
[0m19:28:25.631252 [info ] [Thread-1 (]: 16 of 24 SKIP test not_null_stg_commodity_metrics_timestamp .................... [[33mSKIP[0m]
[0m19:28:25.631984 [debug] [Thread-3 (]: Finished running node test.global_economic_tracker.not_null_stg_commodity_metrics_ticker.6d1d8d12d7
[0m19:28:25.633282 [debug] [Thread-4 (]: Began running node test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe
[0m19:28:25.633517 [debug] [Thread-2 (]: Began running node test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713
[0m19:28:25.633906 [debug] [Thread-1 (]: Finished running node test.global_economic_tracker.not_null_stg_commodity_metrics_timestamp.5651d4b196
[0m19:28:25.634654 [debug] [Thread-3 (]: Began running node test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934
[0m19:28:25.634900 [debug] [Thread-7 (]: Marking all children of 'test.global_economic_tracker.not_null_stg_commodity_metrics_ticker.6d1d8d12d7' to be skipped because of status 'skipped'. 
[0m19:28:25.635463 [info ] [Thread-4 (]: 17 of 24 START test dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5  [RUN]
[0m19:28:25.636345 [info ] [Thread-2 (]: 18 of 24 START test dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5  [RUN]
[0m19:28:25.637058 [debug] [Thread-1 (]: Began running node test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d
[0m19:28:25.637761 [info ] [Thread-3 (]: 19 of 24 START test not_null_stg_commodity_returns_daily_return ................ [RUN]
[0m19:28:25.638452 [debug] [Thread-7 (]: Marking all children of 'test.global_economic_tracker.not_null_stg_commodity_metrics_timestamp.5651d4b196' to be skipped because of status 'skipped'. 
[0m19:28:25.639185 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.global_economic_tracker.stg_index_returns, now test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe)
[0m19:28:25.639921 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.global_economic_tracker.stg_commodity_returns, now test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713)
[0m19:28:25.640714 [info ] [Thread-1 (]: 20 of 24 START test not_null_stg_commodity_returns_ticker ...................... [RUN]
[0m19:28:25.641425 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.global_economic_tracker.stg_index_metrics, now test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934)
[0m19:28:25.642685 [debug] [Thread-4 (]: Began compiling node test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe
[0m19:28:25.643399 [debug] [Thread-2 (]: Began compiling node test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713
[0m19:28:25.644126 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.global_economic_tracker.stg_commodity_metrics, now test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d)
[0m19:28:25.644853 [debug] [Thread-3 (]: Began compiling node test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934
[0m19:28:25.647606 [debug] [Thread-4 (]: Writing injected SQL for node "test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe"
[0m19:28:25.650808 [debug] [Thread-2 (]: Writing injected SQL for node "test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713"
[0m19:28:25.651557 [debug] [Thread-1 (]: Began compiling node test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d
[0m19:28:25.656186 [debug] [Thread-3 (]: Writing injected SQL for node "test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934"
[0m19:28:25.659893 [debug] [Thread-1 (]: Writing injected SQL for node "test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d"
[0m19:28:25.666313 [debug] [Thread-2 (]: Began executing node test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713
[0m19:28:25.676075 [debug] [Thread-2 (]: Writing runtime sql for node "test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713"
[0m19:28:25.676311 [debug] [Thread-1 (]: Began executing node test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d
[0m19:28:25.677359 [debug] [Thread-4 (]: Began executing node test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe
[0m19:28:25.677980 [debug] [Thread-3 (]: Began executing node test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934
[0m19:28:25.679619 [debug] [Thread-1 (]: Writing runtime sql for node "test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d"
[0m19:28:25.681330 [debug] [Thread-4 (]: Writing runtime sql for node "test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe"
[0m19:28:25.683088 [debug] [Thread-3 (]: Writing runtime sql for node "test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934"
[0m19:28:25.686710 [debug] [Thread-2 (]: Using postgres connection "test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713"
[0m19:28:25.687491 [debug] [Thread-2 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713: BEGIN
[0m19:28:25.687745 [debug] [Thread-1 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d"
[0m19:28:25.688258 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:28:25.689050 [debug] [Thread-1 (]: On test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d: BEGIN
[0m19:28:25.689324 [debug] [Thread-3 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934"
[0m19:28:25.690652 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:28:25.691099 [debug] [Thread-4 (]: Using postgres connection "test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe"
[0m19:28:25.691711 [debug] [Thread-3 (]: On test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934: BEGIN
[0m19:28:25.692230 [debug] [Thread-2 (]: SQL status: BEGIN in 0.004 seconds
[0m19:28:25.693311 [debug] [Thread-4 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe: BEGIN
[0m19:28:25.694001 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m19:28:25.694232 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:28:25.694943 [debug] [Thread-2 (]: Using postgres connection "test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713"
[0m19:28:25.695636 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:28:25.696319 [debug] [Thread-1 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d"
[0m19:28:25.697602 [debug] [Thread-2 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with meet_condition as(
  select *
  from "airflow"."public"."stg_index_returns"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not daily_return >= -0.5
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not daily_return <= 0.5
)

select *
from validation_errors


      
    ) dbt_internal_test
[0m19:28:25.698339 [debug] [Thread-3 (]: SQL status: BEGIN in 0.004 seconds
[0m19:28:25.699282 [debug] [Thread-1 (]: On test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select ticker
from "airflow"."public"."stg_commodity_returns"
where ticker is null



      
    ) dbt_internal_test
[0m19:28:25.700593 [debug] [Thread-3 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934"
[0m19:28:25.700845 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m19:28:25.701499 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m19:28:25.701827 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.000 seconds
[0m19:28:25.702199 [debug] [Thread-3 (]: On test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select daily_return
from "airflow"."public"."stg_commodity_returns"
where daily_return is null



      
    ) dbt_internal_test
[0m19:28:25.702990 [debug] [Thread-4 (]: Using postgres connection "test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe"
[0m19:28:25.705283 [debug] [Thread-2 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713: ROLLBACK
[0m19:28:25.706491 [debug] [Thread-1 (]: On test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d: ROLLBACK
[0m19:28:25.707621 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.000 seconds
[0m19:28:25.707875 [debug] [Thread-4 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with meet_condition as(
  select *
  from "airflow"."public"."stg_commodity_returns"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not daily_return >= -0.5
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not daily_return <= 0.5
)

select *
from validation_errors


      
    ) dbt_internal_test
[0m19:28:25.708696 [debug] [Thread-2 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713: Close
[0m19:28:25.709331 [debug] [Thread-1 (]: On test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d: Close
[0m19:28:25.710284 [debug] [Thread-3 (]: On test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934: ROLLBACK
[0m19:28:25.711987 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m19:28:25.711741 [info ] [Thread-2 (]: 18 of 24 PASS dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5  [[32mPASS[0m in 0.07s]
[0m19:28:25.712598 [info ] [Thread-1 (]: 20 of 24 PASS not_null_stg_commodity_returns_ticker ............................ [[32mPASS[0m in 0.07s]
[0m19:28:25.713282 [debug] [Thread-3 (]: On test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934: Close
[0m19:28:25.714272 [debug] [Thread-4 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe: ROLLBACK
[0m19:28:25.715078 [debug] [Thread-2 (]: Finished running node test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713
[0m19:28:25.715855 [debug] [Thread-1 (]: Finished running node test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d
[0m19:28:25.716677 [error] [Thread-3 (]: 19 of 24 FAIL 7 not_null_stg_commodity_returns_daily_return .................... [[31mFAIL 7[0m in 0.08s]
[0m19:28:25.717286 [debug] [Thread-4 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe: Close
[0m19:28:25.717882 [debug] [Thread-2 (]: Began running node test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359
[0m19:28:25.718641 [debug] [Thread-1 (]: Began running node test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8
[0m19:28:25.719517 [debug] [Thread-3 (]: Finished running node test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934
[0m19:28:25.720368 [info ] [Thread-4 (]: 17 of 24 PASS dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5  [[32mPASS[0m in 0.08s]
[0m19:28:25.720932 [info ] [Thread-2 (]: 21 of 24 START test not_null_stg_commodity_returns_timestamp ................... [RUN]
[0m19:28:25.721634 [info ] [Thread-1 (]: 22 of 24 START test not_null_stg_index_returns_daily_return .................... [RUN]
[0m19:28:25.722345 [debug] [Thread-3 (]: Began running node test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0
[0m19:28:25.722657 [debug] [Thread-7 (]: Marking all children of 'test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934' to be skipped because of status 'fail'.  Reason: Got 7 results, configured to fail if != 0.
[0m19:28:25.723287 [debug] [Thread-4 (]: Finished running node test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe
[0m19:28:25.724034 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713, now test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359)
[0m19:28:25.724788 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d, now test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8)
[0m19:28:25.725585 [info ] [Thread-3 (]: 23 of 24 START test not_null_stg_index_returns_ticker .......................... [RUN]
[0m19:28:25.726845 [debug] [Thread-4 (]: Began running node test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17
[0m19:28:25.727557 [debug] [Thread-2 (]: Began compiling node test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359
[0m19:28:25.728227 [debug] [Thread-1 (]: Began compiling node test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8
[0m19:28:25.728951 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934, now test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0)
[0m19:28:25.729664 [info ] [Thread-4 (]: 24 of 24 START test not_null_stg_index_returns_timestamp ....................... [RUN]
[0m19:28:25.732345 [debug] [Thread-2 (]: Writing injected SQL for node "test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359"
[0m19:28:25.734970 [debug] [Thread-1 (]: Writing injected SQL for node "test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8"
[0m19:28:25.735866 [debug] [Thread-3 (]: Began compiling node test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0
[0m19:28:25.736714 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe, now test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17)
[0m19:28:25.740817 [debug] [Thread-3 (]: Writing injected SQL for node "test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0"
[0m19:28:25.741577 [debug] [Thread-4 (]: Began compiling node test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17
[0m19:28:25.744522 [debug] [Thread-4 (]: Writing injected SQL for node "test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17"
[0m19:28:25.745496 [debug] [Thread-2 (]: Began executing node test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359
[0m19:28:25.745723 [debug] [Thread-1 (]: Began executing node test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8
[0m19:28:25.747325 [debug] [Thread-2 (]: Writing runtime sql for node "test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359"
[0m19:28:25.747972 [debug] [Thread-3 (]: Began executing node test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0
[0m19:28:25.749152 [debug] [Thread-1 (]: Writing runtime sql for node "test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8"
[0m19:28:25.749396 [debug] [Thread-4 (]: Began executing node test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17
[0m19:28:25.751423 [debug] [Thread-3 (]: Writing runtime sql for node "test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0"
[0m19:28:25.753628 [debug] [Thread-4 (]: Writing runtime sql for node "test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17"
[0m19:28:25.754613 [debug] [Thread-2 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359"
[0m19:28:25.755675 [debug] [Thread-1 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8"
[0m19:28:25.756093 [debug] [Thread-2 (]: On test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359: BEGIN
[0m19:28:25.756840 [debug] [Thread-3 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0"
[0m19:28:25.757100 [debug] [Thread-1 (]: On test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8: BEGIN
[0m19:28:25.757846 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:28:25.758419 [debug] [Thread-4 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17"
[0m19:28:25.758797 [debug] [Thread-3 (]: On test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0: BEGIN
[0m19:28:25.759559 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:28:25.760890 [debug] [Thread-4 (]: On test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17: BEGIN
[0m19:28:25.761651 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:28:25.761943 [debug] [Thread-2 (]: SQL status: BEGIN in 0.004 seconds
[0m19:28:25.763166 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:28:25.764031 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m19:28:25.764777 [debug] [Thread-2 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359"
[0m19:28:25.765268 [debug] [Thread-3 (]: SQL status: BEGIN in 0.004 seconds
[0m19:28:25.766220 [debug] [Thread-1 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8"
[0m19:28:25.766937 [debug] [Thread-2 (]: On test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select timestamp
from "airflow"."public"."stg_commodity_returns"
where timestamp is null



      
    ) dbt_internal_test
[0m19:28:25.767518 [debug] [Thread-4 (]: SQL status: BEGIN in 0.004 seconds
[0m19:28:25.767892 [debug] [Thread-3 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0"
[0m19:28:25.768595 [debug] [Thread-1 (]: On test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select daily_return
from "airflow"."public"."stg_index_returns"
where daily_return is null



      
    ) dbt_internal_test
[0m19:28:25.769707 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.000 seconds
[0m19:28:25.769941 [debug] [Thread-4 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17"
[0m19:28:25.770650 [debug] [Thread-3 (]: On test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select ticker
from "airflow"."public"."stg_index_returns"
where ticker is null



      
    ) dbt_internal_test
[0m19:28:25.771723 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.000 seconds
[0m19:28:25.772597 [debug] [Thread-2 (]: On test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359: ROLLBACK
[0m19:28:25.773324 [debug] [Thread-4 (]: On test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select timestamp
from "airflow"."public"."stg_index_returns"
where timestamp is null



      
    ) dbt_internal_test
[0m19:28:25.774381 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.000 seconds
[0m19:28:25.775194 [debug] [Thread-1 (]: On test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8: ROLLBACK
[0m19:28:25.775991 [debug] [Thread-2 (]: On test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359: Close
[0m19:28:25.776861 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.000 seconds
[0m19:28:25.777712 [debug] [Thread-3 (]: On test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0: ROLLBACK
[0m19:28:25.778544 [debug] [Thread-1 (]: On test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8: Close
[0m19:28:25.779294 [info ] [Thread-2 (]: 21 of 24 PASS not_null_stg_commodity_returns_timestamp ......................... [[32mPASS[0m in 0.06s]
[0m19:28:25.780231 [debug] [Thread-4 (]: On test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17: ROLLBACK
[0m19:28:25.781100 [debug] [Thread-3 (]: On test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0: Close
[0m19:28:25.781837 [info ] [Thread-1 (]: 22 of 24 PASS not_null_stg_index_returns_daily_return .......................... [[32mPASS[0m in 0.06s]
[0m19:28:25.782462 [debug] [Thread-2 (]: Finished running node test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359
[0m19:28:25.783269 [debug] [Thread-4 (]: On test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17: Close
[0m19:28:25.783959 [info ] [Thread-3 (]: 23 of 24 PASS not_null_stg_index_returns_ticker ................................ [[32mPASS[0m in 0.06s]
[0m19:28:25.784548 [debug] [Thread-1 (]: Finished running node test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8
[0m19:28:25.786012 [info ] [Thread-4 (]: 24 of 24 PASS not_null_stg_index_returns_timestamp ............................. [[32mPASS[0m in 0.05s]
[0m19:28:25.786623 [debug] [Thread-3 (]: Finished running node test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0
[0m19:28:25.787957 [debug] [Thread-4 (]: Finished running node test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17
[0m19:28:25.790193 [debug] [MainThread]: Using postgres connection "master"
[0m19:28:25.790873 [debug] [MainThread]: On master: BEGIN
[0m19:28:25.791548 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:28:25.793395 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m19:28:25.794166 [debug] [MainThread]: On master: COMMIT
[0m19:28:25.794842 [debug] [MainThread]: Using postgres connection "master"
[0m19:28:25.795467 [debug] [MainThread]: On master: COMMIT
[0m19:28:25.796205 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:28:25.796843 [debug] [MainThread]: On master: Close
[0m19:28:25.797574 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:28:25.798227 [debug] [MainThread]: Connection 'test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8' was properly closed.
[0m19:28:25.798871 [debug] [MainThread]: Connection 'test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359' was properly closed.
[0m19:28:25.799493 [debug] [MainThread]: Connection 'test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0' was properly closed.
[0m19:28:25.800111 [debug] [MainThread]: Connection 'test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17' was properly closed.
[0m19:28:25.800850 [info ] [MainThread]: 
[0m19:28:25.801570 [info ] [MainThread]: Finished running 4 table models, 20 data tests in 0 hours 0 minutes and 0.42 seconds (0.42s).
[0m19:28:25.803129 [debug] [MainThread]: Command end result
[0m19:28:25.831289 [debug] [MainThread]: Wrote artifact WritableManifest to /mnt/c/Users/joeyk/PycharmProjects/GlobalEconomicTracker/global_economic_tracker/target/manifest.json
[0m19:28:25.834845 [debug] [MainThread]: Wrote artifact SemanticManifest to /mnt/c/Users/joeyk/PycharmProjects/GlobalEconomicTracker/global_economic_tracker/target/semantic_manifest.json
[0m19:28:25.841566 [debug] [MainThread]: Wrote artifact RunExecutionResult to /mnt/c/Users/joeyk/PycharmProjects/GlobalEconomicTracker/global_economic_tracker/target/run_results.json
[0m19:28:25.842210 [info ] [MainThread]: 
[0m19:28:25.842933 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m19:28:25.843616 [info ] [MainThread]: 
[0m19:28:25.844489 [error] [MainThread]:   Database Error in model stg_index_metrics (models/analytics/stg_index_metrics.sql)
  column "daily_return" does not exist
  LINE 25:         avg(daily_return) over (
                       ^
  compiled code at target/run/global_economic_tracker/models/analytics/stg_index_metrics.sql
[0m19:28:25.845208 [info ] [MainThread]: 
[0m19:28:25.845927 [error] [MainThread]:   Database Error in model stg_commodity_metrics (models/analytics/stg_commodity_metrics.sql)
  column "daily_return" does not exist
  LINE 25:         avg(daily_return) over (
                       ^
  compiled code at target/run/global_economic_tracker/models/analytics/stg_commodity_metrics.sql
[0m19:28:25.846604 [info ] [MainThread]: 
[0m19:28:25.847315 [error] [MainThread]: [31mFailure in test not_null_stg_commodity_returns_daily_return (models/staging/schema.yml)[0m
[0m19:28:25.848012 [error] [MainThread]:   Got 7 results, configured to fail if != 0
[0m19:28:25.848687 [info ] [MainThread]: 
[0m19:28:25.849394 [info ] [MainThread]:   compiled code at target/compiled/global_economic_tracker/models/staging/schema.yml/not_null_stg_commodity_returns_daily_return.sql
[0m19:28:25.850075 [info ] [MainThread]: 
[0m19:28:25.850880 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=3 SKIP=12 TOTAL=24
[0m19:28:25.851870 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 2.3604903, "process_in_blocks": "19184", "process_kernel_time": 0.128081, "process_mem_max_rss": "129796", "process_out_blocks": "0", "process_user_time": 1.773436}
[0m19:28:25.852914 [debug] [MainThread]: Command `dbt build` failed at 19:28:25.852842 after 2.36 seconds
[0m19:28:25.853583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5151b5b40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5123f24d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5123f18a0>]}
[0m19:28:25.854271 [debug] [MainThread]: Flushing usage events
[0m19:28:26.509081 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:36:50.495962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdac2f95a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdac2e6c250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdac2e6f9d0>]}


============================== 19:36:50.497842 | ca7de772-1359-4bf8-ba63-fa924cec9ede ==============================
[0m19:36:50.497842 [info ] [MainThread]: Running with dbt=1.9.4
[0m19:36:50.498634 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/joey/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/mnt/c/Users/joeyk/PycharmProjects/GlobalEconomicTracker/global_economic_tracker/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt build', 'send_anonymous_usage_stats': 'True'}
[0m19:36:50.585241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ca7de772-1359-4bf8-ba63-fa924cec9ede', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdac47063b0>]}
[0m19:36:50.616139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ca7de772-1359-4bf8-ba63-fa924cec9ede', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdac277fd90>]}
[0m19:36:50.617211 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m19:36:50.660000 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m19:36:51.471650 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m19:36:51.472688 [debug] [MainThread]: Partial parsing: updated file: global_economic_tracker://models/analytics/stg_index_metrics.sql
[0m19:36:51.473415 [debug] [MainThread]: Partial parsing: updated file: global_economic_tracker://models/staging/stg_index_returns.sql
[0m19:36:51.724968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ca7de772-1359-4bf8-ba63-fa924cec9ede', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdac0760670>]}
[0m19:36:51.777973 [debug] [MainThread]: Wrote artifact WritableManifest to /mnt/c/Users/joeyk/PycharmProjects/GlobalEconomicTracker/global_economic_tracker/target/manifest.json
[0m19:36:51.781847 [debug] [MainThread]: Wrote artifact SemanticManifest to /mnt/c/Users/joeyk/PycharmProjects/GlobalEconomicTracker/global_economic_tracker/target/semantic_manifest.json
[0m19:36:51.797336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ca7de772-1359-4bf8-ba63-fa924cec9ede', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdac2e5dbd0>]}
[0m19:36:51.798097 [info ] [MainThread]: Found 4 models, 20 data tests, 549 macros
[0m19:36:51.799996 [info ] [MainThread]: 
[0m19:36:51.800751 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:36:51.801427 [info ] [MainThread]: 
[0m19:36:51.802200 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:36:51.805044 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m19:36:51.817213 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m19:36:51.817890 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m19:36:51.818520 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:36:51.821827 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.003 seconds
[0m19:36:51.822910 [debug] [ThreadPool]: On list_airflow: Close
[0m19:36:51.824189 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_public)
[0m19:36:51.827617 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m19:36:51.828266 [debug] [ThreadPool]: On list_airflow_public: BEGIN
[0m19:36:51.828980 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:36:51.831419 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m19:36:51.832051 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m19:36:51.832684 [debug] [ThreadPool]: On list_airflow_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:36:51.835228 [debug] [ThreadPool]: SQL status: SELECT 47 in 0.002 seconds
[0m19:36:51.836781 [debug] [ThreadPool]: On list_airflow_public: ROLLBACK
[0m19:36:51.837550 [debug] [ThreadPool]: On list_airflow_public: Close
[0m19:36:51.842737 [debug] [MainThread]: Using postgres connection "master"
[0m19:36:51.843430 [debug] [MainThread]: On master: BEGIN
[0m19:36:51.844059 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:36:51.845939 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m19:36:51.846573 [debug] [MainThread]: Using postgres connection "master"
[0m19:36:51.847225 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:36:51.849030 [debug] [MainThread]: SQL status: SELECT 0 in 0.001 seconds
[0m19:36:51.850087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca7de772-1359-4bf8-ba63-fa924cec9ede', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdac0782ef0>]}
[0m19:36:51.850819 [debug] [MainThread]: On master: ROLLBACK
[0m19:36:51.851583 [debug] [MainThread]: Using postgres connection "master"
[0m19:36:51.852208 [debug] [MainThread]: On master: BEGIN
[0m19:36:51.853051 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m19:36:51.853684 [debug] [MainThread]: On master: COMMIT
[0m19:36:51.854371 [debug] [MainThread]: Using postgres connection "master"
[0m19:36:51.854990 [debug] [MainThread]: On master: COMMIT
[0m19:36:51.855725 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:36:51.856309 [debug] [MainThread]: On master: Close
[0m19:36:51.859575 [debug] [Thread-1 (]: Began running node model.global_economic_tracker.stg_commodity_metrics
[0m19:36:51.859825 [debug] [Thread-2 (]: Began running node model.global_economic_tracker.stg_commodity_returns
[0m19:36:51.860078 [debug] [Thread-3 (]: Began running node model.global_economic_tracker.stg_index_metrics
[0m19:36:51.860390 [debug] [Thread-4 (]: Began running node model.global_economic_tracker.stg_index_returns
[0m19:36:51.860906 [info ] [Thread-1 (]: 1 of 24 START sql table model public.stg_commodity_metrics ..................... [RUN]
[0m19:36:51.861670 [info ] [Thread-2 (]: 2 of 24 START sql table model public.stg_commodity_returns ..................... [RUN]
[0m19:36:51.862448 [info ] [Thread-3 (]: 3 of 24 START sql table model public.stg_index_metrics ......................... [RUN]
[0m19:36:51.863153 [info ] [Thread-4 (]: 4 of 24 START sql table model public.stg_index_returns ......................... [RUN]
[0m19:36:51.863877 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_public, now model.global_economic_tracker.stg_commodity_metrics)
[0m19:36:51.864638 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.global_economic_tracker.stg_commodity_returns'
[0m19:36:51.865385 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.global_economic_tracker.stg_index_metrics'
[0m19:36:51.866166 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.global_economic_tracker.stg_index_returns'
[0m19:36:51.866880 [debug] [Thread-1 (]: Began compiling node model.global_economic_tracker.stg_commodity_metrics
[0m19:36:51.867566 [debug] [Thread-2 (]: Began compiling node model.global_economic_tracker.stg_commodity_returns
[0m19:36:51.868259 [debug] [Thread-3 (]: Began compiling node model.global_economic_tracker.stg_index_metrics
[0m19:36:51.868925 [debug] [Thread-4 (]: Began compiling node model.global_economic_tracker.stg_index_returns
[0m19:36:51.873339 [debug] [Thread-1 (]: Writing injected SQL for node "model.global_economic_tracker.stg_commodity_metrics"
[0m19:36:51.875147 [debug] [Thread-2 (]: Writing injected SQL for node "model.global_economic_tracker.stg_commodity_returns"
[0m19:36:51.876992 [debug] [Thread-3 (]: Writing injected SQL for node "model.global_economic_tracker.stg_index_metrics"
[0m19:36:51.879244 [debug] [Thread-4 (]: Writing injected SQL for node "model.global_economic_tracker.stg_index_returns"
[0m19:36:51.883691 [debug] [Thread-1 (]: Began executing node model.global_economic_tracker.stg_commodity_metrics
[0m19:36:51.883978 [debug] [Thread-2 (]: Began executing node model.global_economic_tracker.stg_commodity_returns
[0m19:36:51.889763 [debug] [Thread-3 (]: Began executing node model.global_economic_tracker.stg_index_metrics
[0m19:36:51.899926 [debug] [Thread-4 (]: Began executing node model.global_economic_tracker.stg_index_returns
[0m19:36:51.902901 [debug] [Thread-1 (]: Writing runtime sql for node "model.global_economic_tracker.stg_commodity_metrics"
[0m19:36:51.905488 [debug] [Thread-2 (]: Writing runtime sql for node "model.global_economic_tracker.stg_commodity_returns"
[0m19:36:51.908045 [debug] [Thread-3 (]: Writing runtime sql for node "model.global_economic_tracker.stg_index_metrics"
[0m19:36:51.910853 [debug] [Thread-4 (]: Writing runtime sql for node "model.global_economic_tracker.stg_index_returns"
[0m19:36:51.915489 [debug] [Thread-2 (]: Using postgres connection "model.global_economic_tracker.stg_commodity_returns"
[0m19:36:51.915834 [debug] [Thread-1 (]: Using postgres connection "model.global_economic_tracker.stg_commodity_metrics"
[0m19:36:51.916410 [debug] [Thread-2 (]: On model.global_economic_tracker.stg_commodity_returns: BEGIN
[0m19:36:51.916684 [debug] [Thread-4 (]: Using postgres connection "model.global_economic_tracker.stg_index_returns"
[0m19:36:51.916969 [debug] [Thread-3 (]: Using postgres connection "model.global_economic_tracker.stg_index_metrics"
[0m19:36:51.917357 [debug] [Thread-1 (]: On model.global_economic_tracker.stg_commodity_metrics: BEGIN
[0m19:36:51.918158 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:36:51.918907 [debug] [Thread-4 (]: On model.global_economic_tracker.stg_index_returns: BEGIN
[0m19:36:51.919608 [debug] [Thread-3 (]: On model.global_economic_tracker.stg_index_metrics: BEGIN
[0m19:36:51.920410 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:36:51.921731 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:36:51.922479 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:36:51.922735 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m19:36:51.925124 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m19:36:51.925388 [debug] [Thread-2 (]: Using postgres connection "model.global_economic_tracker.stg_commodity_returns"
[0m19:36:51.925634 [debug] [Thread-4 (]: SQL status: BEGIN in 0.004 seconds
[0m19:36:51.926114 [debug] [Thread-3 (]: SQL status: BEGIN in 0.004 seconds
[0m19:36:51.926494 [debug] [Thread-1 (]: Using postgres connection "model.global_economic_tracker.stg_commodity_metrics"
[0m19:36:51.927215 [debug] [Thread-2 (]: On model.global_economic_tracker.stg_commodity_returns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_commodity_returns"} */

  
    

  create  table "airflow"."public"."stg_commodity_returns__dbt_tmp"
  
  
    as
  
  (
    

select
    'commodity' as type,
    ticker,
    timestamp,
    price,
    lag(price) over (partition by ticker order by timestamp) as prev_price,
    (price - lag(price) over (partition by ticker order by timestamp)) / lag(price) over (partition by ticker order by timestamp) as daily_return
from public.commodity_prices
  );
  
[0m19:36:51.927907 [debug] [Thread-4 (]: Using postgres connection "model.global_economic_tracker.stg_index_returns"
[0m19:36:51.928575 [debug] [Thread-3 (]: Using postgres connection "model.global_economic_tracker.stg_index_metrics"
[0m19:36:51.929433 [debug] [Thread-1 (]: On model.global_economic_tracker.stg_commodity_metrics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_commodity_metrics"} */

  
    

  create  table "airflow"."public"."stg_commodity_metrics__dbt_tmp"
  
  
    as
  
  (
    

with base as (
    select
        *,
        row_number() over (partition by ticker order by timestamp) as rn
    from public.commodity_prices
),

rolling as (
    select
        ticker,
        timestamp,
        avg(daily_return) over (
            partition by ticker
            order by rn
            rows between 19 preceding and current row
        ) as rolling_avg_mo,

        avg(daily_return) OVER (
            partition by ticker
            order by timestamp
            rows between 6 preceding and current row
        ) as weekly_avg_return,

        stddev(daily_return) over (
            partition by ticker
            order by rn
            rows between 19 preceding and current row
        ) as rolling_volatility_mo,

        case
            when daily_return > 0 then 'up'
            when daily_return < 0 then 'down'
            else 'flat'
        end as trend

    from base
)

select
    *,
    rolling_avg_mo / nullif(rolling_volatility_mo, 0) as sharpe_mo,
    (daily_return - rolling_avg_mo) / nullif(rolling_volatility_mo, 0) as z_score_mo
from rolling
where rolling_avg_mo is not null
  );
  
[0m19:36:51.930744 [debug] [Thread-4 (]: On model.global_economic_tracker.stg_index_returns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_index_returns"} */

  
    

  create  table "airflow"."public"."stg_index_returns__dbt_tmp"
  
  
    as
  
  (
    

select
    'index' as type,
    country,
    ticker,
    timestamp,
    price,
    lag(price) over (partition by ticker order by timestamp) as prev_price,
    (price - lag(price) over (partition by ticker order by timestamp)) / lag(price) over (partition by ticker order by timestamp) as daily_return
from public.index_prices
  );
  
[0m19:36:51.931475 [debug] [Thread-3 (]: On model.global_economic_tracker.stg_index_metrics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_index_metrics"} */

  
    

  create  table "airflow"."public"."stg_index_metrics__dbt_tmp"
  
  
    as
  
  (
    

with base as (
    select
        *,
        row_number() over (partition by ticker order by timestamp) as rn
    from public.index_prices
),

rolling as (
    select
        ticker,
        timestamp,
        avg(daily_return) over (
            partition by ticker
            order by rn
            rows between 19 preceding and current row
        ) as rolling_avg_mo,

        avg(daily_return) OVER (
            partition by ticker
            order by timestamp
            rows between 6 preceding and current row
        ) as weekly_avg_return,

        stddev(daily_return) over (
            partition by ticker
            order by rn
            rows between 19 preceding and current row
        ) as rolling_volatility_mo,

        case
            when daily_return > 0 then 'up'
            when daily_return < 0 then 'down'
            else 'flat'
        end as trend

    from base
)

select
    *,
    rolling_avg_mo / nullif(rolling_volatility_mo, 0) as sharpe_mo,
    (daily_return - rolling_avg_mo) / nullif(rolling_volatility_mo, 0) as z_score_mo
from rolling
where rolling_avg_mo is not null
  );
  
[0m19:36:51.932678 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "daily_return" does not exist
LINE 25:         avg(daily_return) over (
                     ^

[0m19:36:51.934180 [debug] [Thread-3 (]: Postgres adapter: Postgres error: column "daily_return" does not exist
LINE 25:         avg(daily_return) over (
                     ^

[0m19:36:51.934535 [debug] [Thread-1 (]: On model.global_economic_tracker.stg_commodity_metrics: ROLLBACK
[0m19:36:51.935273 [debug] [Thread-3 (]: On model.global_economic_tracker.stg_index_metrics: ROLLBACK
[0m19:36:51.936092 [debug] [Thread-1 (]: On model.global_economic_tracker.stg_commodity_metrics: Close
[0m19:36:51.936769 [debug] [Thread-3 (]: On model.global_economic_tracker.stg_index_metrics: Close
[0m19:36:51.937699 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.005 seconds
[0m19:36:51.938609 [debug] [Thread-2 (]: SQL status: SELECT 517 in 0.008 seconds
[0m19:36:51.945094 [debug] [Thread-4 (]: Using postgres connection "model.global_economic_tracker.stg_index_returns"
[0m19:36:51.947718 [debug] [Thread-2 (]: Using postgres connection "model.global_economic_tracker.stg_commodity_returns"
[0m19:36:51.948755 [debug] [Thread-4 (]: On model.global_economic_tracker.stg_index_returns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_index_returns"} */
alter table "airflow"."public"."stg_index_returns" rename to "stg_index_returns__dbt_backup"
[0m19:36:51.949082 [debug] [Thread-3 (]: Database Error in model stg_index_metrics (models/analytics/stg_index_metrics.sql)
  column "daily_return" does not exist
  LINE 25:         avg(daily_return) over (
                       ^
  compiled code at target/run/global_economic_tracker/models/analytics/stg_index_metrics.sql
[0m19:36:51.949583 [debug] [Thread-1 (]: Database Error in model stg_commodity_metrics (models/analytics/stg_commodity_metrics.sql)
  column "daily_return" does not exist
  LINE 25:         avg(daily_return) over (
                       ^
  compiled code at target/run/global_economic_tracker/models/analytics/stg_commodity_metrics.sql
[0m19:36:51.950304 [debug] [Thread-2 (]: On model.global_economic_tracker.stg_commodity_returns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_commodity_returns"} */
alter table "airflow"."public"."stg_commodity_returns" rename to "stg_commodity_returns__dbt_backup"
[0m19:36:51.951232 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:36:51.952750 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca7de772-1359-4bf8-ba63-fa924cec9ede', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdac3242d40>]}
[0m19:36:51.953342 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca7de772-1359-4bf8-ba63-fa924cec9ede', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdabcf7beb0>]}
[0m19:36:51.954261 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:36:51.955947 [debug] [Thread-4 (]: Using postgres connection "model.global_economic_tracker.stg_index_returns"
[0m19:36:51.956849 [error] [Thread-3 (]: 3 of 24 ERROR creating sql table model public.stg_index_metrics ................ [[31mERROR[0m in 0.09s]
[0m19:36:51.957703 [error] [Thread-1 (]: 1 of 24 ERROR creating sql table model public.stg_commodity_metrics ............ [[31mERROR[0m in 0.09s]
[0m19:36:51.959561 [debug] [Thread-2 (]: Using postgres connection "model.global_economic_tracker.stg_commodity_returns"
[0m19:36:51.960252 [debug] [Thread-4 (]: On model.global_economic_tracker.stg_index_returns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_index_returns"} */
alter table "airflow"."public"."stg_index_returns__dbt_tmp" rename to "stg_index_returns"
[0m19:36:51.961062 [debug] [Thread-3 (]: Finished running node model.global_economic_tracker.stg_index_metrics
[0m19:36:51.961833 [debug] [Thread-1 (]: Finished running node model.global_economic_tracker.stg_commodity_metrics
[0m19:36:51.962534 [debug] [Thread-2 (]: On model.global_economic_tracker.stg_commodity_returns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_commodity_returns"} */
alter table "airflow"."public"."stg_commodity_returns__dbt_tmp" rename to "stg_commodity_returns"
[0m19:36:51.963432 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:36:51.964188 [debug] [Thread-7 (]: Marking all children of 'model.global_economic_tracker.stg_index_metrics' to be skipped because of status 'error'.  Reason: Database Error in model stg_index_metrics (models/analytics/stg_index_metrics.sql)
  column "daily_return" does not exist
  LINE 25:         avg(daily_return) over (
                       ^
  compiled code at target/run/global_economic_tracker/models/analytics/stg_index_metrics.sql.
[0m19:36:51.965534 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:36:51.966654 [debug] [Thread-4 (]: Using postgres connection "model.global_economic_tracker.stg_index_returns"
[0m19:36:51.967604 [debug] [Thread-7 (]: Marking all children of 'model.global_economic_tracker.stg_commodity_metrics' to be skipped because of status 'error'.  Reason: Database Error in model stg_commodity_metrics (models/analytics/stg_commodity_metrics.sql)
  column "daily_return" does not exist
  LINE 25:         avg(daily_return) over (
                       ^
  compiled code at target/run/global_economic_tracker/models/analytics/stg_commodity_metrics.sql.
[0m19:36:51.968121 [debug] [Thread-3 (]: Began running node test.global_economic_tracker.accepted_values_stg_index_metrics_trend__up__down__flat.1fea418295
[0m19:36:51.968349 [debug] [Thread-1 (]: Began running node test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_daily_return__0_5___0_5.6e9f33b0a2
[0m19:36:51.969308 [debug] [Thread-2 (]: Using postgres connection "model.global_economic_tracker.stg_commodity_returns"
[0m19:36:51.970007 [debug] [Thread-4 (]: On model.global_economic_tracker.stg_index_returns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_index_returns"} */

        CREATE INDEX IF NOT EXISTS idx_index_returns_ticker_ts ON "airflow"."public"."stg_index_returns"(ticker, timestamp)
      
[0m19:36:51.972201 [info ] [Thread-3 (]: 5 of 24 SKIP test accepted_values_stg_index_metrics_trend__up__down__flat ...... [[33mSKIP[0m]
[0m19:36:51.972883 [info ] [Thread-1 (]: 6 of 24 SKIP test dbt_utils_accepted_range_stg_index_metrics_daily_return__0_5___0_5  [[33mSKIP[0m]
[0m19:36:51.973612 [debug] [Thread-2 (]: On model.global_economic_tracker.stg_commodity_returns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_commodity_returns"} */

        CREATE INDEX IF NOT EXISTS idx_returns_ticker_ts ON "airflow"."public"."stg_commodity_returns"(ticker, timestamp)
      
[0m19:36:51.974550 [debug] [Thread-4 (]: SQL status: CREATE INDEX in 0.000 seconds
[0m19:36:51.975160 [debug] [Thread-3 (]: Finished running node test.global_economic_tracker.accepted_values_stg_index_metrics_trend__up__down__flat.1fea418295
[0m19:36:51.975850 [debug] [Thread-1 (]: Finished running node test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_daily_return__0_5___0_5.6e9f33b0a2
[0m19:36:51.976706 [debug] [Thread-2 (]: SQL status: CREATE INDEX in 0.000 seconds
[0m19:36:51.985007 [debug] [Thread-4 (]: On model.global_economic_tracker.stg_index_returns: COMMIT
[0m19:36:51.985601 [debug] [Thread-3 (]: Began running node test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_rolling_avg__0_3___0_3.c2bd8acf6b
[0m19:36:51.985842 [debug] [Thread-7 (]: Marking all children of 'test.global_economic_tracker.accepted_values_stg_index_metrics_trend__up__down__flat.1fea418295' to be skipped because of status 'skipped'. 
[0m19:36:51.986408 [debug] [Thread-1 (]: Began running node test.global_economic_tracker.not_null_stg_index_metrics_daily_return.26f4856193
[0m19:36:51.987601 [debug] [Thread-2 (]: On model.global_economic_tracker.stg_commodity_returns: COMMIT
[0m19:36:51.988285 [debug] [Thread-4 (]: Using postgres connection "model.global_economic_tracker.stg_index_returns"
[0m19:36:51.989008 [info ] [Thread-3 (]: 7 of 24 SKIP test dbt_utils_accepted_range_stg_index_metrics_rolling_avg__0_3___0_3  [[33mSKIP[0m]
[0m19:36:51.989774 [debug] [Thread-7 (]: Marking all children of 'test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_daily_return__0_5___0_5.6e9f33b0a2' to be skipped because of status 'skipped'. 
[0m19:36:51.990596 [info ] [Thread-1 (]: 8 of 24 SKIP test not_null_stg_index_metrics_daily_return ...................... [[33mSKIP[0m]
[0m19:36:51.991314 [debug] [Thread-2 (]: Using postgres connection "model.global_economic_tracker.stg_commodity_returns"
[0m19:36:51.992006 [debug] [Thread-4 (]: On model.global_economic_tracker.stg_index_returns: COMMIT
[0m19:36:51.992722 [debug] [Thread-3 (]: Finished running node test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_rolling_avg__0_3___0_3.c2bd8acf6b
[0m19:36:51.994088 [debug] [Thread-1 (]: Finished running node test.global_economic_tracker.not_null_stg_index_metrics_daily_return.26f4856193
[0m19:36:51.994789 [debug] [Thread-2 (]: On model.global_economic_tracker.stg_commodity_returns: COMMIT
[0m19:36:51.996051 [debug] [Thread-3 (]: Began running node test.global_economic_tracker.not_null_stg_index_metrics_ticker.4b922607c9
[0m19:36:51.996291 [debug] [Thread-7 (]: Marking all children of 'test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_rolling_avg__0_3___0_3.c2bd8acf6b' to be skipped because of status 'skipped'. 
[0m19:36:51.996579 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m19:36:51.996994 [debug] [Thread-1 (]: Began running node test.global_economic_tracker.not_null_stg_index_metrics_timestamp.b1d1abca86
[0m19:36:51.998416 [info ] [Thread-3 (]: 9 of 24 SKIP test not_null_stg_index_metrics_ticker ............................ [[33mSKIP[0m]
[0m19:36:51.998717 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m19:36:51.999305 [debug] [Thread-7 (]: Marking all children of 'test.global_economic_tracker.not_null_stg_index_metrics_daily_return.26f4856193' to be skipped because of status 'skipped'. 
[0m19:36:52.003221 [debug] [Thread-4 (]: Applying DROP to: "airflow"."public"."stg_index_returns__dbt_backup"
[0m19:36:52.003951 [info ] [Thread-1 (]: 10 of 24 SKIP test not_null_stg_index_metrics_timestamp ........................ [[33mSKIP[0m]
[0m19:36:52.004636 [debug] [Thread-3 (]: Finished running node test.global_economic_tracker.not_null_stg_index_metrics_ticker.4b922607c9
[0m19:36:52.006281 [debug] [Thread-2 (]: Applying DROP to: "airflow"."public"."stg_commodity_returns__dbt_backup"
[0m19:36:52.009478 [debug] [Thread-4 (]: Using postgres connection "model.global_economic_tracker.stg_index_returns"
[0m19:36:52.010196 [debug] [Thread-1 (]: Finished running node test.global_economic_tracker.not_null_stg_index_metrics_timestamp.b1d1abca86
[0m19:36:52.010983 [debug] [Thread-3 (]: Began running node test.global_economic_tracker.accepted_values_stg_commodity_metrics_trend__up__down__flat.70479897b5
[0m19:36:52.011218 [debug] [Thread-7 (]: Marking all children of 'test.global_economic_tracker.not_null_stg_index_metrics_ticker.4b922607c9' to be skipped because of status 'skipped'. 
[0m19:36:52.011924 [debug] [Thread-2 (]: Using postgres connection "model.global_economic_tracker.stg_commodity_returns"
[0m19:36:52.012611 [debug] [Thread-4 (]: On model.global_economic_tracker.stg_index_returns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_index_returns"} */
drop table if exists "airflow"."public"."stg_index_returns__dbt_backup" cascade
[0m19:36:52.013312 [debug] [Thread-1 (]: Began running node test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_daily_return__0_5___0_5.2c4246e1e4
[0m19:36:52.014008 [info ] [Thread-3 (]: 11 of 24 SKIP test accepted_values_stg_commodity_metrics_trend__up__down__flat . [[33mSKIP[0m]
[0m19:36:52.014907 [debug] [Thread-7 (]: Marking all children of 'test.global_economic_tracker.not_null_stg_index_metrics_timestamp.b1d1abca86' to be skipped because of status 'skipped'. 
[0m19:36:52.015616 [debug] [Thread-2 (]: On model.global_economic_tracker.stg_commodity_returns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_commodity_returns"} */
drop table if exists "airflow"."public"."stg_commodity_returns__dbt_backup" cascade
[0m19:36:52.016848 [info ] [Thread-1 (]: 12 of 24 SKIP test dbt_utils_accepted_range_stg_commodity_metrics_daily_return__0_5___0_5  [[33mSKIP[0m]
[0m19:36:52.017570 [debug] [Thread-3 (]: Finished running node test.global_economic_tracker.accepted_values_stg_commodity_metrics_trend__up__down__flat.70479897b5
[0m19:36:52.019234 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.003 seconds
[0m19:36:52.019748 [debug] [Thread-1 (]: Finished running node test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_daily_return__0_5___0_5.2c4246e1e4
[0m19:36:52.020543 [debug] [Thread-3 (]: Began running node test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_rolling_avg__0_3___0_3.a261930571
[0m19:36:52.020785 [debug] [Thread-7 (]: Marking all children of 'test.global_economic_tracker.accepted_values_stg_commodity_metrics_trend__up__down__flat.70479897b5' to be skipped because of status 'skipped'. 
[0m19:36:52.021029 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.002 seconds
[0m19:36:52.022568 [debug] [Thread-4 (]: On model.global_economic_tracker.stg_index_returns: Close
[0m19:36:52.023344 [debug] [Thread-1 (]: Began running node test.global_economic_tracker.not_null_stg_commodity_metrics_daily_return.74b14cc336
[0m19:36:52.024048 [info ] [Thread-3 (]: 13 of 24 SKIP test dbt_utils_accepted_range_stg_commodity_metrics_rolling_avg__0_3___0_3  [[33mSKIP[0m]
[0m19:36:52.024695 [debug] [Thread-7 (]: Marking all children of 'test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_daily_return__0_5___0_5.2c4246e1e4' to be skipped because of status 'skipped'. 
[0m19:36:52.025826 [debug] [Thread-2 (]: On model.global_economic_tracker.stg_commodity_returns: Close
[0m19:36:52.026635 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca7de772-1359-4bf8-ba63-fa924cec9ede', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdac4984ca0>]}
[0m19:36:52.027294 [info ] [Thread-1 (]: 14 of 24 SKIP test not_null_stg_commodity_metrics_daily_return ................. [[33mSKIP[0m]
[0m19:36:52.028009 [debug] [Thread-3 (]: Finished running node test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_rolling_avg__0_3___0_3.a261930571
[0m19:36:52.029389 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca7de772-1359-4bf8-ba63-fa924cec9ede', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdabc5ce620>]}
[0m19:36:52.030063 [info ] [Thread-4 (]: 4 of 24 OK created sql table model public.stg_index_returns .................... [[32mSELECT 0[0m in 0.16s]
[0m19:36:52.030786 [debug] [Thread-1 (]: Finished running node test.global_economic_tracker.not_null_stg_commodity_metrics_daily_return.74b14cc336
[0m19:36:52.031707 [debug] [Thread-3 (]: Began running node test.global_economic_tracker.not_null_stg_commodity_metrics_ticker.6d1d8d12d7
[0m19:36:52.031955 [debug] [Thread-7 (]: Marking all children of 'test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_rolling_avg__0_3___0_3.a261930571' to be skipped because of status 'skipped'. 
[0m19:36:52.032623 [info ] [Thread-2 (]: 2 of 24 OK created sql table model public.stg_commodity_returns ................ [[32mSELECT 517[0m in 0.16s]
[0m19:36:52.033389 [debug] [Thread-4 (]: Finished running node model.global_economic_tracker.stg_index_returns
[0m19:36:52.034086 [debug] [Thread-1 (]: Began running node test.global_economic_tracker.not_null_stg_commodity_metrics_timestamp.5651d4b196
[0m19:36:52.034790 [info ] [Thread-3 (]: 15 of 24 SKIP test not_null_stg_commodity_metrics_ticker ....................... [[33mSKIP[0m]
[0m19:36:52.035609 [debug] [Thread-7 (]: Marking all children of 'test.global_economic_tracker.not_null_stg_commodity_metrics_daily_return.74b14cc336' to be skipped because of status 'skipped'. 
[0m19:36:52.036384 [debug] [Thread-2 (]: Finished running node model.global_economic_tracker.stg_commodity_returns
[0m19:36:52.037584 [info ] [Thread-1 (]: 16 of 24 SKIP test not_null_stg_commodity_metrics_timestamp .................... [[33mSKIP[0m]
[0m19:36:52.038307 [debug] [Thread-3 (]: Finished running node test.global_economic_tracker.not_null_stg_commodity_metrics_ticker.6d1d8d12d7
[0m19:36:52.039266 [debug] [Thread-4 (]: Began running node test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713
[0m19:36:52.039872 [debug] [Thread-2 (]: Began running node test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8
[0m19:36:52.040722 [debug] [Thread-1 (]: Finished running node test.global_economic_tracker.not_null_stg_commodity_metrics_timestamp.5651d4b196
[0m19:36:52.041448 [debug] [Thread-3 (]: Began running node test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0
[0m19:36:52.041681 [debug] [Thread-7 (]: Marking all children of 'test.global_economic_tracker.not_null_stg_commodity_metrics_ticker.6d1d8d12d7' to be skipped because of status 'skipped'. 
[0m19:36:52.042358 [info ] [Thread-4 (]: 17 of 24 START test dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5  [RUN]
[0m19:36:52.043161 [info ] [Thread-2 (]: 18 of 24 START test not_null_stg_index_returns_daily_return .................... [RUN]
[0m19:36:52.043980 [debug] [Thread-1 (]: Began running node test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17
[0m19:36:52.044679 [info ] [Thread-3 (]: 19 of 24 START test not_null_stg_index_returns_ticker .......................... [RUN]
[0m19:36:52.045368 [debug] [Thread-7 (]: Marking all children of 'test.global_economic_tracker.not_null_stg_commodity_metrics_timestamp.5651d4b196' to be skipped because of status 'skipped'. 
[0m19:36:52.046120 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.global_economic_tracker.stg_index_returns, now test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713)
[0m19:36:52.046834 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.global_economic_tracker.stg_commodity_returns, now test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8)
[0m19:36:52.047576 [info ] [Thread-1 (]: 20 of 24 START test not_null_stg_index_returns_timestamp ....................... [RUN]
[0m19:36:52.048441 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.global_economic_tracker.stg_index_metrics, now test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0)
[0m19:36:52.049663 [debug] [Thread-4 (]: Began compiling node test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713
[0m19:36:52.050357 [debug] [Thread-2 (]: Began compiling node test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8
[0m19:36:52.051121 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.global_economic_tracker.stg_commodity_metrics, now test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17)
[0m19:36:52.051804 [debug] [Thread-3 (]: Began compiling node test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0
[0m19:36:52.054471 [debug] [Thread-4 (]: Writing injected SQL for node "test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713"
[0m19:36:52.058921 [debug] [Thread-2 (]: Writing injected SQL for node "test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8"
[0m19:36:52.059641 [debug] [Thread-1 (]: Began compiling node test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17
[0m19:36:52.062324 [debug] [Thread-3 (]: Writing injected SQL for node "test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0"
[0m19:36:52.065774 [debug] [Thread-1 (]: Writing injected SQL for node "test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17"
[0m19:36:52.070091 [debug] [Thread-2 (]: Began executing node test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8
[0m19:36:52.070360 [debug] [Thread-4 (]: Began executing node test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713
[0m19:36:52.076223 [debug] [Thread-3 (]: Began executing node test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0
[0m19:36:52.076445 [debug] [Thread-1 (]: Began executing node test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17
[0m19:36:52.078255 [debug] [Thread-2 (]: Writing runtime sql for node "test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8"
[0m19:36:52.079726 [debug] [Thread-4 (]: Writing runtime sql for node "test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713"
[0m19:36:52.081432 [debug] [Thread-3 (]: Writing runtime sql for node "test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0"
[0m19:36:52.083015 [debug] [Thread-1 (]: Writing runtime sql for node "test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17"
[0m19:36:52.087941 [debug] [Thread-2 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8"
[0m19:36:52.088539 [debug] [Thread-3 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0"
[0m19:36:52.089138 [debug] [Thread-2 (]: On test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8: BEGIN
[0m19:36:52.089458 [debug] [Thread-4 (]: Using postgres connection "test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713"
[0m19:36:52.090129 [debug] [Thread-3 (]: On test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0: BEGIN
[0m19:36:52.090388 [debug] [Thread-1 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17"
[0m19:36:52.090958 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:36:52.091658 [debug] [Thread-4 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713: BEGIN
[0m19:36:52.092379 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:36:52.093083 [debug] [Thread-1 (]: On test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17: BEGIN
[0m19:36:52.094368 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:36:52.095067 [debug] [Thread-2 (]: SQL status: BEGIN in 0.004 seconds
[0m19:36:52.095891 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:36:52.096579 [debug] [Thread-3 (]: SQL status: BEGIN in 0.004 seconds
[0m19:36:52.097429 [debug] [Thread-2 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8"
[0m19:36:52.098568 [debug] [Thread-4 (]: SQL status: BEGIN in 0.004 seconds
[0m19:36:52.098955 [debug] [Thread-3 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0"
[0m19:36:52.099426 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m19:36:52.099805 [debug] [Thread-2 (]: On test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select daily_return
from "airflow"."public"."stg_index_returns"
where daily_return is null



      
    ) dbt_internal_test
[0m19:36:52.100617 [debug] [Thread-4 (]: Using postgres connection "test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713"
[0m19:36:52.101390 [debug] [Thread-3 (]: On test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select ticker
from "airflow"."public"."stg_index_returns"
where ticker is null



      
    ) dbt_internal_test
[0m19:36:52.102096 [debug] [Thread-1 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17"
[0m19:36:52.103131 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.000 seconds
[0m19:36:52.103517 [debug] [Thread-4 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with meet_condition as(
  select *
  from "airflow"."public"."stg_index_returns"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not daily_return >= -0.5
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not daily_return <= 0.5
)

select *
from validation_errors


      
    ) dbt_internal_test
[0m19:36:52.104531 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.000 seconds
[0m19:36:52.104910 [debug] [Thread-1 (]: On test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select timestamp
from "airflow"."public"."stg_index_returns"
where timestamp is null



      
    ) dbt_internal_test
[0m19:36:52.106997 [debug] [Thread-2 (]: On test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8: ROLLBACK
[0m19:36:52.108768 [debug] [Thread-3 (]: On test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0: ROLLBACK
[0m19:36:52.109022 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m19:36:52.109871 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.000 seconds
[0m19:36:52.110372 [debug] [Thread-2 (]: On test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8: Close
[0m19:36:52.111056 [debug] [Thread-3 (]: On test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0: Close
[0m19:36:52.112114 [debug] [Thread-4 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713: ROLLBACK
[0m19:36:52.113232 [debug] [Thread-1 (]: On test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17: ROLLBACK
[0m19:36:52.114107 [info ] [Thread-2 (]: 18 of 24 PASS not_null_stg_index_returns_daily_return .......................... [[32mPASS[0m in 0.07s]
[0m19:36:52.114804 [info ] [Thread-3 (]: 19 of 24 PASS not_null_stg_index_returns_ticker ................................ [[32mPASS[0m in 0.07s]
[0m19:36:52.115475 [debug] [Thread-4 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713: Close
[0m19:36:52.116116 [debug] [Thread-1 (]: On test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17: Close
[0m19:36:52.116754 [debug] [Thread-2 (]: Finished running node test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8
[0m19:36:52.117546 [debug] [Thread-3 (]: Finished running node test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0
[0m19:36:52.118385 [info ] [Thread-4 (]: 17 of 24 PASS dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5  [[32mPASS[0m in 0.07s]
[0m19:36:52.119063 [info ] [Thread-1 (]: 20 of 24 PASS not_null_stg_index_returns_timestamp ............................. [[32mPASS[0m in 0.07s]
[0m19:36:52.119643 [debug] [Thread-2 (]: Began running node test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe
[0m19:36:52.120442 [debug] [Thread-3 (]: Began running node test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934
[0m19:36:52.121381 [debug] [Thread-4 (]: Finished running node test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713
[0m19:36:52.122272 [debug] [Thread-1 (]: Finished running node test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17
[0m19:36:52.123047 [info ] [Thread-2 (]: 21 of 24 START test dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5  [RUN]
[0m19:36:52.123802 [info ] [Thread-3 (]: 22 of 24 START test not_null_stg_commodity_returns_daily_return ................ [RUN]
[0m19:36:52.124534 [debug] [Thread-4 (]: Began running node test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d
[0m19:36:52.125295 [debug] [Thread-1 (]: Began running node test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359
[0m19:36:52.126068 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8, now test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe)
[0m19:36:52.126821 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0, now test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934)
[0m19:36:52.127543 [info ] [Thread-4 (]: 23 of 24 START test not_null_stg_commodity_returns_ticker ...................... [RUN]
[0m19:36:52.128252 [info ] [Thread-1 (]: 24 of 24 START test not_null_stg_commodity_returns_timestamp ................... [RUN]
[0m19:36:52.128934 [debug] [Thread-2 (]: Began compiling node test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe
[0m19:36:52.129631 [debug] [Thread-3 (]: Began compiling node test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934
[0m19:36:52.130517 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713, now test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d)
[0m19:36:52.131248 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17, now test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359)
[0m19:36:52.133876 [debug] [Thread-2 (]: Writing injected SQL for node "test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe"
[0m19:36:52.136550 [debug] [Thread-3 (]: Writing injected SQL for node "test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934"
[0m19:36:52.137267 [debug] [Thread-4 (]: Began compiling node test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d
[0m19:36:52.137978 [debug] [Thread-1 (]: Began compiling node test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359
[0m19:36:52.142133 [debug] [Thread-4 (]: Writing injected SQL for node "test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d"
[0m19:36:52.144461 [debug] [Thread-1 (]: Writing injected SQL for node "test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359"
[0m19:36:52.145999 [debug] [Thread-2 (]: Began executing node test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe
[0m19:36:52.146561 [debug] [Thread-3 (]: Began executing node test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934
[0m19:36:52.148114 [debug] [Thread-2 (]: Writing runtime sql for node "test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe"
[0m19:36:52.148365 [debug] [Thread-4 (]: Began executing node test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d
[0m19:36:52.149866 [debug] [Thread-3 (]: Writing runtime sql for node "test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934"
[0m19:36:52.151122 [debug] [Thread-1 (]: Began executing node test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359
[0m19:36:52.152410 [debug] [Thread-4 (]: Writing runtime sql for node "test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d"
[0m19:36:52.154619 [debug] [Thread-1 (]: Writing runtime sql for node "test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359"
[0m19:36:52.156966 [debug] [Thread-2 (]: Using postgres connection "test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe"
[0m19:36:52.157777 [debug] [Thread-3 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934"
[0m19:36:52.158242 [debug] [Thread-2 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe: BEGIN
[0m19:36:52.158565 [debug] [Thread-4 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d"
[0m19:36:52.158968 [debug] [Thread-1 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359"
[0m19:36:52.159357 [debug] [Thread-3 (]: On test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934: BEGIN
[0m19:36:52.160069 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:36:52.160821 [debug] [Thread-4 (]: On test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d: BEGIN
[0m19:36:52.161513 [debug] [Thread-1 (]: On test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359: BEGIN
[0m19:36:52.162251 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:36:52.163526 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:36:52.164241 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:36:52.164497 [debug] [Thread-2 (]: SQL status: BEGIN in 0.004 seconds
[0m19:36:52.166570 [debug] [Thread-3 (]: SQL status: BEGIN in 0.004 seconds
[0m19:36:52.167132 [debug] [Thread-2 (]: Using postgres connection "test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe"
[0m19:36:52.167468 [debug] [Thread-4 (]: SQL status: BEGIN in 0.004 seconds
[0m19:36:52.168225 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m19:36:52.168460 [debug] [Thread-3 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934"
[0m19:36:52.169215 [debug] [Thread-2 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with meet_condition as(
  select *
  from "airflow"."public"."stg_commodity_returns"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not daily_return >= -0.5
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not daily_return <= 0.5
)

select *
from validation_errors


      
    ) dbt_internal_test
[0m19:36:52.169932 [debug] [Thread-4 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d"
[0m19:36:52.170665 [debug] [Thread-1 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359"
[0m19:36:52.171366 [debug] [Thread-3 (]: On test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select daily_return
from "airflow"."public"."stg_commodity_returns"
where daily_return is null



      
    ) dbt_internal_test
[0m19:36:52.172625 [debug] [Thread-4 (]: On test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select ticker
from "airflow"."public"."stg_commodity_returns"
where ticker is null



      
    ) dbt_internal_test
[0m19:36:52.172868 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m19:36:52.173602 [debug] [Thread-1 (]: On test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select timestamp
from "airflow"."public"."stg_commodity_returns"
where timestamp is null



      
    ) dbt_internal_test
[0m19:36:52.174703 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.000 seconds
[0m19:36:52.175381 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.000 seconds
[0m19:36:52.176314 [debug] [Thread-2 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe: ROLLBACK
[0m19:36:52.177451 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.000 seconds
[0m19:36:52.178115 [debug] [Thread-3 (]: On test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934: ROLLBACK
[0m19:36:52.179219 [debug] [Thread-4 (]: On test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d: ROLLBACK
[0m19:36:52.180017 [debug] [Thread-2 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe: Close
[0m19:36:52.180994 [debug] [Thread-1 (]: On test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359: ROLLBACK
[0m19:36:52.181806 [debug] [Thread-3 (]: On test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934: Close
[0m19:36:52.182435 [debug] [Thread-4 (]: On test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d: Close
[0m19:36:52.183120 [info ] [Thread-2 (]: 21 of 24 PASS dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5  [[32mPASS[0m in 0.06s]
[0m19:36:52.183798 [debug] [Thread-1 (]: On test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359: Close
[0m19:36:52.184498 [error] [Thread-3 (]: 22 of 24 FAIL 7 not_null_stg_commodity_returns_daily_return .................... [[31mFAIL 7[0m in 0.06s]
[0m19:36:52.185270 [info ] [Thread-4 (]: 23 of 24 PASS not_null_stg_commodity_returns_ticker ............................ [[32mPASS[0m in 0.05s]
[0m19:36:52.185887 [debug] [Thread-2 (]: Finished running node test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe
[0m19:36:52.186670 [info ] [Thread-1 (]: 24 of 24 PASS not_null_stg_commodity_returns_timestamp ......................... [[32mPASS[0m in 0.06s]
[0m19:36:52.187237 [debug] [Thread-3 (]: Finished running node test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934
[0m19:36:52.188176 [debug] [Thread-4 (]: Finished running node test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d
[0m19:36:52.189539 [debug] [Thread-1 (]: Finished running node test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359
[0m19:36:52.190391 [debug] [Thread-7 (]: Marking all children of 'test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934' to be skipped because of status 'fail'.  Reason: Got 7 results, configured to fail if != 0.
[0m19:36:52.193267 [debug] [MainThread]: Using postgres connection "master"
[0m19:36:52.193912 [debug] [MainThread]: On master: BEGIN
[0m19:36:52.194558 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:36:52.196432 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m19:36:52.197077 [debug] [MainThread]: On master: COMMIT
[0m19:36:52.197716 [debug] [MainThread]: Using postgres connection "master"
[0m19:36:52.198346 [debug] [MainThread]: On master: COMMIT
[0m19:36:52.199072 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:36:52.199711 [debug] [MainThread]: On master: Close
[0m19:36:52.200450 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:36:52.201124 [debug] [MainThread]: Connection 'test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359' was properly closed.
[0m19:36:52.201744 [debug] [MainThread]: Connection 'test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe' was properly closed.
[0m19:36:52.202366 [debug] [MainThread]: Connection 'test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934' was properly closed.
[0m19:36:52.203029 [debug] [MainThread]: Connection 'test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d' was properly closed.
[0m19:36:52.203708 [info ] [MainThread]: 
[0m19:36:52.204508 [info ] [MainThread]: Finished running 4 table models, 20 data tests in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m19:36:52.206075 [debug] [MainThread]: Command end result
[0m19:36:52.233944 [debug] [MainThread]: Wrote artifact WritableManifest to /mnt/c/Users/joeyk/PycharmProjects/GlobalEconomicTracker/global_economic_tracker/target/manifest.json
[0m19:36:52.237507 [debug] [MainThread]: Wrote artifact SemanticManifest to /mnt/c/Users/joeyk/PycharmProjects/GlobalEconomicTracker/global_economic_tracker/target/semantic_manifest.json
[0m19:36:52.244101 [debug] [MainThread]: Wrote artifact RunExecutionResult to /mnt/c/Users/joeyk/PycharmProjects/GlobalEconomicTracker/global_economic_tracker/target/run_results.json
[0m19:36:52.244747 [info ] [MainThread]: 
[0m19:36:52.245544 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m19:36:52.246233 [info ] [MainThread]: 
[0m19:36:52.246936 [error] [MainThread]:   Database Error in model stg_index_metrics (models/analytics/stg_index_metrics.sql)
  column "daily_return" does not exist
  LINE 25:         avg(daily_return) over (
                       ^
  compiled code at target/run/global_economic_tracker/models/analytics/stg_index_metrics.sql
[0m19:36:52.247643 [info ] [MainThread]: 
[0m19:36:52.248412 [error] [MainThread]:   Database Error in model stg_commodity_metrics (models/analytics/stg_commodity_metrics.sql)
  column "daily_return" does not exist
  LINE 25:         avg(daily_return) over (
                       ^
  compiled code at target/run/global_economic_tracker/models/analytics/stg_commodity_metrics.sql
[0m19:36:52.249079 [info ] [MainThread]: 
[0m19:36:52.249897 [error] [MainThread]: [31mFailure in test not_null_stg_commodity_returns_daily_return (models/staging/schema.yml)[0m
[0m19:36:52.250655 [error] [MainThread]:   Got 7 results, configured to fail if != 0
[0m19:36:52.251316 [info ] [MainThread]: 
[0m19:36:52.252022 [info ] [MainThread]:   compiled code at target/compiled/global_economic_tracker/models/staging/schema.yml/not_null_stg_commodity_returns_daily_return.sql
[0m19:36:52.252707 [info ] [MainThread]: 
[0m19:36:52.253401 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=3 SKIP=12 TOTAL=24
[0m19:36:52.254528 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 1.7967942, "process_in_blocks": "0", "process_kernel_time": 0.187989, "process_mem_max_rss": "127136", "process_out_blocks": "0", "process_user_time": 1.28624}
[0m19:36:52.255308 [debug] [MainThread]: Command `dbt build` failed at 19:36:52.255235 after 1.80 seconds
[0m19:36:52.256000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdac2f95a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdac27ba5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdac2760580>]}
[0m19:36:52.256675 [debug] [MainThread]: Flushing usage events
[0m19:36:53.013999 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:40:37.320606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46a450dab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46a3cf4dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46a43f07f0>]}


============================== 19:40:37.322405 | 8189e253-54d3-44fa-8fe1-07bc80aa1654 ==============================
[0m19:40:37.322405 [info ] [MainThread]: Running with dbt=1.9.4
[0m19:40:37.323239 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/joey/.dbt', 'log_path': '/mnt/c/Users/joeyk/PycharmProjects/GlobalEconomicTracker/global_economic_tracker/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt build', 'send_anonymous_usage_stats': 'True'}
[0m19:40:37.407641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8189e253-54d3-44fa-8fe1-07bc80aa1654', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46a5cae410>]}
[0m19:40:37.437734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8189e253-54d3-44fa-8fe1-07bc80aa1654', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46a3d17040>]}
[0m19:40:37.438655 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m19:40:37.479627 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m19:40:38.294689 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m19:40:38.295675 [debug] [MainThread]: Partial parsing: updated file: global_economic_tracker://models/analytics/stg_index_metrics.sql
[0m19:40:38.296514 [debug] [MainThread]: Partial parsing: updated file: global_economic_tracker://models/analytics/stg_commodity_metrics.sql
[0m19:40:38.558130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8189e253-54d3-44fa-8fe1-07bc80aa1654', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46a1d4c220>]}
[0m19:40:38.611490 [debug] [MainThread]: Wrote artifact WritableManifest to /mnt/c/Users/joeyk/PycharmProjects/GlobalEconomicTracker/global_economic_tracker/target/manifest.json
[0m19:40:38.615423 [debug] [MainThread]: Wrote artifact SemanticManifest to /mnt/c/Users/joeyk/PycharmProjects/GlobalEconomicTracker/global_economic_tracker/target/semantic_manifest.json
[0m19:40:38.631699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8189e253-54d3-44fa-8fe1-07bc80aa1654', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46a2d83580>]}
[0m19:40:38.632422 [info ] [MainThread]: Found 4 models, 20 data tests, 549 macros
[0m19:40:38.634311 [info ] [MainThread]: 
[0m19:40:38.635190 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:40:38.635903 [info ] [MainThread]: 
[0m19:40:38.636742 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:40:38.639738 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m19:40:38.652036 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m19:40:38.652690 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m19:40:38.653347 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:40:38.656230 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.003 seconds
[0m19:40:38.657352 [debug] [ThreadPool]: On list_airflow: Close
[0m19:40:38.658761 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_public)
[0m19:40:38.662016 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m19:40:38.662825 [debug] [ThreadPool]: On list_airflow_public: BEGIN
[0m19:40:38.663538 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:40:38.665446 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m19:40:38.666085 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m19:40:38.666734 [debug] [ThreadPool]: On list_airflow_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:40:38.668511 [debug] [ThreadPool]: SQL status: SELECT 47 in 0.001 seconds
[0m19:40:38.669900 [debug] [ThreadPool]: On list_airflow_public: ROLLBACK
[0m19:40:38.670752 [debug] [ThreadPool]: On list_airflow_public: Close
[0m19:40:38.675690 [debug] [MainThread]: Using postgres connection "master"
[0m19:40:38.676384 [debug] [MainThread]: On master: BEGIN
[0m19:40:38.677117 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:40:38.678993 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m19:40:38.679638 [debug] [MainThread]: Using postgres connection "master"
[0m19:40:38.680309 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:40:38.682549 [debug] [MainThread]: SQL status: SELECT 0 in 0.001 seconds
[0m19:40:38.683858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8189e253-54d3-44fa-8fe1-07bc80aa1654', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46a15fde70>]}
[0m19:40:38.684564 [debug] [MainThread]: On master: ROLLBACK
[0m19:40:38.685360 [debug] [MainThread]: Using postgres connection "master"
[0m19:40:38.686160 [debug] [MainThread]: On master: BEGIN
[0m19:40:38.687073 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m19:40:38.687719 [debug] [MainThread]: On master: COMMIT
[0m19:40:38.688337 [debug] [MainThread]: Using postgres connection "master"
[0m19:40:38.688974 [debug] [MainThread]: On master: COMMIT
[0m19:40:38.689689 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:40:38.690339 [debug] [MainThread]: On master: Close
[0m19:40:38.693669 [debug] [Thread-1 (]: Began running node model.global_economic_tracker.stg_commodity_returns
[0m19:40:38.693936 [debug] [Thread-2 (]: Began running node model.global_economic_tracker.stg_index_returns
[0m19:40:38.694588 [info ] [Thread-1 (]: 1 of 24 START sql table model public.stg_commodity_returns ..................... [RUN]
[0m19:40:38.695336 [info ] [Thread-2 (]: 2 of 24 START sql table model public.stg_index_returns ......................... [RUN]
[0m19:40:38.696042 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_public, now model.global_economic_tracker.stg_commodity_returns)
[0m19:40:38.696878 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.global_economic_tracker.stg_index_returns'
[0m19:40:38.697615 [debug] [Thread-1 (]: Began compiling node model.global_economic_tracker.stg_commodity_returns
[0m19:40:38.698392 [debug] [Thread-2 (]: Began compiling node model.global_economic_tracker.stg_index_returns
[0m19:40:38.702562 [debug] [Thread-1 (]: Writing injected SQL for node "model.global_economic_tracker.stg_commodity_returns"
[0m19:40:38.704439 [debug] [Thread-2 (]: Writing injected SQL for node "model.global_economic_tracker.stg_index_returns"
[0m19:40:38.708503 [debug] [Thread-1 (]: Began executing node model.global_economic_tracker.stg_commodity_returns
[0m19:40:38.714848 [debug] [Thread-2 (]: Began executing node model.global_economic_tracker.stg_index_returns
[0m19:40:38.727588 [debug] [Thread-1 (]: Writing runtime sql for node "model.global_economic_tracker.stg_commodity_returns"
[0m19:40:38.729642 [debug] [Thread-2 (]: Writing runtime sql for node "model.global_economic_tracker.stg_index_returns"
[0m19:40:38.734006 [debug] [Thread-1 (]: Using postgres connection "model.global_economic_tracker.stg_commodity_returns"
[0m19:40:38.734723 [debug] [Thread-1 (]: On model.global_economic_tracker.stg_commodity_returns: BEGIN
[0m19:40:38.735176 [debug] [Thread-2 (]: Using postgres connection "model.global_economic_tracker.stg_index_returns"
[0m19:40:38.735554 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:40:38.736252 [debug] [Thread-2 (]: On model.global_economic_tracker.stg_index_returns: BEGIN
[0m19:40:38.737480 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:40:38.738228 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m19:40:38.738892 [debug] [Thread-1 (]: Using postgres connection "model.global_economic_tracker.stg_commodity_returns"
[0m19:40:38.739390 [debug] [Thread-2 (]: SQL status: BEGIN in 0.002 seconds
[0m19:40:38.739778 [debug] [Thread-1 (]: On model.global_economic_tracker.stg_commodity_returns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_commodity_returns"} */

  
    

  create  table "airflow"."public"."stg_commodity_returns__dbt_tmp"
  
  
    as
  
  (
    

select
    'commodity' as type,
    ticker,
    timestamp,
    price,
    lag(price) over (partition by ticker order by timestamp) as prev_price,
    (price - lag(price) over (partition by ticker order by timestamp)) / lag(price) over (partition by ticker order by timestamp) as daily_return
from public.commodity_prices
  );
  
[0m19:40:38.740525 [debug] [Thread-2 (]: Using postgres connection "model.global_economic_tracker.stg_index_returns"
[0m19:40:38.741779 [debug] [Thread-2 (]: On model.global_economic_tracker.stg_index_returns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_index_returns"} */

  
    

  create  table "airflow"."public"."stg_index_returns__dbt_tmp"
  
  
    as
  
  (
    

select
    'index' as type,
    country,
    ticker,
    timestamp,
    price,
    lag(price) over (partition by ticker order by timestamp) as prev_price,
    (price - lag(price) over (partition by ticker order by timestamp)) / lag(price) over (partition by ticker order by timestamp) as daily_return
from public.index_prices
  );
  
[0m19:40:38.745808 [debug] [Thread-1 (]: SQL status: SELECT 517 in 0.005 seconds
[0m19:40:38.750939 [debug] [Thread-1 (]: Using postgres connection "model.global_economic_tracker.stg_commodity_returns"
[0m19:40:38.751170 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.009 seconds
[0m19:40:38.751712 [debug] [Thread-1 (]: On model.global_economic_tracker.stg_commodity_returns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_commodity_returns"} */
alter table "airflow"."public"."stg_commodity_returns" rename to "stg_commodity_returns__dbt_backup"
[0m19:40:38.754003 [debug] [Thread-2 (]: Using postgres connection "model.global_economic_tracker.stg_index_returns"
[0m19:40:38.755185 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:40:38.755719 [debug] [Thread-2 (]: On model.global_economic_tracker.stg_index_returns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_index_returns"} */
alter table "airflow"."public"."stg_index_returns" rename to "stg_index_returns__dbt_backup"
[0m19:40:38.757707 [debug] [Thread-1 (]: Using postgres connection "model.global_economic_tracker.stg_commodity_returns"
[0m19:40:38.758921 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:40:38.759453 [debug] [Thread-1 (]: On model.global_economic_tracker.stg_commodity_returns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_commodity_returns"} */
alter table "airflow"."public"."stg_commodity_returns__dbt_tmp" rename to "stg_commodity_returns"
[0m19:40:38.761857 [debug] [Thread-2 (]: Using postgres connection "model.global_economic_tracker.stg_index_returns"
[0m19:40:38.762790 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:40:38.763336 [debug] [Thread-2 (]: On model.global_economic_tracker.stg_index_returns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_index_returns"} */
alter table "airflow"."public"."stg_index_returns__dbt_tmp" rename to "stg_index_returns"
[0m19:40:38.764696 [debug] [Thread-1 (]: Using postgres connection "model.global_economic_tracker.stg_commodity_returns"
[0m19:40:38.765553 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:40:38.766074 [debug] [Thread-1 (]: On model.global_economic_tracker.stg_commodity_returns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_commodity_returns"} */

        CREATE INDEX IF NOT EXISTS idx_returns_ticker_ts ON "airflow"."public"."stg_commodity_returns"(ticker, timestamp)
      
[0m19:40:38.767521 [debug] [Thread-2 (]: Using postgres connection "model.global_economic_tracker.stg_index_returns"
[0m19:40:38.768885 [debug] [Thread-2 (]: On model.global_economic_tracker.stg_index_returns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_index_returns"} */

        CREATE INDEX IF NOT EXISTS idx_index_returns_ticker_ts ON "airflow"."public"."stg_index_returns"(ticker, timestamp)
      
[0m19:40:38.770942 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.003 seconds
[0m19:40:38.777737 [debug] [Thread-2 (]: SQL status: CREATE INDEX in 0.008 seconds
[0m19:40:38.779312 [debug] [Thread-1 (]: On model.global_economic_tracker.stg_commodity_returns: COMMIT
[0m19:40:38.780367 [debug] [Thread-2 (]: On model.global_economic_tracker.stg_index_returns: COMMIT
[0m19:40:38.781288 [debug] [Thread-1 (]: Using postgres connection "model.global_economic_tracker.stg_commodity_returns"
[0m19:40:38.782010 [debug] [Thread-2 (]: Using postgres connection "model.global_economic_tracker.stg_index_returns"
[0m19:40:38.782730 [debug] [Thread-1 (]: On model.global_economic_tracker.stg_commodity_returns: COMMIT
[0m19:40:38.783437 [debug] [Thread-2 (]: On model.global_economic_tracker.stg_index_returns: COMMIT
[0m19:40:38.786676 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m19:40:38.790200 [debug] [Thread-1 (]: Applying DROP to: "airflow"."public"."stg_commodity_returns__dbt_backup"
[0m19:40:38.790474 [debug] [Thread-2 (]: SQL status: COMMIT in 0.006 seconds
[0m19:40:38.793170 [debug] [Thread-1 (]: Using postgres connection "model.global_economic_tracker.stg_commodity_returns"
[0m19:40:38.795030 [debug] [Thread-2 (]: Applying DROP to: "airflow"."public"."stg_index_returns__dbt_backup"
[0m19:40:38.795764 [debug] [Thread-1 (]: On model.global_economic_tracker.stg_commodity_returns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_commodity_returns"} */
drop table if exists "airflow"."public"."stg_commodity_returns__dbt_backup" cascade
[0m19:40:38.796697 [debug] [Thread-2 (]: Using postgres connection "model.global_economic_tracker.stg_index_returns"
[0m19:40:38.798020 [debug] [Thread-2 (]: On model.global_economic_tracker.stg_index_returns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_index_returns"} */
drop table if exists "airflow"."public"."stg_index_returns__dbt_backup" cascade
[0m19:40:38.800119 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m19:40:38.801934 [debug] [Thread-1 (]: On model.global_economic_tracker.stg_commodity_returns: Close
[0m19:40:38.802167 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.004 seconds
[0m19:40:38.803561 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8189e253-54d3-44fa-8fe1-07bc80aa1654', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4682425fc0>]}
[0m19:40:38.804388 [debug] [Thread-2 (]: On model.global_economic_tracker.stg_index_returns: Close
[0m19:40:38.805236 [info ] [Thread-1 (]: 1 of 24 OK created sql table model public.stg_commodity_returns ................ [[32mSELECT 517[0m in 0.11s]
[0m19:40:38.806110 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8189e253-54d3-44fa-8fe1-07bc80aa1654', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46824246d0>]}
[0m19:40:38.806747 [debug] [Thread-1 (]: Finished running node model.global_economic_tracker.stg_commodity_returns
[0m19:40:38.807588 [info ] [Thread-2 (]: 2 of 24 OK created sql table model public.stg_index_returns .................... [[32mSELECT 0[0m in 0.11s]
[0m19:40:38.808800 [debug] [Thread-4 (]: Began running node test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe
[0m19:40:38.809050 [debug] [Thread-3 (]: Began running node test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934
[0m19:40:38.809315 [debug] [Thread-1 (]: Began running node test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d
[0m19:40:38.809624 [debug] [Thread-2 (]: Finished running node model.global_economic_tracker.stg_index_returns
[0m19:40:38.810349 [info ] [Thread-4 (]: 3 of 24 START test dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5  [RUN]
[0m19:40:38.811121 [info ] [Thread-3 (]: 4 of 24 START test not_null_stg_commodity_returns_daily_return ................. [RUN]
[0m19:40:38.811829 [info ] [Thread-1 (]: 5 of 24 START test not_null_stg_commodity_returns_ticker ....................... [RUN]
[0m19:40:38.812552 [debug] [Thread-2 (]: Began running node test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359
[0m19:40:38.813404 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe'
[0m19:40:38.814309 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934'
[0m19:40:38.815039 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.global_economic_tracker.stg_commodity_returns, now test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d)
[0m19:40:38.815759 [info ] [Thread-2 (]: 6 of 24 START test not_null_stg_commodity_returns_timestamp .................... [RUN]
[0m19:40:38.816441 [debug] [Thread-4 (]: Began compiling node test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe
[0m19:40:38.817143 [debug] [Thread-3 (]: Began compiling node test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934
[0m19:40:38.817965 [debug] [Thread-1 (]: Began compiling node test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d
[0m19:40:38.818873 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.global_economic_tracker.stg_index_returns, now test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359)
[0m19:40:38.821722 [debug] [Thread-4 (]: Writing injected SQL for node "test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe"
[0m19:40:38.826963 [debug] [Thread-3 (]: Writing injected SQL for node "test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934"
[0m19:40:38.829356 [debug] [Thread-1 (]: Writing injected SQL for node "test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d"
[0m19:40:38.830408 [debug] [Thread-2 (]: Began compiling node test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359
[0m19:40:38.834633 [debug] [Thread-2 (]: Writing injected SQL for node "test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359"
[0m19:40:38.838870 [debug] [Thread-1 (]: Began executing node test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d
[0m19:40:38.839411 [debug] [Thread-3 (]: Began executing node test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934
[0m19:40:38.839955 [debug] [Thread-4 (]: Began executing node test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe
[0m19:40:38.846958 [debug] [Thread-2 (]: Began executing node test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359
[0m19:40:38.849823 [debug] [Thread-1 (]: Writing runtime sql for node "test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d"
[0m19:40:38.851829 [debug] [Thread-3 (]: Writing runtime sql for node "test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934"
[0m19:40:38.853622 [debug] [Thread-4 (]: Writing runtime sql for node "test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe"
[0m19:40:38.855535 [debug] [Thread-2 (]: Writing runtime sql for node "test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359"
[0m19:40:38.860538 [debug] [Thread-2 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359"
[0m19:40:38.860841 [debug] [Thread-4 (]: Using postgres connection "test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe"
[0m19:40:38.861485 [debug] [Thread-2 (]: On test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359: BEGIN
[0m19:40:38.861790 [debug] [Thread-3 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934"
[0m19:40:38.862348 [debug] [Thread-4 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe: BEGIN
[0m19:40:38.862623 [debug] [Thread-1 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d"
[0m19:40:38.863150 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:40:38.863854 [debug] [Thread-3 (]: On test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934: BEGIN
[0m19:40:38.864562 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:40:38.865262 [debug] [Thread-1 (]: On test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d: BEGIN
[0m19:40:38.866588 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:40:38.867312 [debug] [Thread-2 (]: SQL status: BEGIN in 0.004 seconds
[0m19:40:38.868146 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:40:38.869322 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m19:40:38.869729 [debug] [Thread-2 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359"
[0m19:40:38.870544 [debug] [Thread-3 (]: SQL status: BEGIN in 0.004 seconds
[0m19:40:38.871273 [debug] [Thread-4 (]: Using postgres connection "test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe"
[0m19:40:38.872001 [debug] [Thread-2 (]: On test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select timestamp
from "airflow"."public"."stg_commodity_returns"
where timestamp is null



      
    ) dbt_internal_test
[0m19:40:38.872485 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m19:40:38.872872 [debug] [Thread-3 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934"
[0m19:40:38.873594 [debug] [Thread-4 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with meet_condition as(
  select *
  from "airflow"."public"."stg_commodity_returns"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not daily_return >= -0.5
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not daily_return <= 0.5
)

select *
from validation_errors


      
    ) dbt_internal_test
[0m19:40:38.874694 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.000 seconds
[0m19:40:38.875078 [debug] [Thread-1 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d"
[0m19:40:38.875783 [debug] [Thread-3 (]: On test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select daily_return
from "airflow"."public"."stg_commodity_returns"
where daily_return is null



      
    ) dbt_internal_test
[0m19:40:38.878397 [debug] [Thread-2 (]: On test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359: ROLLBACK
[0m19:40:38.878655 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m19:40:38.879191 [debug] [Thread-1 (]: On test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select ticker
from "airflow"."public"."stg_commodity_returns"
where ticker is null



      
    ) dbt_internal_test
[0m19:40:38.880399 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.000 seconds
[0m19:40:38.880759 [debug] [Thread-2 (]: On test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359: Close
[0m19:40:38.881779 [debug] [Thread-4 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe: ROLLBACK
[0m19:40:38.882934 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.000 seconds
[0m19:40:38.883570 [debug] [Thread-3 (]: On test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934: ROLLBACK
[0m19:40:38.884382 [info ] [Thread-2 (]: 6 of 24 PASS not_null_stg_commodity_returns_timestamp .......................... [[32mPASS[0m in 0.07s]
[0m19:40:38.885025 [debug] [Thread-4 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe: Close
[0m19:40:38.885982 [debug] [Thread-1 (]: On test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d: ROLLBACK
[0m19:40:38.886783 [debug] [Thread-3 (]: On test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934: Close
[0m19:40:38.887406 [debug] [Thread-2 (]: Finished running node test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359
[0m19:40:38.888265 [info ] [Thread-4 (]: 3 of 24 PASS dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5  [[32mPASS[0m in 0.07s]
[0m19:40:38.888933 [debug] [Thread-1 (]: On test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d: Close
[0m19:40:38.889623 [error] [Thread-3 (]: 4 of 24 FAIL 7 not_null_stg_commodity_returns_daily_return ..................... [[31mFAIL 7[0m in 0.08s]
[0m19:40:38.890204 [debug] [Thread-2 (]: Began running node test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713
[0m19:40:38.891024 [debug] [Thread-4 (]: Finished running node test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe
[0m19:40:38.891959 [info ] [Thread-1 (]: 5 of 24 PASS not_null_stg_commodity_returns_ticker ............................. [[32mPASS[0m in 0.08s]
[0m19:40:38.892585 [debug] [Thread-3 (]: Finished running node test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934
[0m19:40:38.893312 [info ] [Thread-2 (]: 7 of 24 START test dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5  [RUN]
[0m19:40:38.893986 [debug] [Thread-4 (]: Began running node test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8
[0m19:40:38.894790 [debug] [Thread-1 (]: Finished running node test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d
[0m19:40:38.895534 [debug] [Thread-3 (]: Began running node test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0
[0m19:40:38.895847 [debug] [Thread-7 (]: Marking all children of 'test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934' to be skipped because of status 'fail'.  Reason: Got 7 results, configured to fail if != 0.
[0m19:40:38.896470 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359, now test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713)
[0m19:40:38.897189 [info ] [Thread-4 (]: 8 of 24 START test not_null_stg_index_returns_daily_return ..................... [RUN]
[0m19:40:38.897889 [debug] [Thread-1 (]: Began running node test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17
[0m19:40:38.898596 [info ] [Thread-3 (]: 9 of 24 START test not_null_stg_index_returns_ticker ........................... [RUN]
[0m19:40:38.899980 [debug] [Thread-2 (]: Began compiling node test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713
[0m19:40:38.900850 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe, now test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8)
[0m19:40:38.901527 [info ] [Thread-1 (]: 10 of 24 START test not_null_stg_index_returns_timestamp ....................... [RUN]
[0m19:40:38.902247 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934, now test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0)
[0m19:40:38.904869 [debug] [Thread-2 (]: Writing injected SQL for node "test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713"
[0m19:40:38.905618 [debug] [Thread-4 (]: Began compiling node test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8
[0m19:40:38.906360 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d, now test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17)
[0m19:40:38.907062 [debug] [Thread-3 (]: Began compiling node test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0
[0m19:40:38.910137 [debug] [Thread-4 (]: Writing injected SQL for node "test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8"
[0m19:40:38.910902 [debug] [Thread-1 (]: Began compiling node test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17
[0m19:40:38.913255 [debug] [Thread-3 (]: Writing injected SQL for node "test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0"
[0m19:40:38.914142 [debug] [Thread-2 (]: Began executing node test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713
[0m19:40:38.916509 [debug] [Thread-1 (]: Writing injected SQL for node "test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17"
[0m19:40:38.918694 [debug] [Thread-2 (]: Writing runtime sql for node "test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713"
[0m19:40:38.920479 [debug] [Thread-4 (]: Began executing node test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8
[0m19:40:38.920974 [debug] [Thread-3 (]: Began executing node test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0
[0m19:40:38.922674 [debug] [Thread-4 (]: Writing runtime sql for node "test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8"
[0m19:40:38.922927 [debug] [Thread-1 (]: Began executing node test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17
[0m19:40:38.924341 [debug] [Thread-3 (]: Writing runtime sql for node "test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0"
[0m19:40:38.926840 [debug] [Thread-1 (]: Writing runtime sql for node "test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17"
[0m19:40:38.927849 [debug] [Thread-2 (]: Using postgres connection "test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713"
[0m19:40:38.928100 [debug] [Thread-4 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8"
[0m19:40:38.929176 [debug] [Thread-2 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713: BEGIN
[0m19:40:38.929967 [debug] [Thread-4 (]: On test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8: BEGIN
[0m19:40:38.930817 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:40:38.931588 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:40:38.932555 [debug] [Thread-3 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0"
[0m19:40:38.933685 [debug] [Thread-2 (]: SQL status: BEGIN in 0.003 seconds
[0m19:40:38.933905 [debug] [Thread-3 (]: On test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0: BEGIN
[0m19:40:38.934182 [debug] [Thread-1 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17"
[0m19:40:38.934665 [debug] [Thread-4 (]: SQL status: BEGIN in 0.003 seconds
[0m19:40:38.934899 [debug] [Thread-2 (]: Using postgres connection "test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713"
[0m19:40:38.935615 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:40:38.936300 [debug] [Thread-1 (]: On test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17: BEGIN
[0m19:40:38.936981 [debug] [Thread-4 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8"
[0m19:40:38.937723 [debug] [Thread-2 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with meet_condition as(
  select *
  from "airflow"."public"."stg_index_returns"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not daily_return >= -0.5
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not daily_return <= 0.5
)

select *
from validation_errors


      
    ) dbt_internal_test
[0m19:40:38.939076 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:40:38.939703 [debug] [Thread-3 (]: SQL status: BEGIN in 0.004 seconds
[0m19:40:38.939948 [debug] [Thread-4 (]: On test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select daily_return
from "airflow"."public"."stg_index_returns"
where daily_return is null



      
    ) dbt_internal_test
[0m19:40:38.941199 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m19:40:38.942082 [debug] [Thread-3 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0"
[0m19:40:38.942688 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m19:40:38.943385 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.000 seconds
[0m19:40:38.944382 [debug] [Thread-2 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713: ROLLBACK
[0m19:40:38.945087 [debug] [Thread-3 (]: On test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select ticker
from "airflow"."public"."stg_index_returns"
where ticker is null



      
    ) dbt_internal_test
[0m19:40:38.945834 [debug] [Thread-1 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17"
[0m19:40:38.946975 [debug] [Thread-4 (]: On test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8: ROLLBACK
[0m19:40:38.947762 [debug] [Thread-2 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713: Close
[0m19:40:38.948627 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.000 seconds
[0m19:40:38.949010 [debug] [Thread-1 (]: On test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select timestamp
from "airflow"."public"."stg_index_returns"
where timestamp is null



      
    ) dbt_internal_test
[0m19:40:38.949826 [debug] [Thread-4 (]: On test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8: Close
[0m19:40:38.950568 [info ] [Thread-2 (]: 7 of 24 PASS dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5  [[32mPASS[0m in 0.05s]
[0m19:40:38.951517 [debug] [Thread-3 (]: On test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0: ROLLBACK
[0m19:40:38.952538 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.000 seconds
[0m19:40:38.953049 [info ] [Thread-4 (]: 8 of 24 PASS not_null_stg_index_returns_daily_return ........................... [[32mPASS[0m in 0.05s]
[0m19:40:38.953866 [debug] [Thread-2 (]: Finished running node test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713
[0m19:40:38.954683 [debug] [Thread-3 (]: On test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0: Close
[0m19:40:38.955624 [debug] [Thread-1 (]: On test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17: ROLLBACK
[0m19:40:38.956419 [debug] [Thread-4 (]: Finished running node test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8
[0m19:40:38.957131 [debug] [Thread-2 (]: Began running node model.global_economic_tracker.stg_commodity_metrics
[0m19:40:38.957982 [info ] [Thread-3 (]: 9 of 24 PASS not_null_stg_index_returns_ticker ................................. [[32mPASS[0m in 0.06s]
[0m19:40:38.958683 [debug] [Thread-1 (]: On test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17: Close
[0m19:40:38.959772 [info ] [Thread-2 (]: 11 of 24 SKIP relation public.stg_commodity_metrics ............................ [[33mSKIP[0m]
[0m19:40:38.960609 [debug] [Thread-3 (]: Finished running node test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0
[0m19:40:38.961487 [info ] [Thread-1 (]: 10 of 24 PASS not_null_stg_index_returns_timestamp ............................. [[32mPASS[0m in 0.06s]
[0m19:40:38.962014 [debug] [Thread-2 (]: Finished running node model.global_economic_tracker.stg_commodity_metrics
[0m19:40:38.963409 [debug] [Thread-1 (]: Finished running node test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17
[0m19:40:38.964169 [debug] [Thread-7 (]: Marking all children of 'model.global_economic_tracker.stg_commodity_metrics' to be skipped because of status 'skipped'. 
[0m19:40:38.965739 [debug] [Thread-4 (]: Began running node model.global_economic_tracker.stg_index_metrics
[0m19:40:38.965978 [debug] [Thread-3 (]: Began running node test.global_economic_tracker.accepted_values_stg_commodity_metrics_trend__up__down__flat.70479897b5
[0m19:40:38.966219 [debug] [Thread-2 (]: Began running node test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_daily_return__0_5___0_5.2c4246e1e4
[0m19:40:38.966466 [debug] [Thread-1 (]: Began running node test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_rolling_avg__0_3___0_3.a261930571
[0m19:40:38.966916 [info ] [Thread-4 (]: 12 of 24 START sql table model public.stg_index_metrics ........................ [RUN]
[0m19:40:38.967720 [info ] [Thread-3 (]: 13 of 24 SKIP test accepted_values_stg_commodity_metrics_trend__up__down__flat . [[33mSKIP[0m]
[0m19:40:38.968418 [info ] [Thread-2 (]: 14 of 24 SKIP test dbt_utils_accepted_range_stg_commodity_metrics_daily_return__0_5___0_5  [[33mSKIP[0m]
[0m19:40:38.969088 [info ] [Thread-1 (]: 15 of 24 SKIP test dbt_utils_accepted_range_stg_commodity_metrics_rolling_avg__0_3___0_3  [[33mSKIP[0m]
[0m19:40:38.969791 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8, now model.global_economic_tracker.stg_index_metrics)
[0m19:40:38.970572 [debug] [Thread-3 (]: Finished running node test.global_economic_tracker.accepted_values_stg_commodity_metrics_trend__up__down__flat.70479897b5
[0m19:40:38.971446 [debug] [Thread-2 (]: Finished running node test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_daily_return__0_5___0_5.2c4246e1e4
[0m19:40:38.972219 [debug] [Thread-1 (]: Finished running node test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_rolling_avg__0_3___0_3.a261930571
[0m19:40:38.972929 [debug] [Thread-4 (]: Began compiling node model.global_economic_tracker.stg_index_metrics
[0m19:40:38.973661 [debug] [Thread-3 (]: Began running node test.global_economic_tracker.not_null_stg_commodity_metrics_daily_return.74b14cc336
[0m19:40:38.973893 [debug] [Thread-7 (]: Marking all children of 'test.global_economic_tracker.accepted_values_stg_commodity_metrics_trend__up__down__flat.70479897b5' to be skipped because of status 'skipped'. 
[0m19:40:38.974410 [debug] [Thread-2 (]: Began running node test.global_economic_tracker.not_null_stg_commodity_metrics_ticker.6d1d8d12d7
[0m19:40:38.975145 [debug] [Thread-1 (]: Began running node test.global_economic_tracker.not_null_stg_commodity_metrics_timestamp.5651d4b196
[0m19:40:38.977287 [debug] [Thread-4 (]: Writing injected SQL for node "model.global_economic_tracker.stg_index_metrics"
[0m19:40:38.978020 [info ] [Thread-3 (]: 16 of 24 SKIP test not_null_stg_commodity_metrics_daily_return ................. [[33mSKIP[0m]
[0m19:40:38.978720 [debug] [Thread-7 (]: Marking all children of 'test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_daily_return__0_5___0_5.2c4246e1e4' to be skipped because of status 'skipped'. 
[0m19:40:38.979441 [info ] [Thread-2 (]: 17 of 24 SKIP test not_null_stg_commodity_metrics_ticker ....................... [[33mSKIP[0m]
[0m19:40:38.980141 [info ] [Thread-1 (]: 18 of 24 SKIP test not_null_stg_commodity_metrics_timestamp .................... [[33mSKIP[0m]
[0m19:40:38.981403 [debug] [Thread-3 (]: Finished running node test.global_economic_tracker.not_null_stg_commodity_metrics_daily_return.74b14cc336
[0m19:40:38.982128 [debug] [Thread-7 (]: Marking all children of 'test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_rolling_avg__0_3___0_3.a261930571' to be skipped because of status 'skipped'. 
[0m19:40:38.982880 [debug] [Thread-2 (]: Finished running node test.global_economic_tracker.not_null_stg_commodity_metrics_ticker.6d1d8d12d7
[0m19:40:38.983803 [debug] [Thread-1 (]: Finished running node test.global_economic_tracker.not_null_stg_commodity_metrics_timestamp.5651d4b196
[0m19:40:38.985045 [debug] [Thread-7 (]: Marking all children of 'test.global_economic_tracker.not_null_stg_commodity_metrics_daily_return.74b14cc336' to be skipped because of status 'skipped'. 
[0m19:40:38.986705 [debug] [Thread-4 (]: Began executing node model.global_economic_tracker.stg_index_metrics
[0m19:40:38.986946 [debug] [Thread-7 (]: Marking all children of 'test.global_economic_tracker.not_null_stg_commodity_metrics_ticker.6d1d8d12d7' to be skipped because of status 'skipped'. 
[0m19:40:38.989596 [debug] [Thread-4 (]: Writing runtime sql for node "model.global_economic_tracker.stg_index_metrics"
[0m19:40:38.990300 [debug] [Thread-7 (]: Marking all children of 'test.global_economic_tracker.not_null_stg_commodity_metrics_timestamp.5651d4b196' to be skipped because of status 'skipped'. 
[0m19:40:38.996773 [debug] [Thread-4 (]: Using postgres connection "model.global_economic_tracker.stg_index_metrics"
[0m19:40:38.997455 [debug] [Thread-4 (]: On model.global_economic_tracker.stg_index_metrics: BEGIN
[0m19:40:38.998120 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:40:39.000018 [debug] [Thread-4 (]: SQL status: BEGIN in 0.002 seconds
[0m19:40:39.000718 [debug] [Thread-4 (]: Using postgres connection "model.global_economic_tracker.stg_index_metrics"
[0m19:40:39.001394 [debug] [Thread-4 (]: On model.global_economic_tracker.stg_index_metrics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_index_metrics"} */

  
    

  create  table "airflow"."public"."stg_index_metrics__dbt_tmp"
  
  
    as
  
  (
    

with base as (
    select
        *,
        row_number() over (partition by ticker order by timestamp) as rn
    from "airflow"."public"."stg_index_returns"
),

rolling as (
    select
        ticker,
        timestamp,
        avg(daily_return) over (
            partition by ticker
            order by rn
            rows between 19 preceding and current row
        ) as rolling_avg_mo,

        avg(daily_return) OVER (
            partition by ticker
            order by timestamp
            rows between 6 preceding and current row
        ) as weekly_avg_return,

        stddev(daily_return) over (
            partition by ticker
            order by rn
            rows between 19 preceding and current row
        ) as rolling_volatility_mo,

        case
            when daily_return > 0 then 'up'
            when daily_return < 0 then 'down'
            else 'flat'
        end as trend

    from base
)

select
    *,
    rolling_avg_mo / nullif(rolling_volatility_mo, 0) as sharpe_mo,
    (daily_return - rolling_avg_mo) / nullif(rolling_volatility_mo, 0) as z_score_mo
from rolling
where rolling_avg_mo is not null
  );
  
[0m19:40:39.003235 [debug] [Thread-4 (]: Postgres adapter: Postgres error: column "daily_return" does not exist
LINE 55:     (daily_return - rolling_avg_mo) / nullif(rolling_volatil...
              ^

[0m19:40:39.004141 [debug] [Thread-4 (]: On model.global_economic_tracker.stg_index_metrics: ROLLBACK
[0m19:40:39.004910 [debug] [Thread-4 (]: On model.global_economic_tracker.stg_index_metrics: Close
[0m19:40:39.006191 [debug] [Thread-4 (]: Database Error in model stg_index_metrics (models/analytics/stg_index_metrics.sql)
  column "daily_return" does not exist
  LINE 55:     (daily_return - rolling_avg_mo) / nullif(rolling_volatil...
                ^
  compiled code at target/run/global_economic_tracker/models/analytics/stg_index_metrics.sql
[0m19:40:39.006910 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8189e253-54d3-44fa-8fe1-07bc80aa1654', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f468235afb0>]}
[0m19:40:39.007787 [error] [Thread-4 (]: 12 of 24 ERROR creating sql table model public.stg_index_metrics ............... [[31mERROR[0m in 0.04s]
[0m19:40:39.008587 [debug] [Thread-4 (]: Finished running node model.global_economic_tracker.stg_index_metrics
[0m19:40:39.009334 [debug] [Thread-7 (]: Marking all children of 'model.global_economic_tracker.stg_index_metrics' to be skipped because of status 'error'.  Reason: Database Error in model stg_index_metrics (models/analytics/stg_index_metrics.sql)
  column "daily_return" does not exist
  LINE 55:     (daily_return - rolling_avg_mo) / nullif(rolling_volatil...
                ^
  compiled code at target/run/global_economic_tracker/models/analytics/stg_index_metrics.sql.
[0m19:40:39.010500 [debug] [Thread-3 (]: Began running node test.global_economic_tracker.accepted_values_stg_index_metrics_trend__up__down__flat.1fea418295
[0m19:40:39.010753 [debug] [Thread-2 (]: Began running node test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_daily_return__0_5___0_5.6e9f33b0a2
[0m19:40:39.010998 [debug] [Thread-1 (]: Began running node test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_rolling_avg__0_3___0_3.c2bd8acf6b
[0m19:40:39.011249 [debug] [Thread-4 (]: Began running node test.global_economic_tracker.not_null_stg_index_metrics_daily_return.26f4856193
[0m19:40:39.011636 [info ] [Thread-3 (]: 19 of 24 SKIP test accepted_values_stg_index_metrics_trend__up__down__flat ..... [[33mSKIP[0m]
[0m19:40:39.012451 [info ] [Thread-2 (]: 20 of 24 SKIP test dbt_utils_accepted_range_stg_index_metrics_daily_return__0_5___0_5  [[33mSKIP[0m]
[0m19:40:39.013226 [info ] [Thread-1 (]: 21 of 24 SKIP test dbt_utils_accepted_range_stg_index_metrics_rolling_avg__0_3___0_3  [[33mSKIP[0m]
[0m19:40:39.013905 [info ] [Thread-4 (]: 22 of 24 SKIP test not_null_stg_index_metrics_daily_return ..................... [[33mSKIP[0m]
[0m19:40:39.014611 [debug] [Thread-3 (]: Finished running node test.global_economic_tracker.accepted_values_stg_index_metrics_trend__up__down__flat.1fea418295
[0m19:40:39.015312 [debug] [Thread-2 (]: Finished running node test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_daily_return__0_5___0_5.6e9f33b0a2
[0m19:40:39.016004 [debug] [Thread-1 (]: Finished running node test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_rolling_avg__0_3___0_3.c2bd8acf6b
[0m19:40:39.016726 [debug] [Thread-4 (]: Finished running node test.global_economic_tracker.not_null_stg_index_metrics_daily_return.26f4856193
[0m19:40:39.017466 [debug] [Thread-3 (]: Began running node test.global_economic_tracker.not_null_stg_index_metrics_ticker.4b922607c9
[0m19:40:39.017701 [debug] [Thread-7 (]: Marking all children of 'test.global_economic_tracker.accepted_values_stg_index_metrics_trend__up__down__flat.1fea418295' to be skipped because of status 'skipped'. 
[0m19:40:39.018219 [debug] [Thread-2 (]: Began running node test.global_economic_tracker.not_null_stg_index_metrics_timestamp.b1d1abca86
[0m19:40:39.019957 [info ] [Thread-3 (]: 23 of 24 SKIP test not_null_stg_index_metrics_ticker ........................... [[33mSKIP[0m]
[0m19:40:39.020701 [debug] [Thread-7 (]: Marking all children of 'test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_daily_return__0_5___0_5.6e9f33b0a2' to be skipped because of status 'skipped'. 
[0m19:40:39.021420 [info ] [Thread-2 (]: 24 of 24 SKIP test not_null_stg_index_metrics_timestamp ........................ [[33mSKIP[0m]
[0m19:40:39.022116 [debug] [Thread-3 (]: Finished running node test.global_economic_tracker.not_null_stg_index_metrics_ticker.4b922607c9
[0m19:40:39.022869 [debug] [Thread-7 (]: Marking all children of 'test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_rolling_avg__0_3___0_3.c2bd8acf6b' to be skipped because of status 'skipped'. 
[0m19:40:39.023617 [debug] [Thread-2 (]: Finished running node test.global_economic_tracker.not_null_stg_index_metrics_timestamp.b1d1abca86
[0m19:40:39.024896 [debug] [Thread-7 (]: Marking all children of 'test.global_economic_tracker.not_null_stg_index_metrics_daily_return.26f4856193' to be skipped because of status 'skipped'. 
[0m19:40:39.026116 [debug] [Thread-7 (]: Marking all children of 'test.global_economic_tracker.not_null_stg_index_metrics_ticker.4b922607c9' to be skipped because of status 'skipped'. 
[0m19:40:39.026771 [debug] [Thread-7 (]: Marking all children of 'test.global_economic_tracker.not_null_stg_index_metrics_timestamp.b1d1abca86' to be skipped because of status 'skipped'. 
[0m19:40:39.028238 [debug] [MainThread]: Using postgres connection "master"
[0m19:40:39.028897 [debug] [MainThread]: On master: BEGIN
[0m19:40:39.029520 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:40:39.031361 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m19:40:39.031996 [debug] [MainThread]: On master: COMMIT
[0m19:40:39.032629 [debug] [MainThread]: Using postgres connection "master"
[0m19:40:39.033250 [debug] [MainThread]: On master: COMMIT
[0m19:40:39.033999 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:40:39.034638 [debug] [MainThread]: On master: Close
[0m19:40:39.035376 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:40:39.035988 [debug] [MainThread]: Connection 'test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17' was properly closed.
[0m19:40:39.036599 [debug] [MainThread]: Connection 'test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713' was properly closed.
[0m19:40:39.037208 [debug] [MainThread]: Connection 'model.global_economic_tracker.stg_index_metrics' was properly closed.
[0m19:40:39.037824 [debug] [MainThread]: Connection 'test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0' was properly closed.
[0m19:40:39.038590 [info ] [MainThread]: 
[0m19:40:39.039267 [info ] [MainThread]: Finished running 4 table models, 20 data tests in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m19:40:39.040882 [debug] [MainThread]: Command end result
[0m19:40:39.096085 [debug] [MainThread]: Wrote artifact WritableManifest to /mnt/c/Users/joeyk/PycharmProjects/GlobalEconomicTracker/global_economic_tracker/target/manifest.json
[0m19:40:39.099641 [debug] [MainThread]: Wrote artifact SemanticManifest to /mnt/c/Users/joeyk/PycharmProjects/GlobalEconomicTracker/global_economic_tracker/target/semantic_manifest.json
[0m19:40:39.106165 [debug] [MainThread]: Wrote artifact RunExecutionResult to /mnt/c/Users/joeyk/PycharmProjects/GlobalEconomicTracker/global_economic_tracker/target/run_results.json
[0m19:40:39.106851 [info ] [MainThread]: 
[0m19:40:39.107615 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m19:40:39.108356 [info ] [MainThread]: 
[0m19:40:39.109146 [error] [MainThread]: [31mFailure in test not_null_stg_commodity_returns_daily_return (models/staging/schema.yml)[0m
[0m19:40:39.109873 [error] [MainThread]:   Got 7 results, configured to fail if != 0
[0m19:40:39.110567 [info ] [MainThread]: 
[0m19:40:39.111274 [info ] [MainThread]:   compiled code at target/compiled/global_economic_tracker/models/staging/schema.yml/not_null_stg_commodity_returns_daily_return.sql
[0m19:40:39.112011 [info ] [MainThread]: 
[0m19:40:39.112712 [error] [MainThread]:   Database Error in model stg_index_metrics (models/analytics/stg_index_metrics.sql)
  column "daily_return" does not exist
  LINE 55:     (daily_return - rolling_avg_mo) / nullif(rolling_volatil...
                ^
  compiled code at target/run/global_economic_tracker/models/analytics/stg_index_metrics.sql
[0m19:40:39.113403 [info ] [MainThread]: 
[0m19:40:39.114125 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=2 SKIP=13 TOTAL=24
[0m19:40:39.115177 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 1.8333753, "process_in_blocks": "0", "process_kernel_time": 0.185957, "process_mem_max_rss": "128344", "process_out_blocks": "0", "process_user_time": 1.282129}
[0m19:40:39.116079 [debug] [MainThread]: Command `dbt build` failed at 19:40:39.116006 after 1.83 seconds
[0m19:40:39.116739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46a5cae410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46a43cc3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46802c36a0>]}
[0m19:40:39.117406 [debug] [MainThread]: Flushing usage events
[0m19:40:39.622070 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:42:51.585006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0260701a80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f025feebaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f025fee84f0>]}


============================== 19:42:51.586901 | 3268a9e5-4537-41bb-b015-0f2a719656ca ==============================
[0m19:42:51.586901 [info ] [MainThread]: Running with dbt=1.9.4
[0m19:42:51.587723 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/joey/.dbt', 'log_path': '/mnt/c/Users/joeyk/PycharmProjects/GlobalEconomicTracker/global_economic_tracker/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt build', 'send_anonymous_usage_stats': 'True'}
[0m19:42:51.672520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3268a9e5-4537-41bb-b015-0f2a719656ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0261e6e3e0>]}
[0m19:42:51.702370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3268a9e5-4537-41bb-b015-0f2a719656ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f025ff0ff40>]}
[0m19:42:51.703191 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m19:42:51.745009 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m19:42:52.558376 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m19:42:52.559417 [debug] [MainThread]: Partial parsing: updated file: global_economic_tracker://models/staging/stg_index_returns.sql
[0m19:42:52.560142 [debug] [MainThread]: Partial parsing: updated file: global_economic_tracker://models/staging/stg_commodity_returns.sql
[0m19:42:52.803712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3268a9e5-4537-41bb-b015-0f2a719656ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f025c152830>]}
[0m19:42:52.856877 [debug] [MainThread]: Wrote artifact WritableManifest to /mnt/c/Users/joeyk/PycharmProjects/GlobalEconomicTracker/global_economic_tracker/target/manifest.json
[0m19:42:52.861028 [debug] [MainThread]: Wrote artifact SemanticManifest to /mnt/c/Users/joeyk/PycharmProjects/GlobalEconomicTracker/global_economic_tracker/target/semantic_manifest.json
[0m19:42:52.876593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3268a9e5-4537-41bb-b015-0f2a719656ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f025eb94f10>]}
[0m19:42:52.877343 [info ] [MainThread]: Found 4 models, 20 data tests, 549 macros
[0m19:42:52.879187 [info ] [MainThread]: 
[0m19:42:52.879912 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:42:52.880828 [info ] [MainThread]: 
[0m19:42:52.881575 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:42:52.884306 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m19:42:52.896700 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m19:42:52.897380 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m19:42:52.897993 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:42:52.901093 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.003 seconds
[0m19:42:52.902159 [debug] [ThreadPool]: On list_airflow: Close
[0m19:42:52.903418 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_public)
[0m19:42:52.906923 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m19:42:52.907582 [debug] [ThreadPool]: On list_airflow_public: BEGIN
[0m19:42:52.908213 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:42:52.910141 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m19:42:52.910888 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m19:42:52.911535 [debug] [ThreadPool]: On list_airflow_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:42:52.913245 [debug] [ThreadPool]: SQL status: SELECT 47 in 0.001 seconds
[0m19:42:52.914844 [debug] [ThreadPool]: On list_airflow_public: ROLLBACK
[0m19:42:52.915592 [debug] [ThreadPool]: On list_airflow_public: Close
[0m19:42:52.920643 [debug] [MainThread]: Using postgres connection "master"
[0m19:42:52.921294 [debug] [MainThread]: On master: BEGIN
[0m19:42:52.921917 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:42:52.923757 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m19:42:52.924379 [debug] [MainThread]: Using postgres connection "master"
[0m19:42:52.925029 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:42:52.926827 [debug] [MainThread]: SQL status: SELECT 0 in 0.001 seconds
[0m19:42:52.927765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3268a9e5-4537-41bb-b015-0f2a719656ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f025df108e0>]}
[0m19:42:52.928448 [debug] [MainThread]: On master: ROLLBACK
[0m19:42:52.929385 [debug] [MainThread]: Using postgres connection "master"
[0m19:42:52.930034 [debug] [MainThread]: On master: BEGIN
[0m19:42:52.930932 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m19:42:52.931568 [debug] [MainThread]: On master: COMMIT
[0m19:42:52.932200 [debug] [MainThread]: Using postgres connection "master"
[0m19:42:52.932830 [debug] [MainThread]: On master: COMMIT
[0m19:42:52.933564 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:42:52.934192 [debug] [MainThread]: On master: Close
[0m19:42:52.937412 [debug] [Thread-1 (]: Began running node model.global_economic_tracker.stg_commodity_returns
[0m19:42:52.937668 [debug] [Thread-2 (]: Began running node model.global_economic_tracker.stg_index_returns
[0m19:42:52.938312 [info ] [Thread-1 (]: 1 of 24 START sql table model public.stg_commodity_returns ..................... [RUN]
[0m19:42:52.939056 [info ] [Thread-2 (]: 2 of 24 START sql table model public.stg_index_returns ......................... [RUN]
[0m19:42:52.939804 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_public, now model.global_economic_tracker.stg_commodity_returns)
[0m19:42:52.940831 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.global_economic_tracker.stg_index_returns'
[0m19:42:52.941597 [debug] [Thread-1 (]: Began compiling node model.global_economic_tracker.stg_commodity_returns
[0m19:42:52.942291 [debug] [Thread-2 (]: Began compiling node model.global_economic_tracker.stg_index_returns
[0m19:42:52.946443 [debug] [Thread-1 (]: Writing injected SQL for node "model.global_economic_tracker.stg_commodity_returns"
[0m19:42:52.948499 [debug] [Thread-2 (]: Writing injected SQL for node "model.global_economic_tracker.stg_index_returns"
[0m19:42:52.952753 [debug] [Thread-1 (]: Began executing node model.global_economic_tracker.stg_commodity_returns
[0m19:42:52.958815 [debug] [Thread-2 (]: Began executing node model.global_economic_tracker.stg_index_returns
[0m19:42:52.972372 [debug] [Thread-1 (]: Writing runtime sql for node "model.global_economic_tracker.stg_commodity_returns"
[0m19:42:52.974415 [debug] [Thread-2 (]: Writing runtime sql for node "model.global_economic_tracker.stg_index_returns"
[0m19:42:52.978615 [debug] [Thread-1 (]: Using postgres connection "model.global_economic_tracker.stg_commodity_returns"
[0m19:42:52.979374 [debug] [Thread-1 (]: On model.global_economic_tracker.stg_commodity_returns: BEGIN
[0m19:42:52.979872 [debug] [Thread-2 (]: Using postgres connection "model.global_economic_tracker.stg_index_returns"
[0m19:42:52.980257 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:42:52.980985 [debug] [Thread-2 (]: On model.global_economic_tracker.stg_index_returns: BEGIN
[0m19:42:52.982251 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:42:52.983022 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m19:42:52.983695 [debug] [Thread-1 (]: Using postgres connection "model.global_economic_tracker.stg_commodity_returns"
[0m19:42:52.984394 [debug] [Thread-1 (]: On model.global_economic_tracker.stg_commodity_returns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_commodity_returns"} */

  
    

  create  table "airflow"."public"."stg_commodity_returns__dbt_tmp"
  
  
    as
  
  (
    

select
    'commodity' as type,
    ticker,
    timestamp,
    price,
    lag(price) over (partition by ticker order by timestamp) as prev_price,
    coalesce((price - lag(price) over (partition by ticker order by timestamp)) / lag(price) over (partition by ticker order by timestamp), 0) as daily_return
from public.commodity_prices
  );
  
[0m19:42:52.984964 [debug] [Thread-2 (]: SQL status: BEGIN in 0.003 seconds
[0m19:42:52.985895 [debug] [Thread-2 (]: Using postgres connection "model.global_economic_tracker.stg_index_returns"
[0m19:42:52.986565 [debug] [Thread-2 (]: On model.global_economic_tracker.stg_index_returns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_index_returns"} */

  
    

  create  table "airflow"."public"."stg_index_returns__dbt_tmp"
  
  
    as
  
  (
    

select
    'index' as type,
    country,
    ticker,
    timestamp,
    price,
    lag(price) over (partition by ticker order by timestamp) as prev_price,
    coalesce((price - lag(price) over (partition by ticker order by timestamp)) / lag(price) over (partition by ticker order by timestamp), 0) as daily_return
from public.index_prices
  );
  
[0m19:42:52.991642 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.004 seconds
[0m19:42:52.992072 [debug] [Thread-1 (]: SQL status: SELECT 517 in 0.007 seconds
[0m19:42:52.997219 [debug] [Thread-2 (]: Using postgres connection "model.global_economic_tracker.stg_index_returns"
[0m19:42:52.999392 [debug] [Thread-1 (]: Using postgres connection "model.global_economic_tracker.stg_commodity_returns"
[0m19:42:53.000083 [debug] [Thread-2 (]: On model.global_economic_tracker.stg_index_returns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_index_returns"} */
alter table "airflow"."public"."stg_index_returns" rename to "stg_index_returns__dbt_backup"
[0m19:42:53.000917 [debug] [Thread-1 (]: On model.global_economic_tracker.stg_commodity_returns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_commodity_returns"} */
alter table "airflow"."public"."stg_commodity_returns" rename to "stg_commodity_returns__dbt_backup"
[0m19:42:53.001841 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:42:53.002404 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:42:53.004174 [debug] [Thread-2 (]: Using postgres connection "model.global_economic_tracker.stg_index_returns"
[0m19:42:53.006137 [debug] [Thread-1 (]: Using postgres connection "model.global_economic_tracker.stg_commodity_returns"
[0m19:42:53.006837 [debug] [Thread-2 (]: On model.global_economic_tracker.stg_index_returns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_index_returns"} */
alter table "airflow"."public"."stg_index_returns__dbt_tmp" rename to "stg_index_returns"
[0m19:42:53.007549 [debug] [Thread-1 (]: On model.global_economic_tracker.stg_commodity_returns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_commodity_returns"} */
alter table "airflow"."public"."stg_commodity_returns__dbt_tmp" rename to "stg_commodity_returns"
[0m19:42:53.008452 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:42:53.009172 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:42:53.010455 [debug] [Thread-2 (]: Using postgres connection "model.global_economic_tracker.stg_index_returns"
[0m19:42:53.011768 [debug] [Thread-1 (]: Using postgres connection "model.global_economic_tracker.stg_commodity_returns"
[0m19:42:53.012468 [debug] [Thread-2 (]: On model.global_economic_tracker.stg_index_returns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_index_returns"} */

        CREATE INDEX IF NOT EXISTS idx_index_returns_ticker_ts ON "airflow"."public"."stg_index_returns"(ticker, timestamp)
      
[0m19:42:53.013173 [debug] [Thread-1 (]: On model.global_economic_tracker.stg_commodity_returns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_commodity_returns"} */

        CREATE INDEX IF NOT EXISTS idx_returns_ticker_ts ON "airflow"."public"."stg_commodity_returns"(ticker, timestamp)
      
[0m19:42:53.014077 [debug] [Thread-2 (]: SQL status: CREATE INDEX in 0.000 seconds
[0m19:42:53.014801 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.000 seconds
[0m19:42:53.024120 [debug] [Thread-2 (]: On model.global_economic_tracker.stg_index_returns: COMMIT
[0m19:42:53.025190 [debug] [Thread-1 (]: On model.global_economic_tracker.stg_commodity_returns: COMMIT
[0m19:42:53.025924 [debug] [Thread-2 (]: Using postgres connection "model.global_economic_tracker.stg_index_returns"
[0m19:42:53.026623 [debug] [Thread-1 (]: Using postgres connection "model.global_economic_tracker.stg_commodity_returns"
[0m19:42:53.027327 [debug] [Thread-2 (]: On model.global_economic_tracker.stg_index_returns: COMMIT
[0m19:42:53.028022 [debug] [Thread-1 (]: On model.global_economic_tracker.stg_commodity_returns: COMMIT
[0m19:42:53.030249 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m19:42:53.033738 [debug] [Thread-2 (]: Applying DROP to: "airflow"."public"."stg_index_returns__dbt_backup"
[0m19:42:53.033969 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m19:42:53.036423 [debug] [Thread-2 (]: Using postgres connection "model.global_economic_tracker.stg_index_returns"
[0m19:42:53.038198 [debug] [Thread-1 (]: Applying DROP to: "airflow"."public"."stg_commodity_returns__dbt_backup"
[0m19:42:53.038908 [debug] [Thread-2 (]: On model.global_economic_tracker.stg_index_returns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_index_returns"} */
drop table if exists "airflow"."public"."stg_index_returns__dbt_backup" cascade
[0m19:42:53.039835 [debug] [Thread-1 (]: Using postgres connection "model.global_economic_tracker.stg_commodity_returns"
[0m19:42:53.041029 [debug] [Thread-1 (]: On model.global_economic_tracker.stg_commodity_returns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_commodity_returns"} */
drop table if exists "airflow"."public"."stg_commodity_returns__dbt_backup" cascade
[0m19:42:53.043884 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.003 seconds
[0m19:42:53.045648 [debug] [Thread-2 (]: On model.global_economic_tracker.stg_index_returns: Close
[0m19:42:53.045880 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m19:42:53.047624 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3268a9e5-4537-41bb-b015-0f2a719656ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f025db68640>]}
[0m19:42:53.048437 [debug] [Thread-1 (]: On model.global_economic_tracker.stg_commodity_returns: Close
[0m19:42:53.049280 [info ] [Thread-2 (]: 2 of 24 OK created sql table model public.stg_index_returns .................... [[32mSELECT 0[0m in 0.11s]
[0m19:42:53.050131 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3268a9e5-4537-41bb-b015-0f2a719656ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f025df13b20>]}
[0m19:42:53.050906 [debug] [Thread-2 (]: Finished running node model.global_economic_tracker.stg_index_returns
[0m19:42:53.051789 [info ] [Thread-1 (]: 1 of 24 OK created sql table model public.stg_commodity_returns ................ [[32mSELECT 517[0m in 0.11s]
[0m19:42:53.052862 [debug] [Thread-4 (]: Began running node test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713
[0m19:42:53.053164 [debug] [Thread-3 (]: Began running node test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8
[0m19:42:53.053402 [debug] [Thread-2 (]: Began running node test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0
[0m19:42:53.053905 [debug] [Thread-1 (]: Finished running node model.global_economic_tracker.stg_commodity_returns
[0m19:42:53.054752 [info ] [Thread-4 (]: 3 of 24 START test dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5  [RUN]
[0m19:42:53.055569 [info ] [Thread-3 (]: 4 of 24 START test not_null_stg_index_returns_daily_return ..................... [RUN]
[0m19:42:53.056403 [info ] [Thread-2 (]: 5 of 24 START test not_null_stg_index_returns_ticker ........................... [RUN]
[0m19:42:53.057119 [debug] [Thread-1 (]: Began running node test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17
[0m19:42:53.057957 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713'
[0m19:42:53.058706 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8'
[0m19:42:53.059431 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.global_economic_tracker.stg_index_returns, now test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0)
[0m19:42:53.060148 [info ] [Thread-1 (]: 6 of 24 START test not_null_stg_index_returns_timestamp ........................ [RUN]
[0m19:42:53.060897 [debug] [Thread-4 (]: Began compiling node test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713
[0m19:42:53.061610 [debug] [Thread-3 (]: Began compiling node test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8
[0m19:42:53.062304 [debug] [Thread-2 (]: Began compiling node test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0
[0m19:42:53.063029 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.global_economic_tracker.stg_commodity_returns, now test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17)
[0m19:42:53.065688 [debug] [Thread-4 (]: Writing injected SQL for node "test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713"
[0m19:42:53.070934 [debug] [Thread-3 (]: Writing injected SQL for node "test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8"
[0m19:42:53.073344 [debug] [Thread-2 (]: Writing injected SQL for node "test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0"
[0m19:42:53.074060 [debug] [Thread-1 (]: Began compiling node test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17
[0m19:42:53.078490 [debug] [Thread-1 (]: Writing injected SQL for node "test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17"
[0m19:42:53.082657 [debug] [Thread-3 (]: Began executing node test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8
[0m19:42:53.083302 [debug] [Thread-2 (]: Began executing node test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0
[0m19:42:53.089005 [debug] [Thread-4 (]: Began executing node test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713
[0m19:42:53.090960 [debug] [Thread-3 (]: Writing runtime sql for node "test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8"
[0m19:42:53.091224 [debug] [Thread-1 (]: Began executing node test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17
[0m19:42:53.092511 [debug] [Thread-2 (]: Writing runtime sql for node "test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0"
[0m19:42:53.094155 [debug] [Thread-4 (]: Writing runtime sql for node "test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713"
[0m19:42:53.096292 [debug] [Thread-1 (]: Writing runtime sql for node "test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17"
[0m19:42:53.099530 [debug] [Thread-3 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8"
[0m19:42:53.099816 [debug] [Thread-2 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0"
[0m19:42:53.100545 [debug] [Thread-3 (]: On test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8: BEGIN
[0m19:42:53.100835 [debug] [Thread-4 (]: Using postgres connection "test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713"
[0m19:42:53.101400 [debug] [Thread-2 (]: On test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0: BEGIN
[0m19:42:53.101673 [debug] [Thread-1 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17"
[0m19:42:53.102240 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:42:53.102914 [debug] [Thread-4 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713: BEGIN
[0m19:42:53.103617 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:42:53.104322 [debug] [Thread-1 (]: On test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17: BEGIN
[0m19:42:53.105595 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:42:53.106348 [debug] [Thread-3 (]: SQL status: BEGIN in 0.004 seconds
[0m19:42:53.107166 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:42:53.108035 [debug] [Thread-2 (]: SQL status: BEGIN in 0.004 seconds
[0m19:42:53.108579 [debug] [Thread-3 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8"
[0m19:42:53.109170 [debug] [Thread-4 (]: SQL status: BEGIN in 0.004 seconds
[0m19:42:53.110236 [debug] [Thread-2 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0"
[0m19:42:53.111040 [debug] [Thread-3 (]: On test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select daily_return
from "airflow"."public"."stg_index_returns"
where daily_return is null



      
    ) dbt_internal_test
[0m19:42:53.111543 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m19:42:53.111928 [debug] [Thread-4 (]: Using postgres connection "test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713"
[0m19:42:53.112641 [debug] [Thread-2 (]: On test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select ticker
from "airflow"."public"."stg_index_returns"
where ticker is null



      
    ) dbt_internal_test
[0m19:42:53.113734 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.000 seconds
[0m19:42:53.114107 [debug] [Thread-1 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17"
[0m19:42:53.114778 [debug] [Thread-4 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with meet_condition as(
  select *
  from "airflow"."public"."stg_index_returns"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not daily_return >= -0.5
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not daily_return <= 0.5
)

select *
from validation_errors


      
    ) dbt_internal_test
[0m19:42:53.115785 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.000 seconds
[0m19:42:53.117530 [debug] [Thread-3 (]: On test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8: ROLLBACK
[0m19:42:53.118252 [debug] [Thread-1 (]: On test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select timestamp
from "airflow"."public"."stg_index_returns"
where timestamp is null



      
    ) dbt_internal_test
[0m19:42:53.119484 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.000 seconds
[0m19:42:53.120518 [debug] [Thread-2 (]: On test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0: ROLLBACK
[0m19:42:53.121352 [debug] [Thread-3 (]: On test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8: Close
[0m19:42:53.122306 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.000 seconds
[0m19:42:53.122947 [debug] [Thread-4 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713: ROLLBACK
[0m19:42:53.123745 [debug] [Thread-2 (]: On test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0: Close
[0m19:42:53.124439 [info ] [Thread-3 (]: 4 of 24 PASS not_null_stg_index_returns_daily_return ........................... [[32mPASS[0m in 0.07s]
[0m19:42:53.125396 [debug] [Thread-1 (]: On test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17: ROLLBACK
[0m19:42:53.126383 [debug] [Thread-4 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713: Close
[0m19:42:53.127094 [info ] [Thread-2 (]: 5 of 24 PASS not_null_stg_index_returns_ticker ................................. [[32mPASS[0m in 0.07s]
[0m19:42:53.127739 [debug] [Thread-3 (]: Finished running node test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8
[0m19:42:53.128543 [debug] [Thread-1 (]: On test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17: Close
[0m19:42:53.129256 [info ] [Thread-4 (]: 3 of 24 PASS dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5  [[32mPASS[0m in 0.07s]
[0m19:42:53.130329 [debug] [Thread-2 (]: Finished running node test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0
[0m19:42:53.131101 [debug] [Thread-3 (]: Began running node test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe
[0m19:42:53.131971 [info ] [Thread-1 (]: 6 of 24 PASS not_null_stg_index_returns_timestamp .............................. [[32mPASS[0m in 0.07s]
[0m19:42:53.132561 [debug] [Thread-4 (]: Finished running node test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713
[0m19:42:53.133281 [debug] [Thread-2 (]: Began running node test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934
[0m19:42:53.134028 [info ] [Thread-3 (]: 7 of 24 START test dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5  [RUN]
[0m19:42:53.134822 [debug] [Thread-1 (]: Finished running node test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17
[0m19:42:53.135567 [debug] [Thread-4 (]: Began running node test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d
[0m19:42:53.136353 [info ] [Thread-2 (]: 8 of 24 START test not_null_stg_commodity_returns_daily_return ................. [RUN]
[0m19:42:53.137098 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8, now test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe)
[0m19:42:53.137828 [debug] [Thread-1 (]: Began running node test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359
[0m19:42:53.138596 [info ] [Thread-4 (]: 9 of 24 START test not_null_stg_commodity_returns_ticker ....................... [RUN]
[0m19:42:53.139307 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0, now test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934)
[0m19:42:53.140021 [debug] [Thread-3 (]: Began compiling node test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe
[0m19:42:53.140779 [info ] [Thread-1 (]: 10 of 24 START test not_null_stg_commodity_returns_timestamp ................... [RUN]
[0m19:42:53.141484 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713, now test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d)
[0m19:42:53.142182 [debug] [Thread-2 (]: Began compiling node test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934
[0m19:42:53.145378 [debug] [Thread-3 (]: Writing injected SQL for node "test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe"
[0m19:42:53.146117 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17, now test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359)
[0m19:42:53.146854 [debug] [Thread-4 (]: Began compiling node test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d
[0m19:42:53.149455 [debug] [Thread-2 (]: Writing injected SQL for node "test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934"
[0m19:42:53.150986 [debug] [Thread-1 (]: Began compiling node test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359
[0m19:42:53.153400 [debug] [Thread-4 (]: Writing injected SQL for node "test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d"
[0m19:42:53.156343 [debug] [Thread-1 (]: Writing injected SQL for node "test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359"
[0m19:42:53.157256 [debug] [Thread-3 (]: Began executing node test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe
[0m19:42:53.158440 [debug] [Thread-2 (]: Began executing node test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934
[0m19:42:53.160007 [debug] [Thread-3 (]: Writing runtime sql for node "test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe"
[0m19:42:53.160863 [debug] [Thread-4 (]: Began executing node test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d
[0m19:42:53.162055 [debug] [Thread-2 (]: Writing runtime sql for node "test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934"
[0m19:42:53.162331 [debug] [Thread-1 (]: Began executing node test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359
[0m19:42:53.164674 [debug] [Thread-4 (]: Writing runtime sql for node "test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d"
[0m19:42:53.166904 [debug] [Thread-1 (]: Writing runtime sql for node "test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359"
[0m19:42:53.168924 [debug] [Thread-3 (]: Using postgres connection "test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe"
[0m19:42:53.169457 [debug] [Thread-2 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934"
[0m19:42:53.169898 [debug] [Thread-3 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe: BEGIN
[0m19:42:53.170167 [debug] [Thread-4 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d"
[0m19:42:53.170852 [debug] [Thread-2 (]: On test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934: BEGIN
[0m19:42:53.171451 [debug] [Thread-1 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359"
[0m19:42:53.171835 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:42:53.172547 [debug] [Thread-4 (]: On test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d: BEGIN
[0m19:42:53.173241 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:42:53.173925 [debug] [Thread-1 (]: On test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359: BEGIN
[0m19:42:53.175232 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:42:53.175923 [debug] [Thread-3 (]: SQL status: BEGIN in 0.004 seconds
[0m19:42:53.176784 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:42:53.177428 [debug] [Thread-2 (]: SQL status: BEGIN in 0.004 seconds
[0m19:42:53.178309 [debug] [Thread-3 (]: Using postgres connection "test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe"
[0m19:42:53.179028 [debug] [Thread-4 (]: SQL status: BEGIN in 0.004 seconds
[0m19:42:53.180034 [debug] [Thread-2 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934"
[0m19:42:53.180791 [debug] [Thread-3 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with meet_condition as(
  select *
  from "airflow"."public"."stg_commodity_returns"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not daily_return >= -0.5
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not daily_return <= 0.5
)

select *
from validation_errors


      
    ) dbt_internal_test
[0m19:42:53.181047 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m19:42:53.181746 [debug] [Thread-4 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d"
[0m19:42:53.182491 [debug] [Thread-2 (]: On test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select daily_return
from "airflow"."public"."stg_commodity_returns"
where daily_return is null



      
    ) dbt_internal_test
[0m19:42:53.183785 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m19:42:53.184312 [debug] [Thread-1 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359"
[0m19:42:53.185022 [debug] [Thread-4 (]: On test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select ticker
from "airflow"."public"."stg_commodity_returns"
where ticker is null



      
    ) dbt_internal_test
[0m19:42:53.186044 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.000 seconds
[0m19:42:53.186861 [debug] [Thread-3 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe: ROLLBACK
[0m19:42:53.187590 [debug] [Thread-1 (]: On test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select timestamp
from "airflow"."public"."stg_commodity_returns"
where timestamp is null



      
    ) dbt_internal_test
[0m19:42:53.188666 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.000 seconds
[0m19:42:53.189471 [debug] [Thread-2 (]: On test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934: ROLLBACK
[0m19:42:53.190265 [debug] [Thread-3 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe: Close
[0m19:42:53.191139 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.000 seconds
[0m19:42:53.192059 [debug] [Thread-4 (]: On test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d: ROLLBACK
[0m19:42:53.192852 [debug] [Thread-2 (]: On test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934: Close
[0m19:42:53.193726 [info ] [Thread-3 (]: 7 of 24 PASS dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5  [[32mPASS[0m in 0.06s]
[0m19:42:53.194976 [debug] [Thread-1 (]: On test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359: ROLLBACK
[0m19:42:53.195788 [debug] [Thread-4 (]: On test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d: Close
[0m19:42:53.196478 [info ] [Thread-2 (]: 8 of 24 PASS not_null_stg_commodity_returns_daily_return ....................... [[32mPASS[0m in 0.06s]
[0m19:42:53.197177 [debug] [Thread-3 (]: Finished running node test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe
[0m19:42:53.197972 [debug] [Thread-1 (]: On test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359: Close
[0m19:42:53.198675 [info ] [Thread-4 (]: 9 of 24 PASS not_null_stg_commodity_returns_ticker ............................. [[32mPASS[0m in 0.06s]
[0m19:42:53.199309 [debug] [Thread-2 (]: Finished running node test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934
[0m19:42:53.200055 [debug] [Thread-3 (]: Began running node model.global_economic_tracker.stg_index_metrics
[0m19:42:53.200991 [info ] [Thread-1 (]: 10 of 24 PASS not_null_stg_commodity_returns_timestamp ......................... [[32mPASS[0m in 0.05s]
[0m19:42:53.201820 [debug] [Thread-4 (]: Finished running node test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d
[0m19:42:53.203118 [info ] [Thread-3 (]: 11 of 24 START sql table model public.stg_index_metrics ........................ [RUN]
[0m19:42:53.203905 [debug] [Thread-1 (]: Finished running node test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359
[0m19:42:53.205511 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe, now model.global_economic_tracker.stg_index_metrics)
[0m19:42:53.206477 [debug] [Thread-2 (]: Began running node model.global_economic_tracker.stg_commodity_metrics
[0m19:42:53.207042 [debug] [Thread-3 (]: Began compiling node model.global_economic_tracker.stg_index_metrics
[0m19:42:53.207806 [info ] [Thread-2 (]: 12 of 24 START sql table model public.stg_commodity_metrics .................... [RUN]
[0m19:42:53.210157 [debug] [Thread-3 (]: Writing injected SQL for node "model.global_economic_tracker.stg_index_metrics"
[0m19:42:53.210951 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934, now model.global_economic_tracker.stg_commodity_metrics)
[0m19:42:53.212165 [debug] [Thread-2 (]: Began compiling node model.global_economic_tracker.stg_commodity_metrics
[0m19:42:53.214018 [debug] [Thread-2 (]: Writing injected SQL for node "model.global_economic_tracker.stg_commodity_metrics"
[0m19:42:53.217769 [debug] [Thread-3 (]: Began executing node model.global_economic_tracker.stg_index_metrics
[0m19:42:53.220412 [debug] [Thread-3 (]: Writing runtime sql for node "model.global_economic_tracker.stg_index_metrics"
[0m19:42:53.220647 [debug] [Thread-2 (]: Began executing node model.global_economic_tracker.stg_commodity_metrics
[0m19:42:53.223467 [debug] [Thread-2 (]: Writing runtime sql for node "model.global_economic_tracker.stg_commodity_metrics"
[0m19:42:53.226959 [debug] [Thread-3 (]: Using postgres connection "model.global_economic_tracker.stg_index_metrics"
[0m19:42:53.227703 [debug] [Thread-3 (]: On model.global_economic_tracker.stg_index_metrics: BEGIN
[0m19:42:53.228238 [debug] [Thread-2 (]: Using postgres connection "model.global_economic_tracker.stg_commodity_metrics"
[0m19:42:53.228609 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:42:53.229311 [debug] [Thread-2 (]: On model.global_economic_tracker.stg_commodity_metrics: BEGIN
[0m19:42:53.230691 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:42:53.231468 [debug] [Thread-3 (]: SQL status: BEGIN in 0.003 seconds
[0m19:42:53.232144 [debug] [Thread-3 (]: Using postgres connection "model.global_economic_tracker.stg_index_metrics"
[0m19:42:53.232620 [debug] [Thread-2 (]: SQL status: BEGIN in 0.002 seconds
[0m19:42:53.233038 [debug] [Thread-3 (]: On model.global_economic_tracker.stg_index_metrics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_index_metrics"} */

  
    

  create  table "airflow"."public"."stg_index_metrics__dbt_tmp"
  
  
    as
  
  (
    

with base as (
    select
        *,
        row_number() over (partition by ticker order by timestamp) as rn
    from "airflow"."public"."stg_index_returns"
),

rolling as (
    select
        ticker,
        timestamp,
        avg(daily_return) over (
            partition by ticker
            order by rn
            rows between 19 preceding and current row
        ) as rolling_avg_mo,

        avg(daily_return) OVER (
            partition by ticker
            order by timestamp
            rows between 6 preceding and current row
        ) as weekly_avg_return,

        stddev(daily_return) over (
            partition by ticker
            order by rn
            rows between 19 preceding and current row
        ) as rolling_volatility_mo,

        case
            when daily_return > 0 then 'up'
            when daily_return < 0 then 'down'
            else 'flat'
        end as trend

    from base
)

select
    *,
    rolling_avg_mo / nullif(rolling_volatility_mo, 0) as sharpe_mo,
    (daily_return - rolling_avg_mo) / nullif(rolling_volatility_mo, 0) as z_score_mo
from rolling
where rolling_avg_mo is not null
  );
  
[0m19:42:53.233755 [debug] [Thread-2 (]: Using postgres connection "model.global_economic_tracker.stg_commodity_metrics"
[0m19:42:53.234987 [debug] [Thread-2 (]: On model.global_economic_tracker.stg_commodity_metrics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_commodity_metrics"} */

  
    

  create  table "airflow"."public"."stg_commodity_metrics__dbt_tmp"
  
  
    as
  
  (
    

with base as (
    select
        *,
        row_number() over (partition by ticker order by timestamp) as rn
    from "airflow"."public"."stg_commodity_returns"
),

rolling as (
    select
        ticker,
        timestamp,
        avg(daily_return) over (
            partition by ticker
            order by rn
            rows between 19 preceding and current row
        ) as rolling_avg_mo,

        avg(daily_return) OVER (
            partition by ticker
            order by timestamp
            rows between 6 preceding and current row
        ) as weekly_avg_return,

        stddev(daily_return) over (
            partition by ticker
            order by rn
            rows between 19 preceding and current row
        ) as rolling_volatility_mo,

        case
            when daily_return > 0 then 'up'
            when daily_return < 0 then 'down'
            else 'flat'
        end as trend

    from base
)

select
    *,
    rolling_avg_mo / nullif(rolling_volatility_mo, 0) as sharpe_mo,
    (daily_return - rolling_avg_mo) / nullif(rolling_volatility_mo, 0) as z_score_mo
from rolling
where rolling_avg_mo is not null
  );
  
[0m19:42:53.235244 [debug] [Thread-3 (]: Postgres adapter: Postgres error: column "daily_return" does not exist
LINE 55:     (daily_return - rolling_avg_mo) / nullif(rolling_volatil...
              ^

[0m19:42:53.236290 [debug] [Thread-3 (]: On model.global_economic_tracker.stg_index_metrics: ROLLBACK
[0m19:42:53.236517 [debug] [Thread-2 (]: Postgres adapter: Postgres error: column "daily_return" does not exist
LINE 55:     (daily_return - rolling_avg_mo) / nullif(rolling_volatil...
              ^

[0m19:42:53.237167 [debug] [Thread-3 (]: On model.global_economic_tracker.stg_index_metrics: Close
[0m19:42:53.237694 [debug] [Thread-2 (]: On model.global_economic_tracker.stg_commodity_metrics: ROLLBACK
[0m19:42:53.239264 [debug] [Thread-2 (]: On model.global_economic_tracker.stg_commodity_metrics: Close
[0m19:42:53.239708 [debug] [Thread-3 (]: Database Error in model stg_index_metrics (models/analytics/stg_index_metrics.sql)
  column "daily_return" does not exist
  LINE 55:     (daily_return - rolling_avg_mo) / nullif(rolling_volatil...
                ^
  compiled code at target/run/global_economic_tracker/models/analytics/stg_index_metrics.sql
[0m19:42:53.240579 [debug] [Thread-2 (]: Database Error in model stg_commodity_metrics (models/analytics/stg_commodity_metrics.sql)
  column "daily_return" does not exist
  LINE 55:     (daily_return - rolling_avg_mo) / nullif(rolling_volatil...
                ^
  compiled code at target/run/global_economic_tracker/models/analytics/stg_commodity_metrics.sql
[0m19:42:53.241222 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3268a9e5-4537-41bb-b015-0f2a719656ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f023c35f880>]}
[0m19:42:53.242062 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3268a9e5-4537-41bb-b015-0f2a719656ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f023c38fca0>]}
[0m19:42:53.242925 [error] [Thread-3 (]: 11 of 24 ERROR creating sql table model public.stg_index_metrics ............... [[31mERROR[0m in 0.04s]
[0m19:42:53.243780 [error] [Thread-2 (]: 12 of 24 ERROR creating sql table model public.stg_commodity_metrics ........... [[31mERROR[0m in 0.03s]
[0m19:42:53.244495 [debug] [Thread-3 (]: Finished running node model.global_economic_tracker.stg_index_metrics
[0m19:42:53.245263 [debug] [Thread-2 (]: Finished running node model.global_economic_tracker.stg_commodity_metrics
[0m19:42:53.246129 [debug] [Thread-7 (]: Marking all children of 'model.global_economic_tracker.stg_index_metrics' to be skipped because of status 'error'.  Reason: Database Error in model stg_index_metrics (models/analytics/stg_index_metrics.sql)
  column "daily_return" does not exist
  LINE 55:     (daily_return - rolling_avg_mo) / nullif(rolling_volatil...
                ^
  compiled code at target/run/global_economic_tracker/models/analytics/stg_index_metrics.sql.
[0m19:42:53.247476 [debug] [Thread-7 (]: Marking all children of 'model.global_economic_tracker.stg_commodity_metrics' to be skipped because of status 'error'.  Reason: Database Error in model stg_commodity_metrics (models/analytics/stg_commodity_metrics.sql)
  column "daily_return" does not exist
  LINE 55:     (daily_return - rolling_avg_mo) / nullif(rolling_volatil...
                ^
  compiled code at target/run/global_economic_tracker/models/analytics/stg_commodity_metrics.sql.
[0m19:42:53.247870 [debug] [Thread-1 (]: Began running node test.global_economic_tracker.accepted_values_stg_index_metrics_trend__up__down__flat.1fea418295
[0m19:42:53.248143 [debug] [Thread-4 (]: Began running node test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_daily_return__0_5___0_5.6e9f33b0a2
[0m19:42:53.248389 [debug] [Thread-3 (]: Began running node test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_rolling_avg__0_3___0_3.c2bd8acf6b
[0m19:42:53.248661 [debug] [Thread-2 (]: Began running node test.global_economic_tracker.not_null_stg_index_metrics_daily_return.26f4856193
[0m19:42:53.249531 [info ] [Thread-1 (]: 13 of 24 SKIP test accepted_values_stg_index_metrics_trend__up__down__flat ..... [[33mSKIP[0m]
[0m19:42:53.250256 [info ] [Thread-4 (]: 14 of 24 SKIP test dbt_utils_accepted_range_stg_index_metrics_daily_return__0_5___0_5  [[33mSKIP[0m]
[0m19:42:53.251022 [info ] [Thread-3 (]: 15 of 24 SKIP test dbt_utils_accepted_range_stg_index_metrics_rolling_avg__0_3___0_3  [[33mSKIP[0m]
[0m19:42:53.251752 [info ] [Thread-2 (]: 16 of 24 SKIP test not_null_stg_index_metrics_daily_return ..................... [[33mSKIP[0m]
[0m19:42:53.252442 [debug] [Thread-1 (]: Finished running node test.global_economic_tracker.accepted_values_stg_index_metrics_trend__up__down__flat.1fea418295
[0m19:42:53.253160 [debug] [Thread-4 (]: Finished running node test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_daily_return__0_5___0_5.6e9f33b0a2
[0m19:42:53.253866 [debug] [Thread-3 (]: Finished running node test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_rolling_avg__0_3___0_3.c2bd8acf6b
[0m19:42:53.254565 [debug] [Thread-2 (]: Finished running node test.global_economic_tracker.not_null_stg_index_metrics_daily_return.26f4856193
[0m19:42:53.255295 [debug] [Thread-1 (]: Began running node test.global_economic_tracker.not_null_stg_index_metrics_ticker.4b922607c9
[0m19:42:53.255526 [debug] [Thread-7 (]: Marking all children of 'test.global_economic_tracker.accepted_values_stg_index_metrics_trend__up__down__flat.1fea418295' to be skipped because of status 'skipped'. 
[0m19:42:53.256080 [debug] [Thread-4 (]: Began running node test.global_economic_tracker.not_null_stg_index_metrics_timestamp.b1d1abca86
[0m19:42:53.256793 [debug] [Thread-3 (]: Began running node test.global_economic_tracker.accepted_values_stg_commodity_metrics_trend__up__down__flat.70479897b5
[0m19:42:53.257826 [debug] [Thread-2 (]: Began running node test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_daily_return__0_5___0_5.2c4246e1e4
[0m19:42:53.258681 [info ] [Thread-1 (]: 17 of 24 SKIP test not_null_stg_index_metrics_ticker ........................... [[33mSKIP[0m]
[0m19:42:53.259508 [debug] [Thread-7 (]: Marking all children of 'test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_daily_return__0_5___0_5.6e9f33b0a2' to be skipped because of status 'skipped'. 
[0m19:42:53.260225 [info ] [Thread-4 (]: 18 of 24 SKIP test not_null_stg_index_metrics_timestamp ........................ [[33mSKIP[0m]
[0m19:42:53.260963 [info ] [Thread-3 (]: 19 of 24 SKIP test accepted_values_stg_commodity_metrics_trend__up__down__flat . [[33mSKIP[0m]
[0m19:42:53.261663 [info ] [Thread-2 (]: 20 of 24 SKIP test dbt_utils_accepted_range_stg_commodity_metrics_daily_return__0_5___0_5  [[33mSKIP[0m]
[0m19:42:53.262355 [debug] [Thread-1 (]: Finished running node test.global_economic_tracker.not_null_stg_index_metrics_ticker.4b922607c9
[0m19:42:53.263086 [debug] [Thread-7 (]: Marking all children of 'test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_rolling_avg__0_3___0_3.c2bd8acf6b' to be skipped because of status 'skipped'. 
[0m19:42:53.263805 [debug] [Thread-4 (]: Finished running node test.global_economic_tracker.not_null_stg_index_metrics_timestamp.b1d1abca86
[0m19:42:53.264528 [debug] [Thread-3 (]: Finished running node test.global_economic_tracker.accepted_values_stg_commodity_metrics_trend__up__down__flat.70479897b5
[0m19:42:53.265262 [debug] [Thread-2 (]: Finished running node test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_daily_return__0_5___0_5.2c4246e1e4
[0m19:42:53.265983 [debug] [Thread-1 (]: Began running node test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_rolling_avg__0_3___0_3.a261930571
[0m19:42:53.266709 [debug] [Thread-7 (]: Marking all children of 'test.global_economic_tracker.not_null_stg_index_metrics_daily_return.26f4856193' to be skipped because of status 'skipped'. 
[0m19:42:53.267463 [debug] [Thread-4 (]: Began running node test.global_economic_tracker.not_null_stg_commodity_metrics_daily_return.74b14cc336
[0m19:42:53.268195 [debug] [Thread-3 (]: Began running node test.global_economic_tracker.not_null_stg_commodity_metrics_ticker.6d1d8d12d7
[0m19:42:53.269002 [debug] [Thread-2 (]: Began running node test.global_economic_tracker.not_null_stg_commodity_metrics_timestamp.5651d4b196
[0m19:42:53.269729 [info ] [Thread-1 (]: 21 of 24 SKIP test dbt_utils_accepted_range_stg_commodity_metrics_rolling_avg__0_3___0_3  [[33mSKIP[0m]
[0m19:42:53.270494 [debug] [Thread-7 (]: Marking all children of 'test.global_economic_tracker.not_null_stg_index_metrics_ticker.4b922607c9' to be skipped because of status 'skipped'. 
[0m19:42:53.271254 [info ] [Thread-4 (]: 22 of 24 SKIP test not_null_stg_commodity_metrics_daily_return ................. [[33mSKIP[0m]
[0m19:42:53.271977 [info ] [Thread-3 (]: 23 of 24 SKIP test not_null_stg_commodity_metrics_ticker ....................... [[33mSKIP[0m]
[0m19:42:53.272687 [info ] [Thread-2 (]: 24 of 24 SKIP test not_null_stg_commodity_metrics_timestamp .................... [[33mSKIP[0m]
[0m19:42:53.273422 [debug] [Thread-1 (]: Finished running node test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_rolling_avg__0_3___0_3.a261930571
[0m19:42:53.274144 [debug] [Thread-7 (]: Marking all children of 'test.global_economic_tracker.not_null_stg_index_metrics_timestamp.b1d1abca86' to be skipped because of status 'skipped'. 
[0m19:42:53.274865 [debug] [Thread-4 (]: Finished running node test.global_economic_tracker.not_null_stg_commodity_metrics_daily_return.74b14cc336
[0m19:42:53.275571 [debug] [Thread-3 (]: Finished running node test.global_economic_tracker.not_null_stg_commodity_metrics_ticker.6d1d8d12d7
[0m19:42:53.276276 [debug] [Thread-2 (]: Finished running node test.global_economic_tracker.not_null_stg_commodity_metrics_timestamp.5651d4b196
[0m19:42:53.277509 [debug] [Thread-7 (]: Marking all children of 'test.global_economic_tracker.accepted_values_stg_commodity_metrics_trend__up__down__flat.70479897b5' to be skipped because of status 'skipped'. 
[0m19:42:53.279863 [debug] [Thread-7 (]: Marking all children of 'test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_daily_return__0_5___0_5.2c4246e1e4' to be skipped because of status 'skipped'. 
[0m19:42:53.280738 [debug] [Thread-7 (]: Marking all children of 'test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_rolling_avg__0_3___0_3.a261930571' to be skipped because of status 'skipped'. 
[0m19:42:53.281450 [debug] [Thread-7 (]: Marking all children of 'test.global_economic_tracker.not_null_stg_commodity_metrics_daily_return.74b14cc336' to be skipped because of status 'skipped'. 
[0m19:42:53.282136 [debug] [Thread-7 (]: Marking all children of 'test.global_economic_tracker.not_null_stg_commodity_metrics_ticker.6d1d8d12d7' to be skipped because of status 'skipped'. 
[0m19:42:53.282803 [debug] [Thread-7 (]: Marking all children of 'test.global_economic_tracker.not_null_stg_commodity_metrics_timestamp.5651d4b196' to be skipped because of status 'skipped'. 
[0m19:42:53.284318 [debug] [MainThread]: Using postgres connection "master"
[0m19:42:53.284959 [debug] [MainThread]: On master: BEGIN
[0m19:42:53.285580 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:42:53.287413 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m19:42:53.288059 [debug] [MainThread]: On master: COMMIT
[0m19:42:53.288733 [debug] [MainThread]: Using postgres connection "master"
[0m19:42:53.289385 [debug] [MainThread]: On master: COMMIT
[0m19:42:53.290127 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:42:53.290806 [debug] [MainThread]: On master: Close
[0m19:42:53.291536 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:42:53.292363 [debug] [MainThread]: Connection 'test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359' was properly closed.
[0m19:42:53.293080 [debug] [MainThread]: Connection 'model.global_economic_tracker.stg_commodity_metrics' was properly closed.
[0m19:42:53.293700 [debug] [MainThread]: Connection 'test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d' was properly closed.
[0m19:42:53.294361 [debug] [MainThread]: Connection 'model.global_economic_tracker.stg_index_metrics' was properly closed.
[0m19:42:53.295043 [info ] [MainThread]: 
[0m19:42:53.295721 [info ] [MainThread]: Finished running 4 table models, 20 data tests in 0 hours 0 minutes and 0.41 seconds (0.41s).
[0m19:42:53.297257 [debug] [MainThread]: Command end result
[0m19:42:53.324732 [debug] [MainThread]: Wrote artifact WritableManifest to /mnt/c/Users/joeyk/PycharmProjects/GlobalEconomicTracker/global_economic_tracker/target/manifest.json
[0m19:42:53.328367 [debug] [MainThread]: Wrote artifact SemanticManifest to /mnt/c/Users/joeyk/PycharmProjects/GlobalEconomicTracker/global_economic_tracker/target/semantic_manifest.json
[0m19:42:53.335074 [debug] [MainThread]: Wrote artifact RunExecutionResult to /mnt/c/Users/joeyk/PycharmProjects/GlobalEconomicTracker/global_economic_tracker/target/run_results.json
[0m19:42:53.335741 [info ] [MainThread]: 
[0m19:42:53.336528 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m19:42:53.337280 [info ] [MainThread]: 
[0m19:42:53.338236 [error] [MainThread]:   Database Error in model stg_index_metrics (models/analytics/stg_index_metrics.sql)
  column "daily_return" does not exist
  LINE 55:     (daily_return - rolling_avg_mo) / nullif(rolling_volatil...
                ^
  compiled code at target/run/global_economic_tracker/models/analytics/stg_index_metrics.sql
[0m19:42:53.338978 [info ] [MainThread]: 
[0m19:42:53.339688 [error] [MainThread]:   Database Error in model stg_commodity_metrics (models/analytics/stg_commodity_metrics.sql)
  column "daily_return" does not exist
  LINE 55:     (daily_return - rolling_avg_mo) / nullif(rolling_volatil...
                ^
  compiled code at target/run/global_economic_tracker/models/analytics/stg_commodity_metrics.sql
[0m19:42:53.340363 [info ] [MainThread]: 
[0m19:42:53.341086 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=2 SKIP=12 TOTAL=24
[0m19:42:53.342081 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 1.7955313, "process_in_blocks": "0", "process_kernel_time": 0.137822, "process_mem_max_rss": "128284", "process_out_blocks": "0", "process_user_time": 1.309313}
[0m19:42:53.342872 [debug] [MainThread]: Command `dbt build` failed at 19:42:53.342800 after 1.80 seconds
[0m19:42:53.343524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0260701a80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f025dff2470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f025dff3820>]}
[0m19:42:53.344200 [debug] [MainThread]: Flushing usage events
[0m19:42:54.041778 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:47:09.025399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4d90b1b40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4d8264e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4d8264e80>]}


============================== 19:47:09.027205 | 5f2c3118-4169-4379-b3af-d1f1d9106eed ==============================
[0m19:47:09.027205 [info ] [MainThread]: Running with dbt=1.9.4
[0m19:47:09.028124 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/joey/.dbt', 'log_path': '/mnt/c/Users/joeyk/PycharmProjects/GlobalEconomicTracker/global_economic_tracker/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt build', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:47:09.112389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5f2c3118-4169-4379-b3af-d1f1d9106eed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4da8324a0>]}
[0m19:47:09.141912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5f2c3118-4169-4379-b3af-d1f1d9106eed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4d8240400>]}
[0m19:47:09.142755 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m19:47:09.185161 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m19:47:10.002312 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m19:47:10.003247 [debug] [MainThread]: Partial parsing: updated file: global_economic_tracker://models/analytics/stg_index_metrics.sql
[0m19:47:10.004048 [debug] [MainThread]: Partial parsing: updated file: global_economic_tracker://models/analytics/stg_commodity_metrics.sql
[0m19:47:10.270837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5f2c3118-4169-4379-b3af-d1f1d9106eed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4d6566290>]}
[0m19:47:10.325186 [debug] [MainThread]: Wrote artifact WritableManifest to /mnt/c/Users/joeyk/PycharmProjects/GlobalEconomicTracker/global_economic_tracker/target/manifest.json
[0m19:47:10.329218 [debug] [MainThread]: Wrote artifact SemanticManifest to /mnt/c/Users/joeyk/PycharmProjects/GlobalEconomicTracker/global_economic_tracker/target/semantic_manifest.json
[0m19:47:10.346199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f2c3118-4169-4379-b3af-d1f1d9106eed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4d821eda0>]}
[0m19:47:10.347029 [info ] [MainThread]: Found 4 models, 20 data tests, 549 macros
[0m19:47:10.348972 [info ] [MainThread]: 
[0m19:47:10.349680 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:47:10.350363 [info ] [MainThread]: 
[0m19:47:10.351197 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:47:10.354797 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m19:47:10.367438 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m19:47:10.368110 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m19:47:10.368751 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:47:10.372252 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.003 seconds
[0m19:47:10.373323 [debug] [ThreadPool]: On list_airflow: Close
[0m19:47:10.374619 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_public)
[0m19:47:10.377910 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m19:47:10.378618 [debug] [ThreadPool]: On list_airflow_public: BEGIN
[0m19:47:10.379373 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:47:10.381332 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m19:47:10.381996 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m19:47:10.382654 [debug] [ThreadPool]: On list_airflow_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:47:10.384407 [debug] [ThreadPool]: SQL status: SELECT 47 in 0.001 seconds
[0m19:47:10.385722 [debug] [ThreadPool]: On list_airflow_public: ROLLBACK
[0m19:47:10.386452 [debug] [ThreadPool]: On list_airflow_public: Close
[0m19:47:10.391419 [debug] [MainThread]: Using postgres connection "master"
[0m19:47:10.392073 [debug] [MainThread]: On master: BEGIN
[0m19:47:10.392723 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:47:10.394646 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m19:47:10.395323 [debug] [MainThread]: Using postgres connection "master"
[0m19:47:10.395983 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:47:10.398045 [debug] [MainThread]: SQL status: SELECT 0 in 0.001 seconds
[0m19:47:10.399022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f2c3118-4169-4379-b3af-d1f1d9106eed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4d9d2f490>]}
[0m19:47:10.399724 [debug] [MainThread]: On master: ROLLBACK
[0m19:47:10.400531 [debug] [MainThread]: Using postgres connection "master"
[0m19:47:10.401151 [debug] [MainThread]: On master: BEGIN
[0m19:47:10.402008 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m19:47:10.402593 [debug] [MainThread]: On master: COMMIT
[0m19:47:10.403154 [debug] [MainThread]: Using postgres connection "master"
[0m19:47:10.403703 [debug] [MainThread]: On master: COMMIT
[0m19:47:10.404349 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:47:10.404945 [debug] [MainThread]: On master: Close
[0m19:47:10.408843 [debug] [Thread-1 (]: Began running node model.global_economic_tracker.stg_commodity_returns
[0m19:47:10.409095 [debug] [Thread-2 (]: Began running node model.global_economic_tracker.stg_index_returns
[0m19:47:10.409725 [info ] [Thread-1 (]: 1 of 24 START sql table model public.stg_commodity_returns ..................... [RUN]
[0m19:47:10.410538 [info ] [Thread-2 (]: 2 of 24 START sql table model public.stg_index_returns ......................... [RUN]
[0m19:47:10.411372 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_public, now model.global_economic_tracker.stg_commodity_returns)
[0m19:47:10.412156 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.global_economic_tracker.stg_index_returns'
[0m19:47:10.412880 [debug] [Thread-1 (]: Began compiling node model.global_economic_tracker.stg_commodity_returns
[0m19:47:10.413598 [debug] [Thread-2 (]: Began compiling node model.global_economic_tracker.stg_index_returns
[0m19:47:10.417636 [debug] [Thread-1 (]: Writing injected SQL for node "model.global_economic_tracker.stg_commodity_returns"
[0m19:47:10.419629 [debug] [Thread-2 (]: Writing injected SQL for node "model.global_economic_tracker.stg_index_returns"
[0m19:47:10.423927 [debug] [Thread-1 (]: Began executing node model.global_economic_tracker.stg_commodity_returns
[0m19:47:10.430106 [debug] [Thread-2 (]: Began executing node model.global_economic_tracker.stg_index_returns
[0m19:47:10.443251 [debug] [Thread-1 (]: Writing runtime sql for node "model.global_economic_tracker.stg_commodity_returns"
[0m19:47:10.445574 [debug] [Thread-2 (]: Writing runtime sql for node "model.global_economic_tracker.stg_index_returns"
[0m19:47:10.449772 [debug] [Thread-1 (]: Using postgres connection "model.global_economic_tracker.stg_commodity_returns"
[0m19:47:10.450513 [debug] [Thread-1 (]: On model.global_economic_tracker.stg_commodity_returns: BEGIN
[0m19:47:10.450792 [debug] [Thread-2 (]: Using postgres connection "model.global_economic_tracker.stg_index_returns"
[0m19:47:10.451322 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:47:10.452041 [debug] [Thread-2 (]: On model.global_economic_tracker.stg_index_returns: BEGIN
[0m19:47:10.453292 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:47:10.454061 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m19:47:10.454734 [debug] [Thread-1 (]: Using postgres connection "model.global_economic_tracker.stg_commodity_returns"
[0m19:47:10.455401 [debug] [Thread-1 (]: On model.global_economic_tracker.stg_commodity_returns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_commodity_returns"} */

  
    

  create  table "airflow"."public"."stg_commodity_returns__dbt_tmp"
  
  
    as
  
  (
    

select
    'commodity' as type,
    ticker,
    timestamp,
    price,
    lag(price) over (partition by ticker order by timestamp) as prev_price,
    coalesce((price - lag(price) over (partition by ticker order by timestamp)) / lag(price) over (partition by ticker order by timestamp), 0) as daily_return
from public.commodity_prices
  );
  
[0m19:47:10.456027 [debug] [Thread-2 (]: SQL status: BEGIN in 0.003 seconds
[0m19:47:10.457054 [debug] [Thread-2 (]: Using postgres connection "model.global_economic_tracker.stg_index_returns"
[0m19:47:10.457900 [debug] [Thread-2 (]: On model.global_economic_tracker.stg_index_returns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_index_returns"} */

  
    

  create  table "airflow"."public"."stg_index_returns__dbt_tmp"
  
  
    as
  
  (
    

select
    'index' as type,
    country,
    ticker,
    timestamp,
    price,
    lag(price) over (partition by ticker order by timestamp) as prev_price,
    coalesce((price - lag(price) over (partition by ticker order by timestamp)) / lag(price) over (partition by ticker order by timestamp), 0) as daily_return
from public.index_prices
  );
  
[0m19:47:10.461976 [debug] [Thread-1 (]: SQL status: SELECT 517 in 0.005 seconds
[0m19:47:10.467179 [debug] [Thread-1 (]: Using postgres connection "model.global_economic_tracker.stg_commodity_returns"
[0m19:47:10.467410 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.009 seconds
[0m19:47:10.467979 [debug] [Thread-1 (]: On model.global_economic_tracker.stg_commodity_returns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_commodity_returns"} */
alter table "airflow"."public"."stg_commodity_returns" rename to "stg_commodity_returns__dbt_backup"
[0m19:47:10.470413 [debug] [Thread-2 (]: Using postgres connection "model.global_economic_tracker.stg_index_returns"
[0m19:47:10.471415 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:47:10.471802 [debug] [Thread-2 (]: On model.global_economic_tracker.stg_index_returns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_index_returns"} */
alter table "airflow"."public"."stg_index_returns" rename to "stg_index_returns__dbt_backup"
[0m19:47:10.473766 [debug] [Thread-1 (]: Using postgres connection "model.global_economic_tracker.stg_commodity_returns"
[0m19:47:10.474675 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:47:10.475215 [debug] [Thread-1 (]: On model.global_economic_tracker.stg_commodity_returns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_commodity_returns"} */
alter table "airflow"."public"."stg_commodity_returns__dbt_tmp" rename to "stg_commodity_returns"
[0m19:47:10.477499 [debug] [Thread-2 (]: Using postgres connection "model.global_economic_tracker.stg_index_returns"
[0m19:47:10.478400 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:47:10.478944 [debug] [Thread-2 (]: On model.global_economic_tracker.stg_index_returns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_index_returns"} */
alter table "airflow"."public"."stg_index_returns__dbt_tmp" rename to "stg_index_returns"
[0m19:47:10.480303 [debug] [Thread-1 (]: Using postgres connection "model.global_economic_tracker.stg_commodity_returns"
[0m19:47:10.481310 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:47:10.481855 [debug] [Thread-1 (]: On model.global_economic_tracker.stg_commodity_returns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_commodity_returns"} */

        CREATE INDEX IF NOT EXISTS idx_returns_ticker_ts ON "airflow"."public"."stg_commodity_returns"(ticker, timestamp)
      
[0m19:47:10.483153 [debug] [Thread-2 (]: Using postgres connection "model.global_economic_tracker.stg_index_returns"
[0m19:47:10.484420 [debug] [Thread-2 (]: On model.global_economic_tracker.stg_index_returns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_index_returns"} */

        CREATE INDEX IF NOT EXISTS idx_index_returns_ticker_ts ON "airflow"."public"."stg_index_returns"(ticker, timestamp)
      
[0m19:47:10.486370 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.002 seconds
[0m19:47:10.493017 [debug] [Thread-2 (]: SQL status: CREATE INDEX in 0.008 seconds
[0m19:47:10.494871 [debug] [Thread-1 (]: On model.global_economic_tracker.stg_commodity_returns: COMMIT
[0m19:47:10.496180 [debug] [Thread-2 (]: On model.global_economic_tracker.stg_index_returns: COMMIT
[0m19:47:10.496916 [debug] [Thread-1 (]: Using postgres connection "model.global_economic_tracker.stg_commodity_returns"
[0m19:47:10.497639 [debug] [Thread-2 (]: Using postgres connection "model.global_economic_tracker.stg_index_returns"
[0m19:47:10.498340 [debug] [Thread-1 (]: On model.global_economic_tracker.stg_commodity_returns: COMMIT
[0m19:47:10.499033 [debug] [Thread-2 (]: On model.global_economic_tracker.stg_index_returns: COMMIT
[0m19:47:10.502179 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m19:47:10.502856 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m19:47:10.505998 [debug] [Thread-1 (]: Applying DROP to: "airflow"."public"."stg_commodity_returns__dbt_backup"
[0m19:47:10.507784 [debug] [Thread-2 (]: Applying DROP to: "airflow"."public"."stg_index_returns__dbt_backup"
[0m19:47:10.510488 [debug] [Thread-1 (]: Using postgres connection "model.global_economic_tracker.stg_commodity_returns"
[0m19:47:10.511496 [debug] [Thread-2 (]: Using postgres connection "model.global_economic_tracker.stg_index_returns"
[0m19:47:10.512213 [debug] [Thread-1 (]: On model.global_economic_tracker.stg_commodity_returns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_commodity_returns"} */
drop table if exists "airflow"."public"."stg_commodity_returns__dbt_backup" cascade
[0m19:47:10.512924 [debug] [Thread-2 (]: On model.global_economic_tracker.stg_index_returns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_index_returns"} */
drop table if exists "airflow"."public"."stg_index_returns__dbt_backup" cascade
[0m19:47:10.515632 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m19:47:10.517368 [debug] [Thread-1 (]: On model.global_economic_tracker.stg_commodity_returns: Close
[0m19:47:10.517589 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.003 seconds
[0m19:47:10.519033 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f2c3118-4169-4379-b3af-d1f1d9106eed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb49ef4a080>]}
[0m19:47:10.519868 [debug] [Thread-2 (]: On model.global_economic_tracker.stg_index_returns: Close
[0m19:47:10.520889 [info ] [Thread-1 (]: 1 of 24 OK created sql table model public.stg_commodity_returns ................ [[32mSELECT 517[0m in 0.11s]
[0m19:47:10.521695 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f2c3118-4169-4379-b3af-d1f1d9106eed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb49eee4f70>]}
[0m19:47:10.522352 [debug] [Thread-1 (]: Finished running node model.global_economic_tracker.stg_commodity_returns
[0m19:47:10.523196 [info ] [Thread-2 (]: 2 of 24 OK created sql table model public.stg_index_returns .................... [[32mSELECT 0[0m in 0.11s]
[0m19:47:10.524263 [debug] [Thread-4 (]: Began running node test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe
[0m19:47:10.524513 [debug] [Thread-3 (]: Began running node test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934
[0m19:47:10.524789 [debug] [Thread-1 (]: Began running node test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d
[0m19:47:10.525103 [debug] [Thread-2 (]: Finished running node model.global_economic_tracker.stg_index_returns
[0m19:47:10.525811 [info ] [Thread-4 (]: 3 of 24 START test dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5  [RUN]
[0m19:47:10.526504 [info ] [Thread-3 (]: 4 of 24 START test not_null_stg_commodity_returns_daily_return ................. [RUN]
[0m19:47:10.527310 [info ] [Thread-1 (]: 5 of 24 START test not_null_stg_commodity_returns_ticker ....................... [RUN]
[0m19:47:10.528004 [debug] [Thread-2 (]: Began running node test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359
[0m19:47:10.528848 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe'
[0m19:47:10.529606 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934'
[0m19:47:10.530321 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.global_economic_tracker.stg_commodity_returns, now test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d)
[0m19:47:10.531042 [info ] [Thread-2 (]: 6 of 24 START test not_null_stg_commodity_returns_timestamp .................... [RUN]
[0m19:47:10.531738 [debug] [Thread-4 (]: Began compiling node test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe
[0m19:47:10.532442 [debug] [Thread-3 (]: Began compiling node test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934
[0m19:47:10.533133 [debug] [Thread-1 (]: Began compiling node test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d
[0m19:47:10.533799 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.global_economic_tracker.stg_index_returns, now test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359)
[0m19:47:10.536513 [debug] [Thread-4 (]: Writing injected SQL for node "test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe"
[0m19:47:10.541543 [debug] [Thread-3 (]: Writing injected SQL for node "test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934"
[0m19:47:10.543882 [debug] [Thread-1 (]: Writing injected SQL for node "test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d"
[0m19:47:10.544539 [debug] [Thread-2 (]: Began compiling node test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359
[0m19:47:10.548444 [debug] [Thread-2 (]: Writing injected SQL for node "test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359"
[0m19:47:10.551220 [debug] [Thread-1 (]: Began executing node test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d
[0m19:47:10.551808 [debug] [Thread-4 (]: Began executing node test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe
[0m19:47:10.557401 [debug] [Thread-3 (]: Began executing node test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934
[0m19:47:10.558809 [debug] [Thread-1 (]: Writing runtime sql for node "test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d"
[0m19:47:10.560258 [debug] [Thread-4 (]: Writing runtime sql for node "test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe"
[0m19:47:10.560553 [debug] [Thread-2 (]: Began executing node test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359
[0m19:47:10.562028 [debug] [Thread-3 (]: Writing runtime sql for node "test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934"
[0m19:47:10.565061 [debug] [Thread-2 (]: Writing runtime sql for node "test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359"
[0m19:47:10.568906 [debug] [Thread-4 (]: Using postgres connection "test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe"
[0m19:47:10.569489 [debug] [Thread-1 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d"
[0m19:47:10.570036 [debug] [Thread-4 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe: BEGIN
[0m19:47:10.570340 [debug] [Thread-3 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934"
[0m19:47:10.570933 [debug] [Thread-1 (]: On test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d: BEGIN
[0m19:47:10.571200 [debug] [Thread-2 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359"
[0m19:47:10.571726 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:47:10.572427 [debug] [Thread-3 (]: On test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934: BEGIN
[0m19:47:10.573145 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:47:10.573899 [debug] [Thread-2 (]: On test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359: BEGIN
[0m19:47:10.575166 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:47:10.576120 [debug] [Thread-4 (]: SQL status: BEGIN in 0.004 seconds
[0m19:47:10.576837 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:47:10.577320 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m19:47:10.578450 [debug] [Thread-4 (]: Using postgres connection "test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe"
[0m19:47:10.579004 [debug] [Thread-3 (]: SQL status: BEGIN in 0.004 seconds
[0m19:47:10.579958 [debug] [Thread-1 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d"
[0m19:47:10.580707 [debug] [Thread-2 (]: SQL status: BEGIN in 0.004 seconds
[0m19:47:10.580967 [debug] [Thread-4 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with meet_condition as(
  select *
  from "airflow"."public"."stg_commodity_returns"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not daily_return >= -0.5
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not daily_return <= 0.5
)

select *
from validation_errors


      
    ) dbt_internal_test
[0m19:47:10.581701 [debug] [Thread-3 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934"
[0m19:47:10.582426 [debug] [Thread-1 (]: On test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select ticker
from "airflow"."public"."stg_commodity_returns"
where ticker is null



      
    ) dbt_internal_test
[0m19:47:10.583133 [debug] [Thread-2 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359"
[0m19:47:10.584400 [debug] [Thread-3 (]: On test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select daily_return
from "airflow"."public"."stg_commodity_returns"
where daily_return is null



      
    ) dbt_internal_test
[0m19:47:10.584735 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m19:47:10.585833 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.000 seconds
[0m19:47:10.586211 [debug] [Thread-2 (]: On test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select timestamp
from "airflow"."public"."stg_commodity_returns"
where timestamp is null



      
    ) dbt_internal_test
[0m19:47:10.587243 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.000 seconds
[0m19:47:10.589000 [debug] [Thread-4 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe: ROLLBACK
[0m19:47:10.590265 [debug] [Thread-1 (]: On test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d: ROLLBACK
[0m19:47:10.591342 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.000 seconds
[0m19:47:10.592134 [debug] [Thread-3 (]: On test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934: ROLLBACK
[0m19:47:10.592940 [debug] [Thread-4 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe: Close
[0m19:47:10.593577 [debug] [Thread-1 (]: On test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d: Close
[0m19:47:10.594517 [debug] [Thread-2 (]: On test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359: ROLLBACK
[0m19:47:10.595409 [debug] [Thread-3 (]: On test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934: Close
[0m19:47:10.596236 [info ] [Thread-4 (]: 3 of 24 PASS dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5  [[32mPASS[0m in 0.07s]
[0m19:47:10.597031 [info ] [Thread-1 (]: 5 of 24 PASS not_null_stg_commodity_returns_ticker ............................. [[32mPASS[0m in 0.07s]
[0m19:47:10.597665 [debug] [Thread-2 (]: On test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359: Close
[0m19:47:10.598354 [info ] [Thread-3 (]: 4 of 24 PASS not_null_stg_commodity_returns_daily_return ....................... [[32mPASS[0m in 0.07s]
[0m19:47:10.598940 [debug] [Thread-4 (]: Finished running node test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe
[0m19:47:10.599705 [debug] [Thread-1 (]: Finished running node test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d
[0m19:47:10.600556 [info ] [Thread-2 (]: 6 of 24 PASS not_null_stg_commodity_returns_timestamp .......................... [[32mPASS[0m in 0.07s]
[0m19:47:10.601215 [debug] [Thread-3 (]: Finished running node test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934
[0m19:47:10.602082 [debug] [Thread-4 (]: Began running node test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713
[0m19:47:10.602840 [debug] [Thread-1 (]: Began running node test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8
[0m19:47:10.603641 [debug] [Thread-2 (]: Finished running node test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359
[0m19:47:10.604363 [debug] [Thread-3 (]: Began running node test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0
[0m19:47:10.605094 [info ] [Thread-4 (]: 7 of 24 START test dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5  [RUN]
[0m19:47:10.605964 [info ] [Thread-1 (]: 8 of 24 START test not_null_stg_index_returns_daily_return ..................... [RUN]
[0m19:47:10.606692 [debug] [Thread-2 (]: Began running node test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17
[0m19:47:10.607469 [info ] [Thread-3 (]: 9 of 24 START test not_null_stg_index_returns_ticker ........................... [RUN]
[0m19:47:10.608243 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe, now test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713)
[0m19:47:10.608977 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d, now test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8)
[0m19:47:10.609833 [info ] [Thread-2 (]: 10 of 24 START test not_null_stg_index_returns_timestamp ....................... [RUN]
[0m19:47:10.610593 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934, now test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0)
[0m19:47:10.611311 [debug] [Thread-4 (]: Began compiling node test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713
[0m19:47:10.612011 [debug] [Thread-1 (]: Began compiling node test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8
[0m19:47:10.612730 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359, now test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17)
[0m19:47:10.613481 [debug] [Thread-3 (]: Began compiling node test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0
[0m19:47:10.616097 [debug] [Thread-4 (]: Writing injected SQL for node "test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713"
[0m19:47:10.618652 [debug] [Thread-1 (]: Writing injected SQL for node "test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8"
[0m19:47:10.619417 [debug] [Thread-2 (]: Began compiling node test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17
[0m19:47:10.622139 [debug] [Thread-3 (]: Writing injected SQL for node "test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0"
[0m19:47:10.625782 [debug] [Thread-2 (]: Writing injected SQL for node "test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17"
[0m19:47:10.629980 [debug] [Thread-1 (]: Began executing node test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8
[0m19:47:10.630590 [debug] [Thread-4 (]: Began executing node test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713
[0m19:47:10.630879 [debug] [Thread-2 (]: Began executing node test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17
[0m19:47:10.632249 [debug] [Thread-1 (]: Writing runtime sql for node "test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8"
[0m19:47:10.632507 [debug] [Thread-3 (]: Began executing node test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0
[0m19:47:10.634317 [debug] [Thread-4 (]: Writing runtime sql for node "test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713"
[0m19:47:10.636066 [debug] [Thread-2 (]: Writing runtime sql for node "test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17"
[0m19:47:10.638210 [debug] [Thread-3 (]: Writing runtime sql for node "test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0"
[0m19:47:10.641554 [debug] [Thread-1 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8"
[0m19:47:10.642215 [debug] [Thread-4 (]: Using postgres connection "test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713"
[0m19:47:10.642553 [debug] [Thread-1 (]: On test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8: BEGIN
[0m19:47:10.642999 [debug] [Thread-2 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17"
[0m19:47:10.643555 [debug] [Thread-4 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713: BEGIN
[0m19:47:10.643843 [debug] [Thread-3 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0"
[0m19:47:10.644376 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:47:10.645069 [debug] [Thread-2 (]: On test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17: BEGIN
[0m19:47:10.645756 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:47:10.646442 [debug] [Thread-3 (]: On test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0: BEGIN
[0m19:47:10.647707 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:47:10.648538 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m19:47:10.649081 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:47:10.649678 [debug] [Thread-4 (]: SQL status: BEGIN in 0.004 seconds
[0m19:47:10.650534 [debug] [Thread-1 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8"
[0m19:47:10.651711 [debug] [Thread-2 (]: SQL status: BEGIN in 0.004 seconds
[0m19:47:10.652101 [debug] [Thread-4 (]: Using postgres connection "test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713"
[0m19:47:10.652683 [debug] [Thread-3 (]: SQL status: BEGIN in 0.004 seconds
[0m19:47:10.653079 [debug] [Thread-1 (]: On test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select daily_return
from "airflow"."public"."stg_index_returns"
where daily_return is null



      
    ) dbt_internal_test
[0m19:47:10.653764 [debug] [Thread-2 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17"
[0m19:47:10.654531 [debug] [Thread-4 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with meet_condition as(
  select *
  from "airflow"."public"."stg_index_returns"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not daily_return >= -0.5
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not daily_return <= 0.5
)

select *
from validation_errors


      
    ) dbt_internal_test
[0m19:47:10.655250 [debug] [Thread-3 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0"
[0m19:47:10.656297 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.000 seconds
[0m19:47:10.656674 [debug] [Thread-2 (]: On test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select timestamp
from "airflow"."public"."stg_index_returns"
where timestamp is null



      
    ) dbt_internal_test
[0m19:47:10.657889 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m19:47:10.658125 [debug] [Thread-3 (]: On test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select ticker
from "airflow"."public"."stg_index_returns"
where ticker is null



      
    ) dbt_internal_test
[0m19:47:10.659281 [debug] [Thread-1 (]: On test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8: ROLLBACK
[0m19:47:10.660471 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.000 seconds
[0m19:47:10.661119 [debug] [Thread-4 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713: ROLLBACK
[0m19:47:10.662150 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.000 seconds
[0m19:47:10.662619 [debug] [Thread-1 (]: On test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8: Close
[0m19:47:10.663545 [debug] [Thread-2 (]: On test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17: ROLLBACK
[0m19:47:10.664330 [debug] [Thread-4 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713: Close
[0m19:47:10.665334 [debug] [Thread-3 (]: On test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0: ROLLBACK
[0m19:47:10.666243 [info ] [Thread-1 (]: 8 of 24 PASS not_null_stg_index_returns_daily_return ........................... [[32mPASS[0m in 0.06s]
[0m19:47:10.666858 [debug] [Thread-2 (]: On test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17: Close
[0m19:47:10.667528 [info ] [Thread-4 (]: 7 of 24 PASS dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5  [[32mPASS[0m in 0.06s]
[0m19:47:10.668168 [debug] [Thread-3 (]: On test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0: Close
[0m19:47:10.668784 [debug] [Thread-1 (]: Finished running node test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8
[0m19:47:10.669614 [info ] [Thread-2 (]: 10 of 24 PASS not_null_stg_index_returns_timestamp ............................. [[32mPASS[0m in 0.06s]
[0m19:47:10.670204 [debug] [Thread-4 (]: Finished running node test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713
[0m19:47:10.671063 [info ] [Thread-3 (]: 9 of 24 PASS not_null_stg_index_returns_ticker ................................. [[32mPASS[0m in 0.06s]
[0m19:47:10.671621 [debug] [Thread-1 (]: Began running node model.global_economic_tracker.stg_commodity_metrics
[0m19:47:10.672433 [debug] [Thread-2 (]: Finished running node test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17
[0m19:47:10.673758 [debug] [Thread-3 (]: Finished running node test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0
[0m19:47:10.674522 [info ] [Thread-1 (]: 11 of 24 START sql table model public.stg_commodity_metrics .................... [RUN]
[0m19:47:10.675987 [debug] [Thread-4 (]: Began running node model.global_economic_tracker.stg_index_metrics
[0m19:47:10.676656 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8, now model.global_economic_tracker.stg_commodity_metrics)
[0m19:47:10.677472 [info ] [Thread-4 (]: 12 of 24 START sql table model public.stg_index_metrics ........................ [RUN]
[0m19:47:10.678162 [debug] [Thread-1 (]: Began compiling node model.global_economic_tracker.stg_commodity_metrics
[0m19:47:10.678892 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713, now model.global_economic_tracker.stg_index_metrics)
[0m19:47:10.681014 [debug] [Thread-1 (]: Writing injected SQL for node "model.global_economic_tracker.stg_commodity_metrics"
[0m19:47:10.681727 [debug] [Thread-4 (]: Began compiling node model.global_economic_tracker.stg_index_metrics
[0m19:47:10.684237 [debug] [Thread-4 (]: Writing injected SQL for node "model.global_economic_tracker.stg_index_metrics"
[0m19:47:10.687737 [debug] [Thread-1 (]: Began executing node model.global_economic_tracker.stg_commodity_metrics
[0m19:47:10.688606 [debug] [Thread-4 (]: Began executing node model.global_economic_tracker.stg_index_metrics
[0m19:47:10.690741 [debug] [Thread-1 (]: Writing runtime sql for node "model.global_economic_tracker.stg_commodity_metrics"
[0m19:47:10.721872 [debug] [Thread-4 (]: Writing runtime sql for node "model.global_economic_tracker.stg_index_metrics"
[0m19:47:10.726010 [debug] [Thread-1 (]: Using postgres connection "model.global_economic_tracker.stg_commodity_metrics"
[0m19:47:10.726819 [debug] [Thread-4 (]: Using postgres connection "model.global_economic_tracker.stg_index_metrics"
[0m19:47:10.727065 [debug] [Thread-1 (]: On model.global_economic_tracker.stg_commodity_metrics: BEGIN
[0m19:47:10.727792 [debug] [Thread-4 (]: On model.global_economic_tracker.stg_index_metrics: BEGIN
[0m19:47:10.728494 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:47:10.729191 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:47:10.731549 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m19:47:10.732008 [debug] [Thread-4 (]: SQL status: BEGIN in 0.003 seconds
[0m19:47:10.732407 [debug] [Thread-1 (]: Using postgres connection "model.global_economic_tracker.stg_commodity_metrics"
[0m19:47:10.733111 [debug] [Thread-4 (]: Using postgres connection "model.global_economic_tracker.stg_index_metrics"
[0m19:47:10.733978 [debug] [Thread-1 (]: On model.global_economic_tracker.stg_commodity_metrics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_commodity_metrics"} */

  
    

  create  table "airflow"."public"."stg_commodity_metrics__dbt_tmp"
  
  
    as
  
  (
    

with base as (
    select
        *,
        row_number() over (partition by ticker order by timestamp) as rn
    from "airflow"."public"."stg_commodity_returns"
),

rolling as (
    select
        ticker,
        timestamp,
        avg(daily_return) over (
            partition by ticker
            order by rn
            rows between 19 preceding and current row
        ) as rolling_avg_mo,

        avg(daily_return) OVER (
            partition by ticker
            order by timestamp
            rows between 6 preceding and current row
        ) as weekly_avg_return,

        stddev(daily_return) over (
            partition by ticker
            order by rn
            rows between 19 preceding and current row
        ) as rolling_volatility_mo,

        case
            when daily_return > 0 then 'up'
            when daily_return < 0 then 'down'
            else 'flat'
        end as trend,

        daily_return

    from base
)

select
    *,
    rolling_avg_mo / nullif(rolling_volatility_mo, 0) as sharpe_mo,
    (daily_return - rolling_avg_mo) / nullif(rolling_volatility_mo, 0) as z_score_mo
from rolling
where rolling_avg_mo is not null
  );
  
[0m19:47:10.734792 [debug] [Thread-4 (]: On model.global_economic_tracker.stg_index_metrics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_index_metrics"} */

  
    

  create  table "airflow"."public"."stg_index_metrics__dbt_tmp"
  
  
    as
  
  (
    

with base as (
    select
        *,
        row_number() over (partition by ticker order by timestamp) as rn
    from "airflow"."public"."stg_index_returns"
),

rolling as (
    select
        ticker,
        timestamp,
        avg(daily_return) over (
            partition by ticker
            order by rn
            rows between 19 preceding and current row
        ) as rolling_avg_mo,

        avg(daily_return) OVER (
            partition by ticker
            order by timestamp
            rows between 6 preceding and current row
        ) as weekly_avg_return,

        stddev(daily_return) over (
            partition by ticker
            order by rn
            rows between 19 preceding and current row
        ) as rolling_volatility_mo,

        case
            when daily_return > 0 then 'up'
            when daily_return < 0 then 'down'
            else 'flat'
        end as trend,

        daily_return

    from base
)

select
    *,
    rolling_avg_mo / nullif(rolling_volatility_mo, 0) as sharpe_mo,
    (daily_return - rolling_avg_mo) / nullif(rolling_volatility_mo, 0) as z_score_mo
from rolling
where rolling_avg_mo is not null
  );
  
[0m19:47:10.742424 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.006 seconds
[0m19:47:10.744545 [debug] [Thread-4 (]: Using postgres connection "model.global_economic_tracker.stg_index_metrics"
[0m19:47:10.745037 [debug] [Thread-1 (]: SQL status: SELECT 517 in 0.009 seconds
[0m19:47:10.745779 [debug] [Thread-4 (]: On model.global_economic_tracker.stg_index_metrics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_index_metrics"} */
alter table "airflow"."public"."stg_index_metrics__dbt_tmp" rename to "stg_index_metrics"
[0m19:47:10.747775 [debug] [Thread-1 (]: Using postgres connection "model.global_economic_tracker.stg_commodity_metrics"
[0m19:47:10.748650 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:47:10.749193 [debug] [Thread-1 (]: On model.global_economic_tracker.stg_commodity_metrics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_commodity_metrics"} */
alter table "airflow"."public"."stg_commodity_metrics__dbt_tmp" rename to "stg_commodity_metrics"
[0m19:47:10.750614 [debug] [Thread-4 (]: Using postgres connection "model.global_economic_tracker.stg_index_metrics"
[0m19:47:10.751534 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:47:10.752116 [debug] [Thread-4 (]: On model.global_economic_tracker.stg_index_metrics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_index_metrics"} */

        CREATE INDEX IF NOT EXISTS idx_rolling_ticker_ts ON "airflow"."public"."stg_index_metrics"(ticker, timestamp)
      
[0m19:47:10.753429 [debug] [Thread-1 (]: Using postgres connection "model.global_economic_tracker.stg_commodity_metrics"
[0m19:47:10.754715 [debug] [Thread-1 (]: On model.global_economic_tracker.stg_commodity_metrics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_commodity_metrics"} */

        CREATE INDEX IF NOT EXISTS idx_rolling_ticker_ts ON "airflow"."public"."stg_commodity_metrics"(ticker, timestamp)
      
[0m19:47:10.756505 [debug] [Thread-4 (]: SQL status: CREATE INDEX in 0.002 seconds
[0m19:47:10.757701 [debug] [Thread-4 (]: On model.global_economic_tracker.stg_index_metrics: COMMIT
[0m19:47:10.758415 [debug] [Thread-4 (]: Using postgres connection "model.global_economic_tracker.stg_index_metrics"
[0m19:47:10.759076 [debug] [Thread-4 (]: On model.global_economic_tracker.stg_index_metrics: COMMIT
[0m19:47:10.761252 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m19:47:10.761912 [debug] [Thread-1 (]: Postgres adapter: Postgres error: duplicate key value violates unique constraint "pg_class_relname_nsp_index"
DETAIL:  Key (relname, relnamespace)=(idx_rolling_ticker_ts, 2200) already exists.

[0m19:47:10.763116 [debug] [Thread-4 (]: Applying DROP to: "airflow"."public"."stg_index_metrics__dbt_backup"
[0m19:47:10.763816 [debug] [Thread-1 (]: On model.global_economic_tracker.stg_commodity_metrics: ROLLBACK
[0m19:47:10.764694 [debug] [Thread-4 (]: Using postgres connection "model.global_economic_tracker.stg_index_metrics"
[0m19:47:10.765532 [debug] [Thread-1 (]: On model.global_economic_tracker.stg_commodity_metrics: Close
[0m19:47:10.766065 [debug] [Thread-4 (]: On model.global_economic_tracker.stg_index_metrics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_index_metrics"} */
drop table if exists "airflow"."public"."stg_index_metrics__dbt_backup" cascade
[0m19:47:10.767893 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.000 seconds
[0m19:47:10.768324 [debug] [Thread-1 (]: Database Error in model stg_commodity_metrics (models/analytics/stg_commodity_metrics.sql)
  duplicate key value violates unique constraint "pg_class_relname_nsp_index"
  DETAIL:  Key (relname, relnamespace)=(idx_rolling_ticker_ts, 2200) already exists.
  compiled code at target/run/global_economic_tracker/models/analytics/stg_commodity_metrics.sql
[0m19:47:10.769417 [debug] [Thread-4 (]: On model.global_economic_tracker.stg_index_metrics: Close
[0m19:47:10.770223 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f2c3118-4169-4379-b3af-d1f1d9106eed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4d9d63b20>]}
[0m19:47:10.771096 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f2c3118-4169-4379-b3af-d1f1d9106eed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb49ef4a9b0>]}
[0m19:47:10.771840 [error] [Thread-1 (]: 11 of 24 ERROR creating sql table model public.stg_commodity_metrics ........... [[31mERROR[0m in 0.09s]
[0m19:47:10.772734 [info ] [Thread-4 (]: 12 of 24 OK created sql table model public.stg_index_metrics ................... [[32mSELECT 0[0m in 0.09s]
[0m19:47:10.773502 [debug] [Thread-1 (]: Finished running node model.global_economic_tracker.stg_commodity_metrics
[0m19:47:10.774288 [debug] [Thread-4 (]: Finished running node model.global_economic_tracker.stg_index_metrics
[0m19:47:10.775155 [debug] [Thread-7 (]: Marking all children of 'model.global_economic_tracker.stg_commodity_metrics' to be skipped because of status 'error'.  Reason: Database Error in model stg_commodity_metrics (models/analytics/stg_commodity_metrics.sql)
  duplicate key value violates unique constraint "pg_class_relname_nsp_index"
  DETAIL:  Key (relname, relnamespace)=(idx_rolling_ticker_ts, 2200) already exists.
  compiled code at target/run/global_economic_tracker/models/analytics/stg_commodity_metrics.sql.
[0m19:47:10.776851 [debug] [Thread-3 (]: Began running node test.global_economic_tracker.accepted_values_stg_commodity_metrics_trend__up__down__flat.70479897b5
[0m19:47:10.777102 [debug] [Thread-2 (]: Began running node test.global_economic_tracker.accepted_values_stg_index_metrics_trend__up__down__flat.1fea418295
[0m19:47:10.777355 [debug] [Thread-1 (]: Began running node test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_daily_return__0_5___0_5.2c4246e1e4
[0m19:47:10.777610 [debug] [Thread-4 (]: Began running node test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_rolling_avg__0_3___0_3.a261930571
[0m19:47:10.778008 [info ] [Thread-3 (]: 13 of 24 SKIP test accepted_values_stg_commodity_metrics_trend__up__down__flat . [[33mSKIP[0m]
[0m19:47:10.778712 [info ] [Thread-2 (]: 14 of 24 START test accepted_values_stg_index_metrics_trend__up__down__flat .... [RUN]
[0m19:47:10.779406 [info ] [Thread-1 (]: 15 of 24 SKIP test dbt_utils_accepted_range_stg_commodity_metrics_daily_return__0_5___0_5  [[33mSKIP[0m]
[0m19:47:10.780140 [info ] [Thread-4 (]: 16 of 24 SKIP test dbt_utils_accepted_range_stg_commodity_metrics_rolling_avg__0_3___0_3  [[33mSKIP[0m]
[0m19:47:10.780909 [debug] [Thread-3 (]: Finished running node test.global_economic_tracker.accepted_values_stg_commodity_metrics_trend__up__down__flat.70479897b5
[0m19:47:10.781663 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17, now test.global_economic_tracker.accepted_values_stg_index_metrics_trend__up__down__flat.1fea418295)
[0m19:47:10.782382 [debug] [Thread-1 (]: Finished running node test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_daily_return__0_5___0_5.2c4246e1e4
[0m19:47:10.783115 [debug] [Thread-4 (]: Finished running node test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_rolling_avg__0_3___0_3.a261930571
[0m19:47:10.783850 [debug] [Thread-3 (]: Began running node test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_daily_return__0_5___0_5.6e9f33b0a2
[0m19:47:10.784084 [debug] [Thread-7 (]: Marking all children of 'test.global_economic_tracker.accepted_values_stg_commodity_metrics_trend__up__down__flat.70479897b5' to be skipped because of status 'skipped'. 
[0m19:47:10.784648 [debug] [Thread-2 (]: Began compiling node test.global_economic_tracker.accepted_values_stg_index_metrics_trend__up__down__flat.1fea418295
[0m19:47:10.785378 [debug] [Thread-1 (]: Began running node test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_rolling_avg__0_3___0_3.c2bd8acf6b
[0m19:47:10.786091 [debug] [Thread-4 (]: Began running node test.global_economic_tracker.not_null_stg_commodity_metrics_daily_return.74b14cc336
[0m19:47:10.786799 [info ] [Thread-3 (]: 17 of 24 START test dbt_utils_accepted_range_stg_index_metrics_daily_return__0_5___0_5  [RUN]
[0m19:47:10.787435 [debug] [Thread-7 (]: Marking all children of 'test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_daily_return__0_5___0_5.2c4246e1e4' to be skipped because of status 'skipped'. 
[0m19:47:10.789961 [debug] [Thread-2 (]: Writing injected SQL for node "test.global_economic_tracker.accepted_values_stg_index_metrics_trend__up__down__flat.1fea418295"
[0m19:47:10.790756 [info ] [Thread-1 (]: 18 of 24 START test dbt_utils_accepted_range_stg_index_metrics_rolling_avg__0_3___0_3  [RUN]
[0m19:47:10.791585 [info ] [Thread-4 (]: 19 of 24 SKIP test not_null_stg_commodity_metrics_daily_return ................. [[33mSKIP[0m]
[0m19:47:10.792309 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0, now test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_daily_return__0_5___0_5.6e9f33b0a2)
[0m19:47:10.792983 [debug] [Thread-7 (]: Marking all children of 'test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_rolling_avg__0_3___0_3.a261930571' to be skipped because of status 'skipped'. 
[0m19:47:10.794256 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.global_economic_tracker.stg_commodity_metrics, now test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_rolling_avg__0_3___0_3.c2bd8acf6b)
[0m19:47:10.794985 [debug] [Thread-4 (]: Finished running node test.global_economic_tracker.not_null_stg_commodity_metrics_daily_return.74b14cc336
[0m19:47:10.795691 [debug] [Thread-3 (]: Began compiling node test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_daily_return__0_5___0_5.6e9f33b0a2
[0m19:47:10.796811 [debug] [Thread-1 (]: Began compiling node test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_rolling_avg__0_3___0_3.c2bd8acf6b
[0m19:47:10.797575 [debug] [Thread-4 (]: Began running node test.global_economic_tracker.not_null_stg_commodity_metrics_ticker.6d1d8d12d7
[0m19:47:10.797808 [debug] [Thread-7 (]: Marking all children of 'test.global_economic_tracker.not_null_stg_commodity_metrics_daily_return.74b14cc336' to be skipped because of status 'skipped'. 
[0m19:47:10.800212 [debug] [Thread-3 (]: Writing injected SQL for node "test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_daily_return__0_5___0_5.6e9f33b0a2"
[0m19:47:10.803488 [debug] [Thread-1 (]: Writing injected SQL for node "test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_rolling_avg__0_3___0_3.c2bd8acf6b"
[0m19:47:10.804309 [info ] [Thread-4 (]: 20 of 24 SKIP test not_null_stg_commodity_metrics_ticker ....................... [[33mSKIP[0m]
[0m19:47:10.804966 [debug] [Thread-2 (]: Began executing node test.global_economic_tracker.accepted_values_stg_index_metrics_trend__up__down__flat.1fea418295
[0m19:47:10.806853 [debug] [Thread-4 (]: Finished running node test.global_economic_tracker.not_null_stg_commodity_metrics_ticker.6d1d8d12d7
[0m19:47:10.808483 [debug] [Thread-2 (]: Writing runtime sql for node "test.global_economic_tracker.accepted_values_stg_index_metrics_trend__up__down__flat.1fea418295"
[0m19:47:10.809325 [debug] [Thread-4 (]: Began running node test.global_economic_tracker.not_null_stg_commodity_metrics_timestamp.5651d4b196
[0m19:47:10.809564 [debug] [Thread-7 (]: Marking all children of 'test.global_economic_tracker.not_null_stg_commodity_metrics_ticker.6d1d8d12d7' to be skipped because of status 'skipped'. 
[0m19:47:10.810754 [info ] [Thread-4 (]: 21 of 24 SKIP test not_null_stg_commodity_metrics_timestamp .................... [[33mSKIP[0m]
[0m19:47:10.812166 [debug] [Thread-4 (]: Finished running node test.global_economic_tracker.not_null_stg_commodity_metrics_timestamp.5651d4b196
[0m19:47:10.812791 [debug] [Thread-3 (]: Began executing node test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_daily_return__0_5___0_5.6e9f33b0a2
[0m19:47:10.813078 [debug] [Thread-4 (]: Began running node test.global_economic_tracker.not_null_stg_index_metrics_daily_return.26f4856193
[0m19:47:10.813350 [debug] [Thread-7 (]: Marking all children of 'test.global_economic_tracker.not_null_stg_commodity_metrics_timestamp.5651d4b196' to be skipped because of status 'skipped'. 
[0m19:47:10.815054 [debug] [Thread-3 (]: Writing runtime sql for node "test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_daily_return__0_5___0_5.6e9f33b0a2"
[0m19:47:10.815322 [debug] [Thread-1 (]: Began executing node test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_rolling_avg__0_3___0_3.c2bd8acf6b
[0m19:47:10.815879 [info ] [Thread-4 (]: 22 of 24 START test not_null_stg_index_metrics_daily_return .................... [RUN]
[0m19:47:10.818787 [debug] [Thread-1 (]: Writing runtime sql for node "test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_rolling_avg__0_3___0_3.c2bd8acf6b"
[0m19:47:10.819548 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.global_economic_tracker.stg_index_metrics, now test.global_economic_tracker.not_null_stg_index_metrics_daily_return.26f4856193)
[0m19:47:10.820516 [debug] [Thread-2 (]: Using postgres connection "test.global_economic_tracker.accepted_values_stg_index_metrics_trend__up__down__flat.1fea418295"
[0m19:47:10.821187 [debug] [Thread-4 (]: Began compiling node test.global_economic_tracker.not_null_stg_index_metrics_daily_return.26f4856193
[0m19:47:10.821478 [debug] [Thread-3 (]: Using postgres connection "test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_daily_return__0_5___0_5.6e9f33b0a2"
[0m19:47:10.822047 [debug] [Thread-2 (]: On test.global_economic_tracker.accepted_values_stg_index_metrics_trend__up__down__flat.1fea418295: BEGIN
[0m19:47:10.824561 [debug] [Thread-4 (]: Writing injected SQL for node "test.global_economic_tracker.not_null_stg_index_metrics_daily_return.26f4856193"
[0m19:47:10.824846 [debug] [Thread-1 (]: Using postgres connection "test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_rolling_avg__0_3___0_3.c2bd8acf6b"
[0m19:47:10.825395 [debug] [Thread-3 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_daily_return__0_5___0_5.6e9f33b0a2: BEGIN
[0m19:47:10.826246 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:47:10.827502 [debug] [Thread-1 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_rolling_avg__0_3___0_3.c2bd8acf6b: BEGIN
[0m19:47:10.828217 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:47:10.829592 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:47:10.830408 [debug] [Thread-2 (]: SQL status: BEGIN in 0.004 seconds
[0m19:47:10.831641 [debug] [Thread-2 (]: Using postgres connection "test.global_economic_tracker.accepted_values_stg_index_metrics_trend__up__down__flat.1fea418295"
[0m19:47:10.831874 [debug] [Thread-3 (]: SQL status: BEGIN in 0.004 seconds
[0m19:47:10.832368 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m19:47:10.832637 [debug] [Thread-2 (]: On test.global_economic_tracker.accepted_values_stg_index_metrics_trend__up__down__flat.1fea418295: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.accepted_values_stg_index_metrics_trend__up__down__flat.1fea418295"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        trend as value_field,
        count(*) as n_records

    from "airflow"."public"."stg_index_metrics"
    group by trend

)

select *
from all_values
where value_field not in (
    'up','down','flat'
)



      
    ) dbt_internal_test
[0m19:47:10.833368 [debug] [Thread-3 (]: Using postgres connection "test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_daily_return__0_5___0_5.6e9f33b0a2"
[0m19:47:10.834176 [debug] [Thread-1 (]: Using postgres connection "test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_rolling_avg__0_3___0_3.c2bd8acf6b"
[0m19:47:10.834518 [debug] [Thread-4 (]: Began executing node test.global_economic_tracker.not_null_stg_index_metrics_daily_return.26f4856193
[0m19:47:10.835602 [debug] [Thread-3 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_daily_return__0_5___0_5.6e9f33b0a2: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_daily_return__0_5___0_5.6e9f33b0a2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with meet_condition as(
  select *
  from "airflow"."public"."stg_index_metrics"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not daily_return >= -0.5
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not daily_return <= 0.5
)

select *
from validation_errors


      
    ) dbt_internal_test
[0m19:47:10.835874 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m19:47:10.836428 [debug] [Thread-1 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_rolling_avg__0_3___0_3.c2bd8acf6b: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_rolling_avg__0_3___0_3.c2bd8acf6b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with meet_condition as(
  select *
  from "airflow"."public"."stg_index_metrics"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not rolling_avg >= -0.3
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not rolling_avg <= 0.3
)

select *
from validation_errors


      
    ) dbt_internal_test
[0m19:47:10.838209 [debug] [Thread-4 (]: Writing runtime sql for node "test.global_economic_tracker.not_null_stg_index_metrics_daily_return.26f4856193"
[0m19:47:10.839989 [debug] [Thread-2 (]: On test.global_economic_tracker.accepted_values_stg_index_metrics_trend__up__down__flat.1fea418295: ROLLBACK
[0m19:47:10.840247 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m19:47:10.841071 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "rolling_avg" does not exist
LINE 21:     or not rolling_avg >= -0.3
                    ^
HINT:  Perhaps you meant to reference the column "meet_condition.rolling_avg_mo".

[0m19:47:10.842080 [debug] [Thread-2 (]: On test.global_economic_tracker.accepted_values_stg_index_metrics_trend__up__down__flat.1fea418295: Close
[0m19:47:10.843052 [debug] [Thread-3 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_daily_return__0_5___0_5.6e9f33b0a2: ROLLBACK
[0m19:47:10.843699 [debug] [Thread-1 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_rolling_avg__0_3___0_3.c2bd8acf6b: ROLLBACK
[0m19:47:10.844579 [info ] [Thread-2 (]: 14 of 24 PASS accepted_values_stg_index_metrics_trend__up__down__flat .......... [[32mPASS[0m in 0.06s]
[0m19:47:10.845268 [debug] [Thread-3 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_daily_return__0_5___0_5.6e9f33b0a2: Close
[0m19:47:10.846024 [debug] [Thread-1 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_rolling_avg__0_3___0_3.c2bd8acf6b: Close
[0m19:47:10.846741 [debug] [Thread-2 (]: Finished running node test.global_economic_tracker.accepted_values_stg_index_metrics_trend__up__down__flat.1fea418295
[0m19:47:10.847619 [info ] [Thread-3 (]: 17 of 24 PASS dbt_utils_accepted_range_stg_index_metrics_daily_return__0_5___0_5  [[32mPASS[0m in 0.06s]
[0m19:47:10.848463 [debug] [Thread-4 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_index_metrics_daily_return.26f4856193"
[0m19:47:10.849194 [debug] [Thread-2 (]: Began running node test.global_economic_tracker.not_null_stg_index_metrics_ticker.4b922607c9
[0m19:47:10.849729 [debug] [Thread-1 (]: Database Error in test dbt_utils_accepted_range_stg_index_metrics_rolling_avg__0_3___0_3 (models/analytics/schema.yml)
  column "rolling_avg" does not exist
  LINE 21:     or not rolling_avg >= -0.3
                      ^
  HINT:  Perhaps you meant to reference the column "meet_condition.rolling_avg_mo".
  compiled code at target/run/global_economic_tracker/models/analytics/schema.yml/dbt_utils_accepted_range_stg_i_f1d487eb5e3ee1614343dfd2e27ffd25.sql
[0m19:47:10.850366 [debug] [Thread-3 (]: Finished running node test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_daily_return__0_5___0_5.6e9f33b0a2
[0m19:47:10.851198 [debug] [Thread-4 (]: On test.global_economic_tracker.not_null_stg_index_metrics_daily_return.26f4856193: BEGIN
[0m19:47:10.851911 [info ] [Thread-2 (]: 23 of 24 START test not_null_stg_index_metrics_ticker .......................... [RUN]
[0m19:47:10.852658 [error] [Thread-1 (]: 18 of 24 ERROR dbt_utils_accepted_range_stg_index_metrics_rolling_avg__0_3___0_3  [[31mERROR[0m in 0.06s]
[0m19:47:10.853393 [debug] [Thread-3 (]: Began running node test.global_economic_tracker.not_null_stg_index_metrics_timestamp.b1d1abca86
[0m19:47:10.854096 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:47:10.854839 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.global_economic_tracker.accepted_values_stg_index_metrics_trend__up__down__flat.1fea418295, now test.global_economic_tracker.not_null_stg_index_metrics_ticker.4b922607c9)
[0m19:47:10.855687 [debug] [Thread-1 (]: Finished running node test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_rolling_avg__0_3___0_3.c2bd8acf6b
[0m19:47:10.856380 [info ] [Thread-3 (]: 24 of 24 START test not_null_stg_index_metrics_timestamp ....................... [RUN]
[0m19:47:10.857647 [debug] [Thread-2 (]: Began compiling node test.global_economic_tracker.not_null_stg_index_metrics_ticker.4b922607c9
[0m19:47:10.858294 [debug] [Thread-4 (]: SQL status: BEGIN in 0.004 seconds
[0m19:47:10.858688 [debug] [Thread-7 (]: Marking all children of 'test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_rolling_avg__0_3___0_3.c2bd8acf6b' to be skipped because of status 'error'.  Reason: Database Error in test dbt_utils_accepted_range_stg_index_metrics_rolling_avg__0_3___0_3 (models/analytics/schema.yml)
  column "rolling_avg" does not exist
  LINE 21:     or not rolling_avg >= -0.3
                      ^
  HINT:  Perhaps you meant to reference the column "meet_condition.rolling_avg_mo".
  compiled code at target/run/global_economic_tracker/models/analytics/schema.yml/dbt_utils_accepted_range_stg_i_f1d487eb5e3ee1614343dfd2e27ffd25.sql.
[0m19:47:10.859256 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_daily_return__0_5___0_5.6e9f33b0a2, now test.global_economic_tracker.not_null_stg_index_metrics_timestamp.b1d1abca86)
[0m19:47:10.862650 [debug] [Thread-2 (]: Writing injected SQL for node "test.global_economic_tracker.not_null_stg_index_metrics_ticker.4b922607c9"
[0m19:47:10.863486 [debug] [Thread-4 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_index_metrics_daily_return.26f4856193"
[0m19:47:10.864671 [debug] [Thread-3 (]: Began compiling node test.global_economic_tracker.not_null_stg_index_metrics_timestamp.b1d1abca86
[0m19:47:10.865913 [debug] [Thread-4 (]: On test.global_economic_tracker.not_null_stg_index_metrics_daily_return.26f4856193: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.not_null_stg_index_metrics_daily_return.26f4856193"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select daily_return
from "airflow"."public"."stg_index_metrics"
where daily_return is null



      
    ) dbt_internal_test
[0m19:47:10.868373 [debug] [Thread-3 (]: Writing injected SQL for node "test.global_economic_tracker.not_null_stg_index_metrics_timestamp.b1d1abca86"
[0m19:47:10.869527 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.000 seconds
[0m19:47:10.870859 [debug] [Thread-4 (]: On test.global_economic_tracker.not_null_stg_index_metrics_daily_return.26f4856193: ROLLBACK
[0m19:47:10.871636 [debug] [Thread-4 (]: On test.global_economic_tracker.not_null_stg_index_metrics_daily_return.26f4856193: Close
[0m19:47:10.872505 [debug] [Thread-2 (]: Began executing node test.global_economic_tracker.not_null_stg_index_metrics_ticker.4b922607c9
[0m19:47:10.872912 [info ] [Thread-4 (]: 22 of 24 PASS not_null_stg_index_metrics_daily_return .......................... [[32mPASS[0m in 0.05s]
[0m19:47:10.874499 [debug] [Thread-2 (]: Writing runtime sql for node "test.global_economic_tracker.not_null_stg_index_metrics_ticker.4b922607c9"
[0m19:47:10.874759 [debug] [Thread-3 (]: Began executing node test.global_economic_tracker.not_null_stg_index_metrics_timestamp.b1d1abca86
[0m19:47:10.875380 [debug] [Thread-4 (]: Finished running node test.global_economic_tracker.not_null_stg_index_metrics_daily_return.26f4856193
[0m19:47:10.877561 [debug] [Thread-3 (]: Writing runtime sql for node "test.global_economic_tracker.not_null_stg_index_metrics_timestamp.b1d1abca86"
[0m19:47:10.882017 [debug] [Thread-2 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_index_metrics_ticker.4b922607c9"
[0m19:47:10.882947 [debug] [Thread-2 (]: On test.global_economic_tracker.not_null_stg_index_metrics_ticker.4b922607c9: BEGIN
[0m19:47:10.883595 [debug] [Thread-3 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_index_metrics_timestamp.b1d1abca86"
[0m19:47:10.884019 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:47:10.884768 [debug] [Thread-3 (]: On test.global_economic_tracker.not_null_stg_index_metrics_timestamp.b1d1abca86: BEGIN
[0m19:47:10.886071 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:47:10.886736 [debug] [Thread-2 (]: SQL status: BEGIN in 0.003 seconds
[0m19:47:10.887568 [debug] [Thread-2 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_index_metrics_ticker.4b922607c9"
[0m19:47:10.888235 [debug] [Thread-3 (]: SQL status: BEGIN in 0.002 seconds
[0m19:47:10.888497 [debug] [Thread-2 (]: On test.global_economic_tracker.not_null_stg_index_metrics_ticker.4b922607c9: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.not_null_stg_index_metrics_ticker.4b922607c9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select ticker
from "airflow"."public"."stg_index_metrics"
where ticker is null



      
    ) dbt_internal_test
[0m19:47:10.889220 [debug] [Thread-3 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_index_metrics_timestamp.b1d1abca86"
[0m19:47:10.890262 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.000 seconds
[0m19:47:10.890684 [debug] [Thread-3 (]: On test.global_economic_tracker.not_null_stg_index_metrics_timestamp.b1d1abca86: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.not_null_stg_index_metrics_timestamp.b1d1abca86"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select timestamp
from "airflow"."public"."stg_index_metrics"
where timestamp is null



      
    ) dbt_internal_test
[0m19:47:10.891801 [debug] [Thread-2 (]: On test.global_economic_tracker.not_null_stg_index_metrics_ticker.4b922607c9: ROLLBACK
[0m19:47:10.892907 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.000 seconds
[0m19:47:10.893398 [debug] [Thread-2 (]: On test.global_economic_tracker.not_null_stg_index_metrics_ticker.4b922607c9: Close
[0m19:47:10.894367 [debug] [Thread-3 (]: On test.global_economic_tracker.not_null_stg_index_metrics_timestamp.b1d1abca86: ROLLBACK
[0m19:47:10.895237 [info ] [Thread-2 (]: 23 of 24 PASS not_null_stg_index_metrics_ticker ................................ [[32mPASS[0m in 0.04s]
[0m19:47:10.895881 [debug] [Thread-3 (]: On test.global_economic_tracker.not_null_stg_index_metrics_timestamp.b1d1abca86: Close
[0m19:47:10.896654 [debug] [Thread-2 (]: Finished running node test.global_economic_tracker.not_null_stg_index_metrics_ticker.4b922607c9
[0m19:47:10.897486 [info ] [Thread-3 (]: 24 of 24 PASS not_null_stg_index_metrics_timestamp ............................. [[32mPASS[0m in 0.04s]
[0m19:47:10.898754 [debug] [Thread-3 (]: Finished running node test.global_economic_tracker.not_null_stg_index_metrics_timestamp.b1d1abca86
[0m19:47:10.900313 [debug] [MainThread]: Using postgres connection "master"
[0m19:47:10.901023 [debug] [MainThread]: On master: BEGIN
[0m19:47:10.901645 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:47:10.903560 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m19:47:10.904329 [debug] [MainThread]: On master: COMMIT
[0m19:47:10.904948 [debug] [MainThread]: Using postgres connection "master"
[0m19:47:10.905634 [debug] [MainThread]: On master: COMMIT
[0m19:47:10.906414 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:47:10.907142 [debug] [MainThread]: On master: Close
[0m19:47:10.907853 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:47:10.908483 [debug] [MainThread]: Connection 'test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_rolling_avg__0_3___0_3.c2bd8acf6b' was properly closed.
[0m19:47:10.909077 [debug] [MainThread]: Connection 'test.global_economic_tracker.not_null_stg_index_metrics_ticker.4b922607c9' was properly closed.
[0m19:47:10.909685 [debug] [MainThread]: Connection 'test.global_economic_tracker.not_null_stg_index_metrics_daily_return.26f4856193' was properly closed.
[0m19:47:10.910306 [debug] [MainThread]: Connection 'test.global_economic_tracker.not_null_stg_index_metrics_timestamp.b1d1abca86' was properly closed.
[0m19:47:10.911051 [info ] [MainThread]: 
[0m19:47:10.911760 [info ] [MainThread]: Finished running 4 table models, 20 data tests in 0 hours 0 minutes and 0.56 seconds (0.56s).
[0m19:47:10.913485 [debug] [MainThread]: Command end result
[0m19:47:10.941190 [debug] [MainThread]: Wrote artifact WritableManifest to /mnt/c/Users/joeyk/PycharmProjects/GlobalEconomicTracker/global_economic_tracker/target/manifest.json
[0m19:47:10.944715 [debug] [MainThread]: Wrote artifact SemanticManifest to /mnt/c/Users/joeyk/PycharmProjects/GlobalEconomicTracker/global_economic_tracker/target/semantic_manifest.json
[0m19:47:10.951865 [debug] [MainThread]: Wrote artifact RunExecutionResult to /mnt/c/Users/joeyk/PycharmProjects/GlobalEconomicTracker/global_economic_tracker/target/run_results.json
[0m19:47:10.952515 [info ] [MainThread]: 
[0m19:47:10.953286 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m19:47:10.953927 [info ] [MainThread]: 
[0m19:47:10.954842 [error] [MainThread]:   Database Error in model stg_commodity_metrics (models/analytics/stg_commodity_metrics.sql)
  duplicate key value violates unique constraint "pg_class_relname_nsp_index"
  DETAIL:  Key (relname, relnamespace)=(idx_rolling_ticker_ts, 2200) already exists.
  compiled code at target/run/global_economic_tracker/models/analytics/stg_commodity_metrics.sql
[0m19:47:10.955495 [info ] [MainThread]: 
[0m19:47:10.956215 [error] [MainThread]:   Database Error in test dbt_utils_accepted_range_stg_index_metrics_rolling_avg__0_3___0_3 (models/analytics/schema.yml)
  column "rolling_avg" does not exist
  LINE 21:     or not rolling_avg >= -0.3
                      ^
  HINT:  Perhaps you meant to reference the column "meet_condition.rolling_avg_mo".
  compiled code at target/run/global_economic_tracker/models/analytics/schema.yml/dbt_utils_accepted_range_stg_i_f1d487eb5e3ee1614343dfd2e27ffd25.sql
[0m19:47:10.956905 [info ] [MainThread]: 
[0m19:47:10.957633 [info ] [MainThread]: Done. PASS=16 WARN=0 ERROR=2 SKIP=6 TOTAL=24
[0m19:47:10.958683 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 1.9711968, "process_in_blocks": "40", "process_kernel_time": 0.108982, "process_mem_max_rss": "130128", "process_out_blocks": "0", "process_user_time": 1.436583}
[0m19:47:10.959469 [debug] [MainThread]: Command `dbt build` failed at 19:47:10.959399 after 1.97 seconds
[0m19:47:10.960222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4d90b1b40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4d913d300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4d8f70b80>]}
[0m19:47:10.960936 [debug] [MainThread]: Flushing usage events
[0m19:47:11.649899 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:49:01.687504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4258819ae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42586f43d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42586f57b0>]}


============================== 19:49:01.689659 | 9dc5aec9-0a8d-4fa8-a20f-6b0753906331 ==============================
[0m19:49:01.689659 [info ] [MainThread]: Running with dbt=1.9.4
[0m19:49:01.690445 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/joey/.dbt', 'log_path': '/mnt/c/Users/joeyk/PycharmProjects/GlobalEconomicTracker/global_economic_tracker/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt build', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:49:01.781043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9dc5aec9-0a8d-4fa8-a20f-6b0753906331', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4259f8a440>]}
[0m19:49:01.811237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9dc5aec9-0a8d-4fa8-a20f-6b0753906331', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42586f48b0>]}
[0m19:49:01.812117 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m19:49:01.854149 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m19:49:02.687251 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m19:49:02.688430 [debug] [MainThread]: Partial parsing: updated file: global_economic_tracker://models/analytics/schema.yml
[0m19:49:02.689154 [debug] [MainThread]: Partial parsing: updated file: global_economic_tracker://models/analytics/stg_index_metrics.sql
[0m19:49:02.689808 [debug] [MainThread]: Partial parsing: updated file: global_economic_tracker://models/analytics/stg_commodity_metrics.sql
[0m19:49:02.952133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9dc5aec9-0a8d-4fa8-a20f-6b0753906331', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4255fbab30>]}
[0m19:49:03.005654 [debug] [MainThread]: Wrote artifact WritableManifest to /mnt/c/Users/joeyk/PycharmProjects/GlobalEconomicTracker/global_economic_tracker/target/manifest.json
[0m19:49:03.009704 [debug] [MainThread]: Wrote artifact SemanticManifest to /mnt/c/Users/joeyk/PycharmProjects/GlobalEconomicTracker/global_economic_tracker/target/semantic_manifest.json
[0m19:49:03.027007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9dc5aec9-0a8d-4fa8-a20f-6b0753906331', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f425631bfa0>]}
[0m19:49:03.027801 [info ] [MainThread]: Found 4 models, 20 data tests, 549 macros
[0m19:49:03.029742 [info ] [MainThread]: 
[0m19:49:03.030485 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:49:03.031139 [info ] [MainThread]: 
[0m19:49:03.031942 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:49:03.034801 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m19:49:03.047325 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m19:49:03.048025 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m19:49:03.048691 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:49:03.052239 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m19:49:03.053332 [debug] [ThreadPool]: On list_airflow: Close
[0m19:49:03.054640 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_public)
[0m19:49:03.057990 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m19:49:03.058647 [debug] [ThreadPool]: On list_airflow_public: BEGIN
[0m19:49:03.059280 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:49:03.062068 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m19:49:03.062809 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m19:49:03.063487 [debug] [ThreadPool]: On list_airflow_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:49:03.066251 [debug] [ThreadPool]: SQL status: SELECT 48 in 0.002 seconds
[0m19:49:03.067969 [debug] [ThreadPool]: On list_airflow_public: ROLLBACK
[0m19:49:03.068706 [debug] [ThreadPool]: On list_airflow_public: Close
[0m19:49:03.073838 [debug] [MainThread]: Using postgres connection "master"
[0m19:49:03.074511 [debug] [MainThread]: On master: BEGIN
[0m19:49:03.075301 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:49:03.077533 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m19:49:03.078172 [debug] [MainThread]: Using postgres connection "master"
[0m19:49:03.078832 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:49:03.081049 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m19:49:03.081999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9dc5aec9-0a8d-4fa8-a20f-6b0753906331', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4255f7b910>]}
[0m19:49:03.082724 [debug] [MainThread]: On master: ROLLBACK
[0m19:49:03.083468 [debug] [MainThread]: Using postgres connection "master"
[0m19:49:03.084101 [debug] [MainThread]: On master: BEGIN
[0m19:49:03.084953 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m19:49:03.085649 [debug] [MainThread]: On master: COMMIT
[0m19:49:03.086303 [debug] [MainThread]: Using postgres connection "master"
[0m19:49:03.086923 [debug] [MainThread]: On master: COMMIT
[0m19:49:03.087705 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:49:03.088349 [debug] [MainThread]: On master: Close
[0m19:49:03.091764 [debug] [Thread-1 (]: Began running node model.global_economic_tracker.stg_commodity_returns
[0m19:49:03.092013 [debug] [Thread-2 (]: Began running node model.global_economic_tracker.stg_index_returns
[0m19:49:03.092648 [info ] [Thread-1 (]: 1 of 24 START sql table model public.stg_commodity_returns ..................... [RUN]
[0m19:49:03.093437 [info ] [Thread-2 (]: 2 of 24 START sql table model public.stg_index_returns ......................... [RUN]
[0m19:49:03.094169 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_public, now model.global_economic_tracker.stg_commodity_returns)
[0m19:49:03.094982 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.global_economic_tracker.stg_index_returns'
[0m19:49:03.095697 [debug] [Thread-1 (]: Began compiling node model.global_economic_tracker.stg_commodity_returns
[0m19:49:03.096419 [debug] [Thread-2 (]: Began compiling node model.global_economic_tracker.stg_index_returns
[0m19:49:03.100849 [debug] [Thread-1 (]: Writing injected SQL for node "model.global_economic_tracker.stg_commodity_returns"
[0m19:49:03.102698 [debug] [Thread-2 (]: Writing injected SQL for node "model.global_economic_tracker.stg_index_returns"
[0m19:49:03.106758 [debug] [Thread-1 (]: Began executing node model.global_economic_tracker.stg_commodity_returns
[0m19:49:03.113110 [debug] [Thread-2 (]: Began executing node model.global_economic_tracker.stg_index_returns
[0m19:49:03.127001 [debug] [Thread-1 (]: Writing runtime sql for node "model.global_economic_tracker.stg_commodity_returns"
[0m19:49:03.129076 [debug] [Thread-2 (]: Writing runtime sql for node "model.global_economic_tracker.stg_index_returns"
[0m19:49:03.133548 [debug] [Thread-1 (]: Using postgres connection "model.global_economic_tracker.stg_commodity_returns"
[0m19:49:03.134259 [debug] [Thread-1 (]: On model.global_economic_tracker.stg_commodity_returns: BEGIN
[0m19:49:03.134566 [debug] [Thread-2 (]: Using postgres connection "model.global_economic_tracker.stg_index_returns"
[0m19:49:03.135129 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:49:03.135878 [debug] [Thread-2 (]: On model.global_economic_tracker.stg_index_returns: BEGIN
[0m19:49:03.137262 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:49:03.138032 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m19:49:03.139104 [debug] [Thread-1 (]: Using postgres connection "model.global_economic_tracker.stg_commodity_returns"
[0m19:49:03.139802 [debug] [Thread-1 (]: On model.global_economic_tracker.stg_commodity_returns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_commodity_returns"} */

  
    

  create  table "airflow"."public"."stg_commodity_returns__dbt_tmp"
  
  
    as
  
  (
    

select
    'commodity' as type,
    ticker,
    timestamp,
    price,
    lag(price) over (partition by ticker order by timestamp) as prev_price,
    coalesce((price - lag(price) over (partition by ticker order by timestamp)) / lag(price) over (partition by ticker order by timestamp), 0) as daily_return
from public.commodity_prices
  );
  
[0m19:49:03.140406 [debug] [Thread-2 (]: SQL status: BEGIN in 0.003 seconds
[0m19:49:03.141179 [debug] [Thread-2 (]: Using postgres connection "model.global_economic_tracker.stg_index_returns"
[0m19:49:03.141842 [debug] [Thread-2 (]: On model.global_economic_tracker.stg_index_returns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_index_returns"} */

  
    

  create  table "airflow"."public"."stg_index_returns__dbt_tmp"
  
  
    as
  
  (
    

select
    'index' as type,
    country,
    ticker,
    timestamp,
    price,
    lag(price) over (partition by ticker order by timestamp) as prev_price,
    coalesce((price - lag(price) over (partition by ticker order by timestamp)) / lag(price) over (partition by ticker order by timestamp), 0) as daily_return
from public.index_prices
  );
  
[0m19:49:03.148598 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.006 seconds
[0m19:49:03.149391 [debug] [Thread-1 (]: SQL status: SELECT 517 in 0.009 seconds
[0m19:49:03.156066 [debug] [Thread-2 (]: Using postgres connection "model.global_economic_tracker.stg_index_returns"
[0m19:49:03.158284 [debug] [Thread-1 (]: Using postgres connection "model.global_economic_tracker.stg_commodity_returns"
[0m19:49:03.159120 [debug] [Thread-2 (]: On model.global_economic_tracker.stg_index_returns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_index_returns"} */
alter table "airflow"."public"."stg_index_returns" rename to "stg_index_returns__dbt_backup"
[0m19:49:03.159831 [debug] [Thread-1 (]: On model.global_economic_tracker.stg_commodity_returns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_commodity_returns"} */
alter table "airflow"."public"."stg_commodity_returns" rename to "stg_commodity_returns__dbt_backup"
[0m19:49:03.160835 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:49:03.161420 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:49:03.163459 [debug] [Thread-2 (]: Using postgres connection "model.global_economic_tracker.stg_index_returns"
[0m19:49:03.165305 [debug] [Thread-1 (]: Using postgres connection "model.global_economic_tracker.stg_commodity_returns"
[0m19:49:03.166215 [debug] [Thread-2 (]: On model.global_economic_tracker.stg_index_returns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_index_returns"} */
alter table "airflow"."public"."stg_index_returns__dbt_tmp" rename to "stg_index_returns"
[0m19:49:03.167237 [debug] [Thread-1 (]: On model.global_economic_tracker.stg_commodity_returns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_commodity_returns"} */
alter table "airflow"."public"."stg_commodity_returns__dbt_tmp" rename to "stg_commodity_returns"
[0m19:49:03.168157 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:49:03.168880 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:49:03.170061 [debug] [Thread-2 (]: Using postgres connection "model.global_economic_tracker.stg_index_returns"
[0m19:49:03.171397 [debug] [Thread-1 (]: Using postgres connection "model.global_economic_tracker.stg_commodity_returns"
[0m19:49:03.172104 [debug] [Thread-2 (]: On model.global_economic_tracker.stg_index_returns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_index_returns"} */

        CREATE INDEX IF NOT EXISTS idx_index_returns_ticker_ts ON "airflow"."public"."stg_index_returns"(ticker, timestamp)
      
[0m19:49:03.172810 [debug] [Thread-1 (]: On model.global_economic_tracker.stg_commodity_returns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_commodity_returns"} */

        CREATE INDEX IF NOT EXISTS idx_returns_ticker_ts ON "airflow"."public"."stg_commodity_returns"(ticker, timestamp)
      
[0m19:49:03.173786 [debug] [Thread-2 (]: SQL status: CREATE INDEX in 0.000 seconds
[0m19:49:03.174341 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.000 seconds
[0m19:49:03.182492 [debug] [Thread-2 (]: On model.global_economic_tracker.stg_index_returns: COMMIT
[0m19:49:03.183529 [debug] [Thread-1 (]: On model.global_economic_tracker.stg_commodity_returns: COMMIT
[0m19:49:03.184402 [debug] [Thread-2 (]: Using postgres connection "model.global_economic_tracker.stg_index_returns"
[0m19:49:03.185108 [debug] [Thread-1 (]: Using postgres connection "model.global_economic_tracker.stg_commodity_returns"
[0m19:49:03.185799 [debug] [Thread-2 (]: On model.global_economic_tracker.stg_index_returns: COMMIT
[0m19:49:03.186502 [debug] [Thread-1 (]: On model.global_economic_tracker.stg_commodity_returns: COMMIT
[0m19:49:03.188598 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m19:49:03.192171 [debug] [Thread-2 (]: Applying DROP to: "airflow"."public"."stg_index_returns__dbt_backup"
[0m19:49:03.192406 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m19:49:03.194908 [debug] [Thread-2 (]: Using postgres connection "model.global_economic_tracker.stg_index_returns"
[0m19:49:03.196843 [debug] [Thread-1 (]: Applying DROP to: "airflow"."public"."stg_commodity_returns__dbt_backup"
[0m19:49:03.197566 [debug] [Thread-2 (]: On model.global_economic_tracker.stg_index_returns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_index_returns"} */
drop table if exists "airflow"."public"."stg_index_returns__dbt_backup" cascade
[0m19:49:03.198435 [debug] [Thread-1 (]: Using postgres connection "model.global_economic_tracker.stg_commodity_returns"
[0m19:49:03.199616 [debug] [Thread-1 (]: On model.global_economic_tracker.stg_commodity_returns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_commodity_returns"} */
drop table if exists "airflow"."public"."stg_commodity_returns__dbt_backup" cascade
[0m19:49:03.202918 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.004 seconds
[0m19:49:03.203555 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m19:49:03.204953 [debug] [Thread-2 (]: On model.global_economic_tracker.stg_index_returns: Close
[0m19:49:03.206100 [debug] [Thread-1 (]: On model.global_economic_tracker.stg_commodity_returns: Close
[0m19:49:03.207705 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9dc5aec9-0a8d-4fa8-a20f-6b0753906331', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42365fe230>]}
[0m19:49:03.208389 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9dc5aec9-0a8d-4fa8-a20f-6b0753906331', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4255f5f0a0>]}
[0m19:49:03.209789 [info ] [Thread-2 (]: 2 of 24 OK created sql table model public.stg_index_returns .................... [[32mSELECT 0[0m in 0.11s]
[0m19:49:03.210672 [info ] [Thread-1 (]: 1 of 24 OK created sql table model public.stg_commodity_returns ................ [[32mSELECT 517[0m in 0.11s]
[0m19:49:03.211521 [debug] [Thread-2 (]: Finished running node model.global_economic_tracker.stg_index_returns
[0m19:49:03.212432 [debug] [Thread-1 (]: Finished running node model.global_economic_tracker.stg_commodity_returns
[0m19:49:03.213682 [debug] [Thread-4 (]: Began running node test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713
[0m19:49:03.213935 [debug] [Thread-3 (]: Began running node test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8
[0m19:49:03.214247 [debug] [Thread-2 (]: Began running node test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0
[0m19:49:03.214527 [debug] [Thread-1 (]: Began running node test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17
[0m19:49:03.215345 [info ] [Thread-4 (]: 3 of 24 START test dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5  [RUN]
[0m19:49:03.216056 [info ] [Thread-3 (]: 4 of 24 START test not_null_stg_index_returns_daily_return ..................... [RUN]
[0m19:49:03.216753 [info ] [Thread-2 (]: 5 of 24 START test not_null_stg_index_returns_ticker ........................... [RUN]
[0m19:49:03.217552 [info ] [Thread-1 (]: 6 of 24 START test not_null_stg_index_returns_timestamp ........................ [RUN]
[0m19:49:03.218296 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713'
[0m19:49:03.219064 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8'
[0m19:49:03.219793 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.global_economic_tracker.stg_index_returns, now test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0)
[0m19:49:03.220529 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.global_economic_tracker.stg_commodity_returns, now test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17)
[0m19:49:03.221246 [debug] [Thread-4 (]: Began compiling node test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713
[0m19:49:03.221937 [debug] [Thread-3 (]: Began compiling node test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8
[0m19:49:03.222634 [debug] [Thread-2 (]: Began compiling node test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0
[0m19:49:03.223333 [debug] [Thread-1 (]: Began compiling node test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17
[0m19:49:03.226096 [debug] [Thread-4 (]: Writing injected SQL for node "test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713"
[0m19:49:03.231085 [debug] [Thread-3 (]: Writing injected SQL for node "test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8"
[0m19:49:03.233465 [debug] [Thread-2 (]: Writing injected SQL for node "test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0"
[0m19:49:03.236065 [debug] [Thread-1 (]: Writing injected SQL for node "test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17"
[0m19:49:03.240599 [debug] [Thread-1 (]: Began executing node test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17
[0m19:49:03.246569 [debug] [Thread-4 (]: Began executing node test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713
[0m19:49:03.246875 [debug] [Thread-2 (]: Began executing node test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0
[0m19:49:03.248487 [debug] [Thread-1 (]: Writing runtime sql for node "test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17"
[0m19:49:03.249951 [debug] [Thread-4 (]: Writing runtime sql for node "test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713"
[0m19:49:03.250261 [debug] [Thread-3 (]: Began executing node test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8
[0m19:49:03.251766 [debug] [Thread-2 (]: Writing runtime sql for node "test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0"
[0m19:49:03.254742 [debug] [Thread-3 (]: Writing runtime sql for node "test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8"
[0m19:49:03.258341 [debug] [Thread-4 (]: Using postgres connection "test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713"
[0m19:49:03.259080 [debug] [Thread-1 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17"
[0m19:49:03.259591 [debug] [Thread-4 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713: BEGIN
[0m19:49:03.259883 [debug] [Thread-3 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8"
[0m19:49:03.260423 [debug] [Thread-1 (]: On test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17: BEGIN
[0m19:49:03.260720 [debug] [Thread-2 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0"
[0m19:49:03.261454 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:49:03.262166 [debug] [Thread-3 (]: On test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8: BEGIN
[0m19:49:03.262899 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:49:03.263609 [debug] [Thread-2 (]: On test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0: BEGIN
[0m19:49:03.264913 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:49:03.265766 [debug] [Thread-4 (]: SQL status: BEGIN in 0.004 seconds
[0m19:49:03.266307 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:49:03.267204 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m19:49:03.267805 [debug] [Thread-4 (]: Using postgres connection "test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713"
[0m19:49:03.268531 [debug] [Thread-3 (]: SQL status: BEGIN in 0.004 seconds
[0m19:49:03.269350 [debug] [Thread-1 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17"
[0m19:49:03.270130 [debug] [Thread-4 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with meet_condition as(
  select *
  from "airflow"."public"."stg_index_returns"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not daily_return >= -0.5
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not daily_return <= 0.5
)

select *
from validation_errors


      
    ) dbt_internal_test
[0m19:49:03.270716 [debug] [Thread-2 (]: SQL status: BEGIN in 0.004 seconds
[0m19:49:03.271111 [debug] [Thread-3 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8"
[0m19:49:03.271840 [debug] [Thread-1 (]: On test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select timestamp
from "airflow"."public"."stg_index_returns"
where timestamp is null



      
    ) dbt_internal_test
[0m19:49:03.273066 [debug] [Thread-2 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0"
[0m19:49:03.273346 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m19:49:03.273903 [debug] [Thread-3 (]: On test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select daily_return
from "airflow"."public"."stg_index_returns"
where daily_return is null



      
    ) dbt_internal_test
[0m19:49:03.274983 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.000 seconds
[0m19:49:03.275379 [debug] [Thread-2 (]: On test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select ticker
from "airflow"."public"."stg_index_returns"
where ticker is null



      
    ) dbt_internal_test
[0m19:49:03.277576 [debug] [Thread-4 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713: ROLLBACK
[0m19:49:03.278598 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.000 seconds
[0m19:49:03.279441 [debug] [Thread-1 (]: On test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17: ROLLBACK
[0m19:49:03.280487 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.000 seconds
[0m19:49:03.280997 [debug] [Thread-4 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713: Close
[0m19:49:03.282046 [debug] [Thread-3 (]: On test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8: ROLLBACK
[0m19:49:03.282878 [debug] [Thread-1 (]: On test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17: Close
[0m19:49:03.283847 [debug] [Thread-2 (]: On test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0: ROLLBACK
[0m19:49:03.284722 [info ] [Thread-4 (]: 3 of 24 PASS dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5  [[32mPASS[0m in 0.07s]
[0m19:49:03.285353 [debug] [Thread-3 (]: On test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8: Close
[0m19:49:03.286047 [info ] [Thread-1 (]: 6 of 24 PASS not_null_stg_index_returns_timestamp .............................. [[32mPASS[0m in 0.07s]
[0m19:49:03.286666 [debug] [Thread-2 (]: On test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0: Close
[0m19:49:03.287330 [debug] [Thread-4 (]: Finished running node test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713
[0m19:49:03.288178 [info ] [Thread-3 (]: 4 of 24 PASS not_null_stg_index_returns_daily_return ........................... [[32mPASS[0m in 0.07s]
[0m19:49:03.288787 [debug] [Thread-1 (]: Finished running node test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17
[0m19:49:03.289621 [info ] [Thread-2 (]: 5 of 24 PASS not_null_stg_index_returns_ticker ................................. [[32mPASS[0m in 0.07s]
[0m19:49:03.290189 [debug] [Thread-4 (]: Began running node test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe
[0m19:49:03.291055 [debug] [Thread-3 (]: Finished running node test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8
[0m19:49:03.291806 [debug] [Thread-1 (]: Began running node test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934
[0m19:49:03.293039 [debug] [Thread-2 (]: Finished running node test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0
[0m19:49:03.293765 [info ] [Thread-4 (]: 7 of 24 START test dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5  [RUN]
[0m19:49:03.294508 [debug] [Thread-3 (]: Began running node test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d
[0m19:49:03.295253 [info ] [Thread-1 (]: 8 of 24 START test not_null_stg_commodity_returns_daily_return ................. [RUN]
[0m19:49:03.295998 [debug] [Thread-2 (]: Began running node test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359
[0m19:49:03.296778 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713, now test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe)
[0m19:49:03.297513 [info ] [Thread-3 (]: 9 of 24 START test not_null_stg_commodity_returns_ticker ....................... [RUN]
[0m19:49:03.298244 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17, now test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934)
[0m19:49:03.298968 [info ] [Thread-2 (]: 10 of 24 START test not_null_stg_commodity_returns_timestamp ................... [RUN]
[0m19:49:03.299653 [debug] [Thread-4 (]: Began compiling node test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe
[0m19:49:03.300401 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8, now test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d)
[0m19:49:03.301192 [debug] [Thread-1 (]: Began compiling node test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934
[0m19:49:03.301952 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0, now test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359)
[0m19:49:03.304612 [debug] [Thread-4 (]: Writing injected SQL for node "test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe"
[0m19:49:03.305477 [debug] [Thread-3 (]: Began compiling node test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d
[0m19:49:03.307882 [debug] [Thread-1 (]: Writing injected SQL for node "test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934"
[0m19:49:03.308617 [debug] [Thread-2 (]: Began compiling node test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359
[0m19:49:03.311711 [debug] [Thread-3 (]: Writing injected SQL for node "test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d"
[0m19:49:03.314724 [debug] [Thread-2 (]: Writing injected SQL for node "test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359"
[0m19:49:03.315672 [debug] [Thread-4 (]: Began executing node test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe
[0m19:49:03.316809 [debug] [Thread-1 (]: Began executing node test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934
[0m19:49:03.318015 [debug] [Thread-4 (]: Writing runtime sql for node "test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe"
[0m19:49:03.320114 [debug] [Thread-1 (]: Writing runtime sql for node "test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934"
[0m19:49:03.320368 [debug] [Thread-3 (]: Began executing node test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d
[0m19:49:03.320651 [debug] [Thread-2 (]: Began executing node test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359
[0m19:49:03.323213 [debug] [Thread-3 (]: Writing runtime sql for node "test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d"
[0m19:49:03.324871 [debug] [Thread-2 (]: Writing runtime sql for node "test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359"
[0m19:49:03.326123 [debug] [Thread-4 (]: Using postgres connection "test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe"
[0m19:49:03.326680 [debug] [Thread-1 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934"
[0m19:49:03.327475 [debug] [Thread-4 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe: BEGIN
[0m19:49:03.327755 [debug] [Thread-3 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d"
[0m19:49:03.328388 [debug] [Thread-1 (]: On test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934: BEGIN
[0m19:49:03.329118 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:49:03.329532 [debug] [Thread-2 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359"
[0m19:49:03.330087 [debug] [Thread-3 (]: On test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d: BEGIN
[0m19:49:03.330831 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:49:03.332156 [debug] [Thread-2 (]: On test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359: BEGIN
[0m19:49:03.332912 [debug] [Thread-4 (]: SQL status: BEGIN in 0.004 seconds
[0m19:49:03.333149 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:49:03.334555 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:49:03.335343 [debug] [Thread-4 (]: Using postgres connection "test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe"
[0m19:49:03.335925 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m19:49:03.337487 [debug] [Thread-4 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with meet_condition as(
  select *
  from "airflow"."public"."stg_commodity_returns"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not daily_return >= -0.5
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not daily_return <= 0.5
)

select *
from validation_errors


      
    ) dbt_internal_test
[0m19:49:03.338020 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m19:49:03.338413 [debug] [Thread-1 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934"
[0m19:49:03.339373 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m19:49:03.339936 [debug] [Thread-3 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d"
[0m19:49:03.340204 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m19:49:03.340757 [debug] [Thread-1 (]: On test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select daily_return
from "airflow"."public"."stg_commodity_returns"
where daily_return is null



      
    ) dbt_internal_test
[0m19:49:03.341469 [debug] [Thread-2 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359"
[0m19:49:03.342174 [debug] [Thread-3 (]: On test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select ticker
from "airflow"."public"."stg_commodity_returns"
where ticker is null



      
    ) dbt_internal_test
[0m19:49:03.343339 [debug] [Thread-4 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe: ROLLBACK
[0m19:49:03.344492 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.000 seconds
[0m19:49:03.344738 [debug] [Thread-2 (]: On test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select timestamp
from "airflow"."public"."stg_commodity_returns"
where timestamp is null



      
    ) dbt_internal_test
[0m19:49:03.345903 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.000 seconds
[0m19:49:03.346256 [debug] [Thread-4 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe: Close
[0m19:49:03.347414 [debug] [Thread-1 (]: On test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934: ROLLBACK
[0m19:49:03.348883 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.000 seconds
[0m19:49:03.349565 [debug] [Thread-3 (]: On test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d: ROLLBACK
[0m19:49:03.350765 [info ] [Thread-4 (]: 7 of 24 PASS dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5  [[32mPASS[0m in 0.05s]
[0m19:49:03.351527 [debug] [Thread-1 (]: On test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934: Close
[0m19:49:03.352491 [debug] [Thread-2 (]: On test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359: ROLLBACK
[0m19:49:03.353377 [debug] [Thread-3 (]: On test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d: Close
[0m19:49:03.354013 [debug] [Thread-4 (]: Finished running node test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe
[0m19:49:03.354841 [info ] [Thread-1 (]: 8 of 24 PASS not_null_stg_commodity_returns_daily_return ....................... [[32mPASS[0m in 0.06s]
[0m19:49:03.355454 [debug] [Thread-2 (]: On test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359: Close
[0m19:49:03.356144 [info ] [Thread-3 (]: 9 of 24 PASS not_null_stg_commodity_returns_ticker ............................. [[32mPASS[0m in 0.06s]
[0m19:49:03.356699 [debug] [Thread-4 (]: Began running node model.global_economic_tracker.stg_index_metrics
[0m19:49:03.357507 [debug] [Thread-1 (]: Finished running node test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934
[0m19:49:03.358357 [info ] [Thread-2 (]: 10 of 24 PASS not_null_stg_commodity_returns_timestamp ......................... [[32mPASS[0m in 0.06s]
[0m19:49:03.358958 [debug] [Thread-3 (]: Finished running node test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d
[0m19:49:03.359723 [info ] [Thread-4 (]: 11 of 24 START sql table model public.stg_index_metrics ........................ [RUN]
[0m19:49:03.361039 [debug] [Thread-2 (]: Finished running node test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359
[0m19:49:03.362330 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe, now model.global_economic_tracker.stg_index_metrics)
[0m19:49:03.363333 [debug] [Thread-1 (]: Began running node model.global_economic_tracker.stg_commodity_metrics
[0m19:49:03.363925 [debug] [Thread-4 (]: Began compiling node model.global_economic_tracker.stg_index_metrics
[0m19:49:03.364688 [info ] [Thread-1 (]: 12 of 24 START sql table model public.stg_commodity_metrics .................... [RUN]
[0m19:49:03.366764 [debug] [Thread-4 (]: Writing injected SQL for node "model.global_economic_tracker.stg_index_metrics"
[0m19:49:03.368030 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934, now model.global_economic_tracker.stg_commodity_metrics)
[0m19:49:03.369329 [debug] [Thread-1 (]: Began compiling node model.global_economic_tracker.stg_commodity_metrics
[0m19:49:03.371283 [debug] [Thread-1 (]: Writing injected SQL for node "model.global_economic_tracker.stg_commodity_metrics"
[0m19:49:03.374661 [debug] [Thread-4 (]: Began executing node model.global_economic_tracker.stg_index_metrics
[0m19:49:03.377283 [debug] [Thread-4 (]: Writing runtime sql for node "model.global_economic_tracker.stg_index_metrics"
[0m19:49:03.377504 [debug] [Thread-1 (]: Began executing node model.global_economic_tracker.stg_commodity_metrics
[0m19:49:03.408558 [debug] [Thread-1 (]: Writing runtime sql for node "model.global_economic_tracker.stg_commodity_metrics"
[0m19:49:03.410630 [debug] [Thread-4 (]: Using postgres connection "model.global_economic_tracker.stg_index_metrics"
[0m19:49:03.411395 [debug] [Thread-4 (]: On model.global_economic_tracker.stg_index_metrics: BEGIN
[0m19:49:03.411774 [debug] [Thread-1 (]: Using postgres connection "model.global_economic_tracker.stg_commodity_metrics"
[0m19:49:03.412327 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:49:03.413040 [debug] [Thread-1 (]: On model.global_economic_tracker.stg_commodity_metrics: BEGIN
[0m19:49:03.414598 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:49:03.415884 [debug] [Thread-4 (]: SQL status: BEGIN in 0.004 seconds
[0m19:49:03.416587 [debug] [Thread-4 (]: Using postgres connection "model.global_economic_tracker.stg_index_metrics"
[0m19:49:03.417281 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m19:49:03.417548 [debug] [Thread-4 (]: On model.global_economic_tracker.stg_index_metrics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_index_metrics"} */

  
    

  create  table "airflow"."public"."stg_index_metrics__dbt_tmp"
  
  
    as
  
  (
    

with base as (
    select
        *,
        row_number() over (partition by ticker order by timestamp) as rn
    from "airflow"."public"."stg_index_returns"
),

rolling as (
    select
        ticker,
        timestamp,
        avg(daily_return) over (
            partition by ticker
            order by rn
            rows between 19 preceding and current row
        ) as rolling_avg_mo,

        avg(daily_return) OVER (
            partition by ticker
            order by timestamp
            rows between 6 preceding and current row
        ) as weekly_avg_return,

        stddev(daily_return) over (
            partition by ticker
            order by rn
            rows between 19 preceding and current row
        ) as rolling_volatility_mo,

        case
            when daily_return > 0 then 'up'
            when daily_return < 0 then 'down'
            else 'flat'
        end as trend,

        daily_return

    from base
)

select
    *,
    rolling_avg_mo / nullif(rolling_volatility_mo, 0) as sharpe_mo,
    (daily_return - rolling_avg_mo) / nullif(rolling_volatility_mo, 0) as z_score_mo
from rolling
where rolling_avg_mo is not null
  );
  
[0m19:49:03.418291 [debug] [Thread-1 (]: Using postgres connection "model.global_economic_tracker.stg_commodity_metrics"
[0m19:49:03.419559 [debug] [Thread-1 (]: On model.global_economic_tracker.stg_commodity_metrics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_commodity_metrics"} */

  
    

  create  table "airflow"."public"."stg_commodity_metrics__dbt_tmp"
  
  
    as
  
  (
    

with base as (
    select
        *,
        row_number() over (partition by ticker order by timestamp) as rn
    from "airflow"."public"."stg_commodity_returns"
),

rolling as (
    select
        ticker,
        timestamp,
        avg(daily_return) over (
            partition by ticker
            order by rn
            rows between 19 preceding and current row
        ) as rolling_avg_mo,

        avg(daily_return) OVER (
            partition by ticker
            order by timestamp
            rows between 6 preceding and current row
        ) as weekly_avg_return,

        stddev(daily_return) over (
            partition by ticker
            order by rn
            rows between 19 preceding and current row
        ) as rolling_volatility_mo,

        case
            when daily_return > 0 then 'up'
            when daily_return < 0 then 'down'
            else 'flat'
        end as trend,

        daily_return

    from base
)

select
    *,
    rolling_avg_mo / nullif(rolling_volatility_mo, 0) as sharpe_mo,
    (daily_return - rolling_avg_mo) / nullif(rolling_volatility_mo, 0) as z_score_mo
from rolling
where rolling_avg_mo is not null
  );
  
[0m19:49:03.423621 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.005 seconds
[0m19:49:03.425860 [debug] [Thread-4 (]: Using postgres connection "model.global_economic_tracker.stg_index_metrics"
[0m19:49:03.426533 [debug] [Thread-4 (]: On model.global_economic_tracker.stg_index_metrics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_index_metrics"} */
alter table "airflow"."public"."stg_index_metrics" rename to "stg_index_metrics__dbt_backup"
[0m19:49:03.426827 [debug] [Thread-1 (]: SQL status: SELECT 517 in 0.007 seconds
[0m19:49:03.427607 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:49:03.429444 [debug] [Thread-1 (]: Using postgres connection "model.global_economic_tracker.stg_commodity_metrics"
[0m19:49:03.431470 [debug] [Thread-4 (]: Using postgres connection "model.global_economic_tracker.stg_index_metrics"
[0m19:49:03.432246 [debug] [Thread-1 (]: On model.global_economic_tracker.stg_commodity_metrics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_commodity_metrics"} */
alter table "airflow"."public"."stg_commodity_metrics__dbt_tmp" rename to "stg_commodity_metrics"
[0m19:49:03.432974 [debug] [Thread-4 (]: On model.global_economic_tracker.stg_index_metrics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_index_metrics"} */
alter table "airflow"."public"."stg_index_metrics__dbt_tmp" rename to "stg_index_metrics"
[0m19:49:03.433865 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:49:03.434585 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m19:49:03.435785 [debug] [Thread-1 (]: Using postgres connection "model.global_economic_tracker.stg_commodity_metrics"
[0m19:49:03.437122 [debug] [Thread-4 (]: Using postgres connection "model.global_economic_tracker.stg_index_metrics"
[0m19:49:03.437835 [debug] [Thread-1 (]: On model.global_economic_tracker.stg_commodity_metrics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_commodity_metrics"} */

        CREATE INDEX IF NOT EXISTS idx_commodity_ticker_ts ON "airflow"."public"."stg_commodity_metrics"(ticker, timestamp)
      
[0m19:49:03.438533 [debug] [Thread-4 (]: On model.global_economic_tracker.stg_index_metrics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_index_metrics"} */

        CREATE INDEX IF NOT EXISTS idx_index_ticker_ts ON "airflow"."public"."stg_index_metrics"(ticker, timestamp)
      
[0m19:49:03.441782 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.003 seconds
[0m19:49:03.442934 [debug] [Thread-1 (]: On model.global_economic_tracker.stg_commodity_metrics: COMMIT
[0m19:49:03.443375 [debug] [Thread-4 (]: SQL status: CREATE INDEX in 0.004 seconds
[0m19:49:03.443930 [debug] [Thread-1 (]: Using postgres connection "model.global_economic_tracker.stg_commodity_metrics"
[0m19:49:03.445232 [debug] [Thread-4 (]: On model.global_economic_tracker.stg_index_metrics: COMMIT
[0m19:49:03.445931 [debug] [Thread-1 (]: On model.global_economic_tracker.stg_commodity_metrics: COMMIT
[0m19:49:03.446666 [debug] [Thread-4 (]: Using postgres connection "model.global_economic_tracker.stg_index_metrics"
[0m19:49:03.447900 [debug] [Thread-4 (]: On model.global_economic_tracker.stg_index_metrics: COMMIT
[0m19:49:03.449248 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m19:49:03.450935 [debug] [Thread-1 (]: Applying DROP to: "airflow"."public"."stg_commodity_metrics__dbt_backup"
[0m19:49:03.451158 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m19:49:03.451900 [debug] [Thread-1 (]: Using postgres connection "model.global_economic_tracker.stg_commodity_metrics"
[0m19:49:03.453993 [debug] [Thread-4 (]: Applying DROP to: "airflow"."public"."stg_index_metrics__dbt_backup"
[0m19:49:03.455064 [debug] [Thread-1 (]: On model.global_economic_tracker.stg_commodity_metrics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_commodity_metrics"} */
drop table if exists "airflow"."public"."stg_commodity_metrics__dbt_backup" cascade
[0m19:49:03.456108 [debug] [Thread-4 (]: Using postgres connection "model.global_economic_tracker.stg_index_metrics"
[0m19:49:03.457064 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m19:49:03.457449 [debug] [Thread-4 (]: On model.global_economic_tracker.stg_index_metrics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_index_metrics"} */
drop table if exists "airflow"."public"."stg_index_metrics__dbt_backup" cascade
[0m19:49:03.458593 [debug] [Thread-1 (]: On model.global_economic_tracker.stg_commodity_metrics: Close
[0m19:49:03.460179 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9dc5aec9-0a8d-4fa8-a20f-6b0753906331', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4255793b50>]}
[0m19:49:03.460765 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.001 seconds
[0m19:49:03.461487 [info ] [Thread-1 (]: 12 of 24 OK created sql table model public.stg_commodity_metrics ............... [[32mSELECT 517[0m in 0.09s]
[0m19:49:03.462636 [debug] [Thread-4 (]: On model.global_economic_tracker.stg_index_metrics: Close
[0m19:49:03.463430 [debug] [Thread-1 (]: Finished running node model.global_economic_tracker.stg_commodity_metrics
[0m19:49:03.464311 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9dc5aec9-0a8d-4fa8-a20f-6b0753906331', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4255791210>]}
[0m19:49:03.465724 [debug] [Thread-2 (]: Began running node test.global_economic_tracker.accepted_values_stg_commodity_metrics_trend__up__down__flat.70479897b5
[0m19:49:03.465969 [debug] [Thread-3 (]: Began running node test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_daily_return__0_5___0_5.2c4246e1e4
[0m19:49:03.466238 [debug] [Thread-1 (]: Began running node test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_rolling_avg_mo__0_3___0_3.22c9d514f7
[0m19:49:03.466621 [info ] [Thread-4 (]: 11 of 24 OK created sql table model public.stg_index_metrics ................... [[32mSELECT 0[0m in 0.10s]
[0m19:49:03.467357 [info ] [Thread-2 (]: 13 of 24 START test accepted_values_stg_commodity_metrics_trend__up__down__flat  [RUN]
[0m19:49:03.468143 [info ] [Thread-3 (]: 14 of 24 START test dbt_utils_accepted_range_stg_commodity_metrics_daily_return__0_5___0_5  [RUN]
[0m19:49:03.468836 [info ] [Thread-1 (]: 15 of 24 START test dbt_utils_accepted_range_stg_commodity_metrics_rolling_avg_mo__0_3___0_3  [RUN]
[0m19:49:03.469609 [debug] [Thread-4 (]: Finished running node model.global_economic_tracker.stg_index_metrics
[0m19:49:03.470332 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359, now test.global_economic_tracker.accepted_values_stg_commodity_metrics_trend__up__down__flat.70479897b5)
[0m19:49:03.471110 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d, now test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_daily_return__0_5___0_5.2c4246e1e4)
[0m19:49:03.471835 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.global_economic_tracker.stg_commodity_metrics, now test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_rolling_avg_mo__0_3___0_3.22c9d514f7)
[0m19:49:03.472610 [debug] [Thread-4 (]: Began running node test.global_economic_tracker.not_null_stg_commodity_metrics_daily_return.74b14cc336
[0m19:49:03.473415 [debug] [Thread-2 (]: Began compiling node test.global_economic_tracker.accepted_values_stg_commodity_metrics_trend__up__down__flat.70479897b5
[0m19:49:03.474106 [debug] [Thread-3 (]: Began compiling node test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_daily_return__0_5___0_5.2c4246e1e4
[0m19:49:03.474797 [debug] [Thread-1 (]: Began compiling node test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_rolling_avg_mo__0_3___0_3.22c9d514f7
[0m19:49:03.475512 [info ] [Thread-4 (]: 16 of 24 START test not_null_stg_commodity_metrics_daily_return ................ [RUN]
[0m19:49:03.478199 [debug] [Thread-2 (]: Writing injected SQL for node "test.global_economic_tracker.accepted_values_stg_commodity_metrics_trend__up__down__flat.70479897b5"
[0m19:49:03.480821 [debug] [Thread-3 (]: Writing injected SQL for node "test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_daily_return__0_5___0_5.2c4246e1e4"
[0m19:49:03.483438 [debug] [Thread-1 (]: Writing injected SQL for node "test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_rolling_avg_mo__0_3___0_3.22c9d514f7"
[0m19:49:03.484509 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.global_economic_tracker.stg_index_metrics, now test.global_economic_tracker.not_null_stg_commodity_metrics_daily_return.74b14cc336)
[0m19:49:03.486889 [debug] [Thread-4 (]: Began compiling node test.global_economic_tracker.not_null_stg_commodity_metrics_daily_return.74b14cc336
[0m19:49:03.489421 [debug] [Thread-4 (]: Writing injected SQL for node "test.global_economic_tracker.not_null_stg_commodity_metrics_daily_return.74b14cc336"
[0m19:49:03.490443 [debug] [Thread-2 (]: Began executing node test.global_economic_tracker.accepted_values_stg_commodity_metrics_trend__up__down__flat.70479897b5
[0m19:49:03.490817 [debug] [Thread-1 (]: Began executing node test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_rolling_avg_mo__0_3___0_3.22c9d514f7
[0m19:49:03.491570 [debug] [Thread-3 (]: Began executing node test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_daily_return__0_5___0_5.2c4246e1e4
[0m19:49:03.492743 [debug] [Thread-2 (]: Writing runtime sql for node "test.global_economic_tracker.accepted_values_stg_commodity_metrics_trend__up__down__flat.70479897b5"
[0m19:49:03.495175 [debug] [Thread-1 (]: Writing runtime sql for node "test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_rolling_avg_mo__0_3___0_3.22c9d514f7"
[0m19:49:03.495442 [debug] [Thread-4 (]: Began executing node test.global_economic_tracker.not_null_stg_commodity_metrics_daily_return.74b14cc336
[0m19:49:03.496886 [debug] [Thread-3 (]: Writing runtime sql for node "test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_daily_return__0_5___0_5.2c4246e1e4"
[0m19:49:03.499598 [debug] [Thread-4 (]: Writing runtime sql for node "test.global_economic_tracker.not_null_stg_commodity_metrics_daily_return.74b14cc336"
[0m19:49:03.502614 [debug] [Thread-2 (]: Using postgres connection "test.global_economic_tracker.accepted_values_stg_commodity_metrics_trend__up__down__flat.70479897b5"
[0m19:49:03.503376 [debug] [Thread-2 (]: On test.global_economic_tracker.accepted_values_stg_commodity_metrics_trend__up__down__flat.70479897b5: BEGIN
[0m19:49:03.503631 [debug] [Thread-1 (]: Using postgres connection "test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_rolling_avg_mo__0_3___0_3.22c9d514f7"
[0m19:49:03.504294 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:49:03.504576 [debug] [Thread-3 (]: Using postgres connection "test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_daily_return__0_5___0_5.2c4246e1e4"
[0m19:49:03.505185 [debug] [Thread-1 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_rolling_avg_mo__0_3___0_3.22c9d514f7: BEGIN
[0m19:49:03.506419 [debug] [Thread-4 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_commodity_metrics_daily_return.74b14cc336"
[0m19:49:03.506806 [debug] [Thread-3 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_daily_return__0_5___0_5.2c4246e1e4: BEGIN
[0m19:49:03.507493 [debug] [Thread-2 (]: SQL status: BEGIN in 0.003 seconds
[0m19:49:03.507731 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:49:03.508456 [debug] [Thread-4 (]: On test.global_economic_tracker.not_null_stg_commodity_metrics_daily_return.74b14cc336: BEGIN
[0m19:49:03.509206 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:49:03.509934 [debug] [Thread-2 (]: Using postgres connection "test.global_economic_tracker.accepted_values_stg_commodity_metrics_trend__up__down__flat.70479897b5"
[0m19:49:03.511267 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:49:03.512047 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m19:49:03.512935 [debug] [Thread-2 (]: On test.global_economic_tracker.accepted_values_stg_commodity_metrics_trend__up__down__flat.70479897b5: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.accepted_values_stg_commodity_metrics_trend__up__down__flat.70479897b5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        trend as value_field,
        count(*) as n_records

    from "airflow"."public"."stg_commodity_metrics"
    group by trend

)

select *
from all_values
where value_field not in (
    'up','down','flat'
)



      
    ) dbt_internal_test
[0m19:49:03.514090 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m19:49:03.514490 [debug] [Thread-1 (]: Using postgres connection "test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_rolling_avg_mo__0_3___0_3.22c9d514f7"
[0m19:49:03.515335 [debug] [Thread-4 (]: SQL status: BEGIN in 0.004 seconds
[0m19:49:03.515822 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m19:49:03.516095 [debug] [Thread-3 (]: Using postgres connection "test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_daily_return__0_5___0_5.2c4246e1e4"
[0m19:49:03.516822 [debug] [Thread-1 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_rolling_avg_mo__0_3___0_3.22c9d514f7: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_rolling_avg_mo__0_3___0_3.22c9d514f7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with meet_condition as(
  select *
  from "airflow"."public"."stg_commodity_metrics"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not rolling_avg_mo >= -0.3
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not rolling_avg_mo <= 0.3
)

select *
from validation_errors


      
    ) dbt_internal_test
[0m19:49:03.517534 [debug] [Thread-4 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_commodity_metrics_daily_return.74b14cc336"
[0m19:49:03.518733 [debug] [Thread-2 (]: On test.global_economic_tracker.accepted_values_stg_commodity_metrics_trend__up__down__flat.70479897b5: ROLLBACK
[0m19:49:03.519457 [debug] [Thread-3 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_daily_return__0_5___0_5.2c4246e1e4: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_daily_return__0_5___0_5.2c4246e1e4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with meet_condition as(
  select *
  from "airflow"."public"."stg_commodity_metrics"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not daily_return >= -0.5
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not daily_return <= 0.5
)

select *
from validation_errors


      
    ) dbt_internal_test
[0m19:49:03.520728 [debug] [Thread-4 (]: On test.global_economic_tracker.not_null_stg_commodity_metrics_daily_return.74b14cc336: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.not_null_stg_commodity_metrics_daily_return.74b14cc336"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select daily_return
from "airflow"."public"."stg_commodity_metrics"
where daily_return is null



      
    ) dbt_internal_test
[0m19:49:03.520991 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m19:49:03.521623 [debug] [Thread-2 (]: On test.global_economic_tracker.accepted_values_stg_commodity_metrics_trend__up__down__flat.70479897b5: Close
[0m19:49:03.522764 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m19:49:03.523073 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.000 seconds
[0m19:49:03.524099 [debug] [Thread-1 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_rolling_avg_mo__0_3___0_3.22c9d514f7: ROLLBACK
[0m19:49:03.524993 [info ] [Thread-2 (]: 13 of 24 PASS accepted_values_stg_commodity_metrics_trend__up__down__flat ...... [[32mPASS[0m in 0.05s]
[0m19:49:03.526019 [debug] [Thread-3 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_daily_return__0_5___0_5.2c4246e1e4: ROLLBACK
[0m19:49:03.527157 [debug] [Thread-4 (]: On test.global_economic_tracker.not_null_stg_commodity_metrics_daily_return.74b14cc336: ROLLBACK
[0m19:49:03.528004 [debug] [Thread-1 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_rolling_avg_mo__0_3___0_3.22c9d514f7: Close
[0m19:49:03.528637 [debug] [Thread-2 (]: Finished running node test.global_economic_tracker.accepted_values_stg_commodity_metrics_trend__up__down__flat.70479897b5
[0m19:49:03.529429 [debug] [Thread-3 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_daily_return__0_5___0_5.2c4246e1e4: Close
[0m19:49:03.530058 [debug] [Thread-4 (]: On test.global_economic_tracker.not_null_stg_commodity_metrics_daily_return.74b14cc336: Close
[0m19:49:03.530791 [info ] [Thread-1 (]: 15 of 24 PASS dbt_utils_accepted_range_stg_commodity_metrics_rolling_avg_mo__0_3___0_3  [[32mPASS[0m in 0.06s]
[0m19:49:03.531433 [debug] [Thread-2 (]: Began running node test.global_economic_tracker.not_null_stg_commodity_metrics_ticker.6d1d8d12d7
[0m19:49:03.532298 [info ] [Thread-3 (]: 14 of 24 PASS dbt_utils_accepted_range_stg_commodity_metrics_daily_return__0_5___0_5  [[32mPASS[0m in 0.06s]
[0m19:49:03.532945 [info ] [Thread-4 (]: 16 of 24 PASS not_null_stg_commodity_metrics_daily_return ...................... [[32mPASS[0m in 0.05s]
[0m19:49:03.533501 [debug] [Thread-1 (]: Finished running node test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_rolling_avg_mo__0_3___0_3.22c9d514f7
[0m19:49:03.534205 [info ] [Thread-2 (]: 17 of 24 START test not_null_stg_commodity_metrics_ticker ...................... [RUN]
[0m19:49:03.535147 [debug] [Thread-3 (]: Finished running node test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_daily_return__0_5___0_5.2c4246e1e4
[0m19:49:03.536107 [debug] [Thread-4 (]: Finished running node test.global_economic_tracker.not_null_stg_commodity_metrics_daily_return.74b14cc336
[0m19:49:03.536910 [debug] [Thread-1 (]: Began running node test.global_economic_tracker.not_null_stg_commodity_metrics_timestamp.5651d4b196
[0m19:49:03.537655 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.global_economic_tracker.accepted_values_stg_commodity_metrics_trend__up__down__flat.70479897b5, now test.global_economic_tracker.not_null_stg_commodity_metrics_ticker.6d1d8d12d7)
[0m19:49:03.538405 [debug] [Thread-3 (]: Began running node test.global_economic_tracker.accepted_values_stg_index_metrics_trend__up__down__flat.1fea418295
[0m19:49:03.539170 [debug] [Thread-4 (]: Began running node test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_daily_return__0_5___0_5.6e9f33b0a2
[0m19:49:03.539945 [info ] [Thread-1 (]: 18 of 24 START test not_null_stg_commodity_metrics_timestamp ................... [RUN]
[0m19:49:03.540701 [debug] [Thread-2 (]: Began compiling node test.global_economic_tracker.not_null_stg_commodity_metrics_ticker.6d1d8d12d7
[0m19:49:03.541447 [info ] [Thread-3 (]: 19 of 24 START test accepted_values_stg_index_metrics_trend__up__down__flat .... [RUN]
[0m19:49:03.542130 [info ] [Thread-4 (]: 20 of 24 START test dbt_utils_accepted_range_stg_index_metrics_daily_return__0_5___0_5  [RUN]
[0m19:49:03.542846 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_rolling_avg_mo__0_3___0_3.22c9d514f7, now test.global_economic_tracker.not_null_stg_commodity_metrics_timestamp.5651d4b196)
[0m19:49:03.545449 [debug] [Thread-2 (]: Writing injected SQL for node "test.global_economic_tracker.not_null_stg_commodity_metrics_ticker.6d1d8d12d7"
[0m19:49:03.546190 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_daily_return__0_5___0_5.2c4246e1e4, now test.global_economic_tracker.accepted_values_stg_index_metrics_trend__up__down__flat.1fea418295)
[0m19:49:03.546919 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.global_economic_tracker.not_null_stg_commodity_metrics_daily_return.74b14cc336, now test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_daily_return__0_5___0_5.6e9f33b0a2)
[0m19:49:03.547741 [debug] [Thread-1 (]: Began compiling node test.global_economic_tracker.not_null_stg_commodity_metrics_timestamp.5651d4b196
[0m19:49:03.549074 [debug] [Thread-3 (]: Began compiling node test.global_economic_tracker.accepted_values_stg_index_metrics_trend__up__down__flat.1fea418295
[0m19:49:03.549740 [debug] [Thread-4 (]: Began compiling node test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_daily_return__0_5___0_5.6e9f33b0a2
[0m19:49:03.552202 [debug] [Thread-1 (]: Writing injected SQL for node "test.global_economic_tracker.not_null_stg_commodity_metrics_timestamp.5651d4b196"
[0m19:49:03.554625 [debug] [Thread-3 (]: Writing injected SQL for node "test.global_economic_tracker.accepted_values_stg_index_metrics_trend__up__down__flat.1fea418295"
[0m19:49:03.558039 [debug] [Thread-4 (]: Writing injected SQL for node "test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_daily_return__0_5___0_5.6e9f33b0a2"
[0m19:49:03.558290 [debug] [Thread-2 (]: Began executing node test.global_economic_tracker.not_null_stg_commodity_metrics_ticker.6d1d8d12d7
[0m19:49:03.561557 [debug] [Thread-2 (]: Writing runtime sql for node "test.global_economic_tracker.not_null_stg_commodity_metrics_ticker.6d1d8d12d7"
[0m19:49:03.565518 [debug] [Thread-4 (]: Began executing node test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_daily_return__0_5___0_5.6e9f33b0a2
[0m19:49:03.565768 [debug] [Thread-1 (]: Began executing node test.global_economic_tracker.not_null_stg_commodity_metrics_timestamp.5651d4b196
[0m19:49:03.567203 [debug] [Thread-4 (]: Writing runtime sql for node "test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_daily_return__0_5___0_5.6e9f33b0a2"
[0m19:49:03.569067 [debug] [Thread-1 (]: Writing runtime sql for node "test.global_economic_tracker.not_null_stg_commodity_metrics_timestamp.5651d4b196"
[0m19:49:03.569323 [debug] [Thread-3 (]: Began executing node test.global_economic_tracker.accepted_values_stg_index_metrics_trend__up__down__flat.1fea418295
[0m19:49:03.569579 [debug] [Thread-2 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_commodity_metrics_ticker.6d1d8d12d7"
[0m19:49:03.572269 [debug] [Thread-3 (]: Writing runtime sql for node "test.global_economic_tracker.accepted_values_stg_index_metrics_trend__up__down__flat.1fea418295"
[0m19:49:03.573002 [debug] [Thread-2 (]: On test.global_economic_tracker.not_null_stg_commodity_metrics_ticker.6d1d8d12d7: BEGIN
[0m19:49:03.574489 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:49:03.574774 [debug] [Thread-4 (]: Using postgres connection "test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_daily_return__0_5___0_5.6e9f33b0a2"
[0m19:49:03.575040 [debug] [Thread-1 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_commodity_metrics_timestamp.5651d4b196"
[0m19:49:03.576161 [debug] [Thread-4 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_daily_return__0_5___0_5.6e9f33b0a2: BEGIN
[0m19:49:03.576807 [debug] [Thread-2 (]: SQL status: BEGIN in 0.002 seconds
[0m19:49:03.577056 [debug] [Thread-3 (]: Using postgres connection "test.global_economic_tracker.accepted_values_stg_index_metrics_trend__up__down__flat.1fea418295"
[0m19:49:03.577300 [debug] [Thread-1 (]: On test.global_economic_tracker.not_null_stg_commodity_metrics_timestamp.5651d4b196: BEGIN
[0m19:49:03.578024 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:49:03.578731 [debug] [Thread-2 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_commodity_metrics_ticker.6d1d8d12d7"
[0m19:49:03.579435 [debug] [Thread-3 (]: On test.global_economic_tracker.accepted_values_stg_index_metrics_trend__up__down__flat.1fea418295: BEGIN
[0m19:49:03.580126 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:49:03.581726 [debug] [Thread-2 (]: On test.global_economic_tracker.not_null_stg_commodity_metrics_ticker.6d1d8d12d7: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.not_null_stg_commodity_metrics_ticker.6d1d8d12d7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select ticker
from "airflow"."public"."stg_commodity_metrics"
where ticker is null



      
    ) dbt_internal_test
[0m19:49:03.582326 [debug] [Thread-4 (]: SQL status: BEGIN in 0.004 seconds
[0m19:49:03.582573 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:49:03.584734 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.000 seconds
[0m19:49:03.584976 [debug] [Thread-4 (]: Using postgres connection "test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_daily_return__0_5___0_5.6e9f33b0a2"
[0m19:49:03.585464 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m19:49:03.587685 [debug] [Thread-2 (]: On test.global_economic_tracker.not_null_stg_commodity_metrics_ticker.6d1d8d12d7: ROLLBACK
[0m19:49:03.588256 [debug] [Thread-3 (]: SQL status: BEGIN in 0.006 seconds
[0m19:49:03.588649 [debug] [Thread-4 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_daily_return__0_5___0_5.6e9f33b0a2: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_daily_return__0_5___0_5.6e9f33b0a2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with meet_condition as(
  select *
  from "airflow"."public"."stg_index_metrics"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not daily_return >= -0.5
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not daily_return <= 0.5
)

select *
from validation_errors


      
    ) dbt_internal_test
[0m19:49:03.589397 [debug] [Thread-1 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_commodity_metrics_timestamp.5651d4b196"
[0m19:49:03.590201 [debug] [Thread-2 (]: On test.global_economic_tracker.not_null_stg_commodity_metrics_ticker.6d1d8d12d7: Close
[0m19:49:03.590764 [debug] [Thread-3 (]: Using postgres connection "test.global_economic_tracker.accepted_values_stg_index_metrics_trend__up__down__flat.1fea418295"
[0m19:49:03.591984 [debug] [Thread-1 (]: On test.global_economic_tracker.not_null_stg_commodity_metrics_timestamp.5651d4b196: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.not_null_stg_commodity_metrics_timestamp.5651d4b196"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select timestamp
from "airflow"."public"."stg_commodity_metrics"
where timestamp is null



      
    ) dbt_internal_test
[0m19:49:03.592254 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m19:49:03.593103 [info ] [Thread-2 (]: 17 of 24 PASS not_null_stg_commodity_metrics_ticker ............................ [[32mPASS[0m in 0.06s]
[0m19:49:03.593823 [debug] [Thread-3 (]: On test.global_economic_tracker.accepted_values_stg_index_metrics_trend__up__down__flat.1fea418295: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.accepted_values_stg_index_metrics_trend__up__down__flat.1fea418295"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        trend as value_field,
        count(*) as n_records

    from "airflow"."public"."stg_index_metrics"
    group by trend

)

select *
from all_values
where value_field not in (
    'up','down','flat'
)



      
    ) dbt_internal_test
[0m19:49:03.594974 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.000 seconds
[0m19:49:03.595773 [debug] [Thread-4 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_daily_return__0_5___0_5.6e9f33b0a2: ROLLBACK
[0m19:49:03.596566 [debug] [Thread-2 (]: Finished running node test.global_economic_tracker.not_null_stg_commodity_metrics_ticker.6d1d8d12d7
[0m19:49:03.598211 [debug] [Thread-1 (]: On test.global_economic_tracker.not_null_stg_commodity_metrics_timestamp.5651d4b196: ROLLBACK
[0m19:49:03.598447 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m19:49:03.599250 [debug] [Thread-4 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_daily_return__0_5___0_5.6e9f33b0a2: Close
[0m19:49:03.599820 [debug] [Thread-2 (]: Began running node test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_rolling_avg_mo__0_3___0_3.13a5241921
[0m19:49:03.600664 [debug] [Thread-1 (]: On test.global_economic_tracker.not_null_stg_commodity_metrics_timestamp.5651d4b196: Close
[0m19:49:03.601643 [debug] [Thread-3 (]: On test.global_economic_tracker.accepted_values_stg_index_metrics_trend__up__down__flat.1fea418295: ROLLBACK
[0m19:49:03.602559 [info ] [Thread-4 (]: 20 of 24 PASS dbt_utils_accepted_range_stg_index_metrics_daily_return__0_5___0_5  [[32mPASS[0m in 0.06s]
[0m19:49:03.603119 [info ] [Thread-2 (]: 21 of 24 START test dbt_utils_accepted_range_stg_index_metrics_rolling_avg_mo__0_3___0_3  [RUN]
[0m19:49:03.603985 [info ] [Thread-1 (]: 18 of 24 PASS not_null_stg_commodity_metrics_timestamp ......................... [[32mPASS[0m in 0.06s]
[0m19:49:03.604630 [debug] [Thread-3 (]: On test.global_economic_tracker.accepted_values_stg_index_metrics_trend__up__down__flat.1fea418295: Close
[0m19:49:03.605308 [debug] [Thread-4 (]: Finished running node test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_daily_return__0_5___0_5.6e9f33b0a2
[0m19:49:03.606081 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.global_economic_tracker.not_null_stg_commodity_metrics_ticker.6d1d8d12d7, now test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_rolling_avg_mo__0_3___0_3.13a5241921)
[0m19:49:03.606888 [debug] [Thread-1 (]: Finished running node test.global_economic_tracker.not_null_stg_commodity_metrics_timestamp.5651d4b196
[0m19:49:03.607709 [info ] [Thread-3 (]: 19 of 24 PASS accepted_values_stg_index_metrics_trend__up__down__flat .......... [[32mPASS[0m in 0.06s]
[0m19:49:03.608256 [debug] [Thread-4 (]: Began running node test.global_economic_tracker.not_null_stg_index_metrics_daily_return.26f4856193
[0m19:49:03.608980 [debug] [Thread-2 (]: Began compiling node test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_rolling_avg_mo__0_3___0_3.13a5241921
[0m19:49:03.609714 [debug] [Thread-1 (]: Began running node test.global_economic_tracker.not_null_stg_index_metrics_ticker.4b922607c9
[0m19:49:03.610630 [debug] [Thread-3 (]: Finished running node test.global_economic_tracker.accepted_values_stg_index_metrics_trend__up__down__flat.1fea418295
[0m19:49:03.611336 [info ] [Thread-4 (]: 22 of 24 START test not_null_stg_index_metrics_daily_return .................... [RUN]
[0m19:49:03.613971 [debug] [Thread-2 (]: Writing injected SQL for node "test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_rolling_avg_mo__0_3___0_3.13a5241921"
[0m19:49:03.614796 [info ] [Thread-1 (]: 23 of 24 START test not_null_stg_index_metrics_ticker .......................... [RUN]
[0m19:49:03.615654 [debug] [Thread-3 (]: Began running node test.global_economic_tracker.not_null_stg_index_metrics_timestamp.b1d1abca86
[0m19:49:03.616435 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_daily_return__0_5___0_5.6e9f33b0a2, now test.global_economic_tracker.not_null_stg_index_metrics_daily_return.26f4856193)
[0m19:49:03.617741 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.global_economic_tracker.not_null_stg_commodity_metrics_timestamp.5651d4b196, now test.global_economic_tracker.not_null_stg_index_metrics_ticker.4b922607c9)
[0m19:49:03.618497 [info ] [Thread-3 (]: 24 of 24 START test not_null_stg_index_metrics_timestamp ....................... [RUN]
[0m19:49:03.619218 [debug] [Thread-4 (]: Began compiling node test.global_economic_tracker.not_null_stg_index_metrics_daily_return.26f4856193
[0m19:49:03.619929 [debug] [Thread-1 (]: Began compiling node test.global_economic_tracker.not_null_stg_index_metrics_ticker.4b922607c9
[0m19:49:03.620704 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.global_economic_tracker.accepted_values_stg_index_metrics_trend__up__down__flat.1fea418295, now test.global_economic_tracker.not_null_stg_index_metrics_timestamp.b1d1abca86)
[0m19:49:03.623816 [debug] [Thread-4 (]: Writing injected SQL for node "test.global_economic_tracker.not_null_stg_index_metrics_daily_return.26f4856193"
[0m19:49:03.626426 [debug] [Thread-1 (]: Writing injected SQL for node "test.global_economic_tracker.not_null_stg_index_metrics_ticker.4b922607c9"
[0m19:49:03.626690 [debug] [Thread-2 (]: Began executing node test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_rolling_avg_mo__0_3___0_3.13a5241921
[0m19:49:03.627265 [debug] [Thread-3 (]: Began compiling node test.global_economic_tracker.not_null_stg_index_metrics_timestamp.b1d1abca86
[0m19:49:03.630030 [debug] [Thread-2 (]: Writing runtime sql for node "test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_rolling_avg_mo__0_3___0_3.13a5241921"
[0m19:49:03.632500 [debug] [Thread-3 (]: Writing injected SQL for node "test.global_economic_tracker.not_null_stg_index_metrics_timestamp.b1d1abca86"
[0m19:49:03.633467 [debug] [Thread-1 (]: Began executing node test.global_economic_tracker.not_null_stg_index_metrics_ticker.4b922607c9
[0m19:49:03.634064 [debug] [Thread-4 (]: Began executing node test.global_economic_tracker.not_null_stg_index_metrics_daily_return.26f4856193
[0m19:49:03.635923 [debug] [Thread-1 (]: Writing runtime sql for node "test.global_economic_tracker.not_null_stg_index_metrics_ticker.4b922607c9"
[0m19:49:03.637553 [debug] [Thread-4 (]: Writing runtime sql for node "test.global_economic_tracker.not_null_stg_index_metrics_daily_return.26f4856193"
[0m19:49:03.639490 [debug] [Thread-2 (]: Using postgres connection "test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_rolling_avg_mo__0_3___0_3.13a5241921"
[0m19:49:03.640415 [debug] [Thread-2 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_rolling_avg_mo__0_3___0_3.13a5241921: BEGIN
[0m19:49:03.641079 [debug] [Thread-1 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_index_metrics_ticker.4b922607c9"
[0m19:49:03.641606 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:49:03.642251 [debug] [Thread-4 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_index_metrics_daily_return.26f4856193"
[0m19:49:03.642631 [debug] [Thread-1 (]: On test.global_economic_tracker.not_null_stg_index_metrics_ticker.4b922607c9: BEGIN
[0m19:49:03.642887 [debug] [Thread-3 (]: Began executing node test.global_economic_tracker.not_null_stg_index_metrics_timestamp.b1d1abca86
[0m19:49:03.644226 [debug] [Thread-4 (]: On test.global_economic_tracker.not_null_stg_index_metrics_daily_return.26f4856193: BEGIN
[0m19:49:03.644833 [debug] [Thread-2 (]: SQL status: BEGIN in 0.003 seconds
[0m19:49:03.645067 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:49:03.647173 [debug] [Thread-3 (]: Writing runtime sql for node "test.global_economic_tracker.not_null_stg_index_metrics_timestamp.b1d1abca86"
[0m19:49:03.648007 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:49:03.648715 [debug] [Thread-2 (]: Using postgres connection "test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_rolling_avg_mo__0_3___0_3.13a5241921"
[0m19:49:03.651137 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m19:49:03.652127 [debug] [Thread-2 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_rolling_avg_mo__0_3___0_3.13a5241921: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_rolling_avg_mo__0_3___0_3.13a5241921"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with meet_condition as(
  select *
  from "airflow"."public"."stg_index_metrics"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not rolling_avg_mo >= -0.3
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not rolling_avg_mo <= 0.3
)

select *
from validation_errors


      
    ) dbt_internal_test
[0m19:49:03.652754 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m19:49:03.652990 [debug] [Thread-1 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_index_metrics_ticker.4b922607c9"
[0m19:49:03.654213 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m19:49:03.654458 [debug] [Thread-4 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_index_metrics_daily_return.26f4856193"
[0m19:49:03.655165 [debug] [Thread-1 (]: On test.global_economic_tracker.not_null_stg_index_metrics_ticker.4b922607c9: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.not_null_stg_index_metrics_ticker.4b922607c9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select ticker
from "airflow"."public"."stg_index_metrics"
where ticker is null



      
    ) dbt_internal_test
[0m19:49:03.656374 [debug] [Thread-2 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_rolling_avg_mo__0_3___0_3.13a5241921: ROLLBACK
[0m19:49:03.657123 [debug] [Thread-4 (]: On test.global_economic_tracker.not_null_stg_index_metrics_daily_return.26f4856193: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.not_null_stg_index_metrics_daily_return.26f4856193"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select daily_return
from "airflow"."public"."stg_index_metrics"
where daily_return is null



      
    ) dbt_internal_test
[0m19:49:03.657821 [debug] [Thread-3 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_index_metrics_timestamp.b1d1abca86"
[0m19:49:03.658397 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.000 seconds
[0m19:49:03.658877 [debug] [Thread-2 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_rolling_avg_mo__0_3___0_3.13a5241921: Close
[0m19:49:03.659729 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.000 seconds
[0m19:49:03.660102 [debug] [Thread-3 (]: On test.global_economic_tracker.not_null_stg_index_metrics_timestamp.b1d1abca86: BEGIN
[0m19:49:03.661254 [debug] [Thread-1 (]: On test.global_economic_tracker.not_null_stg_index_metrics_ticker.4b922607c9: ROLLBACK
[0m19:49:03.662114 [info ] [Thread-2 (]: 21 of 24 PASS dbt_utils_accepted_range_stg_index_metrics_rolling_avg_mo__0_3___0_3  [[32mPASS[0m in 0.06s]
[0m19:49:03.663262 [debug] [Thread-4 (]: On test.global_economic_tracker.not_null_stg_index_metrics_daily_return.26f4856193: ROLLBACK
[0m19:49:03.663981 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:49:03.664787 [debug] [Thread-1 (]: On test.global_economic_tracker.not_null_stg_index_metrics_ticker.4b922607c9: Close
[0m19:49:03.665463 [debug] [Thread-2 (]: Finished running node test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_rolling_avg_mo__0_3___0_3.13a5241921
[0m19:49:03.666279 [debug] [Thread-4 (]: On test.global_economic_tracker.not_null_stg_index_metrics_daily_return.26f4856193: Close
[0m19:49:03.668223 [info ] [Thread-1 (]: 23 of 24 PASS not_null_stg_index_metrics_ticker ................................ [[32mPASS[0m in 0.05s]
[0m19:49:03.669383 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m19:49:03.669924 [info ] [Thread-4 (]: 22 of 24 PASS not_null_stg_index_metrics_daily_return .......................... [[32mPASS[0m in 0.05s]
[0m19:49:03.670623 [debug] [Thread-1 (]: Finished running node test.global_economic_tracker.not_null_stg_index_metrics_ticker.4b922607c9
[0m19:49:03.671341 [debug] [Thread-3 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_index_metrics_timestamp.b1d1abca86"
[0m19:49:03.672132 [debug] [Thread-4 (]: Finished running node test.global_economic_tracker.not_null_stg_index_metrics_daily_return.26f4856193
[0m19:49:03.673635 [debug] [Thread-3 (]: On test.global_economic_tracker.not_null_stg_index_metrics_timestamp.b1d1abca86: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.not_null_stg_index_metrics_timestamp.b1d1abca86"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select timestamp
from "airflow"."public"."stg_index_metrics"
where timestamp is null



      
    ) dbt_internal_test
[0m19:49:03.675519 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.000 seconds
[0m19:49:03.676627 [debug] [Thread-3 (]: On test.global_economic_tracker.not_null_stg_index_metrics_timestamp.b1d1abca86: ROLLBACK
[0m19:49:03.677419 [debug] [Thread-3 (]: On test.global_economic_tracker.not_null_stg_index_metrics_timestamp.b1d1abca86: Close
[0m19:49:03.678259 [info ] [Thread-3 (]: 24 of 24 PASS not_null_stg_index_metrics_timestamp ............................. [[32mPASS[0m in 0.06s]
[0m19:49:03.679072 [debug] [Thread-3 (]: Finished running node test.global_economic_tracker.not_null_stg_index_metrics_timestamp.b1d1abca86
[0m19:49:03.680734 [debug] [MainThread]: Using postgres connection "master"
[0m19:49:03.681414 [debug] [MainThread]: On master: BEGIN
[0m19:49:03.682085 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:49:03.684345 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m19:49:03.685051 [debug] [MainThread]: On master: COMMIT
[0m19:49:03.685838 [debug] [MainThread]: Using postgres connection "master"
[0m19:49:03.686522 [debug] [MainThread]: On master: COMMIT
[0m19:49:03.687280 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:49:03.687928 [debug] [MainThread]: On master: Close
[0m19:49:03.688665 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:49:03.689313 [debug] [MainThread]: Connection 'test.global_economic_tracker.not_null_stg_index_metrics_ticker.4b922607c9' was properly closed.
[0m19:49:03.689935 [debug] [MainThread]: Connection 'test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_rolling_avg_mo__0_3___0_3.13a5241921' was properly closed.
[0m19:49:03.690620 [debug] [MainThread]: Connection 'test.global_economic_tracker.not_null_stg_index_metrics_daily_return.26f4856193' was properly closed.
[0m19:49:03.691390 [debug] [MainThread]: Connection 'test.global_economic_tracker.not_null_stg_index_metrics_timestamp.b1d1abca86' was properly closed.
[0m19:49:03.692121 [info ] [MainThread]: 
[0m19:49:03.692828 [info ] [MainThread]: Finished running 4 table models, 20 data tests in 0 hours 0 minutes and 0.66 seconds (0.66s).
[0m19:49:03.694795 [debug] [MainThread]: Command end result
[0m19:49:03.722453 [debug] [MainThread]: Wrote artifact WritableManifest to /mnt/c/Users/joeyk/PycharmProjects/GlobalEconomicTracker/global_economic_tracker/target/manifest.json
[0m19:49:03.725965 [debug] [MainThread]: Wrote artifact SemanticManifest to /mnt/c/Users/joeyk/PycharmProjects/GlobalEconomicTracker/global_economic_tracker/target/semantic_manifest.json
[0m19:49:03.732692 [debug] [MainThread]: Wrote artifact RunExecutionResult to /mnt/c/Users/joeyk/PycharmProjects/GlobalEconomicTracker/global_economic_tracker/target/run_results.json
[0m19:49:03.733335 [info ] [MainThread]: 
[0m19:49:03.734058 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:49:03.734770 [info ] [MainThread]: 
[0m19:49:03.735596 [info ] [MainThread]: Done. PASS=24 WARN=0 ERROR=0 SKIP=0 TOTAL=24
[0m19:49:03.736718 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 2.088755, "process_in_blocks": "0", "process_kernel_time": 0.292442, "process_mem_max_rss": "128432", "process_out_blocks": "0", "process_user_time": 1.442045}
[0m19:49:03.737500 [debug] [MainThread]: Command `dbt build` succeeded at 19:49:03.737427 after 2.09 seconds
[0m19:49:03.738165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4258819ae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f425791ef80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f425791f220>]}
[0m19:49:03.738847 [debug] [MainThread]: Flushing usage events
[0m19:49:04.515419 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:09:22.372323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e7122dae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e711083d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e711097b0>]}


============================== 20:09:22.375260 | 5454c15d-7e83-4b70-b871-8619b1f49501 ==============================
[0m20:09:22.375260 [info ] [MainThread]: Running with dbt=1.9.4
[0m20:09:22.376193 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/mnt/c/Users/joeyk/PycharmProjects/GlobalEconomicTracker/global_economic_tracker/logs', 'profiles_dir': '/home/joey/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:09:22.507581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5454c15d-7e83-4b70-b871-8619b1f49501', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e7299e440>]}
[0m20:09:22.540420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5454c15d-7e83-4b70-b871-8619b1f49501', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e711088b0>]}
[0m20:09:22.542113 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:09:22.594414 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m20:09:23.478405 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:09:23.479580 [debug] [MainThread]: Partial parsing: updated file: global_economic_tracker://models/analytics/schema.yml
[0m20:09:23.745649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5454c15d-7e83-4b70-b871-8619b1f49501', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e728a7d90>]}
[0m20:09:23.800985 [debug] [MainThread]: Wrote artifact WritableManifest to /mnt/c/Users/joeyk/PycharmProjects/GlobalEconomicTracker/global_economic_tracker/target/manifest.json
[0m20:09:23.806528 [debug] [MainThread]: Wrote artifact SemanticManifest to /mnt/c/Users/joeyk/PycharmProjects/GlobalEconomicTracker/global_economic_tracker/target/semantic_manifest.json
[0m20:09:23.832891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5454c15d-7e83-4b70-b871-8619b1f49501', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e6e18d3c0>]}
[0m20:09:23.833826 [info ] [MainThread]: Found 4 models, 22 data tests, 549 macros
[0m20:09:23.836098 [info ] [MainThread]: 
[0m20:09:23.836840 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:09:23.837789 [info ] [MainThread]: 
[0m20:09:23.838729 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:09:23.841703 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m20:09:23.857273 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m20:09:23.858007 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m20:09:23.858737 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:09:23.867267 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.009 seconds
[0m20:09:23.868478 [debug] [ThreadPool]: On list_airflow: Close
[0m20:09:23.869892 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_public)
[0m20:09:23.873327 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m20:09:23.874065 [debug] [ThreadPool]: On list_airflow_public: BEGIN
[0m20:09:23.874727 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:09:23.877249 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m20:09:23.877962 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m20:09:23.878634 [debug] [ThreadPool]: On list_airflow_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:09:23.881123 [debug] [ThreadPool]: SQL status: SELECT 49 in 0.002 seconds
[0m20:09:23.882500 [debug] [ThreadPool]: On list_airflow_public: ROLLBACK
[0m20:09:23.883249 [debug] [ThreadPool]: On list_airflow_public: Close
[0m20:09:23.888508 [debug] [MainThread]: Using postgres connection "master"
[0m20:09:23.889214 [debug] [MainThread]: On master: BEGIN
[0m20:09:23.889872 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:09:23.891937 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m20:09:23.892673 [debug] [MainThread]: Using postgres connection "master"
[0m20:09:23.893358 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:09:23.895183 [debug] [MainThread]: SQL status: SELECT 0 in 0.001 seconds
[0m20:09:23.896296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5454c15d-7e83-4b70-b871-8619b1f49501', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e6e125510>]}
[0m20:09:23.897189 [debug] [MainThread]: On master: ROLLBACK
[0m20:09:23.897988 [debug] [MainThread]: Using postgres connection "master"
[0m20:09:23.898642 [debug] [MainThread]: On master: BEGIN
[0m20:09:23.899511 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m20:09:23.900175 [debug] [MainThread]: On master: COMMIT
[0m20:09:23.900880 [debug] [MainThread]: Using postgres connection "master"
[0m20:09:23.901536 [debug] [MainThread]: On master: COMMIT
[0m20:09:23.902287 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:09:23.902952 [debug] [MainThread]: On master: Close
[0m20:09:23.906864 [debug] [Thread-1 (]: Began running node model.global_economic_tracker.stg_commodity_returns
[0m20:09:23.907114 [debug] [Thread-2 (]: Began running node model.global_economic_tracker.stg_index_returns
[0m20:09:23.907812 [info ] [Thread-1 (]: 1 of 26 START sql table model public.stg_commodity_returns ..................... [RUN]
[0m20:09:23.908623 [info ] [Thread-2 (]: 2 of 26 START sql table model public.stg_index_returns ......................... [RUN]
[0m20:09:23.909385 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_public, now model.global_economic_tracker.stg_commodity_returns)
[0m20:09:23.910179 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.global_economic_tracker.stg_index_returns'
[0m20:09:23.910914 [debug] [Thread-1 (]: Began compiling node model.global_economic_tracker.stg_commodity_returns
[0m20:09:23.911673 [debug] [Thread-2 (]: Began compiling node model.global_economic_tracker.stg_index_returns
[0m20:09:23.915854 [debug] [Thread-1 (]: Writing injected SQL for node "model.global_economic_tracker.stg_commodity_returns"
[0m20:09:23.918190 [debug] [Thread-2 (]: Writing injected SQL for node "model.global_economic_tracker.stg_index_returns"
[0m20:09:23.922906 [debug] [Thread-1 (]: Began executing node model.global_economic_tracker.stg_commodity_returns
[0m20:09:23.929058 [debug] [Thread-2 (]: Began executing node model.global_economic_tracker.stg_index_returns
[0m20:09:23.944193 [debug] [Thread-1 (]: Writing runtime sql for node "model.global_economic_tracker.stg_commodity_returns"
[0m20:09:23.946371 [debug] [Thread-2 (]: Writing runtime sql for node "model.global_economic_tracker.stg_index_returns"
[0m20:09:23.951009 [debug] [Thread-1 (]: Using postgres connection "model.global_economic_tracker.stg_commodity_returns"
[0m20:09:23.951800 [debug] [Thread-1 (]: On model.global_economic_tracker.stg_commodity_returns: BEGIN
[0m20:09:23.952168 [debug] [Thread-2 (]: Using postgres connection "model.global_economic_tracker.stg_index_returns"
[0m20:09:23.952743 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:09:23.953482 [debug] [Thread-2 (]: On model.global_economic_tracker.stg_index_returns: BEGIN
[0m20:09:23.955488 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:09:23.956393 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m20:09:23.957141 [debug] [Thread-1 (]: Using postgres connection "model.global_economic_tracker.stg_commodity_returns"
[0m20:09:23.957730 [debug] [Thread-2 (]: SQL status: BEGIN in 0.002 seconds
[0m20:09:23.958170 [debug] [Thread-1 (]: On model.global_economic_tracker.stg_commodity_returns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_commodity_returns"} */

  
    

  create  table "airflow"."public"."stg_commodity_returns__dbt_tmp"
  
  
    as
  
  (
    

select
    'commodity' as type,
    ticker,
    timestamp,
    price,
    lag(price) over (partition by ticker order by timestamp) as prev_price,
    coalesce((price - lag(price) over (partition by ticker order by timestamp)) / lag(price) over (partition by ticker order by timestamp), 0) as daily_return
from public.commodity_prices
  );
  
[0m20:09:23.958910 [debug] [Thread-2 (]: Using postgres connection "model.global_economic_tracker.stg_index_returns"
[0m20:09:23.960265 [debug] [Thread-2 (]: On model.global_economic_tracker.stg_index_returns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_index_returns"} */

  
    

  create  table "airflow"."public"."stg_index_returns__dbt_tmp"
  
  
    as
  
  (
    

select
    'index' as type,
    country,
    ticker,
    timestamp,
    price,
    lag(price) over (partition by ticker order by timestamp) as prev_price,
    coalesce((price - lag(price) over (partition by ticker order by timestamp)) / lag(price) over (partition by ticker order by timestamp), 0) as daily_return
from public.index_prices
  );
  
[0m20:09:23.964707 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.004 seconds
[0m20:09:23.970601 [debug] [Thread-1 (]: SQL status: SELECT 517 in 0.011 seconds
[0m20:09:23.971597 [debug] [Thread-2 (]: Using postgres connection "model.global_economic_tracker.stg_index_returns"
[0m20:09:23.973999 [debug] [Thread-1 (]: Using postgres connection "model.global_economic_tracker.stg_commodity_returns"
[0m20:09:23.974743 [debug] [Thread-2 (]: On model.global_economic_tracker.stg_index_returns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_index_returns"} */
alter table "airflow"."public"."stg_index_returns" rename to "stg_index_returns__dbt_backup"
[0m20:09:23.975514 [debug] [Thread-1 (]: On model.global_economic_tracker.stg_commodity_returns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_commodity_returns"} */
alter table "airflow"."public"."stg_commodity_returns" rename to "stg_commodity_returns__dbt_backup"
[0m20:09:23.976648 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:09:23.977371 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:09:23.979051 [debug] [Thread-2 (]: Using postgres connection "model.global_economic_tracker.stg_index_returns"
[0m20:09:23.980977 [debug] [Thread-1 (]: Using postgres connection "model.global_economic_tracker.stg_commodity_returns"
[0m20:09:23.981733 [debug] [Thread-2 (]: On model.global_economic_tracker.stg_index_returns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_index_returns"} */
alter table "airflow"."public"."stg_index_returns__dbt_tmp" rename to "stg_index_returns"
[0m20:09:23.982461 [debug] [Thread-1 (]: On model.global_economic_tracker.stg_commodity_returns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_commodity_returns"} */
alter table "airflow"."public"."stg_commodity_returns__dbt_tmp" rename to "stg_commodity_returns"
[0m20:09:23.983713 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:09:23.984221 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:09:23.985266 [debug] [Thread-2 (]: Using postgres connection "model.global_economic_tracker.stg_index_returns"
[0m20:09:23.986630 [debug] [Thread-1 (]: Using postgres connection "model.global_economic_tracker.stg_commodity_returns"
[0m20:09:23.987372 [debug] [Thread-2 (]: On model.global_economic_tracker.stg_index_returns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_index_returns"} */

        CREATE INDEX IF NOT EXISTS idx_index_returns_ticker_ts ON "airflow"."public"."stg_index_returns"(ticker, timestamp)
      
[0m20:09:23.988129 [debug] [Thread-1 (]: On model.global_economic_tracker.stg_commodity_returns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_commodity_returns"} */

        CREATE INDEX IF NOT EXISTS idx_returns_ticker_ts ON "airflow"."public"."stg_commodity_returns"(ticker, timestamp)
      
[0m20:09:23.991314 [debug] [Thread-2 (]: SQL status: CREATE INDEX in 0.002 seconds
[0m20:09:23.999807 [debug] [Thread-2 (]: On model.global_economic_tracker.stg_index_returns: COMMIT
[0m20:09:24.000045 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.011 seconds
[0m20:09:24.001009 [debug] [Thread-2 (]: Using postgres connection "model.global_economic_tracker.stg_index_returns"
[0m20:09:24.002377 [debug] [Thread-1 (]: On model.global_economic_tracker.stg_commodity_returns: COMMIT
[0m20:09:24.003097 [debug] [Thread-2 (]: On model.global_economic_tracker.stg_index_returns: COMMIT
[0m20:09:24.003878 [debug] [Thread-1 (]: Using postgres connection "model.global_economic_tracker.stg_commodity_returns"
[0m20:09:24.005228 [debug] [Thread-1 (]: On model.global_economic_tracker.stg_commodity_returns: COMMIT
[0m20:09:24.006332 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m20:09:24.010087 [debug] [Thread-2 (]: Applying DROP to: "airflow"."public"."stg_index_returns__dbt_backup"
[0m20:09:24.010403 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m20:09:24.013777 [debug] [Thread-2 (]: Using postgres connection "model.global_economic_tracker.stg_index_returns"
[0m20:09:24.015594 [debug] [Thread-1 (]: Applying DROP to: "airflow"."public"."stg_commodity_returns__dbt_backup"
[0m20:09:24.016323 [debug] [Thread-2 (]: On model.global_economic_tracker.stg_index_returns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_index_returns"} */
drop table if exists "airflow"."public"."stg_index_returns__dbt_backup" cascade
[0m20:09:24.017254 [debug] [Thread-1 (]: Using postgres connection "model.global_economic_tracker.stg_commodity_returns"
[0m20:09:24.018512 [debug] [Thread-1 (]: On model.global_economic_tracker.stg_commodity_returns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_commodity_returns"} */
drop table if exists "airflow"."public"."stg_commodity_returns__dbt_backup" cascade
[0m20:09:24.019883 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.002 seconds
[0m20:09:24.022279 [debug] [Thread-2 (]: On model.global_economic_tracker.stg_index_returns: Close
[0m20:09:24.022600 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m20:09:24.024298 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5454c15d-7e83-4b70-b871-8619b1f49501', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e3700c3d0>]}
[0m20:09:24.025000 [debug] [Thread-1 (]: On model.global_economic_tracker.stg_commodity_returns: Close
[0m20:09:24.025901 [info ] [Thread-2 (]: 2 of 26 OK created sql table model public.stg_index_returns .................... [[32mSELECT 0[0m in 0.11s]
[0m20:09:24.026857 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5454c15d-7e83-4b70-b871-8619b1f49501', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e36f8e9b0>]}
[0m20:09:24.027557 [debug] [Thread-2 (]: Finished running node model.global_economic_tracker.stg_index_returns
[0m20:09:24.028459 [info ] [Thread-1 (]: 1 of 26 OK created sql table model public.stg_commodity_returns ................ [[32mSELECT 517[0m in 0.12s]
[0m20:09:24.029793 [debug] [Thread-4 (]: Began running node test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713
[0m20:09:24.030055 [debug] [Thread-3 (]: Began running node test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8
[0m20:09:24.030372 [debug] [Thread-2 (]: Began running node test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0
[0m20:09:24.030762 [debug] [Thread-1 (]: Finished running node model.global_economic_tracker.stg_commodity_returns
[0m20:09:24.031552 [info ] [Thread-4 (]: 3 of 26 START test dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5  [RUN]
[0m20:09:24.032287 [info ] [Thread-3 (]: 4 of 26 START test not_null_stg_index_returns_daily_return ..................... [RUN]
[0m20:09:24.032996 [info ] [Thread-2 (]: 5 of 26 START test not_null_stg_index_returns_ticker ........................... [RUN]
[0m20:09:24.033724 [debug] [Thread-1 (]: Began running node test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17
[0m20:09:24.034643 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713'
[0m20:09:24.035494 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8'
[0m20:09:24.036263 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.global_economic_tracker.stg_index_returns, now test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0)
[0m20:09:24.037072 [info ] [Thread-1 (]: 6 of 26 START test not_null_stg_index_returns_timestamp ........................ [RUN]
[0m20:09:24.037773 [debug] [Thread-4 (]: Began compiling node test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713
[0m20:09:24.038538 [debug] [Thread-3 (]: Began compiling node test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8
[0m20:09:24.039261 [debug] [Thread-2 (]: Began compiling node test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0
[0m20:09:24.040031 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.global_economic_tracker.stg_commodity_returns, now test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17)
[0m20:09:24.043239 [debug] [Thread-4 (]: Writing injected SQL for node "test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713"
[0m20:09:24.048088 [debug] [Thread-3 (]: Writing injected SQL for node "test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8"
[0m20:09:24.050541 [debug] [Thread-2 (]: Writing injected SQL for node "test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0"
[0m20:09:24.051364 [debug] [Thread-1 (]: Began compiling node test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17
[0m20:09:24.055424 [debug] [Thread-1 (]: Writing injected SQL for node "test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17"
[0m20:09:24.059918 [debug] [Thread-2 (]: Began executing node test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0
[0m20:09:24.060271 [debug] [Thread-3 (]: Began executing node test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8
[0m20:09:24.066151 [debug] [Thread-4 (]: Began executing node test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713
[0m20:09:24.066386 [debug] [Thread-1 (]: Began executing node test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17
[0m20:09:24.068237 [debug] [Thread-2 (]: Writing runtime sql for node "test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0"
[0m20:09:24.069740 [debug] [Thread-3 (]: Writing runtime sql for node "test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8"
[0m20:09:24.071780 [debug] [Thread-4 (]: Writing runtime sql for node "test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713"
[0m20:09:24.073397 [debug] [Thread-1 (]: Writing runtime sql for node "test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17"
[0m20:09:24.078479 [debug] [Thread-2 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0"
[0m20:09:24.079118 [debug] [Thread-4 (]: Using postgres connection "test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713"
[0m20:09:24.079600 [debug] [Thread-2 (]: On test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0: BEGIN
[0m20:09:24.079881 [debug] [Thread-1 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17"
[0m20:09:24.080661 [debug] [Thread-4 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713: BEGIN
[0m20:09:24.080938 [debug] [Thread-3 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8"
[0m20:09:24.081492 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:09:24.082262 [debug] [Thread-1 (]: On test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17: BEGIN
[0m20:09:24.082979 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:09:24.083706 [debug] [Thread-3 (]: On test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8: BEGIN
[0m20:09:24.085045 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:09:24.086145 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m20:09:24.086540 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:09:24.087231 [debug] [Thread-4 (]: SQL status: BEGIN in 0.004 seconds
[0m20:09:24.088379 [debug] [Thread-2 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0"
[0m20:09:24.089545 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m20:09:24.090669 [debug] [Thread-4 (]: Using postgres connection "test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713"
[0m20:09:24.091422 [debug] [Thread-2 (]: On test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select ticker
from "airflow"."public"."stg_index_returns"
where ticker is null



      
    ) dbt_internal_test
[0m20:09:24.092115 [debug] [Thread-1 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17"
[0m20:09:24.092646 [debug] [Thread-3 (]: SQL status: BEGIN in 0.006 seconds
[0m20:09:24.093073 [debug] [Thread-4 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with meet_condition as(
  select *
  from "airflow"."public"."stg_index_returns"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not daily_return >= -0.5
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not daily_return <= 0.5
)

select *
from validation_errors


      
    ) dbt_internal_test
[0m20:09:24.094344 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.000 seconds
[0m20:09:24.094618 [debug] [Thread-1 (]: On test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select timestamp
from "airflow"."public"."stg_index_returns"
where timestamp is null



      
    ) dbt_internal_test
[0m20:09:24.095362 [debug] [Thread-3 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8"
[0m20:09:24.096695 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:09:24.098657 [debug] [Thread-2 (]: On test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0: ROLLBACK
[0m20:09:24.099830 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.000 seconds
[0m20:09:24.100225 [debug] [Thread-3 (]: On test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select daily_return
from "airflow"."public"."stg_index_returns"
where daily_return is null



      
    ) dbt_internal_test
[0m20:09:24.101649 [debug] [Thread-4 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713: ROLLBACK
[0m20:09:24.102629 [debug] [Thread-2 (]: On test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0: Close
[0m20:09:24.103641 [debug] [Thread-1 (]: On test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17: ROLLBACK
[0m20:09:24.104930 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:09:24.105285 [debug] [Thread-4 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713: Close
[0m20:09:24.106048 [info ] [Thread-2 (]: 5 of 26 PASS not_null_stg_index_returns_ticker ................................. [[32mPASS[0m in 0.07s]
[0m20:09:24.106696 [debug] [Thread-1 (]: On test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17: Close
[0m20:09:24.107704 [debug] [Thread-3 (]: On test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8: ROLLBACK
[0m20:09:24.108579 [info ] [Thread-4 (]: 3 of 26 PASS dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5  [[32mPASS[0m in 0.07s]
[0m20:09:24.109348 [debug] [Thread-2 (]: Finished running node test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0
[0m20:09:24.110309 [info ] [Thread-1 (]: 6 of 26 PASS not_null_stg_index_returns_timestamp .............................. [[32mPASS[0m in 0.07s]
[0m20:09:24.111037 [debug] [Thread-3 (]: On test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8: Close
[0m20:09:24.111691 [debug] [Thread-4 (]: Finished running node test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713
[0m20:09:24.112476 [debug] [Thread-2 (]: Began running node test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe
[0m20:09:24.113470 [debug] [Thread-1 (]: Finished running node test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17
[0m20:09:24.114431 [info ] [Thread-3 (]: 4 of 26 PASS not_null_stg_index_returns_daily_return ........................... [[32mPASS[0m in 0.08s]
[0m20:09:24.115002 [debug] [Thread-4 (]: Began running node test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934
[0m20:09:24.115752 [info ] [Thread-2 (]: 7 of 26 START test dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5  [RUN]
[0m20:09:24.116498 [debug] [Thread-1 (]: Began running node test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d
[0m20:09:24.117296 [debug] [Thread-3 (]: Finished running node test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8
[0m20:09:24.118003 [info ] [Thread-4 (]: 8 of 26 START test not_null_stg_commodity_returns_daily_return ................. [RUN]
[0m20:09:24.118755 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0, now test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe)
[0m20:09:24.119472 [info ] [Thread-1 (]: 9 of 26 START test not_null_stg_commodity_returns_ticker ....................... [RUN]
[0m20:09:24.120198 [debug] [Thread-3 (]: Began running node test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359
[0m20:09:24.121009 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713, now test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934)
[0m20:09:24.121762 [debug] [Thread-2 (]: Began compiling node test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe
[0m20:09:24.122518 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17, now test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d)
[0m20:09:24.123293 [info ] [Thread-3 (]: 10 of 26 START test not_null_stg_commodity_returns_timestamp ................... [RUN]
[0m20:09:24.123999 [debug] [Thread-4 (]: Began compiling node test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934
[0m20:09:24.127165 [debug] [Thread-2 (]: Writing injected SQL for node "test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe"
[0m20:09:24.127885 [debug] [Thread-1 (]: Began compiling node test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d
[0m20:09:24.128614 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8, now test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359)
[0m20:09:24.131223 [debug] [Thread-4 (]: Writing injected SQL for node "test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934"
[0m20:09:24.134199 [debug] [Thread-1 (]: Writing injected SQL for node "test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d"
[0m20:09:24.135069 [debug] [Thread-3 (]: Began compiling node test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359
[0m20:09:24.139194 [debug] [Thread-3 (]: Writing injected SQL for node "test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359"
[0m20:09:24.140337 [debug] [Thread-1 (]: Began executing node test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d
[0m20:09:24.140769 [debug] [Thread-4 (]: Began executing node test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934
[0m20:09:24.141014 [debug] [Thread-2 (]: Began executing node test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe
[0m20:09:24.143132 [debug] [Thread-1 (]: Writing runtime sql for node "test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d"
[0m20:09:24.144787 [debug] [Thread-4 (]: Writing runtime sql for node "test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934"
[0m20:09:24.145044 [debug] [Thread-3 (]: Began executing node test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359
[0m20:09:24.146471 [debug] [Thread-2 (]: Writing runtime sql for node "test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe"
[0m20:09:24.149703 [debug] [Thread-3 (]: Writing runtime sql for node "test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359"
[0m20:09:24.152717 [debug] [Thread-1 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d"
[0m20:09:24.153313 [debug] [Thread-4 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934"
[0m20:09:24.153612 [debug] [Thread-2 (]: Using postgres connection "test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe"
[0m20:09:24.154053 [debug] [Thread-1 (]: On test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d: BEGIN
[0m20:09:24.154818 [debug] [Thread-4 (]: On test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934: BEGIN
[0m20:09:24.155091 [debug] [Thread-3 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359"
[0m20:09:24.155711 [debug] [Thread-2 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe: BEGIN
[0m20:09:24.156453 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:09:24.157169 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:09:24.157844 [debug] [Thread-3 (]: On test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359: BEGIN
[0m20:09:24.158550 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:09:24.161359 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m20:09:24.161741 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:09:24.162222 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m20:09:24.163517 [debug] [Thread-1 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d"
[0m20:09:24.164411 [debug] [Thread-2 (]: SQL status: BEGIN in 0.006 seconds
[0m20:09:24.164933 [debug] [Thread-4 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934"
[0m20:09:24.165692 [debug] [Thread-1 (]: On test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select ticker
from "airflow"."public"."stg_commodity_returns"
where ticker is null



      
    ) dbt_internal_test
[0m20:09:24.165951 [debug] [Thread-3 (]: SQL status: BEGIN in 0.004 seconds
[0m20:09:24.166491 [debug] [Thread-2 (]: Using postgres connection "test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe"
[0m20:09:24.167208 [debug] [Thread-4 (]: On test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select daily_return
from "airflow"."public"."stg_commodity_returns"
where daily_return is null



      
    ) dbt_internal_test
[0m20:09:24.168544 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.000 seconds
[0m20:09:24.168777 [debug] [Thread-3 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359"
[0m20:09:24.169500 [debug] [Thread-2 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with meet_condition as(
  select *
  from "airflow"."public"."stg_commodity_returns"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not daily_return >= -0.5
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not daily_return <= 0.5
)

select *
from validation_errors


      
    ) dbt_internal_test
[0m20:09:24.170817 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.000 seconds
[0m20:09:24.171759 [debug] [Thread-1 (]: On test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d: ROLLBACK
[0m20:09:24.172542 [debug] [Thread-3 (]: On test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select timestamp
from "airflow"."public"."stg_commodity_returns"
where timestamp is null



      
    ) dbt_internal_test
[0m20:09:24.174239 [debug] [Thread-4 (]: On test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934: ROLLBACK
[0m20:09:24.174493 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:09:24.175127 [debug] [Thread-1 (]: On test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d: Close
[0m20:09:24.176053 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.000 seconds
[0m20:09:24.176848 [debug] [Thread-4 (]: On test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934: Close
[0m20:09:24.177819 [debug] [Thread-2 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe: ROLLBACK
[0m20:09:24.178729 [info ] [Thread-1 (]: 9 of 26 PASS not_null_stg_commodity_returns_ticker ............................. [[32mPASS[0m in 0.06s]
[0m20:09:24.179777 [debug] [Thread-3 (]: On test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359: ROLLBACK
[0m20:09:24.180883 [info ] [Thread-4 (]: 8 of 26 PASS not_null_stg_commodity_returns_daily_return ....................... [[32mPASS[0m in 0.06s]
[0m20:09:24.181535 [debug] [Thread-2 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe: Close
[0m20:09:24.182202 [debug] [Thread-1 (]: Finished running node test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d
[0m20:09:24.183077 [debug] [Thread-3 (]: On test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359: Close
[0m20:09:24.183715 [debug] [Thread-4 (]: Finished running node test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934
[0m20:09:24.184599 [info ] [Thread-2 (]: 7 of 26 PASS dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5  [[32mPASS[0m in 0.07s]
[0m20:09:24.185219 [debug] [Thread-1 (]: Began running node model.global_economic_tracker.stg_index_metrics
[0m20:09:24.186114 [info ] [Thread-3 (]: 10 of 26 PASS not_null_stg_commodity_returns_timestamp ......................... [[32mPASS[0m in 0.06s]
[0m20:09:24.187291 [debug] [Thread-2 (]: Finished running node test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe
[0m20:09:24.188122 [info ] [Thread-1 (]: 11 of 26 START sql table model public.stg_index_metrics ........................ [RUN]
[0m20:09:24.188921 [debug] [Thread-3 (]: Finished running node test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359
[0m20:09:24.190275 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d, now model.global_economic_tracker.stg_index_metrics)
[0m20:09:24.191288 [debug] [Thread-4 (]: Began running node model.global_economic_tracker.stg_commodity_metrics
[0m20:09:24.191846 [debug] [Thread-1 (]: Began compiling node model.global_economic_tracker.stg_index_metrics
[0m20:09:24.192637 [info ] [Thread-4 (]: 12 of 26 START sql table model public.stg_commodity_metrics .................... [RUN]
[0m20:09:24.195035 [debug] [Thread-1 (]: Writing injected SQL for node "model.global_economic_tracker.stg_index_metrics"
[0m20:09:24.195816 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934, now model.global_economic_tracker.stg_commodity_metrics)
[0m20:09:24.197157 [debug] [Thread-4 (]: Began compiling node model.global_economic_tracker.stg_commodity_metrics
[0m20:09:24.199251 [debug] [Thread-4 (]: Writing injected SQL for node "model.global_economic_tracker.stg_commodity_metrics"
[0m20:09:24.202683 [debug] [Thread-1 (]: Began executing node model.global_economic_tracker.stg_index_metrics
[0m20:09:24.206191 [debug] [Thread-1 (]: Writing runtime sql for node "model.global_economic_tracker.stg_index_metrics"
[0m20:09:24.206439 [debug] [Thread-4 (]: Began executing node model.global_economic_tracker.stg_commodity_metrics
[0m20:09:24.209367 [debug] [Thread-4 (]: Writing runtime sql for node "model.global_economic_tracker.stg_commodity_metrics"
[0m20:09:24.212701 [debug] [Thread-1 (]: Using postgres connection "model.global_economic_tracker.stg_index_metrics"
[0m20:09:24.213444 [debug] [Thread-1 (]: On model.global_economic_tracker.stg_index_metrics: BEGIN
[0m20:09:24.213796 [debug] [Thread-4 (]: Using postgres connection "model.global_economic_tracker.stg_commodity_metrics"
[0m20:09:24.214418 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:09:24.215147 [debug] [Thread-4 (]: On model.global_economic_tracker.stg_commodity_metrics: BEGIN
[0m20:09:24.216728 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:09:24.217466 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m20:09:24.218443 [debug] [Thread-1 (]: Using postgres connection "model.global_economic_tracker.stg_index_metrics"
[0m20:09:24.219123 [debug] [Thread-4 (]: SQL status: BEGIN in 0.002 seconds
[0m20:09:24.219382 [debug] [Thread-1 (]: On model.global_economic_tracker.stg_index_metrics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_index_metrics"} */

  
    

  create  table "airflow"."public"."stg_index_metrics__dbt_tmp"
  
  
    as
  
  (
    

with base as (
    select
        *,
        row_number() over (partition by ticker order by timestamp) as rn
    from "airflow"."public"."stg_index_returns"
),

rolling as (
    select
        ticker,
        timestamp,
        avg(daily_return) over (
            partition by ticker
            order by rn
            rows between 19 preceding and current row
        ) as rolling_avg_mo,

        avg(daily_return) OVER (
            partition by ticker
            order by timestamp
            rows between 6 preceding and current row
        ) as weekly_avg_return,

        stddev(daily_return) over (
            partition by ticker
            order by rn
            rows between 19 preceding and current row
        ) as rolling_volatility_mo,

        case
            when daily_return > 0 then 'up'
            when daily_return < 0 then 'down'
            else 'flat'
        end as trend,

        daily_return

    from base
)

select
    *,
    rolling_avg_mo / nullif(rolling_volatility_mo, 0) as sharpe_mo,
    (daily_return - rolling_avg_mo) / nullif(rolling_volatility_mo, 0) as z_score_mo
from rolling
where rolling_avg_mo is not null
  );
  
[0m20:09:24.220168 [debug] [Thread-4 (]: Using postgres connection "model.global_economic_tracker.stg_commodity_metrics"
[0m20:09:24.221465 [debug] [Thread-4 (]: On model.global_economic_tracker.stg_commodity_metrics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_commodity_metrics"} */

  
    

  create  table "airflow"."public"."stg_commodity_metrics__dbt_tmp"
  
  
    as
  
  (
    

with base as (
    select
        *,
        row_number() over (partition by ticker order by timestamp) as rn
    from "airflow"."public"."stg_commodity_returns"
),

rolling as (
    select
        ticker,
        timestamp,
        avg(daily_return) over (
            partition by ticker
            order by rn
            rows between 19 preceding and current row
        ) as rolling_avg_mo,

        avg(daily_return) OVER (
            partition by ticker
            order by timestamp
            rows between 6 preceding and current row
        ) as weekly_avg_return,

        stddev(daily_return) over (
            partition by ticker
            order by rn
            rows between 19 preceding and current row
        ) as rolling_volatility_mo,

        case
            when daily_return > 0 then 'up'
            when daily_return < 0 then 'down'
            else 'flat'
        end as trend,

        daily_return

    from base
)

select
    *,
    rolling_avg_mo / nullif(rolling_volatility_mo, 0) as sharpe_mo,
    (daily_return - rolling_avg_mo) / nullif(rolling_volatility_mo, 0) as z_score_mo
from rolling
where rolling_avg_mo is not null
  );
  
[0m20:09:24.224989 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.004 seconds
[0m20:09:24.227195 [debug] [Thread-1 (]: Using postgres connection "model.global_economic_tracker.stg_index_metrics"
[0m20:09:24.227957 [debug] [Thread-1 (]: On model.global_economic_tracker.stg_index_metrics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_index_metrics"} */
alter table "airflow"."public"."stg_index_metrics" rename to "stg_index_metrics__dbt_backup"
[0m20:09:24.228199 [debug] [Thread-4 (]: SQL status: SELECT 517 in 0.006 seconds
[0m20:09:24.228980 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:09:24.231046 [debug] [Thread-4 (]: Using postgres connection "model.global_economic_tracker.stg_commodity_metrics"
[0m20:09:24.232937 [debug] [Thread-1 (]: Using postgres connection "model.global_economic_tracker.stg_index_metrics"
[0m20:09:24.233654 [debug] [Thread-4 (]: On model.global_economic_tracker.stg_commodity_metrics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_commodity_metrics"} */
alter table "airflow"."public"."stg_commodity_metrics" rename to "stg_commodity_metrics__dbt_backup"
[0m20:09:24.234400 [debug] [Thread-1 (]: On model.global_economic_tracker.stg_index_metrics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_index_metrics"} */
alter table "airflow"."public"."stg_index_metrics__dbt_tmp" rename to "stg_index_metrics"
[0m20:09:24.235462 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:09:24.236235 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:09:24.237990 [debug] [Thread-4 (]: Using postgres connection "model.global_economic_tracker.stg_commodity_metrics"
[0m20:09:24.239799 [debug] [Thread-1 (]: Using postgres connection "model.global_economic_tracker.stg_index_metrics"
[0m20:09:24.240558 [debug] [Thread-4 (]: On model.global_economic_tracker.stg_commodity_metrics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_commodity_metrics"} */
alter table "airflow"."public"."stg_commodity_metrics__dbt_tmp" rename to "stg_commodity_metrics"
[0m20:09:24.241311 [debug] [Thread-1 (]: On model.global_economic_tracker.stg_index_metrics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_index_metrics"} */

        CREATE INDEX IF NOT EXISTS idx_index_ticker_ts ON "airflow"."public"."stg_index_metrics"(ticker, timestamp)
      
[0m20:09:24.242240 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:09:24.243019 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.000 seconds
[0m20:09:24.244158 [debug] [Thread-4 (]: Using postgres connection "model.global_economic_tracker.stg_commodity_metrics"
[0m20:09:24.245389 [debug] [Thread-1 (]: On model.global_economic_tracker.stg_index_metrics: COMMIT
[0m20:09:24.246122 [debug] [Thread-4 (]: On model.global_economic_tracker.stg_commodity_metrics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_commodity_metrics"} */

        CREATE INDEX IF NOT EXISTS idx_commodity_ticker_ts ON "airflow"."public"."stg_commodity_metrics"(ticker, timestamp)
      
[0m20:09:24.246879 [debug] [Thread-1 (]: Using postgres connection "model.global_economic_tracker.stg_index_metrics"
[0m20:09:24.247806 [debug] [Thread-4 (]: SQL status: CREATE INDEX in 0.000 seconds
[0m20:09:24.248376 [debug] [Thread-1 (]: On model.global_economic_tracker.stg_index_metrics: COMMIT
[0m20:09:24.249603 [debug] [Thread-4 (]: On model.global_economic_tracker.stg_commodity_metrics: COMMIT
[0m20:09:24.250981 [debug] [Thread-4 (]: Using postgres connection "model.global_economic_tracker.stg_commodity_metrics"
[0m20:09:24.251555 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m20:09:24.251999 [debug] [Thread-4 (]: On model.global_economic_tracker.stg_commodity_metrics: COMMIT
[0m20:09:24.285661 [debug] [Thread-1 (]: Applying DROP to: "airflow"."public"."stg_index_metrics__dbt_backup"
[0m20:09:24.287169 [debug] [Thread-1 (]: Using postgres connection "model.global_economic_tracker.stg_index_metrics"
[0m20:09:24.287677 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m20:09:24.288080 [debug] [Thread-1 (]: On model.global_economic_tracker.stg_index_metrics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_index_metrics"} */
drop table if exists "airflow"."public"."stg_index_metrics__dbt_backup" cascade
[0m20:09:24.289863 [debug] [Thread-4 (]: Applying DROP to: "airflow"."public"."stg_commodity_metrics__dbt_backup"
[0m20:09:24.291367 [debug] [Thread-4 (]: Using postgres connection "model.global_economic_tracker.stg_commodity_metrics"
[0m20:09:24.292042 [debug] [Thread-4 (]: On model.global_economic_tracker.stg_commodity_metrics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_commodity_metrics"} */
drop table if exists "airflow"."public"."stg_commodity_metrics__dbt_backup" cascade
[0m20:09:24.292304 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m20:09:24.293953 [debug] [Thread-1 (]: On model.global_economic_tracker.stg_index_metrics: Close
[0m20:09:24.294518 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.002 seconds
[0m20:09:24.294990 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5454c15d-7e83-4b70-b871-8619b1f49501', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e34676350>]}
[0m20:09:24.296017 [debug] [Thread-4 (]: On model.global_economic_tracker.stg_commodity_metrics: Close
[0m20:09:24.296981 [info ] [Thread-1 (]: 11 of 26 OK created sql table model public.stg_index_metrics ................... [[32mSELECT 0[0m in 0.10s]
[0m20:09:24.298052 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5454c15d-7e83-4b70-b871-8619b1f49501', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e346e7460>]}
[0m20:09:24.298710 [debug] [Thread-1 (]: Finished running node model.global_economic_tracker.stg_index_metrics
[0m20:09:24.299573 [info ] [Thread-4 (]: 12 of 26 OK created sql table model public.stg_commodity_metrics ............... [[32mSELECT 517[0m in 0.10s]
[0m20:09:24.300716 [debug] [Thread-3 (]: Began running node test.global_economic_tracker.accepted_values_stg_index_metrics_trend__up__down__flat.1fea418295
[0m20:09:24.300971 [debug] [Thread-2 (]: Began running node test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_daily_return__0_5___0_5.6e9f33b0a2
[0m20:09:24.301255 [debug] [Thread-1 (]: Began running node test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_rolling_avg_mo__0_3___0_3.13a5241921
[0m20:09:24.301580 [debug] [Thread-4 (]: Finished running node model.global_economic_tracker.stg_commodity_metrics
[0m20:09:24.302341 [info ] [Thread-3 (]: 13 of 26 START test accepted_values_stg_index_metrics_trend__up__down__flat .... [RUN]
[0m20:09:24.303076 [info ] [Thread-2 (]: 14 of 26 START test dbt_utils_accepted_range_stg_index_metrics_daily_return__0_5___0_5  [RUN]
[0m20:09:24.303788 [info ] [Thread-1 (]: 15 of 26 START test dbt_utils_accepted_range_stg_index_metrics_rolling_avg_mo__0_3___0_3  [RUN]
[0m20:09:24.304553 [debug] [Thread-4 (]: Began running node test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_sharpe_mo__0_3___0_3.5c734b2546
[0m20:09:24.305420 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359, now test.global_economic_tracker.accepted_values_stg_index_metrics_trend__up__down__flat.1fea418295)
[0m20:09:24.306188 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe, now test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_daily_return__0_5___0_5.6e9f33b0a2)
[0m20:09:24.306941 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.global_economic_tracker.stg_index_metrics, now test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_rolling_avg_mo__0_3___0_3.13a5241921)
[0m20:09:24.307675 [info ] [Thread-4 (]: 16 of 26 START test dbt_utils_accepted_range_stg_index_metrics_sharpe_mo__0_3___0_3  [RUN]
[0m20:09:24.308409 [debug] [Thread-3 (]: Began compiling node test.global_economic_tracker.accepted_values_stg_index_metrics_trend__up__down__flat.1fea418295
[0m20:09:24.309085 [debug] [Thread-2 (]: Began compiling node test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_daily_return__0_5___0_5.6e9f33b0a2
[0m20:09:24.309824 [debug] [Thread-1 (]: Began compiling node test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_rolling_avg_mo__0_3___0_3.13a5241921
[0m20:09:24.310616 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.global_economic_tracker.stg_commodity_metrics, now test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_sharpe_mo__0_3___0_3.5c734b2546)
[0m20:09:24.313326 [debug] [Thread-3 (]: Writing injected SQL for node "test.global_economic_tracker.accepted_values_stg_index_metrics_trend__up__down__flat.1fea418295"
[0m20:09:24.316016 [debug] [Thread-2 (]: Writing injected SQL for node "test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_daily_return__0_5___0_5.6e9f33b0a2"
[0m20:09:24.318674 [debug] [Thread-1 (]: Writing injected SQL for node "test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_rolling_avg_mo__0_3___0_3.13a5241921"
[0m20:09:24.319533 [debug] [Thread-4 (]: Began compiling node test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_sharpe_mo__0_3___0_3.5c734b2546
[0m20:09:24.324390 [debug] [Thread-4 (]: Writing injected SQL for node "test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_sharpe_mo__0_3___0_3.5c734b2546"
[0m20:09:24.328437 [debug] [Thread-1 (]: Began executing node test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_rolling_avg_mo__0_3___0_3.13a5241921
[0m20:09:24.329184 [debug] [Thread-3 (]: Began executing node test.global_economic_tracker.accepted_values_stg_index_metrics_trend__up__down__flat.1fea418295
[0m20:09:24.330730 [debug] [Thread-1 (]: Writing runtime sql for node "test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_rolling_avg_mo__0_3___0_3.13a5241921"
[0m20:09:24.330993 [debug] [Thread-2 (]: Began executing node test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_daily_return__0_5___0_5.6e9f33b0a2
[0m20:09:24.332579 [debug] [Thread-3 (]: Writing runtime sql for node "test.global_economic_tracker.accepted_values_stg_index_metrics_trend__up__down__flat.1fea418295"
[0m20:09:24.332836 [debug] [Thread-4 (]: Began executing node test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_sharpe_mo__0_3___0_3.5c734b2546
[0m20:09:24.334805 [debug] [Thread-2 (]: Writing runtime sql for node "test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_daily_return__0_5___0_5.6e9f33b0a2"
[0m20:09:24.337150 [debug] [Thread-4 (]: Writing runtime sql for node "test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_sharpe_mo__0_3___0_3.5c734b2546"
[0m20:09:24.338153 [debug] [Thread-1 (]: Using postgres connection "test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_rolling_avg_mo__0_3___0_3.13a5241921"
[0m20:09:24.339468 [debug] [Thread-1 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_rolling_avg_mo__0_3___0_3.13a5241921: BEGIN
[0m20:09:24.339722 [debug] [Thread-3 (]: Using postgres connection "test.global_economic_tracker.accepted_values_stg_index_metrics_trend__up__down__flat.1fea418295"
[0m20:09:24.340272 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:09:24.341071 [debug] [Thread-3 (]: On test.global_economic_tracker.accepted_values_stg_index_metrics_trend__up__down__flat.1fea418295: BEGIN
[0m20:09:24.341668 [debug] [Thread-2 (]: Using postgres connection "test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_daily_return__0_5___0_5.6e9f33b0a2"
[0m20:09:24.343165 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:09:24.343464 [debug] [Thread-4 (]: Using postgres connection "test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_sharpe_mo__0_3___0_3.5c734b2546"
[0m20:09:24.344195 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m20:09:24.344444 [debug] [Thread-2 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_daily_return__0_5___0_5.6e9f33b0a2: BEGIN
[0m20:09:24.346127 [debug] [Thread-4 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_sharpe_mo__0_3___0_3.5c734b2546: BEGIN
[0m20:09:24.346791 [debug] [Thread-3 (]: SQL status: BEGIN in 0.004 seconds
[0m20:09:24.347047 [debug] [Thread-1 (]: Using postgres connection "test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_rolling_avg_mo__0_3___0_3.13a5241921"
[0m20:09:24.347832 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:09:24.348560 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:09:24.349336 [debug] [Thread-3 (]: Using postgres connection "test.global_economic_tracker.accepted_values_stg_index_metrics_trend__up__down__flat.1fea418295"
[0m20:09:24.350123 [debug] [Thread-1 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_rolling_avg_mo__0_3___0_3.13a5241921: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_rolling_avg_mo__0_3___0_3.13a5241921"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with meet_condition as(
  select *
  from "airflow"."public"."stg_index_metrics"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not rolling_avg_mo >= -0.3
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not rolling_avg_mo <= 0.3
)

select *
from validation_errors


      
    ) dbt_internal_test
[0m20:09:24.352461 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m20:09:24.352719 [debug] [Thread-3 (]: On test.global_economic_tracker.accepted_values_stg_index_metrics_trend__up__down__flat.1fea418295: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.accepted_values_stg_index_metrics_trend__up__down__flat.1fea418295"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        trend as value_field,
        count(*) as n_records

    from "airflow"."public"."stg_index_metrics"
    group by trend

)

select *
from all_values
where value_field not in (
    'up','down','flat'
)



      
    ) dbt_internal_test
[0m20:09:24.353242 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m20:09:24.354271 [debug] [Thread-2 (]: Using postgres connection "test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_daily_return__0_5___0_5.6e9f33b0a2"
[0m20:09:24.354543 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:09:24.355862 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.000 seconds
[0m20:09:24.356101 [debug] [Thread-4 (]: Using postgres connection "test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_sharpe_mo__0_3___0_3.5c734b2546"
[0m20:09:24.356869 [debug] [Thread-2 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_daily_return__0_5___0_5.6e9f33b0a2: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_daily_return__0_5___0_5.6e9f33b0a2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with meet_condition as(
  select *
  from "airflow"."public"."stg_index_metrics"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not daily_return >= -0.5
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not daily_return <= 0.5
)

select *
from validation_errors


      
    ) dbt_internal_test
[0m20:09:24.358191 [debug] [Thread-1 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_rolling_avg_mo__0_3___0_3.13a5241921: ROLLBACK
[0m20:09:24.359419 [debug] [Thread-3 (]: On test.global_economic_tracker.accepted_values_stg_index_metrics_trend__up__down__flat.1fea418295: ROLLBACK
[0m20:09:24.360411 [debug] [Thread-4 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_sharpe_mo__0_3___0_3.5c734b2546: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_sharpe_mo__0_3___0_3.5c734b2546"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with meet_condition as(
  select *
  from "airflow"."public"."stg_index_metrics"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not sharpe_mo >= -0.3
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not sharpe_mo <= 0.3
)

select *
from validation_errors


      
    ) dbt_internal_test
[0m20:09:24.361744 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.000 seconds
[0m20:09:24.362098 [debug] [Thread-1 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_rolling_avg_mo__0_3___0_3.13a5241921: Close
[0m20:09:24.362782 [debug] [Thread-3 (]: On test.global_economic_tracker.accepted_values_stg_index_metrics_trend__up__down__flat.1fea418295: Close
[0m20:09:24.363825 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.000 seconds
[0m20:09:24.364516 [debug] [Thread-2 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_daily_return__0_5___0_5.6e9f33b0a2: ROLLBACK
[0m20:09:24.365440 [info ] [Thread-1 (]: 15 of 26 PASS dbt_utils_accepted_range_stg_index_metrics_rolling_avg_mo__0_3___0_3  [[32mPASS[0m in 0.06s]
[0m20:09:24.366198 [info ] [Thread-3 (]: 13 of 26 PASS accepted_values_stg_index_metrics_trend__up__down__flat .......... [[32mPASS[0m in 0.06s]
[0m20:09:24.367284 [debug] [Thread-4 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_sharpe_mo__0_3___0_3.5c734b2546: ROLLBACK
[0m20:09:24.368432 [debug] [Thread-2 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_daily_return__0_5___0_5.6e9f33b0a2: Close
[0m20:09:24.369197 [debug] [Thread-1 (]: Finished running node test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_rolling_avg_mo__0_3___0_3.13a5241921
[0m20:09:24.370011 [debug] [Thread-3 (]: Finished running node test.global_economic_tracker.accepted_values_stg_index_metrics_trend__up__down__flat.1fea418295
[0m20:09:24.370911 [debug] [Thread-4 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_sharpe_mo__0_3___0_3.5c734b2546: Close
[0m20:09:24.371649 [info ] [Thread-2 (]: 14 of 26 PASS dbt_utils_accepted_range_stg_index_metrics_daily_return__0_5___0_5  [[32mPASS[0m in 0.07s]
[0m20:09:24.372918 [debug] [Thread-1 (]: Began running node test.global_economic_tracker.not_null_stg_index_metrics_daily_return.26f4856193
[0m20:09:24.373745 [debug] [Thread-3 (]: Began running node test.global_economic_tracker.not_null_stg_index_metrics_ticker.4b922607c9
[0m20:09:24.374669 [info ] [Thread-4 (]: 16 of 26 PASS dbt_utils_accepted_range_stg_index_metrics_sharpe_mo__0_3___0_3 .. [[32mPASS[0m in 0.06s]
[0m20:09:24.375292 [debug] [Thread-2 (]: Finished running node test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_daily_return__0_5___0_5.6e9f33b0a2
[0m20:09:24.376022 [info ] [Thread-1 (]: 17 of 26 START test not_null_stg_index_metrics_daily_return .................... [RUN]
[0m20:09:24.376781 [info ] [Thread-3 (]: 18 of 26 START test not_null_stg_index_metrics_ticker .......................... [RUN]
[0m20:09:24.377708 [debug] [Thread-4 (]: Finished running node test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_sharpe_mo__0_3___0_3.5c734b2546
[0m20:09:24.378531 [debug] [Thread-2 (]: Began running node test.global_economic_tracker.not_null_stg_index_metrics_timestamp.b1d1abca86
[0m20:09:24.379334 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_rolling_avg_mo__0_3___0_3.13a5241921, now test.global_economic_tracker.not_null_stg_index_metrics_daily_return.26f4856193)
[0m20:09:24.380091 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.global_economic_tracker.accepted_values_stg_index_metrics_trend__up__down__flat.1fea418295, now test.global_economic_tracker.not_null_stg_index_metrics_ticker.4b922607c9)
[0m20:09:24.380897 [debug] [Thread-4 (]: Began running node test.global_economic_tracker.accepted_values_stg_commodity_metrics_trend__up__down__flat.70479897b5
[0m20:09:24.381660 [info ] [Thread-2 (]: 19 of 26 START test not_null_stg_index_metrics_timestamp ....................... [RUN]
[0m20:09:24.382402 [debug] [Thread-1 (]: Began compiling node test.global_economic_tracker.not_null_stg_index_metrics_daily_return.26f4856193
[0m20:09:24.383141 [debug] [Thread-3 (]: Began compiling node test.global_economic_tracker.not_null_stg_index_metrics_ticker.4b922607c9
[0m20:09:24.383895 [info ] [Thread-4 (]: 20 of 26 START test accepted_values_stg_commodity_metrics_trend__up__down__flat  [RUN]
[0m20:09:24.384644 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_daily_return__0_5___0_5.6e9f33b0a2, now test.global_economic_tracker.not_null_stg_index_metrics_timestamp.b1d1abca86)
[0m20:09:24.387708 [debug] [Thread-1 (]: Writing injected SQL for node "test.global_economic_tracker.not_null_stg_index_metrics_daily_return.26f4856193"
[0m20:09:24.392004 [debug] [Thread-3 (]: Writing injected SQL for node "test.global_economic_tracker.not_null_stg_index_metrics_ticker.4b922607c9"
[0m20:09:24.392789 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_sharpe_mo__0_3___0_3.5c734b2546, now test.global_economic_tracker.accepted_values_stg_commodity_metrics_trend__up__down__flat.70479897b5)
[0m20:09:24.393632 [debug] [Thread-2 (]: Began compiling node test.global_economic_tracker.not_null_stg_index_metrics_timestamp.b1d1abca86
[0m20:09:24.395708 [debug] [Thread-4 (]: Began compiling node test.global_economic_tracker.accepted_values_stg_commodity_metrics_trend__up__down__flat.70479897b5
[0m20:09:24.398200 [debug] [Thread-2 (]: Writing injected SQL for node "test.global_economic_tracker.not_null_stg_index_metrics_timestamp.b1d1abca86"
[0m20:09:24.400748 [debug] [Thread-4 (]: Writing injected SQL for node "test.global_economic_tracker.accepted_values_stg_commodity_metrics_trend__up__down__flat.70479897b5"
[0m20:09:24.402405 [debug] [Thread-1 (]: Began executing node test.global_economic_tracker.not_null_stg_index_metrics_daily_return.26f4856193
[0m20:09:24.402730 [debug] [Thread-3 (]: Began executing node test.global_economic_tracker.not_null_stg_index_metrics_ticker.4b922607c9
[0m20:09:24.404539 [debug] [Thread-1 (]: Writing runtime sql for node "test.global_economic_tracker.not_null_stg_index_metrics_daily_return.26f4856193"
[0m20:09:24.405168 [debug] [Thread-2 (]: Began executing node test.global_economic_tracker.not_null_stg_index_metrics_timestamp.b1d1abca86
[0m20:09:24.406701 [debug] [Thread-3 (]: Writing runtime sql for node "test.global_economic_tracker.not_null_stg_index_metrics_ticker.4b922607c9"
[0m20:09:24.406952 [debug] [Thread-4 (]: Began executing node test.global_economic_tracker.accepted_values_stg_commodity_metrics_trend__up__down__flat.70479897b5
[0m20:09:24.409233 [debug] [Thread-2 (]: Writing runtime sql for node "test.global_economic_tracker.not_null_stg_index_metrics_timestamp.b1d1abca86"
[0m20:09:24.412171 [debug] [Thread-4 (]: Writing runtime sql for node "test.global_economic_tracker.accepted_values_stg_commodity_metrics_trend__up__down__flat.70479897b5"
[0m20:09:24.413953 [debug] [Thread-1 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_index_metrics_daily_return.26f4856193"
[0m20:09:24.414749 [debug] [Thread-3 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_index_metrics_ticker.4b922607c9"
[0m20:09:24.415024 [debug] [Thread-1 (]: On test.global_economic_tracker.not_null_stg_index_metrics_daily_return.26f4856193: BEGIN
[0m20:09:24.415654 [debug] [Thread-2 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_index_metrics_timestamp.b1d1abca86"
[0m20:09:24.416136 [debug] [Thread-3 (]: On test.global_economic_tracker.not_null_stg_index_metrics_ticker.4b922607c9: BEGIN
[0m20:09:24.416822 [debug] [Thread-4 (]: Using postgres connection "test.global_economic_tracker.accepted_values_stg_commodity_metrics_trend__up__down__flat.70479897b5"
[0m20:09:24.417080 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:09:24.417801 [debug] [Thread-2 (]: On test.global_economic_tracker.not_null_stg_index_metrics_timestamp.b1d1abca86: BEGIN
[0m20:09:24.418511 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:09:24.419248 [debug] [Thread-4 (]: On test.global_economic_tracker.accepted_values_stg_commodity_metrics_trend__up__down__flat.70479897b5: BEGIN
[0m20:09:24.420709 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:09:24.422151 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m20:09:24.422440 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:09:24.423354 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m20:09:24.424186 [debug] [Thread-1 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_index_metrics_daily_return.26f4856193"
[0m20:09:24.424959 [debug] [Thread-2 (]: SQL status: BEGIN in 0.004 seconds
[0m20:09:24.426000 [debug] [Thread-3 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_index_metrics_ticker.4b922607c9"
[0m20:09:24.426669 [debug] [Thread-4 (]: SQL status: BEGIN in 0.004 seconds
[0m20:09:24.427098 [debug] [Thread-1 (]: On test.global_economic_tracker.not_null_stg_index_metrics_daily_return.26f4856193: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.not_null_stg_index_metrics_daily_return.26f4856193"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select daily_return
from "airflow"."public"."stg_index_metrics"
where daily_return is null



      
    ) dbt_internal_test
[0m20:09:24.427861 [debug] [Thread-2 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_index_metrics_timestamp.b1d1abca86"
[0m20:09:24.428652 [debug] [Thread-3 (]: On test.global_economic_tracker.not_null_stg_index_metrics_ticker.4b922607c9: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.not_null_stg_index_metrics_ticker.4b922607c9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select ticker
from "airflow"."public"."stg_index_metrics"
where ticker is null



      
    ) dbt_internal_test
[0m20:09:24.429410 [debug] [Thread-4 (]: Using postgres connection "test.global_economic_tracker.accepted_values_stg_commodity_metrics_trend__up__down__flat.70479897b5"
[0m20:09:24.430734 [debug] [Thread-2 (]: On test.global_economic_tracker.not_null_stg_index_metrics_timestamp.b1d1abca86: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.not_null_stg_index_metrics_timestamp.b1d1abca86"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select timestamp
from "airflow"."public"."stg_index_metrics"
where timestamp is null



      
    ) dbt_internal_test
[0m20:09:24.431115 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:09:24.432364 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.000 seconds
[0m20:09:24.432659 [debug] [Thread-4 (]: On test.global_economic_tracker.accepted_values_stg_commodity_metrics_trend__up__down__flat.70479897b5: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.accepted_values_stg_commodity_metrics_trend__up__down__flat.70479897b5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        trend as value_field,
        count(*) as n_records

    from "airflow"."public"."stg_commodity_metrics"
    group by trend

)

select *
from all_values
where value_field not in (
    'up','down','flat'
)



      
    ) dbt_internal_test
[0m20:09:24.433851 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.000 seconds
[0m20:09:24.434784 [debug] [Thread-1 (]: On test.global_economic_tracker.not_null_stg_index_metrics_daily_return.26f4856193: ROLLBACK
[0m20:09:24.436529 [debug] [Thread-3 (]: On test.global_economic_tracker.not_null_stg_index_metrics_ticker.4b922607c9: ROLLBACK
[0m20:09:24.437868 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:09:24.438632 [debug] [Thread-2 (]: On test.global_economic_tracker.not_null_stg_index_metrics_timestamp.b1d1abca86: ROLLBACK
[0m20:09:24.439523 [debug] [Thread-1 (]: On test.global_economic_tracker.not_null_stg_index_metrics_daily_return.26f4856193: Close
[0m20:09:24.440229 [debug] [Thread-3 (]: On test.global_economic_tracker.not_null_stg_index_metrics_ticker.4b922607c9: Close
[0m20:09:24.441403 [debug] [Thread-4 (]: On test.global_economic_tracker.accepted_values_stg_commodity_metrics_trend__up__down__flat.70479897b5: ROLLBACK
[0m20:09:24.442360 [debug] [Thread-2 (]: On test.global_economic_tracker.not_null_stg_index_metrics_timestamp.b1d1abca86: Close
[0m20:09:24.443378 [info ] [Thread-1 (]: 17 of 26 PASS not_null_stg_index_metrics_daily_return .......................... [[32mPASS[0m in 0.06s]
[0m20:09:24.444421 [info ] [Thread-3 (]: 18 of 26 PASS not_null_stg_index_metrics_ticker ................................ [[32mPASS[0m in 0.06s]
[0m20:09:24.445173 [debug] [Thread-4 (]: On test.global_economic_tracker.accepted_values_stg_commodity_metrics_trend__up__down__flat.70479897b5: Close
[0m20:09:24.445912 [info ] [Thread-2 (]: 19 of 26 PASS not_null_stg_index_metrics_timestamp ............................. [[32mPASS[0m in 0.06s]
[0m20:09:24.446615 [debug] [Thread-1 (]: Finished running node test.global_economic_tracker.not_null_stg_index_metrics_daily_return.26f4856193
[0m20:09:24.447495 [debug] [Thread-3 (]: Finished running node test.global_economic_tracker.not_null_stg_index_metrics_ticker.4b922607c9
[0m20:09:24.448448 [info ] [Thread-4 (]: 20 of 26 PASS accepted_values_stg_commodity_metrics_trend__up__down__flat ...... [[32mPASS[0m in 0.06s]
[0m20:09:24.449150 [debug] [Thread-2 (]: Finished running node test.global_economic_tracker.not_null_stg_index_metrics_timestamp.b1d1abca86
[0m20:09:24.450058 [debug] [Thread-1 (]: Began running node test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_daily_return__0_5___0_5.2c4246e1e4
[0m20:09:24.450984 [debug] [Thread-3 (]: Began running node test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_rolling_avg_mo__0_3___0_3.22c9d514f7
[0m20:09:24.452288 [debug] [Thread-4 (]: Finished running node test.global_economic_tracker.accepted_values_stg_commodity_metrics_trend__up__down__flat.70479897b5
[0m20:09:24.453387 [debug] [Thread-2 (]: Began running node test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_sharpe_mo__0_3___0_3.749bb13b9a
[0m20:09:24.454627 [info ] [Thread-1 (]: 21 of 26 START test dbt_utils_accepted_range_stg_commodity_metrics_daily_return__0_5___0_5  [RUN]
[0m20:09:24.455608 [info ] [Thread-3 (]: 22 of 26 START test dbt_utils_accepted_range_stg_commodity_metrics_rolling_avg_mo__0_3___0_3  [RUN]
[0m20:09:24.456514 [debug] [Thread-4 (]: Began running node test.global_economic_tracker.not_null_stg_commodity_metrics_daily_return.74b14cc336
[0m20:09:24.457442 [info ] [Thread-2 (]: 23 of 26 START test dbt_utils_accepted_range_stg_commodity_metrics_sharpe_mo__0_3___0_3  [RUN]
[0m20:09:24.458458 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.global_economic_tracker.not_null_stg_index_metrics_daily_return.26f4856193, now test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_daily_return__0_5___0_5.2c4246e1e4)
[0m20:09:24.459510 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.global_economic_tracker.not_null_stg_index_metrics_ticker.4b922607c9, now test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_rolling_avg_mo__0_3___0_3.22c9d514f7)
[0m20:09:24.460626 [info ] [Thread-4 (]: 24 of 26 START test not_null_stg_commodity_metrics_daily_return ................ [RUN]
[0m20:09:24.461564 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.global_economic_tracker.not_null_stg_index_metrics_timestamp.b1d1abca86, now test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_sharpe_mo__0_3___0_3.749bb13b9a)
[0m20:09:24.462559 [debug] [Thread-1 (]: Began compiling node test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_daily_return__0_5___0_5.2c4246e1e4
[0m20:09:24.463404 [debug] [Thread-3 (]: Began compiling node test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_rolling_avg_mo__0_3___0_3.22c9d514f7
[0m20:09:24.464298 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.global_economic_tracker.accepted_values_stg_commodity_metrics_trend__up__down__flat.70479897b5, now test.global_economic_tracker.not_null_stg_commodity_metrics_daily_return.74b14cc336)
[0m20:09:24.465173 [debug] [Thread-2 (]: Began compiling node test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_sharpe_mo__0_3___0_3.749bb13b9a
[0m20:09:24.470240 [debug] [Thread-1 (]: Writing injected SQL for node "test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_daily_return__0_5___0_5.2c4246e1e4"
[0m20:09:24.474050 [debug] [Thread-3 (]: Writing injected SQL for node "test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_rolling_avg_mo__0_3___0_3.22c9d514f7"
[0m20:09:24.474931 [debug] [Thread-4 (]: Began compiling node test.global_economic_tracker.not_null_stg_commodity_metrics_daily_return.74b14cc336
[0m20:09:24.479331 [debug] [Thread-2 (]: Writing injected SQL for node "test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_sharpe_mo__0_3___0_3.749bb13b9a"
[0m20:09:24.484881 [debug] [Thread-4 (]: Writing injected SQL for node "test.global_economic_tracker.not_null_stg_commodity_metrics_daily_return.74b14cc336"
[0m20:09:24.490194 [debug] [Thread-1 (]: Began executing node test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_daily_return__0_5___0_5.2c4246e1e4
[0m20:09:24.491205 [debug] [Thread-3 (]: Began executing node test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_rolling_avg_mo__0_3___0_3.22c9d514f7
[0m20:09:24.493141 [debug] [Thread-1 (]: Writing runtime sql for node "test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_daily_return__0_5___0_5.2c4246e1e4"
[0m20:09:24.493505 [debug] [Thread-2 (]: Began executing node test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_sharpe_mo__0_3___0_3.749bb13b9a
[0m20:09:24.497000 [debug] [Thread-3 (]: Writing runtime sql for node "test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_rolling_avg_mo__0_3___0_3.22c9d514f7"
[0m20:09:24.497334 [debug] [Thread-4 (]: Began executing node test.global_economic_tracker.not_null_stg_commodity_metrics_daily_return.74b14cc336
[0m20:09:24.500346 [debug] [Thread-2 (]: Writing runtime sql for node "test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_sharpe_mo__0_3___0_3.749bb13b9a"
[0m20:09:24.503434 [debug] [Thread-4 (]: Writing runtime sql for node "test.global_economic_tracker.not_null_stg_commodity_metrics_daily_return.74b14cc336"
[0m20:09:24.506275 [debug] [Thread-1 (]: Using postgres connection "test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_daily_return__0_5___0_5.2c4246e1e4"
[0m20:09:24.506604 [debug] [Thread-3 (]: Using postgres connection "test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_rolling_avg_mo__0_3___0_3.22c9d514f7"
[0m20:09:24.507379 [debug] [Thread-1 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_daily_return__0_5___0_5.2c4246e1e4: BEGIN
[0m20:09:24.507734 [debug] [Thread-2 (]: Using postgres connection "test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_sharpe_mo__0_3___0_3.749bb13b9a"
[0m20:09:24.508446 [debug] [Thread-3 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_rolling_avg_mo__0_3___0_3.22c9d514f7: BEGIN
[0m20:09:24.509332 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:09:24.509670 [debug] [Thread-4 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_commodity_metrics_daily_return.74b14cc336"
[0m20:09:24.510368 [debug] [Thread-2 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_sharpe_mo__0_3___0_3.749bb13b9a: BEGIN
[0m20:09:24.511229 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:09:24.513003 [debug] [Thread-4 (]: On test.global_economic_tracker.not_null_stg_commodity_metrics_daily_return.74b14cc336: BEGIN
[0m20:09:24.514053 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:09:24.514699 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m20:09:24.516295 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:09:24.517310 [debug] [Thread-3 (]: SQL status: BEGIN in 0.006 seconds
[0m20:09:24.518060 [debug] [Thread-1 (]: Using postgres connection "test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_daily_return__0_5___0_5.2c4246e1e4"
[0m20:09:24.518879 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m20:09:24.520042 [debug] [Thread-3 (]: Using postgres connection "test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_rolling_avg_mo__0_3___0_3.22c9d514f7"
[0m20:09:24.520820 [debug] [Thread-4 (]: SQL status: BEGIN in 0.004 seconds
[0m20:09:24.521101 [debug] [Thread-1 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_daily_return__0_5___0_5.2c4246e1e4: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_daily_return__0_5___0_5.2c4246e1e4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with meet_condition as(
  select *
  from "airflow"."public"."stg_commodity_metrics"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not daily_return >= -0.5
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not daily_return <= 0.5
)

select *
from validation_errors


      
    ) dbt_internal_test
[0m20:09:24.521915 [debug] [Thread-2 (]: Using postgres connection "test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_sharpe_mo__0_3___0_3.749bb13b9a"
[0m20:09:24.522717 [debug] [Thread-3 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_rolling_avg_mo__0_3___0_3.22c9d514f7: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_rolling_avg_mo__0_3___0_3.22c9d514f7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with meet_condition as(
  select *
  from "airflow"."public"."stg_commodity_metrics"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not rolling_avg_mo >= -0.3
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not rolling_avg_mo <= 0.3
)

select *
from validation_errors


      
    ) dbt_internal_test
[0m20:09:24.523525 [debug] [Thread-4 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_commodity_metrics_daily_return.74b14cc336"
[0m20:09:24.524865 [debug] [Thread-2 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_sharpe_mo__0_3___0_3.749bb13b9a: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_sharpe_mo__0_3___0_3.749bb13b9a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with meet_condition as(
  select *
  from "airflow"."public"."stg_commodity_metrics"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not sharpe_mo >= -0.3
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not sharpe_mo <= 0.3
)

select *
from validation_errors


      
    ) dbt_internal_test
[0m20:09:24.525200 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:09:24.526361 [debug] [Thread-4 (]: On test.global_economic_tracker.not_null_stg_commodity_metrics_daily_return.74b14cc336: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.not_null_stg_commodity_metrics_daily_return.74b14cc336"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select daily_return
from "airflow"."public"."stg_commodity_metrics"
where daily_return is null



      
    ) dbt_internal_test
[0m20:09:24.526648 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:09:24.528610 [debug] [Thread-1 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_daily_return__0_5___0_5.2c4246e1e4: ROLLBACK
[0m20:09:24.528908 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m20:09:24.530194 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:09:24.531247 [debug] [Thread-3 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_rolling_avg_mo__0_3___0_3.22c9d514f7: ROLLBACK
[0m20:09:24.532333 [debug] [Thread-1 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_daily_return__0_5___0_5.2c4246e1e4: Close
[0m20:09:24.533436 [debug] [Thread-2 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_sharpe_mo__0_3___0_3.749bb13b9a: ROLLBACK
[0m20:09:24.534617 [debug] [Thread-4 (]: On test.global_economic_tracker.not_null_stg_commodity_metrics_daily_return.74b14cc336: ROLLBACK
[0m20:09:24.535423 [debug] [Thread-3 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_rolling_avg_mo__0_3___0_3.22c9d514f7: Close
[0m20:09:24.536250 [info ] [Thread-1 (]: 21 of 26 PASS dbt_utils_accepted_range_stg_commodity_metrics_daily_return__0_5___0_5  [[32mPASS[0m in 0.08s]
[0m20:09:24.536949 [debug] [Thread-2 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_sharpe_mo__0_3___0_3.749bb13b9a: Close
[0m20:09:24.537657 [debug] [Thread-4 (]: On test.global_economic_tracker.not_null_stg_commodity_metrics_daily_return.74b14cc336: Close
[0m20:09:24.538448 [info ] [Thread-3 (]: 22 of 26 PASS dbt_utils_accepted_range_stg_commodity_metrics_rolling_avg_mo__0_3___0_3  [[32mPASS[0m in 0.08s]
[0m20:09:24.539119 [debug] [Thread-1 (]: Finished running node test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_daily_return__0_5___0_5.2c4246e1e4
[0m20:09:24.540146 [error] [Thread-2 (]: 23 of 26 FAIL 132 dbt_utils_accepted_range_stg_commodity_metrics_sharpe_mo__0_3___0_3  [[31mFAIL 132[0m in 0.08s]
[0m20:09:24.540969 [info ] [Thread-4 (]: 24 of 26 PASS not_null_stg_commodity_metrics_daily_return ...................... [[32mPASS[0m in 0.08s]
[0m20:09:24.541807 [debug] [Thread-3 (]: Finished running node test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_rolling_avg_mo__0_3___0_3.22c9d514f7
[0m20:09:24.542673 [debug] [Thread-1 (]: Began running node test.global_economic_tracker.not_null_stg_commodity_metrics_ticker.6d1d8d12d7
[0m20:09:24.543706 [debug] [Thread-2 (]: Finished running node test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_sharpe_mo__0_3___0_3.749bb13b9a
[0m20:09:24.544596 [debug] [Thread-4 (]: Finished running node test.global_economic_tracker.not_null_stg_commodity_metrics_daily_return.74b14cc336
[0m20:09:24.545414 [debug] [Thread-3 (]: Began running node test.global_economic_tracker.not_null_stg_commodity_metrics_timestamp.5651d4b196
[0m20:09:24.546229 [info ] [Thread-1 (]: 25 of 26 START test not_null_stg_commodity_metrics_ticker ...................... [RUN]
[0m20:09:24.547179 [debug] [Thread-7 (]: Marking all children of 'test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_sharpe_mo__0_3___0_3.749bb13b9a' to be skipped because of status 'fail'.  Reason: Got 132 results, configured to fail if != 0.
[0m20:09:24.548393 [info ] [Thread-3 (]: 26 of 26 START test not_null_stg_commodity_metrics_timestamp ................... [RUN]
[0m20:09:24.549164 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_daily_return__0_5___0_5.2c4246e1e4, now test.global_economic_tracker.not_null_stg_commodity_metrics_ticker.6d1d8d12d7)
[0m20:09:24.550795 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_rolling_avg_mo__0_3___0_3.22c9d514f7, now test.global_economic_tracker.not_null_stg_commodity_metrics_timestamp.5651d4b196)
[0m20:09:24.551555 [debug] [Thread-1 (]: Began compiling node test.global_economic_tracker.not_null_stg_commodity_metrics_ticker.6d1d8d12d7
[0m20:09:24.552415 [debug] [Thread-3 (]: Began compiling node test.global_economic_tracker.not_null_stg_commodity_metrics_timestamp.5651d4b196
[0m20:09:24.555512 [debug] [Thread-1 (]: Writing injected SQL for node "test.global_economic_tracker.not_null_stg_commodity_metrics_ticker.6d1d8d12d7"
[0m20:09:24.558374 [debug] [Thread-3 (]: Writing injected SQL for node "test.global_economic_tracker.not_null_stg_commodity_metrics_timestamp.5651d4b196"
[0m20:09:24.563289 [debug] [Thread-1 (]: Began executing node test.global_economic_tracker.not_null_stg_commodity_metrics_ticker.6d1d8d12d7
[0m20:09:24.565396 [debug] [Thread-1 (]: Writing runtime sql for node "test.global_economic_tracker.not_null_stg_commodity_metrics_ticker.6d1d8d12d7"
[0m20:09:24.565626 [debug] [Thread-3 (]: Began executing node test.global_economic_tracker.not_null_stg_commodity_metrics_timestamp.5651d4b196
[0m20:09:24.568858 [debug] [Thread-3 (]: Writing runtime sql for node "test.global_economic_tracker.not_null_stg_commodity_metrics_timestamp.5651d4b196"
[0m20:09:24.572679 [debug] [Thread-1 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_commodity_metrics_ticker.6d1d8d12d7"
[0m20:09:24.573620 [debug] [Thread-1 (]: On test.global_economic_tracker.not_null_stg_commodity_metrics_ticker.6d1d8d12d7: BEGIN
[0m20:09:24.573964 [debug] [Thread-3 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_commodity_metrics_timestamp.5651d4b196"
[0m20:09:24.574527 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:09:24.575285 [debug] [Thread-3 (]: On test.global_economic_tracker.not_null_stg_commodity_metrics_timestamp.5651d4b196: BEGIN
[0m20:09:24.576959 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:09:24.577883 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m20:09:24.578575 [debug] [Thread-1 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_commodity_metrics_ticker.6d1d8d12d7"
[0m20:09:24.579260 [debug] [Thread-3 (]: SQL status: BEGIN in 0.002 seconds
[0m20:09:24.579511 [debug] [Thread-1 (]: On test.global_economic_tracker.not_null_stg_commodity_metrics_ticker.6d1d8d12d7: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.not_null_stg_commodity_metrics_ticker.6d1d8d12d7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select ticker
from "airflow"."public"."stg_commodity_metrics"
where ticker is null



      
    ) dbt_internal_test
[0m20:09:24.580251 [debug] [Thread-3 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_commodity_metrics_timestamp.5651d4b196"
[0m20:09:24.581483 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.000 seconds
[0m20:09:24.581735 [debug] [Thread-3 (]: On test.global_economic_tracker.not_null_stg_commodity_metrics_timestamp.5651d4b196: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.not_null_stg_commodity_metrics_timestamp.5651d4b196"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select timestamp
from "airflow"."public"."stg_commodity_metrics"
where timestamp is null



      
    ) dbt_internal_test
[0m20:09:24.583031 [debug] [Thread-1 (]: On test.global_economic_tracker.not_null_stg_commodity_metrics_ticker.6d1d8d12d7: ROLLBACK
[0m20:09:24.584096 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.000 seconds
[0m20:09:24.584595 [debug] [Thread-1 (]: On test.global_economic_tracker.not_null_stg_commodity_metrics_ticker.6d1d8d12d7: Close
[0m20:09:24.585590 [debug] [Thread-3 (]: On test.global_economic_tracker.not_null_stg_commodity_metrics_timestamp.5651d4b196: ROLLBACK
[0m20:09:24.586539 [info ] [Thread-1 (]: 25 of 26 PASS not_null_stg_commodity_metrics_ticker ............................ [[32mPASS[0m in 0.04s]
[0m20:09:24.587274 [debug] [Thread-3 (]: On test.global_economic_tracker.not_null_stg_commodity_metrics_timestamp.5651d4b196: Close
[0m20:09:24.588005 [debug] [Thread-1 (]: Finished running node test.global_economic_tracker.not_null_stg_commodity_metrics_ticker.6d1d8d12d7
[0m20:09:24.588862 [info ] [Thread-3 (]: 26 of 26 PASS not_null_stg_commodity_metrics_timestamp ......................... [[32mPASS[0m in 0.04s]
[0m20:09:24.590078 [debug] [Thread-3 (]: Finished running node test.global_economic_tracker.not_null_stg_commodity_metrics_timestamp.5651d4b196
[0m20:09:24.591806 [debug] [MainThread]: Using postgres connection "master"
[0m20:09:24.592451 [debug] [MainThread]: On master: BEGIN
[0m20:09:24.593119 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:09:24.595283 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m20:09:24.595967 [debug] [MainThread]: On master: COMMIT
[0m20:09:24.596631 [debug] [MainThread]: Using postgres connection "master"
[0m20:09:24.597284 [debug] [MainThread]: On master: COMMIT
[0m20:09:24.598263 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:09:24.598972 [debug] [MainThread]: On master: Close
[0m20:09:24.599704 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:09:24.600407 [debug] [MainThread]: Connection 'test.global_economic_tracker.not_null_stg_commodity_metrics_ticker.6d1d8d12d7' was properly closed.
[0m20:09:24.601051 [debug] [MainThread]: Connection 'test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_sharpe_mo__0_3___0_3.749bb13b9a' was properly closed.
[0m20:09:24.601700 [debug] [MainThread]: Connection 'test.global_economic_tracker.not_null_stg_commodity_metrics_daily_return.74b14cc336' was properly closed.
[0m20:09:24.602356 [debug] [MainThread]: Connection 'test.global_economic_tracker.not_null_stg_commodity_metrics_timestamp.5651d4b196' was properly closed.
[0m20:09:24.603138 [info ] [MainThread]: 
[0m20:09:24.603875 [info ] [MainThread]: Finished running 4 table models, 22 data tests in 0 hours 0 minutes and 0.76 seconds (0.76s).
[0m20:09:24.605996 [debug] [MainThread]: Command end result
[0m20:09:24.636120 [debug] [MainThread]: Wrote artifact WritableManifest to /mnt/c/Users/joeyk/PycharmProjects/GlobalEconomicTracker/global_economic_tracker/target/manifest.json
[0m20:09:24.640205 [debug] [MainThread]: Wrote artifact SemanticManifest to /mnt/c/Users/joeyk/PycharmProjects/GlobalEconomicTracker/global_economic_tracker/target/semantic_manifest.json
[0m20:09:24.647531 [debug] [MainThread]: Wrote artifact RunExecutionResult to /mnt/c/Users/joeyk/PycharmProjects/GlobalEconomicTracker/global_economic_tracker/target/run_results.json
[0m20:09:24.648260 [info ] [MainThread]: 
[0m20:09:24.649064 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:09:24.649792 [info ] [MainThread]: 
[0m20:09:24.650576 [error] [MainThread]: [31mFailure in test dbt_utils_accepted_range_stg_commodity_metrics_sharpe_mo__0_3___0_3 (models/analytics/schema.yml)[0m
[0m20:09:24.651331 [error] [MainThread]:   Got 132 results, configured to fail if != 0
[0m20:09:24.652035 [info ] [MainThread]: 
[0m20:09:24.652763 [info ] [MainThread]:   compiled code at target/compiled/global_economic_tracker/models/analytics/schema.yml/dbt_utils_accepted_range_stg_c_bdc3901177456e9ba222117b4548aa5b.sql
[0m20:09:24.653473 [info ] [MainThread]: 
[0m20:09:24.654210 [info ] [MainThread]: Done. PASS=25 WARN=0 ERROR=1 SKIP=0 TOTAL=26
[0m20:09:24.655881 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 2.3270984, "process_in_blocks": "74112", "process_kernel_time": 0.259952, "process_mem_max_rss": "128120", "process_out_blocks": "0", "process_user_time": 1.611708}
[0m20:09:24.656783 [debug] [MainThread]: Command `dbt build` failed at 20:09:24.656702 after 2.33 seconds
[0m20:09:24.657774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e7122dae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e710bdcc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e6e18f760>]}
[0m20:09:24.658492 [debug] [MainThread]: Flushing usage events
[0m20:09:25.251384 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:12:10.107944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c45121ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c44908910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c450047f0>]}


============================== 20:12:10.109973 | 8e0acfcd-0069-4092-bd9d-ad442adebab8 ==============================
[0m20:12:10.109973 [info ] [MainThread]: Running with dbt=1.9.4
[0m20:12:10.110816 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/joey/.dbt', 'log_path': '/mnt/c/Users/joeyk/PycharmProjects/GlobalEconomicTracker/global_economic_tracker/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt build', 'send_anonymous_usage_stats': 'True'}
[0m20:12:10.199941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8e0acfcd-0069-4092-bd9d-ad442adebab8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c468a2410>]}
[0m20:12:10.231951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8e0acfcd-0069-4092-bd9d-ad442adebab8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c4492f040>]}
[0m20:12:10.233203 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:12:10.282341 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m20:12:11.331331 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:12:11.332492 [debug] [MainThread]: Partial parsing: updated file: global_economic_tracker://models/analytics/schema.yml
[0m20:12:11.604690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8e0acfcd-0069-4092-bd9d-ad442adebab8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c4251ebf0>]}
[0m20:12:11.660428 [debug] [MainThread]: Wrote artifact WritableManifest to /mnt/c/Users/joeyk/PycharmProjects/GlobalEconomicTracker/global_economic_tracker/target/manifest.json
[0m20:12:11.665024 [debug] [MainThread]: Wrote artifact SemanticManifest to /mnt/c/Users/joeyk/PycharmProjects/GlobalEconomicTracker/global_economic_tracker/target/semantic_manifest.json
[0m20:12:11.682081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8e0acfcd-0069-4092-bd9d-ad442adebab8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c421a0310>]}
[0m20:12:11.682932 [info ] [MainThread]: Found 4 models, 22 data tests, 549 macros
[0m20:12:11.684935 [info ] [MainThread]: 
[0m20:12:11.685670 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:12:11.686317 [info ] [MainThread]: 
[0m20:12:11.687144 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:12:11.690836 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m20:12:11.704093 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m20:12:11.704842 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m20:12:11.705626 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:12:11.708597 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.003 seconds
[0m20:12:11.709810 [debug] [ThreadPool]: On list_airflow: Close
[0m20:12:11.711264 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_public)
[0m20:12:11.714591 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m20:12:11.715244 [debug] [ThreadPool]: On list_airflow_public: BEGIN
[0m20:12:11.715933 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:12:11.718421 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m20:12:11.719090 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m20:12:11.719746 [debug] [ThreadPool]: On list_airflow_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:12:11.722256 [debug] [ThreadPool]: SQL status: SELECT 49 in 0.002 seconds
[0m20:12:11.723719 [debug] [ThreadPool]: On list_airflow_public: ROLLBACK
[0m20:12:11.724477 [debug] [ThreadPool]: On list_airflow_public: Close
[0m20:12:11.729541 [debug] [MainThread]: Using postgres connection "master"
[0m20:12:11.730390 [debug] [MainThread]: On master: BEGIN
[0m20:12:11.731116 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:12:11.733052 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m20:12:11.733725 [debug] [MainThread]: Using postgres connection "master"
[0m20:12:11.734438 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:12:11.736665 [debug] [MainThread]: SQL status: SELECT 0 in 0.001 seconds
[0m20:12:11.738049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e0acfcd-0069-4092-bd9d-ad442adebab8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c42906a10>]}
[0m20:12:11.738896 [debug] [MainThread]: On master: ROLLBACK
[0m20:12:11.739871 [debug] [MainThread]: Using postgres connection "master"
[0m20:12:11.740543 [debug] [MainThread]: On master: BEGIN
[0m20:12:11.741445 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m20:12:11.742097 [debug] [MainThread]: On master: COMMIT
[0m20:12:11.742797 [debug] [MainThread]: Using postgres connection "master"
[0m20:12:11.743547 [debug] [MainThread]: On master: COMMIT
[0m20:12:11.744323 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:12:11.744989 [debug] [MainThread]: On master: Close
[0m20:12:11.748182 [debug] [Thread-1 (]: Began running node model.global_economic_tracker.stg_commodity_returns
[0m20:12:11.748438 [debug] [Thread-2 (]: Began running node model.global_economic_tracker.stg_index_returns
[0m20:12:11.749084 [info ] [Thread-1 (]: 1 of 26 START sql table model public.stg_commodity_returns ..................... [RUN]
[0m20:12:11.750012 [info ] [Thread-2 (]: 2 of 26 START sql table model public.stg_index_returns ......................... [RUN]
[0m20:12:11.750834 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_public, now model.global_economic_tracker.stg_commodity_returns)
[0m20:12:11.751660 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.global_economic_tracker.stg_index_returns'
[0m20:12:11.752407 [debug] [Thread-1 (]: Began compiling node model.global_economic_tracker.stg_commodity_returns
[0m20:12:11.753272 [debug] [Thread-2 (]: Began compiling node model.global_economic_tracker.stg_index_returns
[0m20:12:11.757680 [debug] [Thread-1 (]: Writing injected SQL for node "model.global_economic_tracker.stg_commodity_returns"
[0m20:12:11.759856 [debug] [Thread-2 (]: Writing injected SQL for node "model.global_economic_tracker.stg_index_returns"
[0m20:12:11.764345 [debug] [Thread-1 (]: Began executing node model.global_economic_tracker.stg_commodity_returns
[0m20:12:11.770530 [debug] [Thread-2 (]: Began executing node model.global_economic_tracker.stg_index_returns
[0m20:12:11.784731 [debug] [Thread-1 (]: Writing runtime sql for node "model.global_economic_tracker.stg_commodity_returns"
[0m20:12:11.786912 [debug] [Thread-2 (]: Writing runtime sql for node "model.global_economic_tracker.stg_index_returns"
[0m20:12:11.791249 [debug] [Thread-1 (]: Using postgres connection "model.global_economic_tracker.stg_commodity_returns"
[0m20:12:11.791978 [debug] [Thread-1 (]: On model.global_economic_tracker.stg_commodity_returns: BEGIN
[0m20:12:11.792255 [debug] [Thread-2 (]: Using postgres connection "model.global_economic_tracker.stg_index_returns"
[0m20:12:11.792793 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:12:11.793511 [debug] [Thread-2 (]: On model.global_economic_tracker.stg_index_returns: BEGIN
[0m20:12:11.794927 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:12:11.795703 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m20:12:11.796455 [debug] [Thread-1 (]: Using postgres connection "model.global_economic_tracker.stg_commodity_returns"
[0m20:12:11.797298 [debug] [Thread-1 (]: On model.global_economic_tracker.stg_commodity_returns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_commodity_returns"} */

  
    

  create  table "airflow"."public"."stg_commodity_returns__dbt_tmp"
  
  
    as
  
  (
    

select
    'commodity' as type,
    ticker,
    timestamp,
    price,
    lag(price) over (partition by ticker order by timestamp) as prev_price,
    coalesce((price - lag(price) over (partition by ticker order by timestamp)) / lag(price) over (partition by ticker order by timestamp), 0) as daily_return
from public.commodity_prices
  );
  
[0m20:12:11.797545 [debug] [Thread-2 (]: SQL status: BEGIN in 0.003 seconds
[0m20:12:11.798625 [debug] [Thread-2 (]: Using postgres connection "model.global_economic_tracker.stg_index_returns"
[0m20:12:11.799332 [debug] [Thread-2 (]: On model.global_economic_tracker.stg_index_returns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_index_returns"} */

  
    

  create  table "airflow"."public"."stg_index_returns__dbt_tmp"
  
  
    as
  
  (
    

select
    'index' as type,
    country,
    ticker,
    timestamp,
    price,
    lag(price) over (partition by ticker order by timestamp) as prev_price,
    coalesce((price - lag(price) over (partition by ticker order by timestamp)) / lag(price) over (partition by ticker order by timestamp), 0) as daily_return
from public.index_prices
  );
  
[0m20:12:11.806855 [debug] [Thread-1 (]: SQL status: SELECT 517 in 0.009 seconds
[0m20:12:11.812389 [debug] [Thread-1 (]: Using postgres connection "model.global_economic_tracker.stg_commodity_returns"
[0m20:12:11.812628 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.013 seconds
[0m20:12:11.813337 [debug] [Thread-1 (]: On model.global_economic_tracker.stg_commodity_returns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_commodity_returns"} */
alter table "airflow"."public"."stg_commodity_returns" rename to "stg_commodity_returns__dbt_backup"
[0m20:12:11.815857 [debug] [Thread-2 (]: Using postgres connection "model.global_economic_tracker.stg_index_returns"
[0m20:12:11.816987 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:12:11.817396 [debug] [Thread-2 (]: On model.global_economic_tracker.stg_index_returns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_index_returns"} */
alter table "airflow"."public"."stg_index_returns" rename to "stg_index_returns__dbt_backup"
[0m20:12:11.819493 [debug] [Thread-1 (]: Using postgres connection "model.global_economic_tracker.stg_commodity_returns"
[0m20:12:11.820506 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:12:11.820915 [debug] [Thread-1 (]: On model.global_economic_tracker.stg_commodity_returns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_commodity_returns"} */
alter table "airflow"."public"."stg_commodity_returns__dbt_tmp" rename to "stg_commodity_returns"
[0m20:12:11.822825 [debug] [Thread-2 (]: Using postgres connection "model.global_economic_tracker.stg_index_returns"
[0m20:12:11.823725 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:12:11.824272 [debug] [Thread-2 (]: On model.global_economic_tracker.stg_index_returns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_index_returns"} */
alter table "airflow"."public"."stg_index_returns__dbt_tmp" rename to "stg_index_returns"
[0m20:12:11.825647 [debug] [Thread-1 (]: Using postgres connection "model.global_economic_tracker.stg_commodity_returns"
[0m20:12:11.826664 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:12:11.827095 [debug] [Thread-1 (]: On model.global_economic_tracker.stg_commodity_returns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_commodity_returns"} */

        CREATE INDEX IF NOT EXISTS idx_returns_ticker_ts ON "airflow"."public"."stg_commodity_returns"(ticker, timestamp)
      
[0m20:12:11.828369 [debug] [Thread-2 (]: Using postgres connection "model.global_economic_tracker.stg_index_returns"
[0m20:12:11.829260 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.000 seconds
[0m20:12:11.829793 [debug] [Thread-2 (]: On model.global_economic_tracker.stg_index_returns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_index_returns"} */

        CREATE INDEX IF NOT EXISTS idx_index_returns_ticker_ts ON "airflow"."public"."stg_index_returns"(ticker, timestamp)
      
[0m20:12:11.838273 [debug] [Thread-1 (]: On model.global_economic_tracker.stg_commodity_returns: COMMIT
[0m20:12:11.839164 [debug] [Thread-2 (]: SQL status: CREATE INDEX in 0.000 seconds
[0m20:12:11.839560 [debug] [Thread-1 (]: Using postgres connection "model.global_economic_tracker.stg_commodity_returns"
[0m20:12:11.840838 [debug] [Thread-2 (]: On model.global_economic_tracker.stg_index_returns: COMMIT
[0m20:12:11.841574 [debug] [Thread-1 (]: On model.global_economic_tracker.stg_commodity_returns: COMMIT
[0m20:12:11.842286 [debug] [Thread-2 (]: Using postgres connection "model.global_economic_tracker.stg_index_returns"
[0m20:12:11.843706 [debug] [Thread-2 (]: On model.global_economic_tracker.stg_index_returns: COMMIT
[0m20:12:11.844351 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m20:12:11.847996 [debug] [Thread-1 (]: Applying DROP to: "airflow"."public"."stg_commodity_returns__dbt_backup"
[0m20:12:11.848318 [debug] [Thread-2 (]: SQL status: COMMIT in 0.004 seconds
[0m20:12:11.851034 [debug] [Thread-1 (]: Using postgres connection "model.global_economic_tracker.stg_commodity_returns"
[0m20:12:11.852766 [debug] [Thread-2 (]: Applying DROP to: "airflow"."public"."stg_index_returns__dbt_backup"
[0m20:12:11.853478 [debug] [Thread-1 (]: On model.global_economic_tracker.stg_commodity_returns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_commodity_returns"} */
drop table if exists "airflow"."public"."stg_commodity_returns__dbt_backup" cascade
[0m20:12:11.854378 [debug] [Thread-2 (]: Using postgres connection "model.global_economic_tracker.stg_index_returns"
[0m20:12:11.855657 [debug] [Thread-2 (]: On model.global_economic_tracker.stg_index_returns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_index_returns"} */
drop table if exists "airflow"."public"."stg_index_returns__dbt_backup" cascade
[0m20:12:11.858472 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m20:12:11.859158 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.003 seconds
[0m20:12:11.860575 [debug] [Thread-1 (]: On model.global_economic_tracker.stg_commodity_returns: Close
[0m20:12:11.861785 [debug] [Thread-2 (]: On model.global_economic_tracker.stg_index_returns: Close
[0m20:12:11.863496 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e0acfcd-0069-4092-bd9d-ad442adebab8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c0af59660>]}
[0m20:12:11.864043 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e0acfcd-0069-4092-bd9d-ad442adebab8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c0863b520>]}
[0m20:12:11.864783 [info ] [Thread-1 (]: 1 of 26 OK created sql table model public.stg_commodity_returns ................ [[32mSELECT 517[0m in 0.11s]
[0m20:12:11.865646 [info ] [Thread-2 (]: 2 of 26 OK created sql table model public.stg_index_returns .................... [[32mSELECT 0[0m in 0.11s]
[0m20:12:11.866551 [debug] [Thread-1 (]: Finished running node model.global_economic_tracker.stg_commodity_returns
[0m20:12:11.867408 [debug] [Thread-2 (]: Finished running node model.global_economic_tracker.stg_index_returns
[0m20:12:11.868559 [debug] [Thread-4 (]: Began running node test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe
[0m20:12:11.868814 [debug] [Thread-3 (]: Began running node test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934
[0m20:12:11.869089 [debug] [Thread-1 (]: Began running node test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d
[0m20:12:11.869373 [debug] [Thread-2 (]: Began running node test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359
[0m20:12:11.870163 [info ] [Thread-4 (]: 3 of 26 START test dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5  [RUN]
[0m20:12:11.870850 [info ] [Thread-3 (]: 4 of 26 START test not_null_stg_commodity_returns_daily_return ................. [RUN]
[0m20:12:11.871591 [info ] [Thread-1 (]: 5 of 26 START test not_null_stg_commodity_returns_ticker ....................... [RUN]
[0m20:12:11.872294 [info ] [Thread-2 (]: 6 of 26 START test not_null_stg_commodity_returns_timestamp .................... [RUN]
[0m20:12:11.873284 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe'
[0m20:12:11.874093 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934'
[0m20:12:11.874861 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.global_economic_tracker.stg_commodity_returns, now test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d)
[0m20:12:11.875605 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.global_economic_tracker.stg_index_returns, now test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359)
[0m20:12:11.876321 [debug] [Thread-4 (]: Began compiling node test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe
[0m20:12:11.877051 [debug] [Thread-3 (]: Began compiling node test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934
[0m20:12:11.877791 [debug] [Thread-1 (]: Began compiling node test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d
[0m20:12:11.878579 [debug] [Thread-2 (]: Began compiling node test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359
[0m20:12:11.881871 [debug] [Thread-4 (]: Writing injected SQL for node "test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe"
[0m20:12:11.886364 [debug] [Thread-3 (]: Writing injected SQL for node "test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934"
[0m20:12:11.888768 [debug] [Thread-1 (]: Writing injected SQL for node "test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d"
[0m20:12:11.891548 [debug] [Thread-2 (]: Writing injected SQL for node "test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359"
[0m20:12:11.896603 [debug] [Thread-4 (]: Began executing node test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe
[0m20:12:11.897174 [debug] [Thread-1 (]: Began executing node test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d
[0m20:12:11.902881 [debug] [Thread-3 (]: Began executing node test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934
[0m20:12:11.903117 [debug] [Thread-2 (]: Began executing node test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359
[0m20:12:11.905012 [debug] [Thread-4 (]: Writing runtime sql for node "test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe"
[0m20:12:11.906895 [debug] [Thread-1 (]: Writing runtime sql for node "test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d"
[0m20:12:11.908522 [debug] [Thread-3 (]: Writing runtime sql for node "test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934"
[0m20:12:11.910201 [debug] [Thread-2 (]: Writing runtime sql for node "test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359"
[0m20:12:11.915312 [debug] [Thread-2 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359"
[0m20:12:11.915934 [debug] [Thread-3 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934"
[0m20:12:11.916401 [debug] [Thread-2 (]: On test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359: BEGIN
[0m20:12:11.916705 [debug] [Thread-1 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d"
[0m20:12:11.917243 [debug] [Thread-3 (]: On test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934: BEGIN
[0m20:12:11.917539 [debug] [Thread-4 (]: Using postgres connection "test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe"
[0m20:12:11.918079 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:12:11.918802 [debug] [Thread-1 (]: On test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d: BEGIN
[0m20:12:11.919508 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:12:11.920211 [debug] [Thread-4 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe: BEGIN
[0m20:12:11.921682 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:12:11.922403 [debug] [Thread-2 (]: SQL status: BEGIN in 0.004 seconds
[0m20:12:11.923335 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:12:11.924035 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m20:12:11.925024 [debug] [Thread-2 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359"
[0m20:12:11.925581 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m20:12:11.926563 [debug] [Thread-3 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934"
[0m20:12:11.927372 [debug] [Thread-4 (]: SQL status: BEGIN in 0.004 seconds
[0m20:12:11.927627 [debug] [Thread-2 (]: On test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select timestamp
from "airflow"."public"."stg_commodity_returns"
where timestamp is null



      
    ) dbt_internal_test
[0m20:12:11.928369 [debug] [Thread-1 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d"
[0m20:12:11.929007 [debug] [Thread-3 (]: On test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select daily_return
from "airflow"."public"."stg_commodity_returns"
where daily_return is null



      
    ) dbt_internal_test
[0m20:12:11.929722 [debug] [Thread-4 (]: Using postgres connection "test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe"
[0m20:12:11.930875 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.000 seconds
[0m20:12:11.931119 [debug] [Thread-1 (]: On test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select ticker
from "airflow"."public"."stg_commodity_returns"
where ticker is null



      
    ) dbt_internal_test
[0m20:12:11.932159 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.000 seconds
[0m20:12:11.932551 [debug] [Thread-4 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with meet_condition as(
  select *
  from "airflow"."public"."stg_commodity_returns"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not daily_return >= -0.5
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not daily_return <= 0.5
)

select *
from validation_errors


      
    ) dbt_internal_test
[0m20:12:11.934752 [debug] [Thread-2 (]: On test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359: ROLLBACK
[0m20:12:11.936005 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.000 seconds
[0m20:12:11.936823 [debug] [Thread-3 (]: On test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934: ROLLBACK
[0m20:12:11.938156 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:12:11.938388 [debug] [Thread-2 (]: On test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359: Close
[0m20:12:11.939353 [debug] [Thread-1 (]: On test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d: ROLLBACK
[0m20:12:11.940226 [debug] [Thread-3 (]: On test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934: Close
[0m20:12:11.941188 [debug] [Thread-4 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe: ROLLBACK
[0m20:12:11.942061 [info ] [Thread-2 (]: 6 of 26 PASS not_null_stg_commodity_returns_timestamp .......................... [[32mPASS[0m in 0.07s]
[0m20:12:11.942699 [debug] [Thread-1 (]: On test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d: Close
[0m20:12:11.943560 [info ] [Thread-3 (]: 4 of 26 PASS not_null_stg_commodity_returns_daily_return ....................... [[32mPASS[0m in 0.07s]
[0m20:12:11.944364 [debug] [Thread-4 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe: Close
[0m20:12:11.944991 [debug] [Thread-2 (]: Finished running node test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359
[0m20:12:11.945775 [info ] [Thread-1 (]: 5 of 26 PASS not_null_stg_commodity_returns_ticker ............................. [[32mPASS[0m in 0.07s]
[0m20:12:11.946330 [debug] [Thread-3 (]: Finished running node test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934
[0m20:12:11.947161 [info ] [Thread-4 (]: 3 of 26 PASS dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5  [[32mPASS[0m in 0.07s]
[0m20:12:11.947754 [debug] [Thread-2 (]: Began running node test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713
[0m20:12:11.948686 [debug] [Thread-1 (]: Finished running node test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d
[0m20:12:11.949360 [debug] [Thread-3 (]: Began running node test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8
[0m20:12:11.950185 [debug] [Thread-4 (]: Finished running node test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe
[0m20:12:11.950913 [info ] [Thread-2 (]: 7 of 26 START test dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5  [RUN]
[0m20:12:11.951655 [debug] [Thread-1 (]: Began running node test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0
[0m20:12:11.952326 [info ] [Thread-3 (]: 8 of 26 START test not_null_stg_index_returns_daily_return ..................... [RUN]
[0m20:12:11.953036 [debug] [Thread-4 (]: Began running node test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17
[0m20:12:11.953803 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359, now test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713)
[0m20:12:11.954532 [info ] [Thread-1 (]: 9 of 26 START test not_null_stg_index_returns_ticker ........................... [RUN]
[0m20:12:11.955178 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934, now test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8)
[0m20:12:11.955904 [info ] [Thread-4 (]: 10 of 26 START test not_null_stg_index_returns_timestamp ....................... [RUN]
[0m20:12:11.956717 [debug] [Thread-2 (]: Began compiling node test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713
[0m20:12:11.957454 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d, now test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0)
[0m20:12:11.958062 [debug] [Thread-3 (]: Began compiling node test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8
[0m20:12:11.958799 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe, now test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17)
[0m20:12:11.961695 [debug] [Thread-2 (]: Writing injected SQL for node "test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713"
[0m20:12:11.962418 [debug] [Thread-1 (]: Began compiling node test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0
[0m20:12:11.964825 [debug] [Thread-3 (]: Writing injected SQL for node "test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8"
[0m20:12:11.965546 [debug] [Thread-4 (]: Began compiling node test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17
[0m20:12:11.968604 [debug] [Thread-1 (]: Writing injected SQL for node "test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0"
[0m20:12:11.972134 [debug] [Thread-4 (]: Writing injected SQL for node "test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17"
[0m20:12:11.973096 [debug] [Thread-2 (]: Began executing node test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713
[0m20:12:11.973981 [debug] [Thread-3 (]: Began executing node test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8
[0m20:12:11.975513 [debug] [Thread-2 (]: Writing runtime sql for node "test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713"
[0m20:12:11.976236 [debug] [Thread-1 (]: Began executing node test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0
[0m20:12:11.977385 [debug] [Thread-3 (]: Writing runtime sql for node "test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8"
[0m20:12:11.978229 [debug] [Thread-4 (]: Began executing node test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17
[0m20:12:11.979694 [debug] [Thread-1 (]: Writing runtime sql for node "test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0"
[0m20:12:11.981919 [debug] [Thread-4 (]: Writing runtime sql for node "test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17"
[0m20:12:11.984319 [debug] [Thread-2 (]: Using postgres connection "test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713"
[0m20:12:11.984609 [debug] [Thread-3 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8"
[0m20:12:11.985269 [debug] [Thread-2 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713: BEGIN
[0m20:12:11.985588 [debug] [Thread-1 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0"
[0m20:12:11.986209 [debug] [Thread-3 (]: On test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8: BEGIN
[0m20:12:11.986488 [debug] [Thread-4 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17"
[0m20:12:11.987025 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:12:11.987735 [debug] [Thread-1 (]: On test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0: BEGIN
[0m20:12:11.988393 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:12:11.989089 [debug] [Thread-4 (]: On test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17: BEGIN
[0m20:12:11.990941 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:12:11.991578 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m20:12:11.992466 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:12:11.993136 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m20:12:11.994285 [debug] [Thread-2 (]: Using postgres connection "test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713"
[0m20:12:11.994810 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m20:12:11.995964 [debug] [Thread-3 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8"
[0m20:12:11.996711 [debug] [Thread-2 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with meet_condition as(
  select *
  from "airflow"."public"."stg_index_returns"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not daily_return >= -0.5
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not daily_return <= 0.5
)

select *
from validation_errors


      
    ) dbt_internal_test
[0m20:12:11.996977 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m20:12:11.997510 [debug] [Thread-1 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0"
[0m20:12:11.998248 [debug] [Thread-3 (]: On test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select daily_return
from "airflow"."public"."stg_index_returns"
where daily_return is null



      
    ) dbt_internal_test
[0m20:12:11.999496 [debug] [Thread-4 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17"
[0m20:12:11.999746 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:12:12.000501 [debug] [Thread-1 (]: On test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select ticker
from "airflow"."public"."stg_index_returns"
where ticker is null



      
    ) dbt_internal_test
[0m20:12:12.001554 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.000 seconds
[0m20:12:12.001958 [debug] [Thread-4 (]: On test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select timestamp
from "airflow"."public"."stg_index_returns"
where timestamp is null



      
    ) dbt_internal_test
[0m20:12:12.003150 [debug] [Thread-2 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713: ROLLBACK
[0m20:12:12.004245 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.000 seconds
[0m20:12:12.005245 [debug] [Thread-3 (]: On test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8: ROLLBACK
[0m20:12:12.006487 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.000 seconds
[0m20:12:12.006963 [debug] [Thread-2 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713: Close
[0m20:12:12.008017 [debug] [Thread-1 (]: On test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0: ROLLBACK
[0m20:12:12.008822 [debug] [Thread-3 (]: On test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8: Close
[0m20:12:12.009778 [debug] [Thread-4 (]: On test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17: ROLLBACK
[0m20:12:12.010643 [info ] [Thread-2 (]: 7 of 26 PASS dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5  [[32mPASS[0m in 0.06s]
[0m20:12:12.011280 [debug] [Thread-1 (]: On test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0: Close
[0m20:12:12.012000 [info ] [Thread-3 (]: 8 of 26 PASS not_null_stg_index_returns_daily_return ........................... [[32mPASS[0m in 0.06s]
[0m20:12:12.012631 [debug] [Thread-4 (]: On test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17: Close
[0m20:12:12.013269 [debug] [Thread-2 (]: Finished running node test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713
[0m20:12:12.014069 [info ] [Thread-1 (]: 9 of 26 PASS not_null_stg_index_returns_ticker ................................. [[32mPASS[0m in 0.06s]
[0m20:12:12.014974 [debug] [Thread-3 (]: Finished running node test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8
[0m20:12:12.015826 [info ] [Thread-4 (]: 10 of 26 PASS not_null_stg_index_returns_timestamp ............................. [[32mPASS[0m in 0.06s]
[0m20:12:12.016409 [debug] [Thread-2 (]: Began running node model.global_economic_tracker.stg_commodity_metrics
[0m20:12:12.017297 [debug] [Thread-1 (]: Finished running node test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0
[0m20:12:12.018653 [debug] [Thread-4 (]: Finished running node test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17
[0m20:12:12.019477 [info ] [Thread-2 (]: 11 of 26 START sql table model public.stg_commodity_metrics .................... [RUN]
[0m20:12:12.021058 [debug] [Thread-3 (]: Began running node model.global_economic_tracker.stg_index_metrics
[0m20:12:12.021724 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713, now model.global_economic_tracker.stg_commodity_metrics)
[0m20:12:12.022511 [info ] [Thread-3 (]: 12 of 26 START sql table model public.stg_index_metrics ........................ [RUN]
[0m20:12:12.023189 [debug] [Thread-2 (]: Began compiling node model.global_economic_tracker.stg_commodity_metrics
[0m20:12:12.023984 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8, now model.global_economic_tracker.stg_index_metrics)
[0m20:12:12.026168 [debug] [Thread-2 (]: Writing injected SQL for node "model.global_economic_tracker.stg_commodity_metrics"
[0m20:12:12.026894 [debug] [Thread-3 (]: Began compiling node model.global_economic_tracker.stg_index_metrics
[0m20:12:12.030111 [debug] [Thread-3 (]: Writing injected SQL for node "model.global_economic_tracker.stg_index_metrics"
[0m20:12:12.033454 [debug] [Thread-2 (]: Began executing node model.global_economic_tracker.stg_commodity_metrics
[0m20:12:12.036234 [debug] [Thread-2 (]: Writing runtime sql for node "model.global_economic_tracker.stg_commodity_metrics"
[0m20:12:12.036487 [debug] [Thread-3 (]: Began executing node model.global_economic_tracker.stg_index_metrics
[0m20:12:12.039522 [debug] [Thread-3 (]: Writing runtime sql for node "model.global_economic_tracker.stg_index_metrics"
[0m20:12:12.043259 [debug] [Thread-2 (]: Using postgres connection "model.global_economic_tracker.stg_commodity_metrics"
[0m20:12:12.044085 [debug] [Thread-2 (]: On model.global_economic_tracker.stg_commodity_metrics: BEGIN
[0m20:12:12.044484 [debug] [Thread-3 (]: Using postgres connection "model.global_economic_tracker.stg_index_metrics"
[0m20:12:12.045055 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:12:12.045781 [debug] [Thread-3 (]: On model.global_economic_tracker.stg_index_metrics: BEGIN
[0m20:12:12.047168 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:12:12.047830 [debug] [Thread-2 (]: SQL status: BEGIN in 0.003 seconds
[0m20:12:12.048858 [debug] [Thread-2 (]: Using postgres connection "model.global_economic_tracker.stg_commodity_metrics"
[0m20:12:12.049497 [debug] [Thread-3 (]: SQL status: BEGIN in 0.002 seconds
[0m20:12:12.049764 [debug] [Thread-2 (]: On model.global_economic_tracker.stg_commodity_metrics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_commodity_metrics"} */

  
    

  create  table "airflow"."public"."stg_commodity_metrics__dbt_tmp"
  
  
    as
  
  (
    

with base as (
    select
        *,
        row_number() over (partition by ticker order by timestamp) as rn
    from "airflow"."public"."stg_commodity_returns"
),

rolling as (
    select
        ticker,
        timestamp,
        avg(daily_return) over (
            partition by ticker
            order by rn
            rows between 19 preceding and current row
        ) as rolling_avg_mo,

        avg(daily_return) OVER (
            partition by ticker
            order by timestamp
            rows between 6 preceding and current row
        ) as weekly_avg_return,

        stddev(daily_return) over (
            partition by ticker
            order by rn
            rows between 19 preceding and current row
        ) as rolling_volatility_mo,

        case
            when daily_return > 0 then 'up'
            when daily_return < 0 then 'down'
            else 'flat'
        end as trend,

        daily_return

    from base
)

select
    *,
    rolling_avg_mo / nullif(rolling_volatility_mo, 0) as sharpe_mo,
    (daily_return - rolling_avg_mo) / nullif(rolling_volatility_mo, 0) as z_score_mo
from rolling
where rolling_avg_mo is not null
  );
  
[0m20:12:12.050561 [debug] [Thread-3 (]: Using postgres connection "model.global_economic_tracker.stg_index_metrics"
[0m20:12:12.051973 [debug] [Thread-3 (]: On model.global_economic_tracker.stg_index_metrics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_index_metrics"} */

  
    

  create  table "airflow"."public"."stg_index_metrics__dbt_tmp"
  
  
    as
  
  (
    

with base as (
    select
        *,
        row_number() over (partition by ticker order by timestamp) as rn
    from "airflow"."public"."stg_index_returns"
),

rolling as (
    select
        ticker,
        timestamp,
        avg(daily_return) over (
            partition by ticker
            order by rn
            rows between 19 preceding and current row
        ) as rolling_avg_mo,

        avg(daily_return) OVER (
            partition by ticker
            order by timestamp
            rows between 6 preceding and current row
        ) as weekly_avg_return,

        stddev(daily_return) over (
            partition by ticker
            order by rn
            rows between 19 preceding and current row
        ) as rolling_volatility_mo,

        case
            when daily_return > 0 then 'up'
            when daily_return < 0 then 'down'
            else 'flat'
        end as trend,

        daily_return

    from base
)

select
    *,
    rolling_avg_mo / nullif(rolling_volatility_mo, 0) as sharpe_mo,
    (daily_return - rolling_avg_mo) / nullif(rolling_volatility_mo, 0) as z_score_mo
from rolling
where rolling_avg_mo is not null
  );
  
[0m20:12:12.056830 [debug] [Thread-2 (]: SQL status: SELECT 517 in 0.006 seconds
[0m20:12:12.057075 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.004 seconds
[0m20:12:12.059256 [debug] [Thread-2 (]: Using postgres connection "model.global_economic_tracker.stg_commodity_metrics"
[0m20:12:12.061399 [debug] [Thread-3 (]: Using postgres connection "model.global_economic_tracker.stg_index_metrics"
[0m20:12:12.062128 [debug] [Thread-2 (]: On model.global_economic_tracker.stg_commodity_metrics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_commodity_metrics"} */
alter table "airflow"."public"."stg_commodity_metrics" rename to "stg_commodity_metrics__dbt_backup"
[0m20:12:12.062852 [debug] [Thread-3 (]: On model.global_economic_tracker.stg_index_metrics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_index_metrics"} */
alter table "airflow"."public"."stg_index_metrics" rename to "stg_index_metrics__dbt_backup"
[0m20:12:12.063786 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:12:12.064582 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:12:12.066139 [debug] [Thread-2 (]: Using postgres connection "model.global_economic_tracker.stg_commodity_metrics"
[0m20:12:12.068492 [debug] [Thread-3 (]: Using postgres connection "model.global_economic_tracker.stg_index_metrics"
[0m20:12:12.069255 [debug] [Thread-2 (]: On model.global_economic_tracker.stg_commodity_metrics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_commodity_metrics"} */
alter table "airflow"."public"."stg_commodity_metrics__dbt_tmp" rename to "stg_commodity_metrics"
[0m20:12:12.070022 [debug] [Thread-3 (]: On model.global_economic_tracker.stg_index_metrics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_index_metrics"} */
alter table "airflow"."public"."stg_index_metrics__dbt_tmp" rename to "stg_index_metrics"
[0m20:12:12.070961 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:12:12.071686 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:12:12.072869 [debug] [Thread-2 (]: Using postgres connection "model.global_economic_tracker.stg_commodity_metrics"
[0m20:12:12.104549 [debug] [Thread-3 (]: Using postgres connection "model.global_economic_tracker.stg_index_metrics"
[0m20:12:12.105156 [debug] [Thread-2 (]: On model.global_economic_tracker.stg_commodity_metrics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_commodity_metrics"} */

        CREATE INDEX IF NOT EXISTS idx_commodity_ticker_ts ON "airflow"."public"."stg_commodity_metrics"(ticker, timestamp)
      
[0m20:12:12.105896 [debug] [Thread-3 (]: On model.global_economic_tracker.stg_index_metrics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_index_metrics"} */

        CREATE INDEX IF NOT EXISTS idx_index_ticker_ts ON "airflow"."public"."stg_index_metrics"(ticker, timestamp)
      
[0m20:12:12.109510 [debug] [Thread-2 (]: SQL status: CREATE INDEX in 0.003 seconds
[0m20:12:12.110821 [debug] [Thread-2 (]: On model.global_economic_tracker.stg_commodity_metrics: COMMIT
[0m20:12:12.111287 [debug] [Thread-3 (]: SQL status: CREATE INDEX in 0.004 seconds
[0m20:12:12.111962 [debug] [Thread-2 (]: Using postgres connection "model.global_economic_tracker.stg_commodity_metrics"
[0m20:12:12.113224 [debug] [Thread-3 (]: On model.global_economic_tracker.stg_index_metrics: COMMIT
[0m20:12:12.113936 [debug] [Thread-2 (]: On model.global_economic_tracker.stg_commodity_metrics: COMMIT
[0m20:12:12.114686 [debug] [Thread-3 (]: Using postgres connection "model.global_economic_tracker.stg_index_metrics"
[0m20:12:12.115980 [debug] [Thread-3 (]: On model.global_economic_tracker.stg_index_metrics: COMMIT
[0m20:12:12.116570 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m20:12:12.118419 [debug] [Thread-2 (]: Applying DROP to: "airflow"."public"."stg_commodity_metrics__dbt_backup"
[0m20:12:12.118647 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m20:12:12.119371 [debug] [Thread-2 (]: Using postgres connection "model.global_economic_tracker.stg_commodity_metrics"
[0m20:12:12.121146 [debug] [Thread-3 (]: Applying DROP to: "airflow"."public"."stg_index_metrics__dbt_backup"
[0m20:12:12.121957 [debug] [Thread-2 (]: On model.global_economic_tracker.stg_commodity_metrics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_commodity_metrics"} */
drop table if exists "airflow"."public"."stg_commodity_metrics__dbt_backup" cascade
[0m20:12:12.122868 [debug] [Thread-3 (]: Using postgres connection "model.global_economic_tracker.stg_index_metrics"
[0m20:12:12.124139 [debug] [Thread-3 (]: On model.global_economic_tracker.stg_index_metrics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_index_metrics"} */
drop table if exists "airflow"."public"."stg_index_metrics__dbt_backup" cascade
[0m20:12:12.125221 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.002 seconds
[0m20:12:12.126349 [debug] [Thread-2 (]: On model.global_economic_tracker.stg_commodity_metrics: Close
[0m20:12:12.126553 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.002 seconds
[0m20:12:12.127284 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e0acfcd-0069-4092-bd9d-ad442adebab8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c0862e410>]}
[0m20:12:12.128288 [debug] [Thread-3 (]: On model.global_economic_tracker.stg_index_metrics: Close
[0m20:12:12.129160 [info ] [Thread-2 (]: 11 of 26 OK created sql table model public.stg_commodity_metrics ............... [[32mSELECT 517[0m in 0.11s]
[0m20:12:12.130056 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e0acfcd-0069-4092-bd9d-ad442adebab8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c0862d180>]}
[0m20:12:12.130715 [debug] [Thread-2 (]: Finished running node model.global_economic_tracker.stg_commodity_metrics
[0m20:12:12.131586 [info ] [Thread-3 (]: 12 of 26 OK created sql table model public.stg_index_metrics ................... [[32mSELECT 0[0m in 0.11s]
[0m20:12:12.132848 [debug] [Thread-4 (]: Began running node test.global_economic_tracker.accepted_values_stg_commodity_metrics_trend__up__down__flat.70479897b5
[0m20:12:12.133099 [debug] [Thread-1 (]: Began running node test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_daily_return__0_5___0_5.2c4246e1e4
[0m20:12:12.133372 [debug] [Thread-2 (]: Began running node test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_rolling_avg_mo__0_3___0_3.22c9d514f7
[0m20:12:12.133691 [debug] [Thread-3 (]: Finished running node model.global_economic_tracker.stg_index_metrics
[0m20:12:12.134455 [info ] [Thread-4 (]: 13 of 26 START test accepted_values_stg_commodity_metrics_trend__up__down__flat  [RUN]
[0m20:12:12.135206 [info ] [Thread-1 (]: 14 of 26 START test dbt_utils_accepted_range_stg_commodity_metrics_daily_return__0_5___0_5  [RUN]
[0m20:12:12.135926 [info ] [Thread-2 (]: 15 of 26 START test dbt_utils_accepted_range_stg_commodity_metrics_rolling_avg_mo__0_3___0_3  [RUN]
[0m20:12:12.136688 [debug] [Thread-3 (]: Began running node test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_sharpe_mo__2___2.d118d6bf26
[0m20:12:12.137554 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17, now test.global_economic_tracker.accepted_values_stg_commodity_metrics_trend__up__down__flat.70479897b5)
[0m20:12:12.138363 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0, now test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_daily_return__0_5___0_5.2c4246e1e4)
[0m20:12:12.139126 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.global_economic_tracker.stg_commodity_metrics, now test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_rolling_avg_mo__0_3___0_3.22c9d514f7)
[0m20:12:12.139849 [info ] [Thread-3 (]: 16 of 26 START test dbt_utils_accepted_range_stg_commodity_metrics_sharpe_mo__2___2  [RUN]
[0m20:12:12.140696 [debug] [Thread-4 (]: Began compiling node test.global_economic_tracker.accepted_values_stg_commodity_metrics_trend__up__down__flat.70479897b5
[0m20:12:12.141429 [debug] [Thread-1 (]: Began compiling node test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_daily_return__0_5___0_5.2c4246e1e4
[0m20:12:12.142161 [debug] [Thread-2 (]: Began compiling node test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_rolling_avg_mo__0_3___0_3.22c9d514f7
[0m20:12:12.142905 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.global_economic_tracker.stg_index_metrics, now test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_sharpe_mo__2___2.d118d6bf26)
[0m20:12:12.145574 [debug] [Thread-4 (]: Writing injected SQL for node "test.global_economic_tracker.accepted_values_stg_commodity_metrics_trend__up__down__flat.70479897b5"
[0m20:12:12.148199 [debug] [Thread-1 (]: Writing injected SQL for node "test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_daily_return__0_5___0_5.2c4246e1e4"
[0m20:12:12.151202 [debug] [Thread-2 (]: Writing injected SQL for node "test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_rolling_avg_mo__0_3___0_3.22c9d514f7"
[0m20:12:12.151934 [debug] [Thread-3 (]: Began compiling node test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_sharpe_mo__2___2.d118d6bf26
[0m20:12:12.156653 [debug] [Thread-3 (]: Writing injected SQL for node "test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_sharpe_mo__2___2.d118d6bf26"
[0m20:12:12.161456 [debug] [Thread-2 (]: Began executing node test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_rolling_avg_mo__0_3___0_3.22c9d514f7
[0m20:12:12.161720 [debug] [Thread-1 (]: Began executing node test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_daily_return__0_5___0_5.2c4246e1e4
[0m20:12:12.163386 [debug] [Thread-2 (]: Writing runtime sql for node "test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_rolling_avg_mo__0_3___0_3.22c9d514f7"
[0m20:12:12.163656 [debug] [Thread-4 (]: Began executing node test.global_economic_tracker.accepted_values_stg_commodity_metrics_trend__up__down__flat.70479897b5
[0m20:12:12.163890 [debug] [Thread-3 (]: Began executing node test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_sharpe_mo__2___2.d118d6bf26
[0m20:12:12.165338 [debug] [Thread-1 (]: Writing runtime sql for node "test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_daily_return__0_5___0_5.2c4246e1e4"
[0m20:12:12.167531 [debug] [Thread-4 (]: Writing runtime sql for node "test.global_economic_tracker.accepted_values_stg_commodity_metrics_trend__up__down__flat.70479897b5"
[0m20:12:12.169158 [debug] [Thread-3 (]: Writing runtime sql for node "test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_sharpe_mo__2___2.d118d6bf26"
[0m20:12:12.173058 [debug] [Thread-2 (]: Using postgres connection "test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_rolling_avg_mo__0_3___0_3.22c9d514f7"
[0m20:12:12.173772 [debug] [Thread-3 (]: Using postgres connection "test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_sharpe_mo__2___2.d118d6bf26"
[0m20:12:12.174193 [debug] [Thread-2 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_rolling_avg_mo__0_3___0_3.22c9d514f7: BEGIN
[0m20:12:12.175035 [debug] [Thread-4 (]: Using postgres connection "test.global_economic_tracker.accepted_values_stg_commodity_metrics_trend__up__down__flat.70479897b5"
[0m20:12:12.175320 [debug] [Thread-3 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_sharpe_mo__2___2.d118d6bf26: BEGIN
[0m20:12:12.175735 [debug] [Thread-1 (]: Using postgres connection "test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_daily_return__0_5___0_5.2c4246e1e4"
[0m20:12:12.176288 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:12:12.177070 [debug] [Thread-4 (]: On test.global_economic_tracker.accepted_values_stg_commodity_metrics_trend__up__down__flat.70479897b5: BEGIN
[0m20:12:12.177749 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:12:12.178476 [debug] [Thread-1 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_daily_return__0_5___0_5.2c4246e1e4: BEGIN
[0m20:12:12.179998 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:12:12.180773 [debug] [Thread-2 (]: SQL status: BEGIN in 0.004 seconds
[0m20:12:12.181887 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:12:12.182629 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m20:12:12.183627 [debug] [Thread-2 (]: Using postgres connection "test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_rolling_avg_mo__0_3___0_3.22c9d514f7"
[0m20:12:12.184255 [debug] [Thread-4 (]: SQL status: BEGIN in 0.004 seconds
[0m20:12:12.185178 [debug] [Thread-3 (]: Using postgres connection "test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_sharpe_mo__2___2.d118d6bf26"
[0m20:12:12.185806 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m20:12:12.186062 [debug] [Thread-2 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_rolling_avg_mo__0_3___0_3.22c9d514f7: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_rolling_avg_mo__0_3___0_3.22c9d514f7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with meet_condition as(
  select *
  from "airflow"."public"."stg_commodity_metrics"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not rolling_avg_mo >= -0.3
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not rolling_avg_mo <= 0.3
)

select *
from validation_errors


      
    ) dbt_internal_test
[0m20:12:12.186825 [debug] [Thread-4 (]: Using postgres connection "test.global_economic_tracker.accepted_values_stg_commodity_metrics_trend__up__down__flat.70479897b5"
[0m20:12:12.187553 [debug] [Thread-3 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_sharpe_mo__2___2.d118d6bf26: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_sharpe_mo__2___2.d118d6bf26"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with meet_condition as(
  select *
  from "airflow"."public"."stg_commodity_metrics"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not sharpe_mo >= -2
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not sharpe_mo <= 2
)

select *
from validation_errors


      
    ) dbt_internal_test
[0m20:12:12.188246 [debug] [Thread-1 (]: Using postgres connection "test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_daily_return__0_5___0_5.2c4246e1e4"
[0m20:12:12.189498 [debug] [Thread-4 (]: On test.global_economic_tracker.accepted_values_stg_commodity_metrics_trend__up__down__flat.70479897b5: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.accepted_values_stg_commodity_metrics_trend__up__down__flat.70479897b5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        trend as value_field,
        count(*) as n_records

    from "airflow"."public"."stg_commodity_metrics"
    group by trend

)

select *
from all_values
where value_field not in (
    'up','down','flat'
)



      
    ) dbt_internal_test
[0m20:12:12.189764 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:12:12.190906 [debug] [Thread-1 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_daily_return__0_5___0_5.2c4246e1e4: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_daily_return__0_5___0_5.2c4246e1e4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with meet_condition as(
  select *
  from "airflow"."public"."stg_commodity_metrics"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not daily_return >= -0.5
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not daily_return <= 0.5
)

select *
from validation_errors


      
    ) dbt_internal_test
[0m20:12:12.191188 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:12:12.192319 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:12:12.193415 [debug] [Thread-2 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_rolling_avg_mo__0_3___0_3.22c9d514f7: ROLLBACK
[0m20:12:12.194661 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:12:12.195392 [debug] [Thread-3 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_sharpe_mo__2___2.d118d6bf26: ROLLBACK
[0m20:12:12.196548 [debug] [Thread-4 (]: On test.global_economic_tracker.accepted_values_stg_commodity_metrics_trend__up__down__flat.70479897b5: ROLLBACK
[0m20:12:12.197369 [debug] [Thread-2 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_rolling_avg_mo__0_3___0_3.22c9d514f7: Close
[0m20:12:12.198361 [debug] [Thread-1 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_daily_return__0_5___0_5.2c4246e1e4: ROLLBACK
[0m20:12:12.199292 [debug] [Thread-3 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_sharpe_mo__2___2.d118d6bf26: Close
[0m20:12:12.199955 [debug] [Thread-4 (]: On test.global_economic_tracker.accepted_values_stg_commodity_metrics_trend__up__down__flat.70479897b5: Close
[0m20:12:12.200693 [info ] [Thread-2 (]: 15 of 26 PASS dbt_utils_accepted_range_stg_commodity_metrics_rolling_avg_mo__0_3___0_3  [[32mPASS[0m in 0.06s]
[0m20:12:12.201329 [debug] [Thread-1 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_daily_return__0_5___0_5.2c4246e1e4: Close
[0m20:12:12.202023 [info ] [Thread-3 (]: 16 of 26 PASS dbt_utils_accepted_range_stg_commodity_metrics_sharpe_mo__2___2 .. [[32mPASS[0m in 0.06s]
[0m20:12:12.202695 [info ] [Thread-4 (]: 13 of 26 PASS accepted_values_stg_commodity_metrics_trend__up__down__flat ...... [[32mPASS[0m in 0.07s]
[0m20:12:12.203635 [debug] [Thread-2 (]: Finished running node test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_rolling_avg_mo__0_3___0_3.22c9d514f7
[0m20:12:12.204577 [info ] [Thread-1 (]: 14 of 26 PASS dbt_utils_accepted_range_stg_commodity_metrics_daily_return__0_5___0_5  [[32mPASS[0m in 0.07s]
[0m20:12:12.205207 [debug] [Thread-3 (]: Finished running node test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_sharpe_mo__2___2.d118d6bf26
[0m20:12:12.205968 [debug] [Thread-4 (]: Finished running node test.global_economic_tracker.accepted_values_stg_commodity_metrics_trend__up__down__flat.70479897b5
[0m20:12:12.206677 [debug] [Thread-2 (]: Began running node test.global_economic_tracker.not_null_stg_commodity_metrics_daily_return.74b14cc336
[0m20:12:12.207519 [debug] [Thread-1 (]: Finished running node test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_daily_return__0_5___0_5.2c4246e1e4
[0m20:12:12.208345 [debug] [Thread-3 (]: Began running node test.global_economic_tracker.not_null_stg_commodity_metrics_ticker.6d1d8d12d7
[0m20:12:12.209129 [debug] [Thread-4 (]: Began running node test.global_economic_tracker.not_null_stg_commodity_metrics_timestamp.5651d4b196
[0m20:12:12.209884 [info ] [Thread-2 (]: 17 of 26 START test not_null_stg_commodity_metrics_daily_return ................ [RUN]
[0m20:12:12.210702 [debug] [Thread-1 (]: Began running node test.global_economic_tracker.accepted_values_stg_index_metrics_trend__up__down__flat.1fea418295
[0m20:12:12.211482 [info ] [Thread-3 (]: 18 of 26 START test not_null_stg_commodity_metrics_ticker ...................... [RUN]
[0m20:12:12.212253 [info ] [Thread-4 (]: 19 of 26 START test not_null_stg_commodity_metrics_timestamp ................... [RUN]
[0m20:12:12.212985 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_rolling_avg_mo__0_3___0_3.22c9d514f7, now test.global_economic_tracker.not_null_stg_commodity_metrics_daily_return.74b14cc336)
[0m20:12:12.213717 [info ] [Thread-1 (]: 20 of 26 START test accepted_values_stg_index_metrics_trend__up__down__flat .... [RUN]
[0m20:12:12.214460 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_sharpe_mo__2___2.d118d6bf26, now test.global_economic_tracker.not_null_stg_commodity_metrics_ticker.6d1d8d12d7)
[0m20:12:12.215266 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.global_economic_tracker.accepted_values_stg_commodity_metrics_trend__up__down__flat.70479897b5, now test.global_economic_tracker.not_null_stg_commodity_metrics_timestamp.5651d4b196)
[0m20:12:12.216184 [debug] [Thread-2 (]: Began compiling node test.global_economic_tracker.not_null_stg_commodity_metrics_daily_return.74b14cc336
[0m20:12:12.216939 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_daily_return__0_5___0_5.2c4246e1e4, now test.global_economic_tracker.accepted_values_stg_index_metrics_trend__up__down__flat.1fea418295)
[0m20:12:12.217678 [debug] [Thread-3 (]: Began compiling node test.global_economic_tracker.not_null_stg_commodity_metrics_ticker.6d1d8d12d7
[0m20:12:12.218353 [debug] [Thread-4 (]: Began compiling node test.global_economic_tracker.not_null_stg_commodity_metrics_timestamp.5651d4b196
[0m20:12:12.221020 [debug] [Thread-2 (]: Writing injected SQL for node "test.global_economic_tracker.not_null_stg_commodity_metrics_daily_return.74b14cc336"
[0m20:12:12.221750 [debug] [Thread-1 (]: Began compiling node test.global_economic_tracker.accepted_values_stg_index_metrics_trend__up__down__flat.1fea418295
[0m20:12:12.225007 [debug] [Thread-3 (]: Writing injected SQL for node "test.global_economic_tracker.not_null_stg_commodity_metrics_ticker.6d1d8d12d7"
[0m20:12:12.227459 [debug] [Thread-4 (]: Writing injected SQL for node "test.global_economic_tracker.not_null_stg_commodity_metrics_timestamp.5651d4b196"
[0m20:12:12.230607 [debug] [Thread-1 (]: Writing injected SQL for node "test.global_economic_tracker.accepted_values_stg_index_metrics_trend__up__down__flat.1fea418295"
[0m20:12:12.235074 [debug] [Thread-2 (]: Began executing node test.global_economic_tracker.not_null_stg_commodity_metrics_daily_return.74b14cc336
[0m20:12:12.235658 [debug] [Thread-1 (]: Began executing node test.global_economic_tracker.accepted_values_stg_index_metrics_trend__up__down__flat.1fea418295
[0m20:12:12.237296 [debug] [Thread-2 (]: Writing runtime sql for node "test.global_economic_tracker.not_null_stg_commodity_metrics_daily_return.74b14cc336"
[0m20:12:12.237558 [debug] [Thread-3 (]: Began executing node test.global_economic_tracker.not_null_stg_commodity_metrics_ticker.6d1d8d12d7
[0m20:12:12.237792 [debug] [Thread-4 (]: Began executing node test.global_economic_tracker.not_null_stg_commodity_metrics_timestamp.5651d4b196
[0m20:12:12.239277 [debug] [Thread-1 (]: Writing runtime sql for node "test.global_economic_tracker.accepted_values_stg_index_metrics_trend__up__down__flat.1fea418295"
[0m20:12:12.241537 [debug] [Thread-3 (]: Writing runtime sql for node "test.global_economic_tracker.not_null_stg_commodity_metrics_ticker.6d1d8d12d7"
[0m20:12:12.243597 [debug] [Thread-4 (]: Writing runtime sql for node "test.global_economic_tracker.not_null_stg_commodity_metrics_timestamp.5651d4b196"
[0m20:12:12.247852 [debug] [Thread-2 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_commodity_metrics_daily_return.74b14cc336"
[0m20:12:12.248498 [debug] [Thread-1 (]: Using postgres connection "test.global_economic_tracker.accepted_values_stg_index_metrics_trend__up__down__flat.1fea418295"
[0m20:12:12.249128 [debug] [Thread-2 (]: On test.global_economic_tracker.not_null_stg_commodity_metrics_daily_return.74b14cc336: BEGIN
[0m20:12:12.249506 [debug] [Thread-3 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_commodity_metrics_ticker.6d1d8d12d7"
[0m20:12:12.250187 [debug] [Thread-1 (]: On test.global_economic_tracker.accepted_values_stg_index_metrics_trend__up__down__flat.1fea418295: BEGIN
[0m20:12:12.250705 [debug] [Thread-4 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_commodity_metrics_timestamp.5651d4b196"
[0m20:12:12.251095 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:12:12.251823 [debug] [Thread-3 (]: On test.global_economic_tracker.not_null_stg_commodity_metrics_ticker.6d1d8d12d7: BEGIN
[0m20:12:12.252546 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:12:12.253282 [debug] [Thread-4 (]: On test.global_economic_tracker.not_null_stg_commodity_metrics_timestamp.5651d4b196: BEGIN
[0m20:12:12.254693 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:12:12.255705 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m20:12:12.256249 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:12:12.257102 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m20:12:12.257886 [debug] [Thread-2 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_commodity_metrics_daily_return.74b14cc336"
[0m20:12:12.258445 [debug] [Thread-3 (]: SQL status: BEGIN in 0.004 seconds
[0m20:12:12.259429 [debug] [Thread-1 (]: Using postgres connection "test.global_economic_tracker.accepted_values_stg_index_metrics_trend__up__down__flat.1fea418295"
[0m20:12:12.260209 [debug] [Thread-2 (]: On test.global_economic_tracker.not_null_stg_commodity_metrics_daily_return.74b14cc336: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.not_null_stg_commodity_metrics_daily_return.74b14cc336"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select daily_return
from "airflow"."public"."stg_commodity_metrics"
where daily_return is null



      
    ) dbt_internal_test
[0m20:12:12.260564 [debug] [Thread-4 (]: SQL status: BEGIN in 0.004 seconds
[0m20:12:12.261068 [debug] [Thread-3 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_commodity_metrics_ticker.6d1d8d12d7"
[0m20:12:12.261839 [debug] [Thread-1 (]: On test.global_economic_tracker.accepted_values_stg_index_metrics_trend__up__down__flat.1fea418295: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.accepted_values_stg_index_metrics_trend__up__down__flat.1fea418295"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        trend as value_field,
        count(*) as n_records

    from "airflow"."public"."stg_index_metrics"
    group by trend

)

select *
from all_values
where value_field not in (
    'up','down','flat'
)



      
    ) dbt_internal_test
[0m20:12:12.263070 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.000 seconds
[0m20:12:12.263318 [debug] [Thread-4 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_commodity_metrics_timestamp.5651d4b196"
[0m20:12:12.264037 [debug] [Thread-3 (]: On test.global_economic_tracker.not_null_stg_commodity_metrics_ticker.6d1d8d12d7: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.not_null_stg_commodity_metrics_ticker.6d1d8d12d7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select ticker
from "airflow"."public"."stg_commodity_metrics"
where ticker is null



      
    ) dbt_internal_test
[0m20:12:12.265876 [debug] [Thread-2 (]: On test.global_economic_tracker.not_null_stg_commodity_metrics_daily_return.74b14cc336: ROLLBACK
[0m20:12:12.266147 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:12:12.266709 [debug] [Thread-4 (]: On test.global_economic_tracker.not_null_stg_commodity_metrics_timestamp.5651d4b196: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.not_null_stg_commodity_metrics_timestamp.5651d4b196"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select timestamp
from "airflow"."public"."stg_commodity_metrics"
where timestamp is null



      
    ) dbt_internal_test
[0m20:12:12.267731 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.000 seconds
[0m20:12:12.268213 [debug] [Thread-2 (]: On test.global_economic_tracker.not_null_stg_commodity_metrics_daily_return.74b14cc336: Close
[0m20:12:12.269213 [debug] [Thread-1 (]: On test.global_economic_tracker.accepted_values_stg_index_metrics_trend__up__down__flat.1fea418295: ROLLBACK
[0m20:12:12.270542 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:12:12.271445 [debug] [Thread-3 (]: On test.global_economic_tracker.not_null_stg_commodity_metrics_ticker.6d1d8d12d7: ROLLBACK
[0m20:12:12.272365 [info ] [Thread-2 (]: 17 of 26 PASS not_null_stg_commodity_metrics_daily_return ...................... [[32mPASS[0m in 0.06s]
[0m20:12:12.273069 [debug] [Thread-1 (]: On test.global_economic_tracker.accepted_values_stg_index_metrics_trend__up__down__flat.1fea418295: Close
[0m20:12:12.274054 [debug] [Thread-4 (]: On test.global_economic_tracker.not_null_stg_commodity_metrics_timestamp.5651d4b196: ROLLBACK
[0m20:12:12.274783 [debug] [Thread-3 (]: On test.global_economic_tracker.not_null_stg_commodity_metrics_ticker.6d1d8d12d7: Close
[0m20:12:12.275434 [debug] [Thread-2 (]: Finished running node test.global_economic_tracker.not_null_stg_commodity_metrics_daily_return.74b14cc336
[0m20:12:12.276305 [info ] [Thread-1 (]: 20 of 26 PASS accepted_values_stg_index_metrics_trend__up__down__flat .......... [[32mPASS[0m in 0.06s]
[0m20:12:12.276927 [debug] [Thread-4 (]: On test.global_economic_tracker.not_null_stg_commodity_metrics_timestamp.5651d4b196: Close
[0m20:12:12.277574 [info ] [Thread-3 (]: 18 of 26 PASS not_null_stg_commodity_metrics_ticker ............................ [[32mPASS[0m in 0.06s]
[0m20:12:12.278246 [debug] [Thread-2 (]: Began running node test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_daily_return__0_5___0_5.6e9f33b0a2
[0m20:12:12.279123 [debug] [Thread-1 (]: Finished running node test.global_economic_tracker.accepted_values_stg_index_metrics_trend__up__down__flat.1fea418295
[0m20:12:12.279924 [info ] [Thread-4 (]: 19 of 26 PASS not_null_stg_commodity_metrics_timestamp ......................... [[32mPASS[0m in 0.06s]
[0m20:12:12.280575 [debug] [Thread-3 (]: Finished running node test.global_economic_tracker.not_null_stg_commodity_metrics_ticker.6d1d8d12d7
[0m20:12:12.281337 [info ] [Thread-2 (]: 21 of 26 START test dbt_utils_accepted_range_stg_index_metrics_daily_return__0_5___0_5  [RUN]
[0m20:12:12.282091 [debug] [Thread-1 (]: Began running node test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_rolling_avg_mo__0_3___0_3.13a5241921
[0m20:12:12.282942 [debug] [Thread-4 (]: Finished running node test.global_economic_tracker.not_null_stg_commodity_metrics_timestamp.5651d4b196
[0m20:12:12.283592 [debug] [Thread-3 (]: Began running node test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_sharpe_mo__2___2.5a4a583bdc
[0m20:12:12.284462 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.global_economic_tracker.not_null_stg_commodity_metrics_daily_return.74b14cc336, now test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_daily_return__0_5___0_5.6e9f33b0a2)
[0m20:12:12.285252 [info ] [Thread-1 (]: 22 of 26 START test dbt_utils_accepted_range_stg_index_metrics_rolling_avg_mo__0_3___0_3  [RUN]
[0m20:12:12.286135 [debug] [Thread-4 (]: Began running node test.global_economic_tracker.not_null_stg_index_metrics_daily_return.26f4856193
[0m20:12:12.286835 [info ] [Thread-3 (]: 23 of 26 START test dbt_utils_accepted_range_stg_index_metrics_sharpe_mo__2___2  [RUN]
[0m20:12:12.287565 [debug] [Thread-2 (]: Began compiling node test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_daily_return__0_5___0_5.6e9f33b0a2
[0m20:12:12.288338 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.global_economic_tracker.accepted_values_stg_index_metrics_trend__up__down__flat.1fea418295, now test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_rolling_avg_mo__0_3___0_3.13a5241921)
[0m20:12:12.289069 [info ] [Thread-4 (]: 24 of 26 START test not_null_stg_index_metrics_daily_return .................... [RUN]
[0m20:12:12.289717 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.global_economic_tracker.not_null_stg_commodity_metrics_ticker.6d1d8d12d7, now test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_sharpe_mo__2___2.5a4a583bdc)
[0m20:12:12.292999 [debug] [Thread-2 (]: Writing injected SQL for node "test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_daily_return__0_5___0_5.6e9f33b0a2"
[0m20:12:12.293731 [debug] [Thread-1 (]: Began compiling node test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_rolling_avg_mo__0_3___0_3.13a5241921
[0m20:12:12.294483 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.global_economic_tracker.not_null_stg_commodity_metrics_timestamp.5651d4b196, now test.global_economic_tracker.not_null_stg_index_metrics_daily_return.26f4856193)
[0m20:12:12.295221 [debug] [Thread-3 (]: Began compiling node test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_sharpe_mo__2___2.5a4a583bdc
[0m20:12:12.298621 [debug] [Thread-1 (]: Writing injected SQL for node "test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_rolling_avg_mo__0_3___0_3.13a5241921"
[0m20:12:12.299396 [debug] [Thread-4 (]: Began compiling node test.global_economic_tracker.not_null_stg_index_metrics_daily_return.26f4856193
[0m20:12:12.301857 [debug] [Thread-3 (]: Writing injected SQL for node "test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_sharpe_mo__2___2.5a4a583bdc"
[0m20:12:12.302789 [debug] [Thread-2 (]: Began executing node test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_daily_return__0_5___0_5.6e9f33b0a2
[0m20:12:12.305246 [debug] [Thread-4 (]: Writing injected SQL for node "test.global_economic_tracker.not_null_stg_index_metrics_daily_return.26f4856193"
[0m20:12:12.307758 [debug] [Thread-2 (]: Writing runtime sql for node "test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_daily_return__0_5___0_5.6e9f33b0a2"
[0m20:12:12.309430 [debug] [Thread-1 (]: Began executing node test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_rolling_avg_mo__0_3___0_3.13a5241921
[0m20:12:12.309955 [debug] [Thread-3 (]: Began executing node test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_sharpe_mo__2___2.5a4a583bdc
[0m20:12:12.312144 [debug] [Thread-1 (]: Writing runtime sql for node "test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_rolling_avg_mo__0_3___0_3.13a5241921"
[0m20:12:12.313868 [debug] [Thread-3 (]: Writing runtime sql for node "test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_sharpe_mo__2___2.5a4a583bdc"
[0m20:12:12.314117 [debug] [Thread-4 (]: Began executing node test.global_economic_tracker.not_null_stg_index_metrics_daily_return.26f4856193
[0m20:12:12.315932 [debug] [Thread-2 (]: Using postgres connection "test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_daily_return__0_5___0_5.6e9f33b0a2"
[0m20:12:12.317093 [debug] [Thread-4 (]: Writing runtime sql for node "test.global_economic_tracker.not_null_stg_index_metrics_daily_return.26f4856193"
[0m20:12:12.317920 [debug] [Thread-2 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_daily_return__0_5___0_5.6e9f33b0a2: BEGIN
[0m20:12:12.318234 [debug] [Thread-1 (]: Using postgres connection "test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_rolling_avg_mo__0_3___0_3.13a5241921"
[0m20:12:12.318644 [debug] [Thread-3 (]: Using postgres connection "test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_sharpe_mo__2___2.5a4a583bdc"
[0m20:12:12.319703 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:12:12.320557 [debug] [Thread-1 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_rolling_avg_mo__0_3___0_3.13a5241921: BEGIN
[0m20:12:12.321303 [debug] [Thread-3 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_sharpe_mo__2___2.5a4a583bdc: BEGIN
[0m20:12:12.322663 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:12:12.323371 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:12:12.323990 [debug] [Thread-2 (]: SQL status: BEGIN in 0.004 seconds
[0m20:12:12.325592 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m20:12:12.325989 [debug] [Thread-2 (]: Using postgres connection "test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_daily_return__0_5___0_5.6e9f33b0a2"
[0m20:12:12.326311 [debug] [Thread-4 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_index_metrics_daily_return.26f4856193"
[0m20:12:12.326571 [debug] [Thread-3 (]: SQL status: BEGIN in 0.003 seconds
[0m20:12:12.326957 [debug] [Thread-1 (]: Using postgres connection "test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_rolling_avg_mo__0_3___0_3.13a5241921"
[0m20:12:12.327672 [debug] [Thread-2 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_daily_return__0_5___0_5.6e9f33b0a2: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_daily_return__0_5___0_5.6e9f33b0a2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with meet_condition as(
  select *
  from "airflow"."public"."stg_index_metrics"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not daily_return >= -0.5
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not daily_return <= 0.5
)

select *
from validation_errors


      
    ) dbt_internal_test
[0m20:12:12.328383 [debug] [Thread-4 (]: On test.global_economic_tracker.not_null_stg_index_metrics_daily_return.26f4856193: BEGIN
[0m20:12:12.329045 [debug] [Thread-3 (]: Using postgres connection "test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_sharpe_mo__2___2.5a4a583bdc"
[0m20:12:12.329721 [debug] [Thread-1 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_rolling_avg_mo__0_3___0_3.13a5241921: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_rolling_avg_mo__0_3___0_3.13a5241921"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with meet_condition as(
  select *
  from "airflow"."public"."stg_index_metrics"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not rolling_avg_mo >= -0.3
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not rolling_avg_mo <= 0.3
)

select *
from validation_errors


      
    ) dbt_internal_test
[0m20:12:12.331115 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:12:12.331386 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:12:12.331929 [debug] [Thread-3 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_sharpe_mo__2___2.5a4a583bdc: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_sharpe_mo__2___2.5a4a583bdc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with meet_condition as(
  select *
  from "airflow"."public"."stg_index_metrics"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not sharpe_mo >= -2
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not sharpe_mo <= 2
)

select *
from validation_errors


      
    ) dbt_internal_test
[0m20:12:12.333161 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:12:12.334949 [debug] [Thread-2 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_daily_return__0_5___0_5.6e9f33b0a2: ROLLBACK
[0m20:12:12.335456 [debug] [Thread-4 (]: SQL status: BEGIN in 0.004 seconds
[0m20:12:12.336798 [debug] [Thread-1 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_rolling_avg_mo__0_3___0_3.13a5241921: ROLLBACK
[0m20:12:12.337050 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:12:12.337906 [debug] [Thread-2 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_daily_return__0_5___0_5.6e9f33b0a2: Close
[0m20:12:12.338447 [debug] [Thread-4 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_index_metrics_daily_return.26f4856193"
[0m20:12:12.339253 [debug] [Thread-1 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_rolling_avg_mo__0_3___0_3.13a5241921: Close
[0m20:12:12.340215 [debug] [Thread-3 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_sharpe_mo__2___2.5a4a583bdc: ROLLBACK
[0m20:12:12.341118 [info ] [Thread-2 (]: 21 of 26 PASS dbt_utils_accepted_range_stg_index_metrics_daily_return__0_5___0_5  [[32mPASS[0m in 0.06s]
[0m20:12:12.341655 [debug] [Thread-4 (]: On test.global_economic_tracker.not_null_stg_index_metrics_daily_return.26f4856193: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.not_null_stg_index_metrics_daily_return.26f4856193"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select daily_return
from "airflow"."public"."stg_index_metrics"
where daily_return is null



      
    ) dbt_internal_test
[0m20:12:12.342695 [info ] [Thread-1 (]: 22 of 26 PASS dbt_utils_accepted_range_stg_index_metrics_rolling_avg_mo__0_3___0_3  [[32mPASS[0m in 0.05s]
[0m20:12:12.343333 [debug] [Thread-3 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_sharpe_mo__2___2.5a4a583bdc: Close
[0m20:12:12.343975 [debug] [Thread-2 (]: Finished running node test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_daily_return__0_5___0_5.6e9f33b0a2
[0m20:12:12.344998 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.000 seconds
[0m20:12:12.345459 [debug] [Thread-1 (]: Finished running node test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_rolling_avg_mo__0_3___0_3.13a5241921
[0m20:12:12.346353 [info ] [Thread-3 (]: 23 of 26 PASS dbt_utils_accepted_range_stg_index_metrics_sharpe_mo__2___2 ...... [[32mPASS[0m in 0.06s]
[0m20:12:12.346929 [debug] [Thread-2 (]: Began running node test.global_economic_tracker.not_null_stg_index_metrics_ticker.4b922607c9
[0m20:12:12.348084 [debug] [Thread-4 (]: On test.global_economic_tracker.not_null_stg_index_metrics_daily_return.26f4856193: ROLLBACK
[0m20:12:12.348837 [debug] [Thread-1 (]: Began running node test.global_economic_tracker.not_null_stg_index_metrics_timestamp.b1d1abca86
[0m20:12:12.349673 [debug] [Thread-3 (]: Finished running node test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_sharpe_mo__2___2.5a4a583bdc
[0m20:12:12.350381 [info ] [Thread-2 (]: 25 of 26 START test not_null_stg_index_metrics_ticker .......................... [RUN]
[0m20:12:12.351226 [debug] [Thread-4 (]: On test.global_economic_tracker.not_null_stg_index_metrics_daily_return.26f4856193: Close
[0m20:12:12.351768 [info ] [Thread-1 (]: 26 of 26 START test not_null_stg_index_metrics_timestamp ....................... [RUN]
[0m20:12:12.352996 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_daily_return__0_5___0_5.6e9f33b0a2, now test.global_economic_tracker.not_null_stg_index_metrics_ticker.4b922607c9)
[0m20:12:12.354103 [info ] [Thread-4 (]: 24 of 26 PASS not_null_stg_index_metrics_daily_return .......................... [[32mPASS[0m in 0.06s]
[0m20:12:12.354727 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_rolling_avg_mo__0_3___0_3.13a5241921, now test.global_economic_tracker.not_null_stg_index_metrics_timestamp.b1d1abca86)
[0m20:12:12.355465 [debug] [Thread-2 (]: Began compiling node test.global_economic_tracker.not_null_stg_index_metrics_ticker.4b922607c9
[0m20:12:12.356268 [debug] [Thread-4 (]: Finished running node test.global_economic_tracker.not_null_stg_index_metrics_daily_return.26f4856193
[0m20:12:12.356960 [debug] [Thread-1 (]: Began compiling node test.global_economic_tracker.not_null_stg_index_metrics_timestamp.b1d1abca86
[0m20:12:12.359531 [debug] [Thread-2 (]: Writing injected SQL for node "test.global_economic_tracker.not_null_stg_index_metrics_ticker.4b922607c9"
[0m20:12:12.362575 [debug] [Thread-1 (]: Writing injected SQL for node "test.global_economic_tracker.not_null_stg_index_metrics_timestamp.b1d1abca86"
[0m20:12:12.367243 [debug] [Thread-2 (]: Began executing node test.global_economic_tracker.not_null_stg_index_metrics_ticker.4b922607c9
[0m20:12:12.368927 [debug] [Thread-2 (]: Writing runtime sql for node "test.global_economic_tracker.not_null_stg_index_metrics_ticker.4b922607c9"
[0m20:12:12.369153 [debug] [Thread-1 (]: Began executing node test.global_economic_tracker.not_null_stg_index_metrics_timestamp.b1d1abca86
[0m20:12:12.371710 [debug] [Thread-1 (]: Writing runtime sql for node "test.global_economic_tracker.not_null_stg_index_metrics_timestamp.b1d1abca86"
[0m20:12:12.375683 [debug] [Thread-2 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_index_metrics_ticker.4b922607c9"
[0m20:12:12.376399 [debug] [Thread-2 (]: On test.global_economic_tracker.not_null_stg_index_metrics_ticker.4b922607c9: BEGIN
[0m20:12:12.377008 [debug] [Thread-1 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_index_metrics_timestamp.b1d1abca86"
[0m20:12:12.377253 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:12:12.378013 [debug] [Thread-1 (]: On test.global_economic_tracker.not_null_stg_index_metrics_timestamp.b1d1abca86: BEGIN
[0m20:12:12.379384 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:12:12.380145 [debug] [Thread-2 (]: SQL status: BEGIN in 0.003 seconds
[0m20:12:12.381058 [debug] [Thread-2 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_index_metrics_ticker.4b922607c9"
[0m20:12:12.381684 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m20:12:12.381934 [debug] [Thread-2 (]: On test.global_economic_tracker.not_null_stg_index_metrics_ticker.4b922607c9: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.not_null_stg_index_metrics_ticker.4b922607c9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select ticker
from "airflow"."public"."stg_index_metrics"
where ticker is null



      
    ) dbt_internal_test
[0m20:12:12.382650 [debug] [Thread-1 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_index_metrics_timestamp.b1d1abca86"
[0m20:12:12.383742 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.000 seconds
[0m20:12:12.384126 [debug] [Thread-1 (]: On test.global_economic_tracker.not_null_stg_index_metrics_timestamp.b1d1abca86: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.not_null_stg_index_metrics_timestamp.b1d1abca86"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select timestamp
from "airflow"."public"."stg_index_metrics"
where timestamp is null



      
    ) dbt_internal_test
[0m20:12:12.385288 [debug] [Thread-2 (]: On test.global_economic_tracker.not_null_stg_index_metrics_ticker.4b922607c9: ROLLBACK
[0m20:12:12.386328 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.000 seconds
[0m20:12:12.386801 [debug] [Thread-2 (]: On test.global_economic_tracker.not_null_stg_index_metrics_ticker.4b922607c9: Close
[0m20:12:12.387768 [debug] [Thread-1 (]: On test.global_economic_tracker.not_null_stg_index_metrics_timestamp.b1d1abca86: ROLLBACK
[0m20:12:12.388705 [info ] [Thread-2 (]: 25 of 26 PASS not_null_stg_index_metrics_ticker ................................ [[32mPASS[0m in 0.04s]
[0m20:12:12.389444 [debug] [Thread-1 (]: On test.global_economic_tracker.not_null_stg_index_metrics_timestamp.b1d1abca86: Close
[0m20:12:12.390064 [debug] [Thread-2 (]: Finished running node test.global_economic_tracker.not_null_stg_index_metrics_ticker.4b922607c9
[0m20:12:12.390910 [info ] [Thread-1 (]: 26 of 26 PASS not_null_stg_index_metrics_timestamp ............................. [[32mPASS[0m in 0.04s]
[0m20:12:12.392116 [debug] [Thread-1 (]: Finished running node test.global_economic_tracker.not_null_stg_index_metrics_timestamp.b1d1abca86
[0m20:12:12.393703 [debug] [MainThread]: Using postgres connection "master"
[0m20:12:12.394348 [debug] [MainThread]: On master: BEGIN
[0m20:12:12.395063 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:12:12.397091 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m20:12:12.397742 [debug] [MainThread]: On master: COMMIT
[0m20:12:12.398408 [debug] [MainThread]: Using postgres connection "master"
[0m20:12:12.399037 [debug] [MainThread]: On master: COMMIT
[0m20:12:12.399917 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:12:12.400675 [debug] [MainThread]: On master: Close
[0m20:12:12.401436 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:12:12.402079 [debug] [MainThread]: Connection 'test.global_economic_tracker.not_null_stg_index_metrics_timestamp.b1d1abca86' was properly closed.
[0m20:12:12.402717 [debug] [MainThread]: Connection 'test.global_economic_tracker.not_null_stg_index_metrics_ticker.4b922607c9' was properly closed.
[0m20:12:12.403325 [debug] [MainThread]: Connection 'test.global_economic_tracker.not_null_stg_index_metrics_daily_return.26f4856193' was properly closed.
[0m20:12:12.403977 [debug] [MainThread]: Connection 'test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_sharpe_mo__2___2.5a4a583bdc' was properly closed.
[0m20:12:12.404789 [info ] [MainThread]: 
[0m20:12:12.405501 [info ] [MainThread]: Finished running 4 table models, 22 data tests in 0 hours 0 minutes and 0.72 seconds (0.72s).
[0m20:12:12.407567 [debug] [MainThread]: Command end result
[0m20:12:12.436436 [debug] [MainThread]: Wrote artifact WritableManifest to /mnt/c/Users/joeyk/PycharmProjects/GlobalEconomicTracker/global_economic_tracker/target/manifest.json
[0m20:12:12.440087 [debug] [MainThread]: Wrote artifact SemanticManifest to /mnt/c/Users/joeyk/PycharmProjects/GlobalEconomicTracker/global_economic_tracker/target/semantic_manifest.json
[0m20:12:12.447442 [debug] [MainThread]: Wrote artifact RunExecutionResult to /mnt/c/Users/joeyk/PycharmProjects/GlobalEconomicTracker/global_economic_tracker/target/run_results.json
[0m20:12:12.448110 [info ] [MainThread]: 
[0m20:12:12.448855 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:12:12.449547 [info ] [MainThread]: 
[0m20:12:12.450263 [info ] [MainThread]: Done. PASS=26 WARN=0 ERROR=0 SKIP=0 TOTAL=26
[0m20:12:12.451401 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 2.3884876, "process_in_blocks": "0", "process_kernel_time": 0.16348, "process_mem_max_rss": "128596", "process_out_blocks": "0", "process_user_time": 1.522415}
[0m20:12:12.452248 [debug] [MainThread]: Command `dbt build` succeeded at 20:12:12.452175 after 2.39 seconds
[0m20:12:12.452886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c45121ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c468a2410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c44fe12d0>]}
[0m20:12:12.453570 [debug] [MainThread]: Flushing usage events
[0m20:12:13.180609 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:16:59.931419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6dbbe55a80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6dbb63e290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6dbb63eec0>]}


============================== 13:16:59.936790 | b8af9d36-c09e-4f27-a831-4180e4e35090 ==============================
[0m13:16:59.936790 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:16:59.937982 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/joey/.dbt', 'log_path': '/mnt/c/Users/joeyk/PycharmProjects/GlobalEconomicTracker/global_economic_tracker/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:17:00.097916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b8af9d36-c09e-4f27-a831-4180e4e35090', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6dbd5c23e0>]}
[0m13:17:00.136308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b8af9d36-c09e-4f27-a831-4180e4e35090', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6dbb006680>]}
[0m13:17:00.138356 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:17:00.207581 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m13:17:01.499743 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:17:01.500564 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:17:01.524852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b8af9d36-c09e-4f27-a831-4180e4e35090', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6db9378130>]}
[0m13:17:01.593557 [debug] [MainThread]: Wrote artifact WritableManifest to /mnt/c/Users/joeyk/PycharmProjects/GlobalEconomicTracker/global_economic_tracker/target/manifest.json
[0m13:17:01.598227 [debug] [MainThread]: Wrote artifact SemanticManifest to /mnt/c/Users/joeyk/PycharmProjects/GlobalEconomicTracker/global_economic_tracker/target/semantic_manifest.json
[0m13:17:01.620324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b8af9d36-c09e-4f27-a831-4180e4e35090', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6db9365c60>]}
[0m13:17:01.621105 [info ] [MainThread]: Found 4 models, 22 data tests, 549 macros
[0m13:17:01.621862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8af9d36-c09e-4f27-a831-4180e4e35090', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6db9365bd0>]}
[0m13:17:01.623479 [info ] [MainThread]: 
[0m13:17:01.624260 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:17:01.625095 [info ] [MainThread]: 
[0m13:17:01.625956 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:17:01.630158 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m13:17:01.661962 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m13:17:01.662756 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m13:17:01.663490 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:17:04.809234 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "172.18.0.2", port 5432 failed: No route to host
	Is the server running on that host and accepting TCP/IP connections?

[0m13:17:07.928963 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m13:17:07.930146 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m13:17:07.931032 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m13:17:07.931682 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m13:17:07.932436 [debug] [ThreadPool]: On list_airflow: No close available on handle
[0m13:17:07.933490 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:17:07.934358 [debug] [MainThread]: Connection 'list_airflow' was properly closed.
[0m13:17:07.935111 [info ] [MainThread]: 
[0m13:17:07.936111 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 6.31 seconds (6.31s).
[0m13:17:07.937093 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "172.18.0.2", port 5432 failed: No route to host
  	Is the server running on that host and accepting TCP/IP connections?
  
[0m13:17:07.938435 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 8.056945, "process_in_blocks": "15352", "process_kernel_time": 0.157068, "process_mem_max_rss": "110436", "process_out_blocks": "0", "process_user_time": 0.952882}
[0m13:17:07.939511 [debug] [MainThread]: Command `dbt run` failed at 13:17:07.939410 after 8.06 seconds
[0m13:17:07.940385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6dbbe55a80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6db9365e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6db93bb9a0>]}
[0m13:17:07.941176 [debug] [MainThread]: Flushing usage events
[0m13:17:08.318854 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:17:11.445048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec9a25a80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec9904880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec8bb9d20>]}


============================== 13:17:11.447613 | 0e2bbceb-db29-4ca6-ac55-ac276a675856 ==============================
[0m13:17:11.447613 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:17:11.448574 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/joey/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/mnt/c/Users/joeyk/PycharmProjects/GlobalEconomicTracker/global_economic_tracker/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m13:17:11.555006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0e2bbceb-db29-4ca6-ac55-ac276a675856', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec9900700>]}
[0m13:17:11.590816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0e2bbceb-db29-4ca6-ac55-ac276a675856', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec924b280>]}
[0m13:17:11.591827 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:17:11.638079 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m13:17:12.586444 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:17:12.587679 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:17:12.619788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0e2bbceb-db29-4ca6-ac55-ac276a675856', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec6b84130>]}
[0m13:17:12.697808 [debug] [MainThread]: Wrote artifact WritableManifest to /mnt/c/Users/joeyk/PycharmProjects/GlobalEconomicTracker/global_economic_tracker/target/manifest.json
[0m13:17:12.702531 [debug] [MainThread]: Wrote artifact SemanticManifest to /mnt/c/Users/joeyk/PycharmProjects/GlobalEconomicTracker/global_economic_tracker/target/semantic_manifest.json
[0m13:17:12.726802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0e2bbceb-db29-4ca6-ac55-ac276a675856', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec6b2eda0>]}
[0m13:17:12.727687 [info ] [MainThread]: Found 4 models, 22 data tests, 549 macros
[0m13:17:12.728463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e2bbceb-db29-4ca6-ac55-ac276a675856', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec6b2fd60>]}
[0m13:17:12.730409 [info ] [MainThread]: 
[0m13:17:12.731162 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:17:12.731858 [info ] [MainThread]: 
[0m13:17:12.732824 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:17:12.737278 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_public'
[0m13:17:12.776567 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m13:17:12.777473 [debug] [ThreadPool]: On list_airflow_public: BEGIN
[0m13:17:12.778177 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:17:15.974791 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "172.18.0.2", port 5432 failed: No route to host
	Is the server running on that host and accepting TCP/IP connections?

[0m13:17:19.097854 [debug] [ThreadPool]: Postgres adapter: Error running SQL: BEGIN
[0m13:17:19.099230 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m13:17:19.099974 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_relations_without_caching
[0m13:17:19.100662 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m13:17:19.101350 [debug] [ThreadPool]: On list_airflow_public: No close available on handle
[0m13:17:19.102363 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:17:19.103045 [debug] [MainThread]: Connection 'list_airflow_public' was properly closed.
[0m13:17:19.103736 [info ] [MainThread]: 
[0m13:17:19.104502 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 6.37 seconds (6.37s).
[0m13:17:19.105338 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "172.18.0.2", port 5432 failed: No route to host
  	Is the server running on that host and accepting TCP/IP connections?
  
[0m13:17:19.106743 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 7.7225466, "process_in_blocks": "1432", "process_kernel_time": 0.136606, "process_mem_max_rss": "112216", "process_out_blocks": "0", "process_user_time": 0.992676}
[0m13:17:19.107776 [debug] [MainThread]: Command `dbt test` failed at 13:17:19.107696 after 7.72 seconds
[0m13:17:19.108498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec9a25a80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec6b2d840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ec8bc17b0>]}
[0m13:17:19.109219 [debug] [MainThread]: Flushing usage events
[0m13:17:19.524883 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:10:41.742868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1388798da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f138925b9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f138879af60>]}


============================== 21:10:41.747619 | 1e699279-ced8-4628-941c-7aba37a7c07f ==============================
[0m21:10:41.747619 [info ] [MainThread]: Running with dbt=1.9.4
[0m21:10:41.748559 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/global_economic_tracker', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/global_economic_tracker/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select path:models/staging --profiles-dir /opt/global_economic_tracker', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:10:41.752793 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'global_economic_tracker'
[0m21:10:41.753991 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.050018694, "process_in_blocks": "24440", "process_kernel_time": 0.176752, "process_mem_max_rss": "97748", "process_out_blocks": "0", "process_user_time": 1.109611}
[0m21:10:41.754854 [debug] [MainThread]: Command `dbt run` failed at 21:10:41.754770 after 0.05 seconds
[0m21:10:41.755576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1388616ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f138823ce00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13884c7e90>]}
[0m21:10:41.756346 [debug] [MainThread]: Flushing usage events
[0m21:10:42.316076 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:10:58.955106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09dd2a7ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09dee1b2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09de273920>]}


============================== 21:10:58.960119 | a3cc6435-7511-43a1-b3a4-25f47082b489 ==============================
[0m21:10:58.960119 [info ] [MainThread]: Running with dbt=1.9.4
[0m21:10:58.961067 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/global_economic_tracker', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/global_economic_tracker/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select path:models/staging --profiles-dir /opt/global_economic_tracker', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:10:58.965304 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'global_economic_tracker'
[0m21:10:58.966517 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.05131685, "process_in_blocks": "0", "process_kernel_time": 0.133177, "process_mem_max_rss": "97896", "process_out_blocks": "0", "process_user_time": 0.989318}
[0m21:10:58.967484 [debug] [MainThread]: Command `dbt run` failed at 21:10:58.967396 after 0.05 seconds
[0m21:10:58.968213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09dd2882c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09e098af60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09dcefc860>]}
[0m21:10:58.968996 [debug] [MainThread]: Flushing usage events
[0m21:10:59.517081 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:21:42.357093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1cf8efe60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1d099e690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1ce9278c0>]}


============================== 21:21:42.361298 | 4a5c7633-0d36-45b2-8875-ca175881b861 ==============================
[0m21:21:42.361298 [info ] [MainThread]: Running with dbt=1.9.4
[0m21:21:42.362309 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/global_economic_tracker/logs', 'profiles_dir': '/opt/global_economic_tracker', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select path:models/staging --profiles-dir /opt/global_economic_tracker', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:21:42.366680 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'global_economic_tracker'
[0m21:21:42.367862 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.05242865, "process_in_blocks": "23336", "process_kernel_time": 0.115636, "process_mem_max_rss": "100164", "process_out_blocks": "1904", "process_user_time": 1.137096}
[0m21:21:42.368712 [debug] [MainThread]: Command `dbt run` failed at 21:21:42.368626 after 0.05 seconds
[0m21:21:42.369534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1ce8ca630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1ceb07710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1cf06fd70>]}
[0m21:21:42.370398 [debug] [MainThread]: Flushing usage events
[0m21:21:42.929847 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:22:00.058489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d67453aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d67277c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d688c7770>]}


============================== 21:22:00.063067 | 284f8a3f-39fe-479f-885e-b0eb76520f45 ==============================
[0m21:22:00.063067 [info ] [MainThread]: Running with dbt=1.9.4
[0m21:22:00.063937 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/global_economic_tracker/logs', 'version_check': 'True', 'profiles_dir': '/opt/global_economic_tracker', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select path:models/staging --profiles-dir /opt/global_economic_tracker', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:22:00.067989 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'global_economic_tracker'
[0m21:22:00.069107 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.051935233, "process_in_blocks": "0", "process_kernel_time": 0.08517, "process_mem_max_rss": "97768", "process_out_blocks": "0", "process_user_time": 1.012582}
[0m21:22:00.069964 [debug] [MainThread]: Command `dbt run` failed at 21:22:00.069879 after 0.05 seconds
[0m21:22:00.070675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d67277c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d674532c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d671bf5f0>]}
[0m21:22:00.071409 [debug] [MainThread]: Flushing usage events
[0m21:22:00.467109 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:04:53.460553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc73ebf590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc72a07dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc72a07e60>]}


============================== 22:04:53.466902 | cbce85bc-419c-4ce5-97aa-00b28a6b8d92 ==============================
[0m22:04:53.466902 [info ] [MainThread]: Running with dbt=1.9.4
[0m22:04:53.468639 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/global_economic_tracker', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/global_economic_tracker/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select path:models/staging --profiles-dir /opt/global_economic_tracker', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:04:53.476160 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'global_economic_tracker'
[0m22:04:53.477758 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.0728651, "process_in_blocks": "57760", "process_kernel_time": 0.188537, "process_mem_max_rss": "97652", "process_out_blocks": "0", "process_user_time": 1.071684}
[0m22:04:53.478768 [debug] [MainThread]: Command `dbt run` failed at 22:04:53.478658 after 0.07 seconds
[0m22:04:53.479794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc720c27b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc728b3440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc728b1eb0>]}
[0m22:04:53.481947 [debug] [MainThread]: Flushing usage events
[0m22:04:53.839252 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:05:10.329530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87fd958bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87fdc9d3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87fd77b9e0>]}


============================== 22:05:10.334804 | f8a826db-8bc2-4562-99e3-8702dba67526 ==============================
[0m22:05:10.334804 [info ] [MainThread]: Running with dbt=1.9.4
[0m22:05:10.335779 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/global_economic_tracker/logs', 'debug': 'False', 'profiles_dir': '/opt/global_economic_tracker', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select path:models/staging --profiles-dir /opt/global_economic_tracker', 'send_anonymous_usage_stats': 'True'}
[0m22:05:10.340096 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'global_economic_tracker'
[0m22:05:10.341393 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.05648243, "process_in_blocks": "0", "process_kernel_time": 0.112861, "process_mem_max_rss": "97896", "process_out_blocks": "0", "process_user_time": 0.98754}
[0m22:05:10.342275 [debug] [MainThread]: Command `dbt run` failed at 22:05:10.342187 after 0.06 seconds
[0m22:05:10.343019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87fd95af00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87fe327b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87fde95bb0>]}
[0m22:05:10.343803 [debug] [MainThread]: Flushing usage events
[0m22:05:10.889360 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:24:35.991665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47c2baf050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47c2baf110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47c2baf560>]}


============================== 22:24:35.996682 | 20fe646b-339f-4796-8f33-23dd047af7c8 ==============================
[0m22:24:35.996682 [info ] [MainThread]: Running with dbt=1.9.4
[0m22:24:35.997602 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/global_economic_tracker', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/global_economic_tracker/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select path:models/staging --profiles-dir /opt/global_economic_tracker', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:24:36.001942 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'global_economic_tracker'
[0m22:24:36.003086 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.05281708, "process_in_blocks": "23336", "process_kernel_time": 0.205249, "process_mem_max_rss": "100124", "process_out_blocks": "1904", "process_user_time": 1.231499}
[0m22:24:36.003957 [debug] [MainThread]: Command `dbt run` failed at 22:24:36.003870 after 0.05 seconds
[0m22:24:36.004728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47c39d6cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47c2baf050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47c327fce0>]}
[0m22:24:36.005607 [debug] [MainThread]: Flushing usage events
[0m22:24:36.374488 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:24:51.819922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5982aab1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f598188bec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5980f04c50>]}


============================== 22:24:51.824409 | 0d4cd9bb-54fc-47d3-adc5-969fe17f3138 ==============================
[0m22:24:51.824409 [info ] [MainThread]: Running with dbt=1.9.4
[0m22:24:51.825318 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/global_economic_tracker', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/global_economic_tracker/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select path:models/staging --profiles-dir /opt/global_economic_tracker', 'send_anonymous_usage_stats': 'True'}
[0m22:24:51.829561 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'global_economic_tracker'
[0m22:24:51.830689 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.057359323, "process_in_blocks": "0", "process_kernel_time": 0.144868, "process_mem_max_rss": "97564", "process_out_blocks": "0", "process_user_time": 0.994763}
[0m22:24:51.831552 [debug] [MainThread]: Command `dbt run` failed at 22:24:51.831464 after 0.06 seconds
[0m22:24:51.832236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f598113b1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5980f07e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5980967bc0>]}
[0m22:24:51.833045 [debug] [MainThread]: Flushing usage events
[0m22:24:52.272338 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:30:48.240488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7abfe0b980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7abf095e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7abf097140>]}


============================== 22:30:48.245371 | 401af692-61d7-48af-99d6-5ebc26c22390 ==============================
[0m22:30:48.245371 [info ] [MainThread]: Running with dbt=1.9.4
[0m22:30:48.246287 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/global_economic_tracker/logs', 'profiles_dir': '/opt/global_economic_tracker', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select path:models/staging --profiles-dir /opt/global_economic_tracker', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:30:48.250494 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'global_economic_tracker'
[0m22:30:48.252080 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.054110356, "process_in_blocks": "57816", "process_kernel_time": 0.132557, "process_mem_max_rss": "100112", "process_out_blocks": "1904", "process_user_time": 1.117274}
[0m22:30:48.253004 [debug] [MainThread]: Command `dbt run` failed at 22:30:48.252879 after 0.06 seconds
[0m22:30:48.253736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7abec38920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7abed69670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7abed69970>]}
[0m22:30:48.254455 [debug] [MainThread]: Flushing usage events
[0m22:30:48.815188 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:31:06.083454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efed72b7740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efed7e63fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efed7a9fd10>]}


============================== 22:31:06.087708 | fd69ffe8-8efb-44de-9719-8bf8821de766 ==============================
[0m22:31:06.087708 [info ] [MainThread]: Running with dbt=1.9.4
[0m22:31:06.088700 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/global_economic_tracker', 'log_path': '/opt/global_economic_tracker/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select path:models/staging --profiles-dir /opt/global_economic_tracker', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:31:06.092835 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'global_economic_tracker'
[0m22:31:06.093992 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.05111775, "process_in_blocks": "0", "process_kernel_time": 0.094485, "process_mem_max_rss": "97828", "process_out_blocks": "0", "process_user_time": 0.973203}
[0m22:31:06.094831 [debug] [MainThread]: Command `dbt run` failed at 22:31:06.094745 after 0.05 seconds
[0m22:31:06.095548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efed72b7740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efed7a9e840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efed71fc2f0>]}
[0m22:31:06.096299 [debug] [MainThread]: Flushing usage events
[0m22:31:06.633467 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:00:03.661124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80735978f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8072ab05f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8073e77080>]}


============================== 01:00:03.665892 | 81a3923b-d90e-47a1-9480-06120c812ebf ==============================
[0m01:00:03.665892 [info ] [MainThread]: Running with dbt=1.9.4
[0m01:00:03.667000 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/global_economic_tracker', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/global_economic_tracker/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select path:models/staging --profiles-dir /opt/global_economic_tracker', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:00:03.670899 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'global_economic_tracker'
[0m01:00:03.672435 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.06173831, "process_in_blocks": "57848", "process_kernel_time": 0.240382, "process_mem_max_rss": "97568", "process_out_blocks": "0", "process_user_time": 1.153834}
[0m01:00:03.673205 [debug] [MainThread]: Command `dbt run` failed at 01:00:03.673126 after 0.06 seconds
[0m01:00:03.673884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80735978f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8072cd5520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8072b39010>]}
[0m01:00:03.674590 [debug] [MainThread]: Flushing usage events
[0m01:00:04.294342 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:00:21.178588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3205e5c9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3207fb2390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3205afe000>]}


============================== 01:00:21.182566 | cc32556b-9c42-4db0-9658-1467b4303c40 ==============================
[0m01:00:21.182566 [info ] [MainThread]: Running with dbt=1.9.4
[0m01:00:21.183451 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/global_economic_tracker', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/global_economic_tracker/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select path:models/staging --profiles-dir /opt/global_economic_tracker', 'send_anonymous_usage_stats': 'True'}
[0m01:00:21.187239 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'global_economic_tracker'
[0m01:00:21.188309 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.04763619, "process_in_blocks": "0", "process_kernel_time": 0.070365, "process_mem_max_rss": "97524", "process_out_blocks": "0", "process_user_time": 0.965005}
[0m01:00:21.189112 [debug] [MainThread]: Command `dbt run` failed at 01:00:21.189031 after 0.05 seconds
[0m01:00:21.189891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3205e5e780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32072bf380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3205b475f0>]}
[0m01:00:21.190633 [debug] [MainThread]: Flushing usage events
[0m01:00:21.746578 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:07:55.904373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd4da945f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd4db32600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd4dbc1af0>]}


============================== 01:07:55.908901 | c98a6113-40a8-4161-9853-85e166a5ffdb ==============================
[0m01:07:55.908901 [info ] [MainThread]: Running with dbt=1.9.4
[0m01:07:55.909800 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/global_economic_tracker', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/global_economic_tracker/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select path:models/staging --profiles-dir /opt/global_economic_tracker', 'send_anonymous_usage_stats': 'True'}
[0m01:07:55.913588 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'global_economic_tracker'
[0m01:07:55.914804 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.049585123, "process_in_blocks": "57832", "process_kernel_time": 0.162476, "process_mem_max_rss": "99872", "process_out_blocks": "1904", "process_user_time": 1.202328}
[0m01:07:55.915598 [debug] [MainThread]: Command `dbt run` failed at 01:07:55.915517 after 0.05 seconds
[0m01:07:55.916266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd4dbc0950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd4db2c380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd4db2ca40>]}
[0m01:07:55.916978 [debug] [MainThread]: Flushing usage events
[0m01:07:56.542578 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:08:13.299991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7580c52d80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f758027a1e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75805db560>]}


============================== 01:08:13.303987 | fa16f132-b621-4616-81d5-52b2c9292830 ==============================
[0m01:08:13.303987 [info ] [MainThread]: Running with dbt=1.9.4
[0m01:08:13.304916 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/global_economic_tracker', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/global_economic_tracker/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select path:models/staging --profiles-dir /opt/global_economic_tracker', 'send_anonymous_usage_stats': 'True'}
[0m01:08:13.308751 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'global_economic_tracker'
[0m01:08:13.309970 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.048597917, "process_in_blocks": "0", "process_kernel_time": 0.120087, "process_mem_max_rss": "97784", "process_out_blocks": "0", "process_user_time": 0.940686}
[0m01:08:13.310742 [debug] [MainThread]: Command `dbt run` failed at 01:08:13.310663 after 0.05 seconds
[0m01:08:13.311400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7580039460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75805d9550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75810ba270>]}
[0m01:08:13.312117 [debug] [MainThread]: Flushing usage events
[0m01:08:13.930439 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:50:22.709378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94ba69e5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94b8e74e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94b8e77380>]}


============================== 03:50:22.713994 | 3dfc00f8-57b9-4b6b-9f86-d5249d9fc9d6 ==============================
[0m03:50:22.713994 [info ] [MainThread]: Running with dbt=1.9.4
[0m03:50:22.714903 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/global_economic_tracker/logs', 'profiles_dir': '/opt/global_economic_tracker', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select path:models/staging --profiles-dir /opt/global_economic_tracker', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m03:50:22.718901 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'global_economic_tracker'
[0m03:50:22.720200 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.05861588, "process_in_blocks": "57832", "process_kernel_time": 0.2356, "process_mem_max_rss": "100112", "process_out_blocks": "1904", "process_user_time": 1.020933}
[0m03:50:22.721027 [debug] [MainThread]: Command `dbt run` failed at 03:50:22.720911 after 0.06 seconds
[0m03:50:22.721785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94ba69e5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94b8ccfd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94b8607cb0>]}
[0m03:50:22.722513 [debug] [MainThread]: Flushing usage events
[0m03:50:23.337282 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:50:40.180128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26435f59d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2643c6f710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26454a2840>]}


============================== 03:50:40.184411 | 1e17e4d8-c466-48b8-b8ac-ec5600ec7a5e ==============================
[0m03:50:40.184411 [info ] [MainThread]: Running with dbt=1.9.4
[0m03:50:40.185334 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/global_economic_tracker/logs', 'profiles_dir': '/opt/global_economic_tracker', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select path:models/staging --profiles-dir /opt/global_economic_tracker', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:50:40.189246 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'global_economic_tracker'
[0m03:50:40.190348 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.048112217, "process_in_blocks": "0", "process_kernel_time": 0.070417, "process_mem_max_rss": "97704", "process_out_blocks": "0", "process_user_time": 0.975788}
[0m03:50:40.191113 [debug] [MainThread]: Command `dbt run` failed at 03:50:40.191031 after 0.05 seconds
[0m03:50:40.191778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26443e6ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f264329f890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2645564260>]}
[0m03:50:40.192464 [debug] [MainThread]: Flushing usage events
[0m03:50:40.575749 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:57:55.145486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0458dab320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f045718b980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04581d19a0>]}


============================== 03:57:55.149998 | f9364235-53b5-4d1f-b233-dd2fa32341f7 ==============================
[0m03:57:55.149998 [info ] [MainThread]: Running with dbt=1.9.4
[0m03:57:55.150941 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/global_economic_tracker/logs', 'debug': 'False', 'profiles_dir': '/opt/global_economic_tracker', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select path:models/staging --profiles-dir /opt/global_economic_tracker', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m03:57:55.154784 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'global_economic_tracker'
[0m03:57:55.155940 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.05064487, "process_in_blocks": "23336", "process_kernel_time": 0.12939, "process_mem_max_rss": "100280", "process_out_blocks": "1904", "process_user_time": 1.104799}
[0m03:57:55.156752 [debug] [MainThread]: Command `dbt run` failed at 03:57:55.156676 after 0.05 seconds
[0m03:57:55.157416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0456f593d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04574791c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04581d19a0>]}
[0m03:57:55.158117 [debug] [MainThread]: Flushing usage events
[0m03:57:55.596698 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:58:12.843092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9dbe4facf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9dbe873bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9dc043e930>]}


============================== 03:58:12.847153 | daab68fc-5d12-472c-b83b-d2f7e193da67 ==============================
[0m03:58:12.847153 [info ] [MainThread]: Running with dbt=1.9.4
[0m03:58:12.848200 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/global_economic_tracker', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/global_economic_tracker/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select path:models/staging --profiles-dir /opt/global_economic_tracker', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m03:58:12.852097 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'global_economic_tracker'
[0m03:58:12.853121 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.04757736, "process_in_blocks": "0", "process_kernel_time": 0.03013, "process_mem_max_rss": "97852", "process_out_blocks": "0", "process_user_time": 1.044528}
[0m03:58:12.853885 [debug] [MainThread]: Command `dbt run` failed at 03:58:12.853809 after 0.05 seconds
[0m03:58:12.854536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9dbe320530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9dbdf60050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9dbe4613a0>]}
[0m03:58:12.855234 [debug] [MainThread]: Flushing usage events
[0m03:58:13.284648 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m04:17:56.249465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e087a3bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e0a989c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e0a616b70>]}


============================== 04:17:56.253429 | ce5292b1-3004-4354-90c4-538a3bd291f0 ==============================
[0m04:17:56.253429 [info ] [MainThread]: Running with dbt=1.9.4
[0m04:17:56.254423 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/global_economic_tracker/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/global_economic_tracker', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select path:models/staging', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m04:17:56.258784 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'global_economic_tracker'
[0m04:17:56.259958 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.05038969, "process_in_blocks": "23336", "process_kernel_time": 0.148253, "process_mem_max_rss": "100104", "process_out_blocks": "1904", "process_user_time": 1.116844}
[0m04:17:56.260775 [debug] [MainThread]: Command `dbt run` failed at 04:17:56.260693 after 0.05 seconds
[0m04:17:56.261454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e087a3bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e081e2840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e085c9130>]}
[0m04:17:56.262182 [debug] [MainThread]: Flushing usage events
[0m04:17:56.804847 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m04:18:13.905096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5732b30b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5732b33830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5732783ef0>]}


============================== 04:18:13.909774 | a45673fe-e53e-45b1-b8fd-8aca474660b0 ==============================
[0m04:18:13.909774 [info ] [MainThread]: Running with dbt=1.9.4
[0m04:18:13.910816 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/global_economic_tracker', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/global_economic_tracker/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select path:models/staging', 'send_anonymous_usage_stats': 'True'}
[0m04:18:13.915018 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'global_economic_tracker'
[0m04:18:13.916050 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.05016949, "process_in_blocks": "0", "process_kernel_time": 0.109963, "process_mem_max_rss": "97656", "process_out_blocks": "0", "process_user_time": 0.949684}
[0m04:18:13.916851 [debug] [MainThread]: Command `dbt run` failed at 04:18:13.916770 after 0.05 seconds
[0m04:18:13.917529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57328d5700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5732fb2210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5732a74110>]}
[0m04:18:13.918274 [debug] [MainThread]: Flushing usage events
[0m04:18:14.474221 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m04:36:43.210709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f244dd88e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f244e5baae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f244e2abdd0>]}


============================== 04:36:43.214631 | cf0a20d2-03a1-44b4-868f-f1ab5bfb68e7 ==============================
[0m04:36:43.214631 [info ] [MainThread]: Running with dbt=1.9.4
[0m04:36:43.215698 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/global_economic_tracker/logs', 'profiles_dir': '/home/airflow/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select path:models/staging --profiles-dir /home/airflow/.dbt', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m04:36:43.385567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cf0a20d2-03a1-44b4-868f-f1ab5bfb68e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f244e19ab70>]}
[0m04:36:43.421275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cf0a20d2-03a1-44b4-868f-f1ab5bfb68e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f244d8917f0>]}
[0m04:36:43.422573 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m04:36:43.486405 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m04:36:44.568059 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:36:44.568991 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:36:44.592979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cf0a20d2-03a1-44b4-868f-f1ab5bfb68e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f244d760cb0>]}
[0m04:36:44.649252 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/global_economic_tracker/target/manifest.json
[0m04:36:44.654971 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/global_economic_tracker/target/semantic_manifest.json
[0m04:36:44.687435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cf0a20d2-03a1-44b4-868f-f1ab5bfb68e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f244c386ed0>]}
[0m04:36:44.688236 [info ] [MainThread]: Found 4 models, 22 data tests, 549 macros
[0m04:36:44.689031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf0a20d2-03a1-44b4-868f-f1ab5bfb68e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f244cb2ee10>]}
[0m04:36:44.693698 [info ] [MainThread]: 
[0m04:36:44.694501 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m04:36:44.695272 [info ] [MainThread]: 
[0m04:36:44.696293 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m04:36:44.700154 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m04:36:44.721775 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m04:36:44.722513 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m04:36:44.723215 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:36:44.727076 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m04:36:44.728214 [debug] [ThreadPool]: On list_airflow: Close
[0m04:36:44.730121 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_public)
[0m04:36:44.734048 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m04:36:44.734851 [debug] [ThreadPool]: On list_airflow_public: BEGIN
[0m04:36:44.735547 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:36:44.738328 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m04:36:44.739055 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m04:36:44.739769 [debug] [ThreadPool]: On list_airflow_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m04:36:44.744030 [debug] [ThreadPool]: SQL status: SELECT 49 in 0.004 seconds
[0m04:36:44.745497 [debug] [ThreadPool]: On list_airflow_public: ROLLBACK
[0m04:36:44.746481 [debug] [ThreadPool]: On list_airflow_public: Close
[0m04:36:44.752492 [debug] [MainThread]: Using postgres connection "master"
[0m04:36:44.753213 [debug] [MainThread]: On master: BEGIN
[0m04:36:44.753936 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:36:44.756099 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m04:36:44.756815 [debug] [MainThread]: Using postgres connection "master"
[0m04:36:44.757539 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m04:36:44.760559 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m04:36:44.761698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf0a20d2-03a1-44b4-868f-f1ab5bfb68e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f244c313da0>]}
[0m04:36:44.762455 [debug] [MainThread]: On master: ROLLBACK
[0m04:36:44.763361 [debug] [MainThread]: Using postgres connection "master"
[0m04:36:44.764095 [debug] [MainThread]: On master: BEGIN
[0m04:36:44.765040 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m04:36:44.765799 [debug] [MainThread]: On master: COMMIT
[0m04:36:44.766560 [debug] [MainThread]: Using postgres connection "master"
[0m04:36:44.767283 [debug] [MainThread]: On master: COMMIT
[0m04:36:44.768078 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m04:36:44.768771 [debug] [MainThread]: On master: Close
[0m04:36:44.774746 [debug] [Thread-1 (]: Began running node model.global_economic_tracker.stg_commodity_returns
[0m04:36:44.775058 [debug] [Thread-2 (]: Began running node model.global_economic_tracker.stg_index_returns
[0m04:36:44.775771 [info ] [Thread-1 (]: 1 of 2 START sql table model public.stg_commodity_returns ...................... [RUN]
[0m04:36:44.776649 [info ] [Thread-2 (]: 2 of 2 START sql table model public.stg_index_returns .......................... [RUN]
[0m04:36:44.777400 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_public, now model.global_economic_tracker.stg_commodity_returns)
[0m04:36:44.778253 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.global_economic_tracker.stg_index_returns'
[0m04:36:44.779039 [debug] [Thread-1 (]: Began compiling node model.global_economic_tracker.stg_commodity_returns
[0m04:36:44.779773 [debug] [Thread-2 (]: Began compiling node model.global_economic_tracker.stg_index_returns
[0m04:36:44.783664 [debug] [Thread-1 (]: Writing injected SQL for node "model.global_economic_tracker.stg_commodity_returns"
[0m04:36:44.785874 [debug] [Thread-2 (]: Writing injected SQL for node "model.global_economic_tracker.stg_index_returns"
[0m04:36:44.790375 [debug] [Thread-1 (]: Began executing node model.global_economic_tracker.stg_commodity_returns
[0m04:36:44.791027 [debug] [Thread-2 (]: Began executing node model.global_economic_tracker.stg_index_returns
[0m04:36:44.811001 [debug] [Thread-1 (]: Writing runtime sql for node "model.global_economic_tracker.stg_commodity_returns"
[0m04:36:44.812774 [debug] [Thread-2 (]: Writing runtime sql for node "model.global_economic_tracker.stg_index_returns"
[0m04:36:44.817155 [debug] [Thread-1 (]: Using postgres connection "model.global_economic_tracker.stg_commodity_returns"
[0m04:36:44.818187 [debug] [Thread-2 (]: Using postgres connection "model.global_economic_tracker.stg_index_returns"
[0m04:36:44.818462 [debug] [Thread-1 (]: On model.global_economic_tracker.stg_commodity_returns: BEGIN
[0m04:36:44.819244 [debug] [Thread-2 (]: On model.global_economic_tracker.stg_index_returns: BEGIN
[0m04:36:44.820036 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:36:44.820802 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m04:36:44.823963 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m04:36:44.824534 [debug] [Thread-2 (]: SQL status: BEGIN in 0.004 seconds
[0m04:36:44.824997 [debug] [Thread-1 (]: Using postgres connection "model.global_economic_tracker.stg_commodity_returns"
[0m04:36:44.825766 [debug] [Thread-2 (]: Using postgres connection "model.global_economic_tracker.stg_index_returns"
[0m04:36:44.826549 [debug] [Thread-1 (]: On model.global_economic_tracker.stg_commodity_returns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_commodity_returns"} */

  
    

  create  table "airflow"."public"."stg_commodity_returns__dbt_tmp"
  
  
    as
  
  (
    

select
    'commodity' as type,
    ticker,
    timestamp,
    price,
    lag(price) over (partition by ticker order by timestamp) as prev_price,
    coalesce((price - lag(price) over (partition by ticker order by timestamp)) / lag(price) over (partition by ticker order by timestamp), 0) as daily_return
from public.commodity_prices
  );
  
[0m04:36:44.827367 [debug] [Thread-2 (]: On model.global_economic_tracker.stg_index_returns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_index_returns"} */

  
    

  create  table "airflow"."public"."stg_index_returns__dbt_tmp"
  
  
    as
  
  (
    

select
    'index' as type,
    country,
    ticker,
    timestamp,
    price,
    lag(price) over (partition by ticker order by timestamp) as prev_price,
    coalesce((price - lag(price) over (partition by ticker order by timestamp)) / lag(price) over (partition by ticker order by timestamp), 0) as daily_return
from public.index_prices
  );
  
[0m04:36:44.842566 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.014 seconds
[0m04:36:44.848158 [debug] [Thread-2 (]: Using postgres connection "model.global_economic_tracker.stg_index_returns"
[0m04:36:44.848413 [debug] [Thread-1 (]: SQL status: SELECT 517 in 0.020 seconds
[0m04:36:44.849050 [debug] [Thread-2 (]: On model.global_economic_tracker.stg_index_returns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_index_returns"} */
alter table "airflow"."public"."stg_index_returns" rename to "stg_index_returns__dbt_backup"
[0m04:36:44.851147 [debug] [Thread-1 (]: Using postgres connection "model.global_economic_tracker.stg_commodity_returns"
[0m04:36:44.852383 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m04:36:44.852806 [debug] [Thread-1 (]: On model.global_economic_tracker.stg_commodity_returns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_commodity_returns"} */
alter table "airflow"."public"."stg_commodity_returns" rename to "stg_commodity_returns__dbt_backup"
[0m04:36:44.854669 [debug] [Thread-2 (]: Using postgres connection "model.global_economic_tracker.stg_index_returns"
[0m04:36:44.855878 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m04:36:44.856335 [debug] [Thread-2 (]: On model.global_economic_tracker.stg_index_returns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_index_returns"} */
alter table "airflow"."public"."stg_index_returns__dbt_tmp" rename to "stg_index_returns"
[0m04:36:44.858234 [debug] [Thread-1 (]: Using postgres connection "model.global_economic_tracker.stg_commodity_returns"
[0m04:36:44.859190 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m04:36:44.859975 [debug] [Thread-1 (]: On model.global_economic_tracker.stg_commodity_returns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_commodity_returns"} */
alter table "airflow"."public"."stg_commodity_returns__dbt_tmp" rename to "stg_commodity_returns"
[0m04:36:44.861494 [debug] [Thread-2 (]: Using postgres connection "model.global_economic_tracker.stg_index_returns"
[0m04:36:44.862443 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m04:36:44.863022 [debug] [Thread-2 (]: On model.global_economic_tracker.stg_index_returns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_index_returns"} */

        CREATE INDEX IF NOT EXISTS idx_index_returns_ticker_ts ON "airflow"."public"."stg_index_returns"(ticker, timestamp)
      
[0m04:36:44.864467 [debug] [Thread-1 (]: Using postgres connection "model.global_economic_tracker.stg_commodity_returns"
[0m04:36:44.865777 [debug] [Thread-1 (]: On model.global_economic_tracker.stg_commodity_returns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_commodity_returns"} */

        CREATE INDEX IF NOT EXISTS idx_returns_ticker_ts ON "airflow"."public"."stg_commodity_returns"(ticker, timestamp)
      
[0m04:36:44.868142 [debug] [Thread-2 (]: SQL status: CREATE INDEX in 0.003 seconds
[0m04:36:44.876959 [debug] [Thread-2 (]: On model.global_economic_tracker.stg_index_returns: COMMIT
[0m04:36:44.877222 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.011 seconds
[0m04:36:44.877824 [debug] [Thread-2 (]: Using postgres connection "model.global_economic_tracker.stg_index_returns"
[0m04:36:44.879136 [debug] [Thread-1 (]: On model.global_economic_tracker.stg_commodity_returns: COMMIT
[0m04:36:44.879909 [debug] [Thread-2 (]: On model.global_economic_tracker.stg_index_returns: COMMIT
[0m04:36:44.880665 [debug] [Thread-1 (]: Using postgres connection "model.global_economic_tracker.stg_commodity_returns"
[0m04:36:44.882000 [debug] [Thread-1 (]: On model.global_economic_tracker.stg_commodity_returns: COMMIT
[0m04:36:44.883241 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m04:36:44.886836 [debug] [Thread-2 (]: Applying DROP to: "airflow"."public"."stg_index_returns__dbt_backup"
[0m04:36:44.887089 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m04:36:44.890113 [debug] [Thread-2 (]: Using postgres connection "model.global_economic_tracker.stg_index_returns"
[0m04:36:44.891825 [debug] [Thread-1 (]: Applying DROP to: "airflow"."public"."stg_commodity_returns__dbt_backup"
[0m04:36:44.892549 [debug] [Thread-2 (]: On model.global_economic_tracker.stg_index_returns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_index_returns"} */
drop table if exists "airflow"."public"."stg_index_returns__dbt_backup" cascade
[0m04:36:44.893522 [debug] [Thread-1 (]: Using postgres connection "model.global_economic_tracker.stg_commodity_returns"
[0m04:36:44.894962 [debug] [Thread-1 (]: On model.global_economic_tracker.stg_commodity_returns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_commodity_returns"} */
drop table if exists "airflow"."public"."stg_commodity_returns__dbt_backup" cascade
[0m04:36:44.898627 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m04:36:44.899346 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.005 seconds
[0m04:36:44.900711 [debug] [Thread-1 (]: On model.global_economic_tracker.stg_commodity_returns: Close
[0m04:36:44.902116 [debug] [Thread-2 (]: On model.global_economic_tracker.stg_index_returns: Close
[0m04:36:44.903966 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf0a20d2-03a1-44b4-868f-f1ab5bfb68e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f244f7ed250>]}
[0m04:36:44.904373 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf0a20d2-03a1-44b4-868f-f1ab5bfb68e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f244c3875f0>]}
[0m04:36:44.905109 [info ] [Thread-1 (]: 1 of 2 OK created sql table model public.stg_commodity_returns ................. [[32mSELECT 517[0m in 0.13s]
[0m04:36:44.906212 [info ] [Thread-2 (]: 2 of 2 OK created sql table model public.stg_index_returns ..................... [[32mSELECT 0[0m in 0.13s]
[0m04:36:44.907094 [debug] [Thread-1 (]: Finished running node model.global_economic_tracker.stg_commodity_returns
[0m04:36:44.907917 [debug] [Thread-2 (]: Finished running node model.global_economic_tracker.stg_index_returns
[0m04:36:44.910548 [debug] [MainThread]: Using postgres connection "master"
[0m04:36:44.911363 [debug] [MainThread]: On master: BEGIN
[0m04:36:44.912077 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:36:44.914261 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m04:36:44.915097 [debug] [MainThread]: On master: COMMIT
[0m04:36:44.915852 [debug] [MainThread]: Using postgres connection "master"
[0m04:36:44.916548 [debug] [MainThread]: On master: COMMIT
[0m04:36:44.917414 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m04:36:44.918149 [debug] [MainThread]: On master: Close
[0m04:36:44.918975 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:36:44.919776 [debug] [MainThread]: Connection 'model.global_economic_tracker.stg_commodity_returns' was properly closed.
[0m04:36:44.920465 [debug] [MainThread]: Connection 'model.global_economic_tracker.stg_index_returns' was properly closed.
[0m04:36:44.921208 [info ] [MainThread]: 
[0m04:36:44.922022 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.23 seconds (0.23s).
[0m04:36:44.923241 [debug] [MainThread]: Command end result
[0m04:36:44.952724 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/global_economic_tracker/target/manifest.json
[0m04:36:44.956673 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/global_economic_tracker/target/semantic_manifest.json
[0m04:36:44.963442 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/global_economic_tracker/target/run_results.json
[0m04:36:44.964219 [info ] [MainThread]: 
[0m04:36:44.965299 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:36:44.966100 [info ] [MainThread]: 
[0m04:36:44.966907 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m04:36:44.967992 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.7942865, "process_in_blocks": "36848", "process_kernel_time": 0.284755, "process_mem_max_rss": "124304", "process_out_blocks": "2352", "process_user_time": 1.472874}
[0m04:36:44.968824 [debug] [MainThread]: Command `dbt run` succeeded at 04:36:44.968739 after 1.80 seconds
[0m04:36:44.969690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f244dbbfef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f244bfee2a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f244ef819a0>]}
[0m04:36:44.970435 [debug] [MainThread]: Flushing usage events
[0m04:36:45.344265 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m04:36:46.872602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdd9813a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdd8f79580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdd917a810>]}


============================== 04:36:46.876765 | bbe8ccff-e089-4f90-bf7b-d626a96b23be ==============================
[0m04:36:46.876765 [info ] [MainThread]: Running with dbt=1.9.4
[0m04:36:46.877698 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/global_economic_tracker/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select path:models/analytics --profiles-dir /home/airflow/.dbt', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m04:36:47.008104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bbe8ccff-e089-4f90-bf7b-d626a96b23be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdd8c0e720>]}
[0m04:36:47.046759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bbe8ccff-e089-4f90-bf7b-d626a96b23be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdd96a8ec0>]}
[0m04:36:47.047695 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m04:36:47.102383 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m04:36:47.992665 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:36:47.993570 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:36:48.016428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bbe8ccff-e089-4f90-bf7b-d626a96b23be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdd8e26240>]}
[0m04:36:48.071540 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/global_economic_tracker/target/manifest.json
[0m04:36:48.077060 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/global_economic_tracker/target/semantic_manifest.json
[0m04:36:48.092176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bbe8ccff-e089-4f90-bf7b-d626a96b23be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdd7126810>]}
[0m04:36:48.092939 [info ] [MainThread]: Found 4 models, 22 data tests, 549 macros
[0m04:36:48.093676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bbe8ccff-e089-4f90-bf7b-d626a96b23be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdd7919400>]}
[0m04:36:48.098175 [info ] [MainThread]: 
[0m04:36:48.098953 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m04:36:48.099659 [info ] [MainThread]: 
[0m04:36:48.100502 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m04:36:48.103933 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m04:36:48.118998 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m04:36:48.119766 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m04:36:48.120479 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:36:48.123261 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.003 seconds
[0m04:36:48.124378 [debug] [ThreadPool]: On list_airflow: Close
[0m04:36:48.125749 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_public)
[0m04:36:48.128884 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m04:36:48.129734 [debug] [ThreadPool]: On list_airflow_public: BEGIN
[0m04:36:48.130388 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:36:48.132345 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m04:36:48.133000 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m04:36:48.133665 [debug] [ThreadPool]: On list_airflow_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m04:36:48.135491 [debug] [ThreadPool]: SQL status: SELECT 49 in 0.001 seconds
[0m04:36:48.136969 [debug] [ThreadPool]: On list_airflow_public: ROLLBACK
[0m04:36:48.137733 [debug] [ThreadPool]: On list_airflow_public: Close
[0m04:36:48.143143 [debug] [MainThread]: Using postgres connection "master"
[0m04:36:48.143820 [debug] [MainThread]: On master: BEGIN
[0m04:36:48.144493 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:36:48.146501 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m04:36:48.147586 [debug] [MainThread]: Using postgres connection "master"
[0m04:36:48.148285 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m04:36:48.150201 [debug] [MainThread]: SQL status: SELECT 0 in 0.001 seconds
[0m04:36:48.151546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bbe8ccff-e089-4f90-bf7b-d626a96b23be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdd5dba570>]}
[0m04:36:48.152417 [debug] [MainThread]: On master: ROLLBACK
[0m04:36:48.153196 [debug] [MainThread]: Using postgres connection "master"
[0m04:36:48.153868 [debug] [MainThread]: On master: BEGIN
[0m04:36:48.154786 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m04:36:48.155538 [debug] [MainThread]: On master: COMMIT
[0m04:36:48.156211 [debug] [MainThread]: Using postgres connection "master"
[0m04:36:48.156864 [debug] [MainThread]: On master: COMMIT
[0m04:36:48.157631 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m04:36:48.158294 [debug] [MainThread]: On master: Close
[0m04:36:48.163341 [debug] [Thread-1 (]: Began running node model.global_economic_tracker.stg_commodity_metrics
[0m04:36:48.163757 [debug] [Thread-2 (]: Began running node model.global_economic_tracker.stg_index_metrics
[0m04:36:48.164417 [info ] [Thread-1 (]: 1 of 2 START sql table model public.stg_commodity_metrics ...................... [RUN]
[0m04:36:48.165162 [info ] [Thread-2 (]: 2 of 2 START sql table model public.stg_index_metrics .......................... [RUN]
[0m04:36:48.165871 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_public, now model.global_economic_tracker.stg_commodity_metrics)
[0m04:36:48.166659 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.global_economic_tracker.stg_index_metrics'
[0m04:36:48.167381 [debug] [Thread-1 (]: Began compiling node model.global_economic_tracker.stg_commodity_metrics
[0m04:36:48.168118 [debug] [Thread-2 (]: Began compiling node model.global_economic_tracker.stg_index_metrics
[0m04:36:48.172140 [debug] [Thread-1 (]: Writing injected SQL for node "model.global_economic_tracker.stg_commodity_metrics"
[0m04:36:48.174184 [debug] [Thread-2 (]: Writing injected SQL for node "model.global_economic_tracker.stg_index_metrics"
[0m04:36:48.178397 [debug] [Thread-1 (]: Began executing node model.global_economic_tracker.stg_commodity_metrics
[0m04:36:48.185080 [debug] [Thread-2 (]: Began executing node model.global_economic_tracker.stg_index_metrics
[0m04:36:48.198759 [debug] [Thread-1 (]: Writing runtime sql for node "model.global_economic_tracker.stg_commodity_metrics"
[0m04:36:48.200515 [debug] [Thread-2 (]: Writing runtime sql for node "model.global_economic_tracker.stg_index_metrics"
[0m04:36:48.204996 [debug] [Thread-1 (]: Using postgres connection "model.global_economic_tracker.stg_commodity_metrics"
[0m04:36:48.205793 [debug] [Thread-1 (]: On model.global_economic_tracker.stg_commodity_metrics: BEGIN
[0m04:36:48.206050 [debug] [Thread-2 (]: Using postgres connection "model.global_economic_tracker.stg_index_metrics"
[0m04:36:48.206631 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:36:48.207331 [debug] [Thread-2 (]: On model.global_economic_tracker.stg_index_metrics: BEGIN
[0m04:36:48.208790 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m04:36:48.209718 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m04:36:48.210414 [debug] [Thread-1 (]: Using postgres connection "model.global_economic_tracker.stg_commodity_metrics"
[0m04:36:48.210926 [debug] [Thread-2 (]: SQL status: BEGIN in 0.002 seconds
[0m04:36:48.211350 [debug] [Thread-1 (]: On model.global_economic_tracker.stg_commodity_metrics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_commodity_metrics"} */

  
    

  create  table "airflow"."public"."stg_commodity_metrics__dbt_tmp"
  
  
    as
  
  (
    

with base as (
    select
        *,
        row_number() over (partition by ticker order by timestamp) as rn
    from "airflow"."public"."stg_commodity_returns"
),

rolling as (
    select
        ticker,
        timestamp,
        avg(daily_return) over (
            partition by ticker
            order by rn
            rows between 19 preceding and current row
        ) as rolling_avg_mo,

        avg(daily_return) OVER (
            partition by ticker
            order by timestamp
            rows between 6 preceding and current row
        ) as weekly_avg_return,

        stddev(daily_return) over (
            partition by ticker
            order by rn
            rows between 19 preceding and current row
        ) as rolling_volatility_mo,

        case
            when daily_return > 0 then 'up'
            when daily_return < 0 then 'down'
            else 'flat'
        end as trend,

        daily_return

    from base
)

select
    *,
    rolling_avg_mo / nullif(rolling_volatility_mo, 0) as sharpe_mo,
    (daily_return - rolling_avg_mo) / nullif(rolling_volatility_mo, 0) as z_score_mo
from rolling
where rolling_avg_mo is not null
  );
  
[0m04:36:48.212110 [debug] [Thread-2 (]: Using postgres connection "model.global_economic_tracker.stg_index_metrics"
[0m04:36:48.213403 [debug] [Thread-2 (]: On model.global_economic_tracker.stg_index_metrics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_index_metrics"} */

  
    

  create  table "airflow"."public"."stg_index_metrics__dbt_tmp"
  
  
    as
  
  (
    

with base as (
    select
        *,
        row_number() over (partition by ticker order by timestamp) as rn
    from "airflow"."public"."stg_index_returns"
),

rolling as (
    select
        ticker,
        timestamp,
        avg(daily_return) over (
            partition by ticker
            order by rn
            rows between 19 preceding and current row
        ) as rolling_avg_mo,

        avg(daily_return) OVER (
            partition by ticker
            order by timestamp
            rows between 6 preceding and current row
        ) as weekly_avg_return,

        stddev(daily_return) over (
            partition by ticker
            order by rn
            rows between 19 preceding and current row
        ) as rolling_volatility_mo,

        case
            when daily_return > 0 then 'up'
            when daily_return < 0 then 'down'
            else 'flat'
        end as trend,

        daily_return

    from base
)

select
    *,
    rolling_avg_mo / nullif(rolling_volatility_mo, 0) as sharpe_mo,
    (daily_return - rolling_avg_mo) / nullif(rolling_volatility_mo, 0) as z_score_mo
from rolling
where rolling_avg_mo is not null
  );
  
[0m04:36:48.218802 [debug] [Thread-1 (]: SQL status: SELECT 517 in 0.006 seconds
[0m04:36:48.219344 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.005 seconds
[0m04:36:48.225091 [debug] [Thread-1 (]: Using postgres connection "model.global_economic_tracker.stg_commodity_metrics"
[0m04:36:48.227098 [debug] [Thread-2 (]: Using postgres connection "model.global_economic_tracker.stg_index_metrics"
[0m04:36:48.227849 [debug] [Thread-1 (]: On model.global_economic_tracker.stg_commodity_metrics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_commodity_metrics"} */
alter table "airflow"."public"."stg_commodity_metrics" rename to "stg_commodity_metrics__dbt_backup"
[0m04:36:48.228616 [debug] [Thread-2 (]: On model.global_economic_tracker.stg_index_metrics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_index_metrics"} */
alter table "airflow"."public"."stg_index_metrics" rename to "stg_index_metrics__dbt_backup"
[0m04:36:48.229790 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m04:36:48.230541 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m04:36:48.232281 [debug] [Thread-1 (]: Using postgres connection "model.global_economic_tracker.stg_commodity_metrics"
[0m04:36:48.234265 [debug] [Thread-2 (]: Using postgres connection "model.global_economic_tracker.stg_index_metrics"
[0m04:36:48.234968 [debug] [Thread-1 (]: On model.global_economic_tracker.stg_commodity_metrics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_commodity_metrics"} */
alter table "airflow"."public"."stg_commodity_metrics__dbt_tmp" rename to "stg_commodity_metrics"
[0m04:36:48.235639 [debug] [Thread-2 (]: On model.global_economic_tracker.stg_index_metrics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_index_metrics"} */
alter table "airflow"."public"."stg_index_metrics__dbt_tmp" rename to "stg_index_metrics"
[0m04:36:48.236545 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m04:36:48.237264 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m04:36:48.238453 [debug] [Thread-1 (]: Using postgres connection "model.global_economic_tracker.stg_commodity_metrics"
[0m04:36:48.240122 [debug] [Thread-2 (]: Using postgres connection "model.global_economic_tracker.stg_index_metrics"
[0m04:36:48.240864 [debug] [Thread-1 (]: On model.global_economic_tracker.stg_commodity_metrics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_commodity_metrics"} */

        CREATE INDEX IF NOT EXISTS idx_commodity_ticker_ts ON "airflow"."public"."stg_commodity_metrics"(ticker, timestamp)
      
[0m04:36:48.241618 [debug] [Thread-2 (]: On model.global_economic_tracker.stg_index_metrics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_index_metrics"} */

        CREATE INDEX IF NOT EXISTS idx_index_ticker_ts ON "airflow"."public"."stg_index_metrics"(ticker, timestamp)
      
[0m04:36:48.242623 [debug] [Thread-1 (]: SQL status: CREATE INDEX in 0.000 seconds
[0m04:36:48.243218 [debug] [Thread-2 (]: SQL status: CREATE INDEX in 0.000 seconds
[0m04:36:48.251669 [debug] [Thread-1 (]: On model.global_economic_tracker.stg_commodity_metrics: COMMIT
[0m04:36:48.252804 [debug] [Thread-2 (]: On model.global_economic_tracker.stg_index_metrics: COMMIT
[0m04:36:48.253555 [debug] [Thread-1 (]: Using postgres connection "model.global_economic_tracker.stg_commodity_metrics"
[0m04:36:48.254284 [debug] [Thread-2 (]: Using postgres connection "model.global_economic_tracker.stg_index_metrics"
[0m04:36:48.255001 [debug] [Thread-1 (]: On model.global_economic_tracker.stg_commodity_metrics: COMMIT
[0m04:36:48.255747 [debug] [Thread-2 (]: On model.global_economic_tracker.stg_index_metrics: COMMIT
[0m04:36:48.257731 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m04:36:48.261310 [debug] [Thread-1 (]: Applying DROP to: "airflow"."public"."stg_commodity_metrics__dbt_backup"
[0m04:36:48.261562 [debug] [Thread-2 (]: SQL status: COMMIT in 0.004 seconds
[0m04:36:48.264633 [debug] [Thread-1 (]: Using postgres connection "model.global_economic_tracker.stg_commodity_metrics"
[0m04:36:48.266766 [debug] [Thread-2 (]: Applying DROP to: "airflow"."public"."stg_index_metrics__dbt_backup"
[0m04:36:48.267488 [debug] [Thread-1 (]: On model.global_economic_tracker.stg_commodity_metrics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_commodity_metrics"} */
drop table if exists "airflow"."public"."stg_commodity_metrics__dbt_backup" cascade
[0m04:36:48.268424 [debug] [Thread-2 (]: Using postgres connection "model.global_economic_tracker.stg_index_metrics"
[0m04:36:48.269699 [debug] [Thread-2 (]: On model.global_economic_tracker.stg_index_metrics: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "model.global_economic_tracker.stg_index_metrics"} */
drop table if exists "airflow"."public"."stg_index_metrics__dbt_backup" cascade
[0m04:36:48.271227 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m04:36:48.272953 [debug] [Thread-1 (]: On model.global_economic_tracker.stg_commodity_metrics: Close
[0m04:36:48.273194 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.003 seconds
[0m04:36:48.274668 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbe8ccff-e089-4f90-bf7b-d626a96b23be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcddad69040>]}
[0m04:36:48.275608 [debug] [Thread-2 (]: On model.global_economic_tracker.stg_index_metrics: Close
[0m04:36:48.276463 [info ] [Thread-1 (]: 1 of 2 OK created sql table model public.stg_commodity_metrics ................. [[32mSELECT 517[0m in 0.11s]
[0m04:36:48.277302 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbe8ccff-e089-4f90-bf7b-d626a96b23be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdd5cb17c0>]}
[0m04:36:48.277957 [debug] [Thread-1 (]: Finished running node model.global_economic_tracker.stg_commodity_metrics
[0m04:36:48.278790 [info ] [Thread-2 (]: 2 of 2 OK created sql table model public.stg_index_metrics ..................... [[32mSELECT 0[0m in 0.11s]
[0m04:36:48.280138 [debug] [Thread-2 (]: Finished running node model.global_economic_tracker.stg_index_metrics
[0m04:36:48.282026 [debug] [MainThread]: Using postgres connection "master"
[0m04:36:48.282711 [debug] [MainThread]: On master: BEGIN
[0m04:36:48.283339 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:36:48.285604 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m04:36:48.286346 [debug] [MainThread]: On master: COMMIT
[0m04:36:48.287058 [debug] [MainThread]: Using postgres connection "master"
[0m04:36:48.287755 [debug] [MainThread]: On master: COMMIT
[0m04:36:48.288643 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m04:36:48.289331 [debug] [MainThread]: On master: Close
[0m04:36:48.290152 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:36:48.290813 [debug] [MainThread]: Connection 'model.global_economic_tracker.stg_commodity_metrics' was properly closed.
[0m04:36:48.291485 [debug] [MainThread]: Connection 'model.global_economic_tracker.stg_index_metrics' was properly closed.
[0m04:36:48.292193 [info ] [MainThread]: 
[0m04:36:48.292980 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.19 seconds (0.19s).
[0m04:36:48.293938 [debug] [MainThread]: Command end result
[0m04:36:48.321631 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/global_economic_tracker/target/manifest.json
[0m04:36:48.325259 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/global_economic_tracker/target/semantic_manifest.json
[0m04:36:48.331165 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/global_economic_tracker/target/run_results.json
[0m04:36:48.331823 [info ] [MainThread]: 
[0m04:36:48.332606 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:36:48.333450 [info ] [MainThread]: 
[0m04:36:48.334245 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m04:36:48.335341 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.5005274, "process_in_blocks": "0", "process_kernel_time": 0.178575, "process_mem_max_rss": "123016", "process_out_blocks": "0", "process_user_time": 1.408763}
[0m04:36:48.336198 [debug] [MainThread]: Command `dbt run` succeeded at 04:36:48.336118 after 1.50 seconds
[0m04:36:48.336906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcddc87ef90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdd7919bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdd8ba9250>]}
[0m04:36:48.337605 [debug] [MainThread]: Flushing usage events
[0m04:36:48.698467 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m04:36:50.806021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb66fc1eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb6687f4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb6687fe60>]}


============================== 04:36:50.810030 | fd5a8172-1898-49f7-b987-a54be131f6a6 ==============================
[0m04:36:50.810030 [info ] [MainThread]: Running with dbt=1.9.4
[0m04:36:50.810922 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/airflow/.dbt', 'log_path': '/opt/global_economic_tracker/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test --profiles-dir /home/airflow/.dbt', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m04:36:50.934099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fd5a8172-1898-49f7-b987-a54be131f6a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb665dac90>]}
[0m04:36:50.974829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fd5a8172-1898-49f7-b987-a54be131f6a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb66662660>]}
[0m04:36:50.975779 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m04:36:51.033160 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m04:36:51.899055 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:36:51.899847 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:36:51.922450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fd5a8172-1898-49f7-b987-a54be131f6a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb64d90ad0>]}
[0m04:36:51.980433 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/global_economic_tracker/target/manifest.json
[0m04:36:51.985975 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/global_economic_tracker/target/semantic_manifest.json
[0m04:36:52.013235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fd5a8172-1898-49f7-b987-a54be131f6a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb6559ecc0>]}
[0m04:36:52.014159 [info ] [MainThread]: Found 4 models, 22 data tests, 549 macros
[0m04:36:52.014970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd5a8172-1898-49f7-b987-a54be131f6a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb67d02c60>]}
[0m04:36:52.016988 [info ] [MainThread]: 
[0m04:36:52.017856 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m04:36:52.018642 [info ] [MainThread]: 
[0m04:36:52.019566 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m04:36:52.022836 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_public'
[0m04:36:52.038590 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m04:36:52.039307 [debug] [ThreadPool]: On list_airflow_public: BEGIN
[0m04:36:52.040025 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:36:52.043177 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m04:36:52.043857 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m04:36:52.044581 [debug] [ThreadPool]: On list_airflow_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m04:36:52.047168 [debug] [ThreadPool]: SQL status: SELECT 49 in 0.002 seconds
[0m04:36:52.048700 [debug] [ThreadPool]: On list_airflow_public: ROLLBACK
[0m04:36:52.049502 [debug] [ThreadPool]: On list_airflow_public: Close
[0m04:36:52.055089 [debug] [MainThread]: Using postgres connection "master"
[0m04:36:52.055782 [debug] [MainThread]: On master: BEGIN
[0m04:36:52.056514 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:36:52.058622 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m04:36:52.059651 [debug] [MainThread]: Using postgres connection "master"
[0m04:36:52.060362 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m04:36:52.062339 [debug] [MainThread]: SQL status: SELECT 0 in 0.001 seconds
[0m04:36:52.063559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd5a8172-1898-49f7-b987-a54be131f6a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb662859a0>]}
[0m04:36:52.064333 [debug] [MainThread]: On master: ROLLBACK
[0m04:36:52.065093 [debug] [MainThread]: Using postgres connection "master"
[0m04:36:52.065740 [debug] [MainThread]: On master: BEGIN
[0m04:36:52.066649 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m04:36:52.067395 [debug] [MainThread]: On master: COMMIT
[0m04:36:52.068287 [debug] [MainThread]: Using postgres connection "master"
[0m04:36:52.068992 [debug] [MainThread]: On master: COMMIT
[0m04:36:52.069837 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m04:36:52.070520 [debug] [MainThread]: On master: Close
[0m04:36:52.075084 [debug] [Thread-1 (]: Began running node test.global_economic_tracker.accepted_values_stg_commodity_metrics_trend__up__down__flat.70479897b5
[0m04:36:52.075367 [debug] [Thread-2 (]: Began running node test.global_economic_tracker.accepted_values_stg_index_metrics_trend__up__down__flat.1fea418295
[0m04:36:52.075748 [debug] [Thread-3 (]: Began running node test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_daily_return__0_5___0_5.2c4246e1e4
[0m04:36:52.076125 [debug] [Thread-4 (]: Began running node test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_rolling_avg_mo__0_3___0_3.22c9d514f7
[0m04:36:52.076548 [info ] [Thread-1 (]: 1 of 22 START test accepted_values_stg_commodity_metrics_trend__up__down__flat . [RUN]
[0m04:36:52.077310 [info ] [Thread-2 (]: 2 of 22 START test accepted_values_stg_index_metrics_trend__up__down__flat ..... [RUN]
[0m04:36:52.078017 [info ] [Thread-3 (]: 3 of 22 START test dbt_utils_accepted_range_stg_commodity_metrics_daily_return__0_5___0_5  [RUN]
[0m04:36:52.078870 [info ] [Thread-4 (]: 4 of 22 START test dbt_utils_accepted_range_stg_commodity_metrics_rolling_avg_mo__0_3___0_3  [RUN]
[0m04:36:52.079748 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_public, now test.global_economic_tracker.accepted_values_stg_commodity_metrics_trend__up__down__flat.70479897b5)
[0m04:36:52.080728 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.global_economic_tracker.accepted_values_stg_index_metrics_trend__up__down__flat.1fea418295'
[0m04:36:52.081521 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_daily_return__0_5___0_5.2c4246e1e4'
[0m04:36:52.082293 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_rolling_avg_mo__0_3___0_3.22c9d514f7'
[0m04:36:52.083024 [debug] [Thread-1 (]: Began compiling node test.global_economic_tracker.accepted_values_stg_commodity_metrics_trend__up__down__flat.70479897b5
[0m04:36:52.083792 [debug] [Thread-2 (]: Began compiling node test.global_economic_tracker.accepted_values_stg_index_metrics_trend__up__down__flat.1fea418295
[0m04:36:52.084542 [debug] [Thread-3 (]: Began compiling node test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_daily_return__0_5___0_5.2c4246e1e4
[0m04:36:52.085277 [debug] [Thread-4 (]: Began compiling node test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_rolling_avg_mo__0_3___0_3.22c9d514f7
[0m04:36:52.094032 [debug] [Thread-1 (]: Writing injected SQL for node "test.global_economic_tracker.accepted_values_stg_commodity_metrics_trend__up__down__flat.70479897b5"
[0m04:36:52.096255 [debug] [Thread-2 (]: Writing injected SQL for node "test.global_economic_tracker.accepted_values_stg_index_metrics_trend__up__down__flat.1fea418295"
[0m04:36:52.101237 [debug] [Thread-3 (]: Writing injected SQL for node "test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_daily_return__0_5___0_5.2c4246e1e4"
[0m04:36:52.104031 [debug] [Thread-4 (]: Writing injected SQL for node "test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_rolling_avg_mo__0_3___0_3.22c9d514f7"
[0m04:36:52.109156 [debug] [Thread-1 (]: Began executing node test.global_economic_tracker.accepted_values_stg_commodity_metrics_trend__up__down__flat.70479897b5
[0m04:36:52.115157 [debug] [Thread-3 (]: Began executing node test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_daily_return__0_5___0_5.2c4246e1e4
[0m04:36:52.117881 [debug] [Thread-1 (]: Writing runtime sql for node "test.global_economic_tracker.accepted_values_stg_commodity_metrics_trend__up__down__flat.70479897b5"
[0m04:36:52.118169 [debug] [Thread-4 (]: Began executing node test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_rolling_avg_mo__0_3___0_3.22c9d514f7
[0m04:36:52.119750 [debug] [Thread-3 (]: Writing runtime sql for node "test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_daily_return__0_5___0_5.2c4246e1e4"
[0m04:36:52.120052 [debug] [Thread-2 (]: Began executing node test.global_economic_tracker.accepted_values_stg_index_metrics_trend__up__down__flat.1fea418295
[0m04:36:52.122051 [debug] [Thread-4 (]: Writing runtime sql for node "test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_rolling_avg_mo__0_3___0_3.22c9d514f7"
[0m04:36:52.124086 [debug] [Thread-2 (]: Writing runtime sql for node "test.global_economic_tracker.accepted_values_stg_index_metrics_trend__up__down__flat.1fea418295"
[0m04:36:52.125539 [debug] [Thread-1 (]: Using postgres connection "test.global_economic_tracker.accepted_values_stg_commodity_metrics_trend__up__down__flat.70479897b5"
[0m04:36:52.126608 [debug] [Thread-1 (]: On test.global_economic_tracker.accepted_values_stg_commodity_metrics_trend__up__down__flat.70479897b5: BEGIN
[0m04:36:52.126934 [debug] [Thread-3 (]: Using postgres connection "test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_daily_return__0_5___0_5.2c4246e1e4"
[0m04:36:52.127523 [debug] [Thread-4 (]: Using postgres connection "test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_rolling_avg_mo__0_3___0_3.22c9d514f7"
[0m04:36:52.127783 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:36:52.128772 [debug] [Thread-3 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_daily_return__0_5___0_5.2c4246e1e4: BEGIN
[0m04:36:52.129236 [debug] [Thread-2 (]: Using postgres connection "test.global_economic_tracker.accepted_values_stg_index_metrics_trend__up__down__flat.1fea418295"
[0m04:36:52.129967 [debug] [Thread-4 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_rolling_avg_mo__0_3___0_3.22c9d514f7: BEGIN
[0m04:36:52.131355 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m04:36:52.132113 [debug] [Thread-2 (]: On test.global_economic_tracker.accepted_values_stg_index_metrics_trend__up__down__flat.1fea418295: BEGIN
[0m04:36:52.132667 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m04:36:52.133082 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m04:36:52.134361 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m04:36:52.135108 [debug] [Thread-1 (]: Using postgres connection "test.global_economic_tracker.accepted_values_stg_commodity_metrics_trend__up__down__flat.70479897b5"
[0m04:36:52.135408 [debug] [Thread-3 (]: SQL status: BEGIN in 0.004 seconds
[0m04:36:52.137146 [debug] [Thread-1 (]: On test.global_economic_tracker.accepted_values_stg_commodity_metrics_trend__up__down__flat.70479897b5: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.accepted_values_stg_commodity_metrics_trend__up__down__flat.70479897b5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        trend as value_field,
        count(*) as n_records

    from "airflow"."public"."stg_commodity_metrics"
    group by trend

)

select *
from all_values
where value_field not in (
    'up','down','flat'
)



      
    ) dbt_internal_test
[0m04:36:52.137501 [debug] [Thread-4 (]: SQL status: BEGIN in 0.004 seconds
[0m04:36:52.138062 [debug] [Thread-3 (]: Using postgres connection "test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_daily_return__0_5___0_5.2c4246e1e4"
[0m04:36:52.138723 [debug] [Thread-2 (]: SQL status: BEGIN in 0.004 seconds
[0m04:36:52.139582 [debug] [Thread-4 (]: Using postgres connection "test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_rolling_avg_mo__0_3___0_3.22c9d514f7"
[0m04:36:52.139851 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m04:36:52.140608 [debug] [Thread-3 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_daily_return__0_5___0_5.2c4246e1e4: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_daily_return__0_5___0_5.2c4246e1e4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with meet_condition as(
  select *
  from "airflow"."public"."stg_commodity_metrics"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not daily_return >= -0.5
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not daily_return <= 0.5
)

select *
from validation_errors


      
    ) dbt_internal_test
[0m04:36:52.141537 [debug] [Thread-2 (]: Using postgres connection "test.global_economic_tracker.accepted_values_stg_index_metrics_trend__up__down__flat.1fea418295"
[0m04:36:52.142272 [debug] [Thread-4 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_rolling_avg_mo__0_3___0_3.22c9d514f7: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_rolling_avg_mo__0_3___0_3.22c9d514f7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with meet_condition as(
  select *
  from "airflow"."public"."stg_commodity_metrics"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not rolling_avg_mo >= -0.3
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not rolling_avg_mo <= 0.3
)

select *
from validation_errors


      
    ) dbt_internal_test
[0m04:36:52.144895 [debug] [Thread-1 (]: On test.global_economic_tracker.accepted_values_stg_commodity_metrics_trend__up__down__flat.70479897b5: ROLLBACK
[0m04:36:52.146185 [debug] [Thread-2 (]: On test.global_economic_tracker.accepted_values_stg_index_metrics_trend__up__down__flat.1fea418295: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.accepted_values_stg_index_metrics_trend__up__down__flat.1fea418295"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        trend as value_field,
        count(*) as n_records

    from "airflow"."public"."stg_index_metrics"
    group by trend

)

select *
from all_values
where value_field not in (
    'up','down','flat'
)



      
    ) dbt_internal_test
[0m04:36:52.146506 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m04:36:52.147574 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m04:36:52.147929 [debug] [Thread-1 (]: On test.global_economic_tracker.accepted_values_stg_commodity_metrics_trend__up__down__flat.70479897b5: Close
[0m04:36:52.149601 [debug] [Thread-3 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_daily_return__0_5___0_5.2c4246e1e4: ROLLBACK
[0m04:36:52.149881 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m04:36:52.150979 [debug] [Thread-4 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_rolling_avg_mo__0_3___0_3.22c9d514f7: ROLLBACK
[0m04:36:52.151888 [info ] [Thread-1 (]: 1 of 22 PASS accepted_values_stg_commodity_metrics_trend__up__down__flat ....... [[32mPASS[0m in 0.07s]
[0m04:36:52.152528 [debug] [Thread-3 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_daily_return__0_5___0_5.2c4246e1e4: Close
[0m04:36:52.153588 [debug] [Thread-2 (]: On test.global_economic_tracker.accepted_values_stg_index_metrics_trend__up__down__flat.1fea418295: ROLLBACK
[0m04:36:52.154434 [debug] [Thread-4 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_rolling_avg_mo__0_3___0_3.22c9d514f7: Close
[0m04:36:52.155135 [debug] [Thread-1 (]: Finished running node test.global_economic_tracker.accepted_values_stg_commodity_metrics_trend__up__down__flat.70479897b5
[0m04:36:52.156004 [info ] [Thread-3 (]: 3 of 22 PASS dbt_utils_accepted_range_stg_commodity_metrics_daily_return__0_5___0_5  [[32mPASS[0m in 0.07s]
[0m04:36:52.156659 [debug] [Thread-2 (]: On test.global_economic_tracker.accepted_values_stg_index_metrics_trend__up__down__flat.1fea418295: Close
[0m04:36:52.157353 [info ] [Thread-4 (]: 4 of 22 PASS dbt_utils_accepted_range_stg_commodity_metrics_rolling_avg_mo__0_3___0_3  [[32mPASS[0m in 0.08s]
[0m04:36:52.158011 [debug] [Thread-1 (]: Began running node test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_sharpe_mo__2___2.d118d6bf26
[0m04:36:52.158919 [debug] [Thread-3 (]: Finished running node test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_daily_return__0_5___0_5.2c4246e1e4
[0m04:36:52.159827 [info ] [Thread-2 (]: 2 of 22 PASS accepted_values_stg_index_metrics_trend__up__down__flat ........... [[32mPASS[0m in 0.08s]
[0m04:36:52.160450 [debug] [Thread-4 (]: Finished running node test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_rolling_avg_mo__0_3___0_3.22c9d514f7
[0m04:36:52.161185 [info ] [Thread-1 (]: 5 of 22 START test dbt_utils_accepted_range_stg_commodity_metrics_sharpe_mo__2___2  [RUN]
[0m04:36:52.161916 [debug] [Thread-3 (]: Began running node test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe
[0m04:36:52.162745 [debug] [Thread-2 (]: Finished running node test.global_economic_tracker.accepted_values_stg_index_metrics_trend__up__down__flat.1fea418295
[0m04:36:52.163501 [debug] [Thread-4 (]: Began running node test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_daily_return__0_5___0_5.6e9f33b0a2
[0m04:36:52.164254 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.global_economic_tracker.accepted_values_stg_commodity_metrics_trend__up__down__flat.70479897b5, now test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_sharpe_mo__2___2.d118d6bf26)
[0m04:36:52.164933 [info ] [Thread-3 (]: 6 of 22 START test dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5  [RUN]
[0m04:36:52.165678 [debug] [Thread-2 (]: Began running node test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_rolling_avg_mo__0_3___0_3.13a5241921
[0m04:36:52.166436 [info ] [Thread-4 (]: 7 of 22 START test dbt_utils_accepted_range_stg_index_metrics_daily_return__0_5___0_5  [RUN]
[0m04:36:52.167205 [debug] [Thread-1 (]: Began compiling node test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_sharpe_mo__2___2.d118d6bf26
[0m04:36:52.167950 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_daily_return__0_5___0_5.2c4246e1e4, now test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe)
[0m04:36:52.168677 [info ] [Thread-2 (]: 8 of 22 START test dbt_utils_accepted_range_stg_index_metrics_rolling_avg_mo__0_3___0_3  [RUN]
[0m04:36:52.169732 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_rolling_avg_mo__0_3___0_3.22c9d514f7, now test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_daily_return__0_5___0_5.6e9f33b0a2)
[0m04:36:52.172901 [debug] [Thread-1 (]: Writing injected SQL for node "test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_sharpe_mo__2___2.d118d6bf26"
[0m04:36:52.173639 [debug] [Thread-3 (]: Began compiling node test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe
[0m04:36:52.174413 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.global_economic_tracker.accepted_values_stg_index_metrics_trend__up__down__flat.1fea418295, now test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_rolling_avg_mo__0_3___0_3.13a5241921)
[0m04:36:52.175143 [debug] [Thread-4 (]: Began compiling node test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_daily_return__0_5___0_5.6e9f33b0a2
[0m04:36:52.178103 [debug] [Thread-3 (]: Writing injected SQL for node "test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe"
[0m04:36:52.179055 [debug] [Thread-2 (]: Began compiling node test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_rolling_avg_mo__0_3___0_3.13a5241921
[0m04:36:52.181607 [debug] [Thread-4 (]: Writing injected SQL for node "test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_daily_return__0_5___0_5.6e9f33b0a2"
[0m04:36:52.182867 [debug] [Thread-1 (]: Began executing node test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_sharpe_mo__2___2.d118d6bf26
[0m04:36:52.185008 [debug] [Thread-2 (]: Writing injected SQL for node "test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_rolling_avg_mo__0_3___0_3.13a5241921"
[0m04:36:52.187275 [debug] [Thread-1 (]: Writing runtime sql for node "test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_sharpe_mo__2___2.d118d6bf26"
[0m04:36:52.189547 [debug] [Thread-3 (]: Began executing node test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe
[0m04:36:52.191252 [debug] [Thread-3 (]: Writing runtime sql for node "test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe"
[0m04:36:52.191502 [debug] [Thread-4 (]: Began executing node test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_daily_return__0_5___0_5.6e9f33b0a2
[0m04:36:52.191757 [debug] [Thread-2 (]: Began executing node test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_rolling_avg_mo__0_3___0_3.13a5241921
[0m04:36:52.193761 [debug] [Thread-4 (]: Writing runtime sql for node "test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_daily_return__0_5___0_5.6e9f33b0a2"
[0m04:36:52.195379 [debug] [Thread-2 (]: Writing runtime sql for node "test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_rolling_avg_mo__0_3___0_3.13a5241921"
[0m04:36:52.196281 [debug] [Thread-1 (]: Using postgres connection "test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_sharpe_mo__2___2.d118d6bf26"
[0m04:36:52.197430 [debug] [Thread-3 (]: Using postgres connection "test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe"
[0m04:36:52.197870 [debug] [Thread-1 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_sharpe_mo__2___2.d118d6bf26: BEGIN
[0m04:36:52.198672 [debug] [Thread-3 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe: BEGIN
[0m04:36:52.198988 [debug] [Thread-4 (]: Using postgres connection "test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_daily_return__0_5___0_5.6e9f33b0a2"
[0m04:36:52.199785 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:36:52.200258 [debug] [Thread-2 (]: Using postgres connection "test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_rolling_avg_mo__0_3___0_3.13a5241921"
[0m04:36:52.200660 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m04:36:52.201397 [debug] [Thread-4 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_daily_return__0_5___0_5.6e9f33b0a2: BEGIN
[0m04:36:52.202659 [debug] [Thread-2 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_rolling_avg_mo__0_3___0_3.13a5241921: BEGIN
[0m04:36:52.203933 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m04:36:52.204345 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m04:36:52.204890 [debug] [Thread-3 (]: SQL status: BEGIN in 0.004 seconds
[0m04:36:52.205321 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m04:36:52.206058 [debug] [Thread-1 (]: Using postgres connection "test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_sharpe_mo__2___2.d118d6bf26"
[0m04:36:52.207519 [debug] [Thread-3 (]: Using postgres connection "test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe"
[0m04:36:52.208398 [debug] [Thread-4 (]: SQL status: BEGIN in 0.004 seconds
[0m04:36:52.209028 [debug] [Thread-1 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_sharpe_mo__2___2.d118d6bf26: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_sharpe_mo__2___2.d118d6bf26"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with meet_condition as(
  select *
  from "airflow"."public"."stg_commodity_metrics"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not sharpe_mo >= -2
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not sharpe_mo <= 2
)

select *
from validation_errors


      
    ) dbt_internal_test
[0m04:36:52.209721 [debug] [Thread-2 (]: SQL status: BEGIN in 0.004 seconds
[0m04:36:52.209995 [debug] [Thread-3 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with meet_condition as(
  select *
  from "airflow"."public"."stg_commodity_returns"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not daily_return >= -0.5
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not daily_return <= 0.5
)

select *
from validation_errors


      
    ) dbt_internal_test
[0m04:36:52.210746 [debug] [Thread-4 (]: Using postgres connection "test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_daily_return__0_5___0_5.6e9f33b0a2"
[0m04:36:52.212030 [debug] [Thread-2 (]: Using postgres connection "test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_rolling_avg_mo__0_3___0_3.13a5241921"
[0m04:36:52.212485 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m04:36:52.213412 [debug] [Thread-4 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_daily_return__0_5___0_5.6e9f33b0a2: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_daily_return__0_5___0_5.6e9f33b0a2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with meet_condition as(
  select *
  from "airflow"."public"."stg_index_metrics"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not daily_return >= -0.5
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not daily_return <= 0.5
)

select *
from validation_errors


      
    ) dbt_internal_test
[0m04:36:52.213702 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m04:36:52.214256 [debug] [Thread-2 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_rolling_avg_mo__0_3___0_3.13a5241921: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_rolling_avg_mo__0_3___0_3.13a5241921"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with meet_condition as(
  select *
  from "airflow"."public"."stg_index_metrics"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not rolling_avg_mo >= -0.3
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not rolling_avg_mo <= 0.3
)

select *
from validation_errors


      
    ) dbt_internal_test
[0m04:36:52.215718 [debug] [Thread-1 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_sharpe_mo__2___2.d118d6bf26: ROLLBACK
[0m04:36:52.217061 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.000 seconds
[0m04:36:52.217811 [debug] [Thread-3 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe: ROLLBACK
[0m04:36:52.218991 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.000 seconds
[0m04:36:52.219376 [debug] [Thread-1 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_sharpe_mo__2___2.d118d6bf26: Close
[0m04:36:52.220474 [debug] [Thread-4 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_daily_return__0_5___0_5.6e9f33b0a2: ROLLBACK
[0m04:36:52.221347 [debug] [Thread-3 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe: Close
[0m04:36:52.222377 [debug] [Thread-2 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_rolling_avg_mo__0_3___0_3.13a5241921: ROLLBACK
[0m04:36:52.223261 [info ] [Thread-1 (]: 5 of 22 PASS dbt_utils_accepted_range_stg_commodity_metrics_sharpe_mo__2___2 ... [[32mPASS[0m in 0.06s]
[0m04:36:52.224073 [debug] [Thread-4 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_daily_return__0_5___0_5.6e9f33b0a2: Close
[0m04:36:52.224801 [info ] [Thread-3 (]: 6 of 22 PASS dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5  [[32mPASS[0m in 0.06s]
[0m04:36:52.225438 [debug] [Thread-2 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_rolling_avg_mo__0_3___0_3.13a5241921: Close
[0m04:36:52.226125 [debug] [Thread-1 (]: Finished running node test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_sharpe_mo__2___2.d118d6bf26
[0m04:36:52.226997 [info ] [Thread-4 (]: 7 of 22 PASS dbt_utils_accepted_range_stg_index_metrics_daily_return__0_5___0_5  [[32mPASS[0m in 0.06s]
[0m04:36:52.227638 [debug] [Thread-3 (]: Finished running node test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe
[0m04:36:52.228509 [info ] [Thread-2 (]: 8 of 22 PASS dbt_utils_accepted_range_stg_index_metrics_rolling_avg_mo__0_3___0_3  [[32mPASS[0m in 0.05s]
[0m04:36:52.229086 [debug] [Thread-1 (]: Began running node test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_sharpe_mo__2___2.5a4a583bdc
[0m04:36:52.229987 [debug] [Thread-4 (]: Finished running node test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_daily_return__0_5___0_5.6e9f33b0a2
[0m04:36:52.230744 [debug] [Thread-3 (]: Began running node test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713
[0m04:36:52.231562 [debug] [Thread-2 (]: Finished running node test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_rolling_avg_mo__0_3___0_3.13a5241921
[0m04:36:52.232290 [info ] [Thread-1 (]: 9 of 22 START test dbt_utils_accepted_range_stg_index_metrics_sharpe_mo__2___2 . [RUN]
[0m04:36:52.233017 [debug] [Thread-4 (]: Began running node test.global_economic_tracker.not_null_stg_commodity_metrics_daily_return.74b14cc336
[0m04:36:52.233777 [info ] [Thread-3 (]: 10 of 22 START test dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5  [RUN]
[0m04:36:52.234506 [debug] [Thread-2 (]: Began running node test.global_economic_tracker.not_null_stg_commodity_metrics_ticker.6d1d8d12d7
[0m04:36:52.235290 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_metrics_sharpe_mo__2___2.d118d6bf26, now test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_sharpe_mo__2___2.5a4a583bdc)
[0m04:36:52.236097 [info ] [Thread-4 (]: 11 of 22 START test not_null_stg_commodity_metrics_daily_return ................ [RUN]
[0m04:36:52.236852 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.global_economic_tracker.dbt_utils_accepted_range_stg_commodity_returns_daily_return__0_5___0_5.d73ca1f9fe, now test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713)
[0m04:36:52.237799 [info ] [Thread-2 (]: 12 of 22 START test not_null_stg_commodity_metrics_ticker ...................... [RUN]
[0m04:36:52.238565 [debug] [Thread-1 (]: Began compiling node test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_sharpe_mo__2___2.5a4a583bdc
[0m04:36:52.239335 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_daily_return__0_5___0_5.6e9f33b0a2, now test.global_economic_tracker.not_null_stg_commodity_metrics_daily_return.74b14cc336)
[0m04:36:52.240173 [debug] [Thread-3 (]: Began compiling node test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713
[0m04:36:52.240925 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_rolling_avg_mo__0_3___0_3.13a5241921, now test.global_economic_tracker.not_null_stg_commodity_metrics_ticker.6d1d8d12d7)
[0m04:36:52.243250 [debug] [Thread-1 (]: Writing injected SQL for node "test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_sharpe_mo__2___2.5a4a583bdc"
[0m04:36:52.244466 [debug] [Thread-4 (]: Began compiling node test.global_economic_tracker.not_null_stg_commodity_metrics_daily_return.74b14cc336
[0m04:36:52.246917 [debug] [Thread-3 (]: Writing injected SQL for node "test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713"
[0m04:36:52.247965 [debug] [Thread-2 (]: Began compiling node test.global_economic_tracker.not_null_stg_commodity_metrics_ticker.6d1d8d12d7
[0m04:36:52.253534 [debug] [Thread-4 (]: Writing injected SQL for node "test.global_economic_tracker.not_null_stg_commodity_metrics_daily_return.74b14cc336"
[0m04:36:52.256431 [debug] [Thread-2 (]: Writing injected SQL for node "test.global_economic_tracker.not_null_stg_commodity_metrics_ticker.6d1d8d12d7"
[0m04:36:52.257681 [debug] [Thread-1 (]: Began executing node test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_sharpe_mo__2___2.5a4a583bdc
[0m04:36:52.259523 [debug] [Thread-1 (]: Writing runtime sql for node "test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_sharpe_mo__2___2.5a4a583bdc"
[0m04:36:52.260492 [debug] [Thread-4 (]: Began executing node test.global_economic_tracker.not_null_stg_commodity_metrics_daily_return.74b14cc336
[0m04:36:52.260816 [debug] [Thread-3 (]: Began executing node test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713
[0m04:36:52.261330 [debug] [Thread-2 (]: Began executing node test.global_economic_tracker.not_null_stg_commodity_metrics_ticker.6d1d8d12d7
[0m04:36:52.262303 [debug] [Thread-4 (]: Writing runtime sql for node "test.global_economic_tracker.not_null_stg_commodity_metrics_daily_return.74b14cc336"
[0m04:36:52.263748 [debug] [Thread-3 (]: Writing runtime sql for node "test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713"
[0m04:36:52.265218 [debug] [Thread-2 (]: Writing runtime sql for node "test.global_economic_tracker.not_null_stg_commodity_metrics_ticker.6d1d8d12d7"
[0m04:36:52.267694 [debug] [Thread-1 (]: Using postgres connection "test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_sharpe_mo__2___2.5a4a583bdc"
[0m04:36:52.267966 [debug] [Thread-4 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_commodity_metrics_daily_return.74b14cc336"
[0m04:36:52.268767 [debug] [Thread-1 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_sharpe_mo__2___2.5a4a583bdc: BEGIN
[0m04:36:52.269629 [debug] [Thread-4 (]: On test.global_economic_tracker.not_null_stg_commodity_metrics_daily_return.74b14cc336: BEGIN
[0m04:36:52.269963 [debug] [Thread-2 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_commodity_metrics_ticker.6d1d8d12d7"
[0m04:36:52.270631 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:36:52.271203 [debug] [Thread-3 (]: Using postgres connection "test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713"
[0m04:36:52.271603 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m04:36:52.272370 [debug] [Thread-2 (]: On test.global_economic_tracker.not_null_stg_commodity_metrics_ticker.6d1d8d12d7: BEGIN
[0m04:36:52.273785 [debug] [Thread-3 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713: BEGIN
[0m04:36:52.274482 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m04:36:52.275343 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m04:36:52.276076 [debug] [Thread-4 (]: SQL status: BEGIN in 0.004 seconds
[0m04:36:52.276364 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m04:36:52.277101 [debug] [Thread-1 (]: Using postgres connection "test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_sharpe_mo__2___2.5a4a583bdc"
[0m04:36:52.278404 [debug] [Thread-4 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_commodity_metrics_daily_return.74b14cc336"
[0m04:36:52.279130 [debug] [Thread-2 (]: SQL status: BEGIN in 0.004 seconds
[0m04:36:52.280144 [debug] [Thread-1 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_sharpe_mo__2___2.5a4a583bdc: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_sharpe_mo__2___2.5a4a583bdc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with meet_condition as(
  select *
  from "airflow"."public"."stg_index_metrics"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not sharpe_mo >= -2
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not sharpe_mo <= 2
)

select *
from validation_errors


      
    ) dbt_internal_test
[0m04:36:52.280868 [debug] [Thread-3 (]: SQL status: BEGIN in 0.004 seconds
[0m04:36:52.281135 [debug] [Thread-4 (]: On test.global_economic_tracker.not_null_stg_commodity_metrics_daily_return.74b14cc336: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.not_null_stg_commodity_metrics_daily_return.74b14cc336"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select daily_return
from "airflow"."public"."stg_commodity_metrics"
where daily_return is null



      
    ) dbt_internal_test
[0m04:36:52.281864 [debug] [Thread-2 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_commodity_metrics_ticker.6d1d8d12d7"
[0m04:36:52.283092 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m04:36:52.283397 [debug] [Thread-3 (]: Using postgres connection "test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713"
[0m04:36:52.284472 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.000 seconds
[0m04:36:52.284866 [debug] [Thread-2 (]: On test.global_economic_tracker.not_null_stg_commodity_metrics_ticker.6d1d8d12d7: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.not_null_stg_commodity_metrics_ticker.6d1d8d12d7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select ticker
from "airflow"."public"."stg_commodity_metrics"
where ticker is null



      
    ) dbt_internal_test
[0m04:36:52.286083 [debug] [Thread-1 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_sharpe_mo__2___2.5a4a583bdc: ROLLBACK
[0m04:36:52.286831 [debug] [Thread-3 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

with meet_condition as(
  select *
  from "airflow"."public"."stg_index_returns"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not daily_return >= -0.5
    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not daily_return <= 0.5
)

select *
from validation_errors


      
    ) dbt_internal_test
[0m04:36:52.287981 [debug] [Thread-4 (]: On test.global_economic_tracker.not_null_stg_commodity_metrics_daily_return.74b14cc336: ROLLBACK
[0m04:36:52.289045 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.000 seconds
[0m04:36:52.289612 [debug] [Thread-1 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_sharpe_mo__2___2.5a4a583bdc: Close
[0m04:36:52.290682 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.000 seconds
[0m04:36:52.291043 [debug] [Thread-4 (]: On test.global_economic_tracker.not_null_stg_commodity_metrics_daily_return.74b14cc336: Close
[0m04:36:52.292083 [debug] [Thread-2 (]: On test.global_economic_tracker.not_null_stg_commodity_metrics_ticker.6d1d8d12d7: ROLLBACK
[0m04:36:52.292953 [info ] [Thread-1 (]: 9 of 22 PASS dbt_utils_accepted_range_stg_index_metrics_sharpe_mo__2___2 ....... [[32mPASS[0m in 0.06s]
[0m04:36:52.294148 [debug] [Thread-3 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713: ROLLBACK
[0m04:36:52.295117 [info ] [Thread-4 (]: 11 of 22 PASS not_null_stg_commodity_metrics_daily_return ...................... [[32mPASS[0m in 0.06s]
[0m04:36:52.295785 [debug] [Thread-2 (]: On test.global_economic_tracker.not_null_stg_commodity_metrics_ticker.6d1d8d12d7: Close
[0m04:36:52.296441 [debug] [Thread-1 (]: Finished running node test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_sharpe_mo__2___2.5a4a583bdc
[0m04:36:52.297288 [debug] [Thread-3 (]: On test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713: Close
[0m04:36:52.297955 [debug] [Thread-4 (]: Finished running node test.global_economic_tracker.not_null_stg_commodity_metrics_daily_return.74b14cc336
[0m04:36:52.298868 [info ] [Thread-2 (]: 12 of 22 PASS not_null_stg_commodity_metrics_ticker ............................ [[32mPASS[0m in 0.06s]
[0m04:36:52.299495 [debug] [Thread-1 (]: Began running node test.global_economic_tracker.not_null_stg_commodity_metrics_timestamp.5651d4b196
[0m04:36:52.300395 [info ] [Thread-3 (]: 10 of 22 PASS dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5  [[32mPASS[0m in 0.06s]
[0m04:36:52.300973 [debug] [Thread-4 (]: Began running node test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934
[0m04:36:52.301984 [debug] [Thread-2 (]: Finished running node test.global_economic_tracker.not_null_stg_commodity_metrics_ticker.6d1d8d12d7
[0m04:36:52.302708 [info ] [Thread-1 (]: 13 of 22 START test not_null_stg_commodity_metrics_timestamp ................... [RUN]
[0m04:36:52.303520 [debug] [Thread-3 (]: Finished running node test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713
[0m04:36:52.304226 [info ] [Thread-4 (]: 14 of 22 START test not_null_stg_commodity_returns_daily_return ................ [RUN]
[0m04:36:52.304999 [debug] [Thread-2 (]: Began running node test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d
[0m04:36:52.305985 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.global_economic_tracker.dbt_utils_accepted_range_stg_index_metrics_sharpe_mo__2___2.5a4a583bdc, now test.global_economic_tracker.not_null_stg_commodity_metrics_timestamp.5651d4b196)
[0m04:36:52.306834 [debug] [Thread-3 (]: Began running node test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359
[0m04:36:52.307628 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.global_economic_tracker.not_null_stg_commodity_metrics_daily_return.74b14cc336, now test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934)
[0m04:36:52.308363 [info ] [Thread-2 (]: 15 of 22 START test not_null_stg_commodity_returns_ticker ...................... [RUN]
[0m04:36:52.309089 [debug] [Thread-1 (]: Began compiling node test.global_economic_tracker.not_null_stg_commodity_metrics_timestamp.5651d4b196
[0m04:36:52.309857 [info ] [Thread-3 (]: 16 of 22 START test not_null_stg_commodity_returns_timestamp ................... [RUN]
[0m04:36:52.310574 [debug] [Thread-4 (]: Began compiling node test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934
[0m04:36:52.311329 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.global_economic_tracker.not_null_stg_commodity_metrics_ticker.6d1d8d12d7, now test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d)
[0m04:36:52.313732 [debug] [Thread-1 (]: Writing injected SQL for node "test.global_economic_tracker.not_null_stg_commodity_metrics_timestamp.5651d4b196"
[0m04:36:52.314671 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.global_economic_tracker.dbt_utils_accepted_range_stg_index_returns_daily_return__0_5___0_5.634bf70713, now test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359)
[0m04:36:52.316935 [debug] [Thread-4 (]: Writing injected SQL for node "test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934"
[0m04:36:52.317729 [debug] [Thread-2 (]: Began compiling node test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d
[0m04:36:52.319158 [debug] [Thread-3 (]: Began compiling node test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359
[0m04:36:52.322104 [debug] [Thread-2 (]: Writing injected SQL for node "test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d"
[0m04:36:52.324500 [debug] [Thread-3 (]: Writing injected SQL for node "test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359"
[0m04:36:52.326259 [debug] [Thread-4 (]: Began executing node test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934
[0m04:36:52.326513 [debug] [Thread-1 (]: Began executing node test.global_economic_tracker.not_null_stg_commodity_metrics_timestamp.5651d4b196
[0m04:36:52.327998 [debug] [Thread-4 (]: Writing runtime sql for node "test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934"
[0m04:36:52.328270 [debug] [Thread-2 (]: Began executing node test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d
[0m04:36:52.330519 [debug] [Thread-1 (]: Writing runtime sql for node "test.global_economic_tracker.not_null_stg_commodity_metrics_timestamp.5651d4b196"
[0m04:36:52.330830 [debug] [Thread-3 (]: Began executing node test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359
[0m04:36:52.332749 [debug] [Thread-2 (]: Writing runtime sql for node "test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d"
[0m04:36:52.334797 [debug] [Thread-3 (]: Writing runtime sql for node "test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359"
[0m04:36:52.336065 [debug] [Thread-4 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934"
[0m04:36:52.337119 [debug] [Thread-4 (]: On test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934: BEGIN
[0m04:36:52.337586 [debug] [Thread-1 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_commodity_metrics_timestamp.5651d4b196"
[0m04:36:52.337849 [debug] [Thread-2 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d"
[0m04:36:52.338254 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m04:36:52.339047 [debug] [Thread-1 (]: On test.global_economic_tracker.not_null_stg_commodity_metrics_timestamp.5651d4b196: BEGIN
[0m04:36:52.340006 [debug] [Thread-2 (]: On test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d: BEGIN
[0m04:36:52.340903 [debug] [Thread-3 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359"
[0m04:36:52.341759 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:36:52.342521 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m04:36:52.342859 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m04:36:52.343426 [debug] [Thread-3 (]: On test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359: BEGIN
[0m04:36:52.345323 [debug] [Thread-4 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934"
[0m04:36:52.345716 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m04:36:52.346324 [debug] [Thread-2 (]: SQL status: BEGIN in 0.004 seconds
[0m04:36:52.346794 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m04:36:52.347569 [debug] [Thread-4 (]: On test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select daily_return
from "airflow"."public"."stg_commodity_returns"
where daily_return is null



      
    ) dbt_internal_test
[0m04:36:52.348307 [debug] [Thread-1 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_commodity_metrics_timestamp.5651d4b196"
[0m04:36:52.349037 [debug] [Thread-2 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d"
[0m04:36:52.351186 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m04:36:52.351454 [debug] [Thread-1 (]: On test.global_economic_tracker.not_null_stg_commodity_metrics_timestamp.5651d4b196: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.not_null_stg_commodity_metrics_timestamp.5651d4b196"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select timestamp
from "airflow"."public"."stg_commodity_metrics"
where timestamp is null



      
    ) dbt_internal_test
[0m04:36:52.351733 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m04:36:52.352540 [debug] [Thread-2 (]: On test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select ticker
from "airflow"."public"."stg_commodity_returns"
where ticker is null



      
    ) dbt_internal_test
[0m04:36:52.353811 [debug] [Thread-4 (]: On test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934: ROLLBACK
[0m04:36:52.354957 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.000 seconds
[0m04:36:52.355492 [debug] [Thread-3 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359"
[0m04:36:52.356585 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.000 seconds
[0m04:36:52.357099 [debug] [Thread-4 (]: On test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934: Close
[0m04:36:52.358114 [debug] [Thread-1 (]: On test.global_economic_tracker.not_null_stg_commodity_metrics_timestamp.5651d4b196: ROLLBACK
[0m04:36:52.358827 [debug] [Thread-3 (]: On test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select timestamp
from "airflow"."public"."stg_commodity_returns"
where timestamp is null



      
    ) dbt_internal_test
[0m04:36:52.360198 [debug] [Thread-2 (]: On test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d: ROLLBACK
[0m04:36:52.361115 [info ] [Thread-4 (]: 14 of 22 PASS not_null_stg_commodity_returns_daily_return ...................... [[32mPASS[0m in 0.05s]
[0m04:36:52.361785 [debug] [Thread-1 (]: On test.global_economic_tracker.not_null_stg_commodity_metrics_timestamp.5651d4b196: Close
[0m04:36:52.362691 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.000 seconds
[0m04:36:52.363299 [debug] [Thread-2 (]: On test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d: Close
[0m04:36:52.363965 [debug] [Thread-4 (]: Finished running node test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934
[0m04:36:52.364812 [info ] [Thread-1 (]: 13 of 22 PASS not_null_stg_commodity_metrics_timestamp ......................... [[32mPASS[0m in 0.06s]
[0m04:36:52.365843 [debug] [Thread-3 (]: On test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359: ROLLBACK
[0m04:36:52.366720 [info ] [Thread-2 (]: 15 of 22 PASS not_null_stg_commodity_returns_ticker ............................ [[32mPASS[0m in 0.06s]
[0m04:36:52.367491 [debug] [Thread-4 (]: Began running node test.global_economic_tracker.not_null_stg_index_metrics_daily_return.26f4856193
[0m04:36:52.368415 [debug] [Thread-1 (]: Finished running node test.global_economic_tracker.not_null_stg_commodity_metrics_timestamp.5651d4b196
[0m04:36:52.369228 [debug] [Thread-3 (]: On test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359: Close
[0m04:36:52.369896 [debug] [Thread-2 (]: Finished running node test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d
[0m04:36:52.370622 [info ] [Thread-4 (]: 17 of 22 START test not_null_stg_index_metrics_daily_return .................... [RUN]
[0m04:36:52.371356 [debug] [Thread-1 (]: Began running node test.global_economic_tracker.not_null_stg_index_metrics_ticker.4b922607c9
[0m04:36:52.372283 [info ] [Thread-3 (]: 16 of 22 PASS not_null_stg_commodity_returns_timestamp ......................... [[32mPASS[0m in 0.06s]
[0m04:36:52.372850 [debug] [Thread-2 (]: Began running node test.global_economic_tracker.not_null_stg_index_metrics_timestamp.b1d1abca86
[0m04:36:52.373753 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.global_economic_tracker.not_null_stg_commodity_returns_daily_return.4aee50d934, now test.global_economic_tracker.not_null_stg_index_metrics_daily_return.26f4856193)
[0m04:36:52.374503 [info ] [Thread-1 (]: 18 of 22 START test not_null_stg_index_metrics_ticker .......................... [RUN]
[0m04:36:52.375426 [debug] [Thread-3 (]: Finished running node test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359
[0m04:36:52.376145 [info ] [Thread-2 (]: 19 of 22 START test not_null_stg_index_metrics_timestamp ....................... [RUN]
[0m04:36:52.376843 [debug] [Thread-4 (]: Began compiling node test.global_economic_tracker.not_null_stg_index_metrics_daily_return.26f4856193
[0m04:36:52.377551 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.global_economic_tracker.not_null_stg_commodity_metrics_timestamp.5651d4b196, now test.global_economic_tracker.not_null_stg_index_metrics_ticker.4b922607c9)
[0m04:36:52.378355 [debug] [Thread-3 (]: Began running node test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8
[0m04:36:52.379113 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.global_economic_tracker.not_null_stg_commodity_returns_ticker.667685f78d, now test.global_economic_tracker.not_null_stg_index_metrics_timestamp.b1d1abca86)
[0m04:36:52.381585 [debug] [Thread-4 (]: Writing injected SQL for node "test.global_economic_tracker.not_null_stg_index_metrics_daily_return.26f4856193"
[0m04:36:52.382367 [debug] [Thread-1 (]: Began compiling node test.global_economic_tracker.not_null_stg_index_metrics_ticker.4b922607c9
[0m04:36:52.383107 [info ] [Thread-3 (]: 20 of 22 START test not_null_stg_index_returns_daily_return .................... [RUN]
[0m04:36:52.383869 [debug] [Thread-2 (]: Began compiling node test.global_economic_tracker.not_null_stg_index_metrics_timestamp.b1d1abca86
[0m04:36:52.386670 [debug] [Thread-1 (]: Writing injected SQL for node "test.global_economic_tracker.not_null_stg_index_metrics_ticker.4b922607c9"
[0m04:36:52.387474 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.global_economic_tracker.not_null_stg_commodity_returns_timestamp.db78c2b359, now test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8)
[0m04:36:52.389884 [debug] [Thread-2 (]: Writing injected SQL for node "test.global_economic_tracker.not_null_stg_index_metrics_timestamp.b1d1abca86"
[0m04:36:52.390740 [debug] [Thread-4 (]: Began executing node test.global_economic_tracker.not_null_stg_index_metrics_daily_return.26f4856193
[0m04:36:52.391328 [debug] [Thread-3 (]: Began compiling node test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8
[0m04:36:52.393562 [debug] [Thread-4 (]: Writing runtime sql for node "test.global_economic_tracker.not_null_stg_index_metrics_daily_return.26f4856193"
[0m04:36:52.395867 [debug] [Thread-3 (]: Writing injected SQL for node "test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8"
[0m04:36:52.396973 [debug] [Thread-1 (]: Began executing node test.global_economic_tracker.not_null_stg_index_metrics_ticker.4b922607c9
[0m04:36:52.397679 [debug] [Thread-2 (]: Began executing node test.global_economic_tracker.not_null_stg_index_metrics_timestamp.b1d1abca86
[0m04:36:52.399364 [debug] [Thread-1 (]: Writing runtime sql for node "test.global_economic_tracker.not_null_stg_index_metrics_ticker.4b922607c9"
[0m04:36:52.400938 [debug] [Thread-2 (]: Writing runtime sql for node "test.global_economic_tracker.not_null_stg_index_metrics_timestamp.b1d1abca86"
[0m04:36:52.402817 [debug] [Thread-4 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_index_metrics_daily_return.26f4856193"
[0m04:36:52.403684 [debug] [Thread-4 (]: On test.global_economic_tracker.not_null_stg_index_metrics_daily_return.26f4856193: BEGIN
[0m04:36:52.403978 [debug] [Thread-1 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_index_metrics_ticker.4b922607c9"
[0m04:36:52.404737 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m04:36:52.405525 [debug] [Thread-2 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_index_metrics_timestamp.b1d1abca86"
[0m04:36:52.405834 [debug] [Thread-1 (]: On test.global_economic_tracker.not_null_stg_index_metrics_ticker.4b922607c9: BEGIN
[0m04:36:52.406080 [debug] [Thread-3 (]: Began executing node test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8
[0m04:36:52.407471 [debug] [Thread-2 (]: On test.global_economic_tracker.not_null_stg_index_metrics_timestamp.b1d1abca86: BEGIN
[0m04:36:52.408183 [debug] [Thread-4 (]: SQL status: BEGIN in 0.003 seconds
[0m04:36:52.408508 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:36:52.410665 [debug] [Thread-3 (]: Writing runtime sql for node "test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8"
[0m04:36:52.411424 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m04:36:52.412236 [debug] [Thread-4 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_index_metrics_daily_return.26f4856193"
[0m04:36:52.414760 [debug] [Thread-4 (]: On test.global_economic_tracker.not_null_stg_index_metrics_daily_return.26f4856193: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.not_null_stg_index_metrics_daily_return.26f4856193"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select daily_return
from "airflow"."public"."stg_index_metrics"
where daily_return is null



      
    ) dbt_internal_test
[0m04:36:52.415015 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m04:36:52.415548 [debug] [Thread-2 (]: SQL status: BEGIN in 0.004 seconds
[0m04:36:52.416181 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.000 seconds
[0m04:36:52.416640 [debug] [Thread-1 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_index_metrics_ticker.4b922607c9"
[0m04:36:52.417361 [debug] [Thread-2 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_index_metrics_timestamp.b1d1abca86"
[0m04:36:52.418606 [debug] [Thread-4 (]: On test.global_economic_tracker.not_null_stg_index_metrics_daily_return.26f4856193: ROLLBACK
[0m04:36:52.419377 [debug] [Thread-1 (]: On test.global_economic_tracker.not_null_stg_index_metrics_ticker.4b922607c9: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.not_null_stg_index_metrics_ticker.4b922607c9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select ticker
from "airflow"."public"."stg_index_metrics"
where ticker is null



      
    ) dbt_internal_test
[0m04:36:52.420286 [debug] [Thread-2 (]: On test.global_economic_tracker.not_null_stg_index_metrics_timestamp.b1d1abca86: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.not_null_stg_index_metrics_timestamp.b1d1abca86"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select timestamp
from "airflow"."public"."stg_index_metrics"
where timestamp is null



      
    ) dbt_internal_test
[0m04:36:52.421013 [debug] [Thread-3 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8"
[0m04:36:52.421386 [debug] [Thread-4 (]: On test.global_economic_tracker.not_null_stg_index_metrics_daily_return.26f4856193: Close
[0m04:36:52.422357 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.000 seconds
[0m04:36:52.422946 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.000 seconds
[0m04:36:52.423357 [debug] [Thread-3 (]: On test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8: BEGIN
[0m04:36:52.424233 [info ] [Thread-4 (]: 17 of 22 PASS not_null_stg_index_metrics_daily_return .......................... [[32mPASS[0m in 0.05s]
[0m04:36:52.425256 [debug] [Thread-1 (]: On test.global_economic_tracker.not_null_stg_index_metrics_ticker.4b922607c9: ROLLBACK
[0m04:36:52.426441 [debug] [Thread-2 (]: On test.global_economic_tracker.not_null_stg_index_metrics_timestamp.b1d1abca86: ROLLBACK
[0m04:36:52.427188 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m04:36:52.428023 [debug] [Thread-4 (]: Finished running node test.global_economic_tracker.not_null_stg_index_metrics_daily_return.26f4856193
[0m04:36:52.428864 [debug] [Thread-1 (]: On test.global_economic_tracker.not_null_stg_index_metrics_ticker.4b922607c9: Close
[0m04:36:52.429620 [debug] [Thread-2 (]: On test.global_economic_tracker.not_null_stg_index_metrics_timestamp.b1d1abca86: Close
[0m04:36:52.430888 [debug] [Thread-4 (]: Began running node test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0
[0m04:36:52.431513 [debug] [Thread-3 (]: SQL status: BEGIN in 0.004 seconds
[0m04:36:52.431919 [info ] [Thread-1 (]: 18 of 22 PASS not_null_stg_index_metrics_ticker ................................ [[32mPASS[0m in 0.05s]
[0m04:36:52.432592 [info ] [Thread-2 (]: 19 of 22 PASS not_null_stg_index_metrics_timestamp ............................. [[32mPASS[0m in 0.05s]
[0m04:36:52.433272 [info ] [Thread-4 (]: 21 of 22 START test not_null_stg_index_returns_ticker .......................... [RUN]
[0m04:36:52.433990 [debug] [Thread-3 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8"
[0m04:36:52.434812 [debug] [Thread-1 (]: Finished running node test.global_economic_tracker.not_null_stg_index_metrics_ticker.4b922607c9
[0m04:36:52.435572 [debug] [Thread-2 (]: Finished running node test.global_economic_tracker.not_null_stg_index_metrics_timestamp.b1d1abca86
[0m04:36:52.436296 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.global_economic_tracker.not_null_stg_index_metrics_daily_return.26f4856193, now test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0)
[0m04:36:52.437024 [debug] [Thread-3 (]: On test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select daily_return
from "airflow"."public"."stg_index_returns"
where daily_return is null



      
    ) dbt_internal_test
[0m04:36:52.437871 [debug] [Thread-1 (]: Began running node test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17
[0m04:36:52.439347 [debug] [Thread-4 (]: Began compiling node test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0
[0m04:36:52.440476 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.000 seconds
[0m04:36:52.440876 [info ] [Thread-1 (]: 22 of 22 START test not_null_stg_index_returns_timestamp ....................... [RUN]
[0m04:36:52.443371 [debug] [Thread-4 (]: Writing injected SQL for node "test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0"
[0m04:36:52.444965 [debug] [Thread-3 (]: On test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8: ROLLBACK
[0m04:36:52.445831 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.global_economic_tracker.not_null_stg_index_metrics_ticker.4b922607c9, now test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17)
[0m04:36:52.447218 [debug] [Thread-3 (]: On test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8: Close
[0m04:36:52.447815 [debug] [Thread-1 (]: Began compiling node test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17
[0m04:36:52.448682 [info ] [Thread-3 (]: 20 of 22 PASS not_null_stg_index_returns_daily_return .......................... [[32mPASS[0m in 0.06s]
[0m04:36:52.450847 [debug] [Thread-1 (]: Writing injected SQL for node "test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17"
[0m04:36:52.451646 [debug] [Thread-3 (]: Finished running node test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8
[0m04:36:52.452443 [debug] [Thread-4 (]: Began executing node test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0
[0m04:36:52.454640 [debug] [Thread-4 (]: Writing runtime sql for node "test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0"
[0m04:36:52.457213 [debug] [Thread-1 (]: Began executing node test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17
[0m04:36:52.458649 [debug] [Thread-1 (]: Writing runtime sql for node "test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17"
[0m04:36:52.461195 [debug] [Thread-4 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0"
[0m04:36:52.462103 [debug] [Thread-4 (]: On test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0: BEGIN
[0m04:36:52.462516 [debug] [Thread-1 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17"
[0m04:36:52.463013 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m04:36:52.463739 [debug] [Thread-1 (]: On test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17: BEGIN
[0m04:36:52.465082 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:36:52.465921 [debug] [Thread-4 (]: SQL status: BEGIN in 0.003 seconds
[0m04:36:52.466628 [debug] [Thread-4 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0"
[0m04:36:52.467294 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m04:36:52.467555 [debug] [Thread-4 (]: On test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select ticker
from "airflow"."public"."stg_index_returns"
where ticker is null



      
    ) dbt_internal_test
[0m04:36:52.468306 [debug] [Thread-1 (]: Using postgres connection "test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17"
[0m04:36:52.469482 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.000 seconds
[0m04:36:52.469889 [debug] [Thread-1 (]: On test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "global_economic_tracker", "target_name": "dev", "node_id": "test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select timestamp
from "airflow"."public"."stg_index_returns"
where timestamp is null



      
    ) dbt_internal_test
[0m04:36:52.471120 [debug] [Thread-4 (]: On test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0: ROLLBACK
[0m04:36:52.472198 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.000 seconds
[0m04:36:52.472698 [debug] [Thread-4 (]: On test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0: Close
[0m04:36:52.473722 [debug] [Thread-1 (]: On test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17: ROLLBACK
[0m04:36:52.474655 [info ] [Thread-4 (]: 21 of 22 PASS not_null_stg_index_returns_ticker ................................ [[32mPASS[0m in 0.04s]
[0m04:36:52.475365 [debug] [Thread-1 (]: On test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17: Close
[0m04:36:52.476058 [debug] [Thread-4 (]: Finished running node test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0
[0m04:36:52.476880 [info ] [Thread-1 (]: 22 of 22 PASS not_null_stg_index_returns_timestamp ............................. [[32mPASS[0m in 0.03s]
[0m04:36:52.478047 [debug] [Thread-1 (]: Finished running node test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17
[0m04:36:52.480113 [debug] [MainThread]: Using postgres connection "master"
[0m04:36:52.480809 [debug] [MainThread]: On master: BEGIN
[0m04:36:52.481491 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:36:52.483478 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m04:36:52.484187 [debug] [MainThread]: On master: COMMIT
[0m04:36:52.485034 [debug] [MainThread]: Using postgres connection "master"
[0m04:36:52.485713 [debug] [MainThread]: On master: COMMIT
[0m04:36:52.486702 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m04:36:52.487436 [debug] [MainThread]: On master: Close
[0m04:36:52.488166 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:36:52.488903 [debug] [MainThread]: Connection 'test.global_economic_tracker.not_null_stg_index_returns_timestamp.4f8a428b17' was properly closed.
[0m04:36:52.489624 [debug] [MainThread]: Connection 'test.global_economic_tracker.not_null_stg_index_metrics_timestamp.b1d1abca86' was properly closed.
[0m04:36:52.490307 [debug] [MainThread]: Connection 'test.global_economic_tracker.not_null_stg_index_returns_daily_return.19ad6938b8' was properly closed.
[0m04:36:52.491042 [debug] [MainThread]: Connection 'test.global_economic_tracker.not_null_stg_index_returns_ticker.acc6892ae0' was properly closed.
[0m04:36:52.491738 [info ] [MainThread]: 
[0m04:36:52.492499 [info ] [MainThread]: Finished running 22 data tests in 0 hours 0 minutes and 0.47 seconds (0.47s).
[0m04:36:52.494649 [debug] [MainThread]: Command end result
[0m04:36:52.564035 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/global_economic_tracker/target/manifest.json
[0m04:36:52.568790 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/global_economic_tracker/target/semantic_manifest.json
[0m04:36:52.576922 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/global_economic_tracker/target/run_results.json
[0m04:36:52.577706 [info ] [MainThread]: 
[0m04:36:52.578566 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:36:52.579350 [info ] [MainThread]: 
[0m04:36:52.580273 [info ] [MainThread]: Done. PASS=22 WARN=0 ERROR=0 SKIP=0 TOTAL=22
[0m04:36:52.581845 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.8107997, "process_in_blocks": "1968", "process_kernel_time": 0.26121, "process_mem_max_rss": "124040", "process_out_blocks": "0", "process_user_time": 1.535916}
[0m04:36:52.582712 [debug] [MainThread]: Command `dbt test` succeeded at 04:36:52.582624 after 1.81 seconds
[0m04:36:52.583494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb69e9fdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb66fe2c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb69ec29c0>]}
[0m04:36:52.584242 [debug] [MainThread]: Flushing usage events
[0m04:36:52.926237 [debug] [MainThread]: An error was encountered while trying to flush usage events
